# Using C++ and CMake

CMake is an open-source platform-independent build system that manages the
entire software build process, from source code to executable binary. If you're
new to CMake, you can find more information on the [CMake website](https://cmake.org).

**Installing a binary release**

Pre-built XSIGMA releases maintained by the community exist for a number of
distributions, as shown in the following table:


| Operating System/ Package manager  | Package Name    | Version |
|------------------------------------|-----------------|---------|
| Fedora Rawhide                     |  xsigma-devel      | ![Fedora rawhide package](https://img.shields.io/fedora/v/xsigma-devel) |
| Fedora 38                          |  xsigma-devel      | ![Fedora 38 package](https://img.shields.io/fedora/v/xsigma-devel/f38) |
| Fedora 37                          |  xsigma-devel      | ![Fedora 37 package](https://img.shields.io/fedora/v/xsigma-devel/f37) |
| Ubuntu 23.04 (lunar)               |  libxsigma9-dev    | ![Ubuntu lunar package](https://img.shields.io/ubuntu/v/xsigma9/lunar)
| Ubuntu 22.10 (kinetic)             |  libxsigma9-dev    | ![Ubuntu kinetic package](https://img.shields.io/ubuntu/v/xsigma9/kinetic)
| Ubuntu 22.04 (jammy)               |  libxsigma9-dev    | ![Ubuntu jammy package](https://img.shields.io/ubuntu/v/xsigma9/jammy)
| Ubuntu 20.04 (focal)               |  libxsigma7-dev    | ![Ubuntu focal package](https://img.shields.io/ubuntu/v/xsigma7/focal)
| Debian unstable                    |  libxsigma9-devel  | ![Debian unstable package](https://img.shields.io/debian/v/libxsigma9-dev) |
| Debian testing                     |  libxsigma9-devel  | ![Debian testing package](https://img.shields.io/debian/v/libxsigma9-dev/testing) |
| Debian stable                      |  libxsigma9-devel  | ![Debian stable package](https://img.shields.io/debian/v/libxsigma9-dev/stable) |
| Gentoo                             |     xsigma         | 	[![Gentoo package](https://repology.org/badge/version-for-repo/gentoo/xsigma.svg)](https://repology.org/project/xsigma/versions)
| homebrew                           |     xsigma         | ![homebrew version](https://img.shields.io/homebrew/v/xsigma)|
| vckpg                              |     xsigma         | ![Vcpkg](https://img.shields.io/vcpkg/v/xsigma) |
| spack                              |     xsigma         | ![Spack](https://img.shields.io/spack/v/xsigma) |


Note that these packages may be lacking some optional features such as mpi, qt
etc. or, they may not contain the latest XSIGMA features.  Check the documentation
of each package to verify that the build contains what you need.  If what you
need is missing you will need to [build xsigma from scratch](../build_instructions/index.md).

**Building an executable**

Once XSIGMA is installed using either of the methods above you can use it in your
project utilizing the
[find_package](https://cmake.org/cmake/help/latest/command/find_package.html)
infrastructure of cmake:

```cmake
find_package(XSIGMA
  COMPONENTS
  .. list of xsigma modules to link to
)

# your executable
add_executable(testExample ...)

# link to required XSIGMA libraries
target_link_libraries(testExample
  PRIVATE
   ${XSIGMA_LIBRARIES}
)

xsigma_module_autoinit(
  TARGETS testExample
  MODULES ${XSIGMA_LIBRARIES}
)
```

{cmake:command}`xsigma_module_autoinit` is responsible for triggering static code construction required for some XSIGMA classes.
For more details regarding the autoinit system of XSIGMA see [here](../api/cmake/ModuleSystem.md#autoinit).

The list of required xsigma modules depends on the files `#include`d in your code. The module a header file belongs to is determined
in most cases by its location in the XSIGMA source tree. For, example `xsigmaXMLPolyDataReader` is located under `IO/XML` so it belongs to the `IOXML` module,
to verify check the accompanying [`xsigma.module`](https://gitlab.kitware.com/xsigma/xsigma/-/blob/master/IO/XML/xsigma.module) file in the same directory.

The above method works in most cases but it does not express the dependencies that some module have. A better (and easier) way to
find the required modules is the [XSIGMAModulesForCxx](https://examples.xsigma.org/site/Python/Utilities/XSIGMAModulesForCxx) script.

For example, running the script on the [CylinderExample](https://examples.xsigma.org/site/Cxx/GeometricObjects/CylinderExample)
we get the following suggestion:

```cmake
find_package(XSIGMA
 COMPONENTS
    CommonColor
    CommonCore
    FiltersSources
    RenderingCore
    #
    # These modules are suggested since they implement an existing module.
    # You may need to uncomment one or more of these.
    # If xsigmaRenderWindow is used and you want to use OpenGL,
    #   you also need the RenderingOpenGL2 module.
    # If xsigmaRenderWindowInteractor is used,
    #    uncomment RenderingUI and possibly InteractionStyle.
    # If text rendering is used, uncomment RenderingFreeType
    #
    # InteractionStyle  # implements XSIGMA::RenderingCore
    # RenderingCellGrid # implements XSIGMA::RenderingCore
    # RenderingFreeType # implements XSIGMA::RenderingCore
    # RenderingOpenGL2  # implements XSIGMA::RenderingCore
    # RenderingUI       # implements XSIGMA::RenderingCore
)
```

Based on the suggestions of the script and the template above the relevant sections of the `CMakeLists.txt` are:

```cmake
...
find_package(XSIGMA COMPONENTS
  CommonColor
  CommonCore
  FiltersSources
  InteractionStyle
  RenderingContextOpenGL2
  RenderingCore
  RenderingFreeType
  RenderingGL2PSOpenGL2
  RenderingOpenGL2
)

add_executable(CylinderExample CylinderExample.cxx)
target_link_libraries(CylinderExample PRIVATE ${XSIGMA_LIBRARIES})
# xsigma_module_autoinit is needed
xsigma_module_autoinit(
  TARGETS CylinderExample
  MODULES ${XSIGMA_LIBRARIES}
)
```

The full source of the example can be found [here](https://examples.xsigma.org/site/Cxx/GeometricObjects/CylinderExample/).

To build the example:

```
mkdir build
cd build
ccmake ../ # or cmake-gui if on Windows
```
Hit `C` if using `ccmake` or the configure button if using `cmake-gui`.
If XSIGMA was built from scratch you will need to set `XSIGMA_DIR` to the installation path.
If `ccmake`/`cmake-gui` reports no errors quit `ccmake`/`cmake-gui` and build the project as follows:

```
cmake --build .
```
To run the example

```
./CylinderExample
```

For more examples check the
[tutorials](https://kitware.github.io/xsigma-examples/site/Cxx/#tutorial),
[how to guides](https://kitware.github.io/xsigma-examples/site/CxxHowTo) or
[examples](https://kitware.github.io/xsigma-examples/site/Cxx) sections of the xsigma examples website.
