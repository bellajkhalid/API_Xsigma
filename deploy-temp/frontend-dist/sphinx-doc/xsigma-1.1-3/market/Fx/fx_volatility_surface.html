<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="author" title="About these documents" href="../../about.html" /><link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="1.6. Implied Volatility Filter Guides" href="../Implied%20Volatility%20Filter/index.html" /><link rel="prev" title="1.5. fx_volatility_surface Guides" href="index.html" />

    <link rel="shortcut icon" href="../../_static/xsigma_favicon.png"/><!-- Generated with Sphinx 7.2.6 and Furo 2023.09.10 -->
        <title>1.5.1. FX Analytic Volatility Surfaces - PRETORIAN Documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=8c702e86" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=36a5483c" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=8c702e86" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --color-brand-primary: #0066cc;
  --color-brand-content: #0066cc;
  --color-admonition-background: #f8f9fa;
  --color-sidebar-background: #f8f9fa;
  --color-sidebar-background-border: #e9ecef;
  --font-stack: system-ui, -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, sans-serif;
  --font-stack--monospace: SFMono-Regular, Menlo, Monaco, Consolas, Liberation Mono, Courier New, monospace;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #4da6ff;
  --color-brand-content: #4da6ff;
  --color-admonition-background: #1e1e1e;
  --color-sidebar-background: #1e1e1e;
  --color-sidebar-background-border: #404040;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #4da6ff;
  --color-brand-content: #4da6ff;
  --color-admonition-background: #1e1e1e;
  --color-sidebar-background: #1e1e1e;
  --color-sidebar-background-border: #404040;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">PRETORIAN Documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../../_static/Logo.ico" alt="Logo"/>
  </div>
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../_static/../../Logo.ico" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../_static/../../Logo.ico" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">PRETORIAN Documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../about.html">About</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../index.html">1. Market</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of 1. Market</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../ASV/index.html">1.1. Analytical Sigma Volatility (ASV)</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of 1.1. Analytical Sigma Volatility (ASV)</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../ASV/executive_summary.html">1. Executive Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ASV/scope.html">2. Scope</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ASV/product_and_portfolio.html">3. Product and Portfolio</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ASV/model_methodology.html">4. Model Methodology</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ASV/implementation.html">5. Implementation and Numerical Schema</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ASV/calibration.html">6. Calibration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ASV/risk_analysis.html">7. Risk Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ASV/testing_and_validation.html">8. Testing and Validation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ASV/general_limitations.html">9. General Limitations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ASV/model_monitoring.html">10. Model Monitoring and KPIs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ASV/user_guide.html">11. User Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ASV/references.html">12. References</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ASV/README.html">13. Analytical Sigma Volatility (ASV) Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ASV/executive_summary.html">1. Executive Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ASV/scope.html">2. Scope</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ASV/product_and_portfolio.html">3. Product and Portfolio</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ASV/model_methodology.html">4. Model Methodology</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ASV/implementation.html">5. Implementation and Numerical Schema</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ASV/calibration.html">6. Calibration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ASV/risk_analysis.html">7. Risk Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ASV/testing_and_validation.html">8. Testing and Validation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ASV/general_limitations.html">9. General Limitations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ASV/model_monitoring.html">10. Model Monitoring and KPIs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ASV/user_guide.html">11. User Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ASV/references.html">12. References</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ASV/README.html">13. Analytical Sigma Volatility (ASV) Documentation</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Cheyette/index.html">Cheyette Local Vol Model</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Cheyette Local Vol Model</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../Cheyette/executive_summary.html">1. Executive Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cheyette/scope.html">2. Scope</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cheyette/products_and_payoffs.html">1.2.1.3. Products and Payoffs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cheyette/model_methodology.html">3. Model Methodology</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cheyette/implementation.html">4. Implementation / Numerical Schema Description</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cheyette/calibration.html">5. Calibration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cheyette/risk_analysis.html">6. Risk Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cheyette/testing_and_validation.html">7. Testing and Validation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cheyette/assumptions_and_limitations.html">1.2.1.9. Assumptions and Limitations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cheyette/monitoring_and_kpis.html">8. Monitoring and KPIs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cheyette/appendices.html">1.2.1.11. Appendices</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cheyette/README.html">1.2.1.12. Cheyette Local Vol Model Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cheyette/executive_summary.html">1. Executive Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cheyette/scope.html">2. Scope</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cheyette/model_methodology.html">3. Model Methodology</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cheyette/implementation.html">4. Implementation / Numerical Schema Description</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cheyette/calibration.html">5. Calibration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cheyette/risk_analysis.html">6. Risk Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cheyette/testing_and_validation.html">7. Testing and Validation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cheyette/monitoring_and_kpis.html">8. Monitoring and KPIs</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Curve%20Construction/index.html">1.3. Curve Construction and Risk Framework (New Curve Framework)</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of 1.3. Curve Construction and Risk Framework (New Curve Framework)</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../Curve%20Construction/executive_summary.html">1. Executive Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Curve%20Construction/scope.html">2. Scope</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Curve%20Construction/product_and_portfolio.html">3. Product and Portfolio</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Curve%20Construction/model_methodology.html">4. Model Methodology</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Curve%20Construction/implementation.html">5. Implementation / Numerical Schema Description</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Curve%20Construction/calibration.html">6. Calibration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Curve%20Construction/risk_analysis.html">7. Risk Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Curve%20Construction/testing_and_validation.html">8. Testing and Validation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Curve%20Construction/general_limitations.html">9. General Limitations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Curve%20Construction/model_monitoring.html">10. Model Monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Curve%20Construction/development_feedback.html">11. Development Feedback</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Curve%20Construction/references.html">12. References</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Curve%20Construction/README.html">1.3.1.13. Curve Construction and Risk Framework Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Curve%20Construction/executive_summary.html">1. Executive Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Curve%20Construction/scope.html">2. Scope</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Curve%20Construction/product_and_portfolio.html">3. Product and Portfolio</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Curve%20Construction/model_methodology.html">4. Model Methodology</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Curve%20Construction/implementation.html">5. Implementation / Numerical Schema Description</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Curve%20Construction/calibration.html">6. Calibration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Curve%20Construction/risk_analysis.html">7. Risk Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Curve%20Construction/testing_and_validation.html">8. Testing and Validation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Curve%20Construction/general_limitations.html">9. General Limitations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Curve%20Construction/model_monitoring.html">10. Model Monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Curve%20Construction/development_feedback.html">11. Development Feedback</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Curve%20Construction/references.html">12. References</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../DBOPT-CorrelationSkew/index.html">1.1. DBOPT Correlation Skew Guides</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of 1.1. DBOPT Correlation Skew Guides</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../DBOPT-CorrelationSkew/DBOPT-CorrelationSkew.html">1.1.1. Deutsche Bank Risk Model Validation Document</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../DBOPT/index.html">1.2. RateDeterministic Inflation Deterministic Guides</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of 1.2. RateDeterministic Inflation Deterministic Guides</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../DBOPT/RateDeterministic_InflationDeterministic.html">1.2.1. Interest Rate Volatility Model GSABR</a></li>
<li class="toctree-l3"><a class="reference internal" href="../DBOPT/RateDeterministic_InflationDeterministic.html#independent-validation-testing">1.2.2. 4 Independent Validation Testing</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../DBSMC/index.html">1.3. DBSMC Rate terministic FX Market Guides</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of 1.3. DBSMC Rate terministic FX Market Guides</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../DBSMC/DBSMC-RateDeterministic_FXMarket.html">1.3.1. FX Market Model Validation Document</a></li>
<li class="toctree-l3"><a class="reference internal" href="../DBSMC/DBSMC-RateDeterministic_FXMarket.html#model-uncertainty-identification-measurement-and-management">1.3.2. 5 Model Uncertainty Identification, Measurement, and Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="../DBSMC/DBSMC-RateDeterministic_FXMarket.html#control-assessment">1.3.3. 6 Control Assessment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../DBSMC/DBSMC-RateDeterministic_FXMarket.html#conclusion">1.3.4. 7 Conclusion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../DBSMC/DBSMC-RateDeterministic_FXMarket.html#document-change-history">1.3.5. 8 Document Change History</a></li>
<li class="toctree-l3"><a class="reference internal" href="../DBSMC/DBSMC-RateDeterministic_FXMarket.html#a-fx-sabr3formulapd-interpolation-and-extrapolation-retired">1.3.6. A FX SABR3FORMULAPD interpolation and extrapolation (retired)</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../DBX-ShortRate%20and%20FX%20Skew%20Stochastic%20Volatility%20models/index.html">1.4. DBX-Short Rate and FX Skew StochVol Guides</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of 1.4. DBX-Short Rate and FX Skew StochVol Guides</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../DBX-ShortRate%20and%20FX%20Skew%20Stochastic%20Volatility%20models/DBX-ShortRate_FXSkewStochVol.html">1.4.1. DBX-ShortRate_FXSkewStochVol Document</a></li>
</ul>
</li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="index.html">1.5. fx_volatility_surface Guides</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of 1.5. fx_volatility_surface Guides</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">1.5.1. FX Analytic Volatility Surfaces</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Implied%20Volatility%20Filter/index.html">1.6. Implied Volatility Filter Guides</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of 1.6. Implied Volatility Filter Guides</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../Implied%20Volatility%20Filter/Implied_Volatility_Filter.html">1.6.1. Implied Volatility Filter</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Ir/index.html">1.7. Linear_Interest_Rate_Swaps Guides</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of 1.7. Linear_Interest_Rate_Swaps Guides</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../Ir/Linear_Interest_Rate_Swaps.html">1.7.1. Linear Interest Rate Swaps</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../LSV/index.html">1.8. LSV Guides</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of 1.8. LSV Guides</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../LSV/LSV.html">1.8.1. LSV</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of 1.8.1. LSV</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../LSV/FX%20LSV%20Markov%20Switching%20%20Monte%20Carlo/FX_LSV_Markov_Switching_Monte_Carlo.html">1.8.1.1. FX LSV Markov Switching : Monte Carlo</a></li>
<li class="toctree-l4"><a class="reference internal" href="../LSV/FX%20LSV%20Markov%20Switching%20PDE/FX_LSV_Markov_Switching_PDE.html">1.8.1.2. FX LSV Markov Switching : PDE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../LSV/Local%20Volatility%20PDE%20and%20MC/Local_Volatility_PDE_and_MC.html">1.8.1.3. Local Volatility: PDE and MC</a></li>
<li class="toctree-l4"><a class="reference internal" href="../LSV/LSV%20Markov%20Switching%20%20Monte%20Carlo/LSV_Markov_Switching_Monte_Carlo.html">1.8.1.4. LSV Markov Switching : Monte Carlo</a></li>
<li class="toctree-l4"><a class="reference internal" href="../LSV/LSV%20Markov%20Switching%20%20PDE/LSV_Markov_Switching_PDE.html">1.8.1.5. LSV Markov Switching : PDE</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Local_Volatility_PDE_MC/index.html">1.9. Local Volatility PDE MC Guides</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of 1.9. Local Volatility PDE MC Guides</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../Local_Volatility_PDE_MC/Local_Volatility_PDE_MC.html">1.9.1. Local Volatility: PDE and MC</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Model%20Rate%20Deterministic_InflationDeterministic/index.html">1.10. Model Rate Deterministic Inflation Deterministic Guides</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle navigation of 1.10. Model Rate Deterministic Inflation Deterministic Guides</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../Model%20Rate%20Deterministic_InflationDeterministic/RateDeterministic_InflationDeterministic.html">1.10.1. Model Rate Deterministic Document (DBOPT/DBX)</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Model%20RateDeterministic/index.html">1.11. Rate Deterministic Guides</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle navigation of 1.11. Rate Deterministic Guides</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../Model%20RateDeterministic/RateDeterministic.html">1.11.1. The model RateDeterministic</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Model%20Short%20Rate%20Normal/index.html">1.12. Short Rate Normal Guides</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle navigation of 1.12. Short Rate Normal Guides</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../Model%20Short%20Rate%20Normal/Short_Rate_Normal.html">1.12.1. Short Rate Normal Model Validation Document</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../SABR/index.html">1.16. Interest Rate Volatility Model GSABR</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle navigation of 1.16. Interest Rate Volatility Model GSABR</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../SABR/executive_summary.html">1. Executive Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/scope.html">2. Scope and Use</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/product_and_portfolio.html">3. Product and Portfolio</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/model_methodology.html">4. Model Methodology</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/implementation.html">5. Implementation / Numerical Schema Description</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/calibration.html">6. Calibration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/risk_analysis.html">7. Risk Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/testing_and_validation.html">8. Testing and Validation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/general_limitations.html">9. General Limitations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/model_monitoring.html">10. Model Monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/market_data_integration.html">11. Market Data Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/performance_benchmarking.html">12. Performance Benchmarking</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/troubleshooting_guide.html">13. Troubleshooting Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/development_feedback.html">14. Development Feedback</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/references.html">15. References</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/executive_summary.html">1. Executive Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/scope.html">2. Scope and Use</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/product_and_portfolio.html">3. Product and Portfolio</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/model_methodology.html">4. Model Methodology</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/implementation.html">5. Implementation / Numerical Schema Description</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/calibration.html">6. Calibration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/risk_analysis.html">7. Risk Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/testing_and_validation.html">8. Testing and Validation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/general_limitations.html">9. General Limitations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/model_monitoring.html">10. Model Monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/market_data_integration.html">11. Market Data Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/performance_benchmarking.html">12. Performance Benchmarking</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/troubleshooting_guide.html">13. Troubleshooting Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/development_feedback.html">14. Development Feedback</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/references.html">15. References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../getting_started/index.html">Getting Started</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle navigation of Getting Started</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../learning.html">Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../supported_data_formats.html">Supported Data Formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../supported_hardware.html">Supported Hardware</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../modules/index.html">Modules</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle navigation of Modules</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../modules/xsigma-modules/Wrapping/PythonCore/README.html">Python Wrapper Core Classes</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../build_instructions/index.html">Building</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><div class="visually-hidden">Toggle navigation of Building</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../build_instructions/build_settings.html">Build Settings</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../api/index.html">API</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" role="switch" type="checkbox"/><label for="toctree-checkbox-22"><div class="visually-hidden">Toggle navigation of API</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../api/cpp.html">1.1. C++</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../api/python.html">1.2. Python</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" role="switch" type="checkbox"/><label for="toctree-checkbox-23"><div class="visually-hidden">Toggle navigation of 1.2. Python</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" role="switch" type="checkbox"/><label for="toctree-checkbox-24"><div class="visually-hidden">Toggle navigation of xsigmamodules</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.common.html">1.2.1.1.1.1. <code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.common</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" role="switch" type="checkbox"/><label for="toctree-checkbox-25"><div class="visually-hidden">Toggle navigation of 1.2.1.1.1.1. xsigmamodules.common</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.common.helper.html">1.2.1.1.1.1.1.1. <code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.common.helper</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.common.instrument.html">1.2.1.1.1.1.1.2. <code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.common.instrument</span></code></a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.market.html">1.2.1.1.1.2. <code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.market</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" role="switch" type="checkbox"/><label for="toctree-checkbox-26"><div class="visually-hidden">Toggle navigation of 1.2.1.1.1.2. xsigmamodules.market</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.market.market_data.html">1.2.1.1.1.2.1.1. <code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.market.market_data</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.market.object_factory.html">1.2.1.1.1.2.1.2. <code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.market.object_factory</span></code></a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.simulation.html">1.2.1.1.1.3. <code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.simulation</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" role="switch" type="checkbox"/><label for="toctree-checkbox-27"><div class="visually-hidden">Toggle navigation of 1.2.1.1.1.3. xsigmamodules.simulation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.simulation.simulation.html">1.2.1.1.1.3.1.1. <code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.simulation.simulation</span></code></a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.test.html">1.2.1.1.1.4. <code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.test</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" role="switch" type="checkbox"/><label for="toctree-checkbox-28"><div class="visually-hidden">Toggle navigation of 1.2.1.1.1.4. xsigmamodules.test</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.test.BlackBox.html">1.2.1.1.1.4.1.1. <code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.test.BlackBox</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.test.Testing.html">1.2.1.1.1.4.1.2. <code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.test.Testing</span></code></a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.util.html">1.2.1.1.1.5. <code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.util</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" role="switch" type="checkbox"/><label for="toctree-checkbox-29"><div class="visually-hidden">Toggle navigation of 1.2.1.1.1.5. xsigmamodules.util</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.util.misc.html">1.2.1.1.1.5.1.1. <code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.util.misc</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.util.numpy_support.html">1.2.1.1.1.5.1.2. <code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.util.numpy_support</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.util.object_converter.html">1.2.1.1.1.5.1.3. <code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.util.object_converter</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.util.xsigmaConstants.html">1.2.1.1.1.5.1.4. <code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.util.xsigmaConstants</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.util.xsigmaMethodParser.html">1.2.1.1.1.5.1.5. <code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.util.xsigmaMethodParser</span></code></a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.xlwing.html">1.2.1.1.1.6. <code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.xlwing</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" role="switch" type="checkbox"/><label for="toctree-checkbox-30"><div class="visually-hidden">Toggle navigation of 1.2.1.1.1.6. xsigmamodules.xlwing</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.xlwing.hartman_watson_template.html">1.2.1.1.1.6.1.1. <code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.xlwing.hartman_watson_template</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.xlwing.sabr_template.html">1.2.1.1.1.6.1.2. <code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.xlwing.sabr_template</span></code></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.generate_pyi.html">1.2.1.1.2.1. <code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.generate_pyi</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../api/cmake/cmake-modules.html">1.3. CMake</a><input class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" role="switch" type="checkbox"/><label for="toctree-checkbox-31"><div class="visually-hidden">Toggle navigation of 1.3. CMake</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/cmake/ModuleSystem.html">1.3.1. Module System</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/cmake/xsigmaModule.html">1.3.2. xsigmaModule</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/cmake/xsigmaModuleTesting.html">1.3.3. xsigmaModuleTesting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/cmake/xsigmaModuleWrapPython.html">1.3.4. xsigmaModuleWrapPython</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/cmake/xsigmaModuleWrapJava.html">1.3.5. xsigmaModuleWrapJava</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/cmake/xsigmaModuleJSON.html">1.3.6. xsigmaModuleJSON</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/cmake/xsigmaModuleGraphviz.html">1.3.7. xsigmaModuleGraphviz</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../advanced/index.html">Advanced Topics</a><input class="toctree-checkbox" id="toctree-checkbox-32" name="toctree-checkbox-32" role="switch" type="checkbox"/><label for="toctree-checkbox-32"><div class="visually-hidden">Toggle navigation of Advanced Topics</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../advanced/available_python_wheels.html">Additional Python Wheels</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../advanced/spdx_and_sbom.html">SPDX &amp; SBOM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../advanced/build_python_wheels.html">Building Python Wheels</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../advanced/build_wasm_emscripten.html">Building using emscripten for WebAssembly</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../advanced/build_for_mobile.html">Cross-compiling for Mobile devices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../advanced/build_documentation.html">Building documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../advanced/marshalling_hints.html">Marshalling Hints</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../advanced/object_manager.html">Object manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../advanced/object_serialization.html">Auto serialization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../advanced/PythonWrappers.html">Python Wrappers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../advanced/runtime_settings.html">Runtime settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../advanced/WrappingTools.html">Wrapping Tools</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../advanced/migration_guides/index.html">Migration Guides</a><input class="toctree-checkbox" id="toctree-checkbox-33" name="toctree-checkbox-33" role="switch" type="checkbox"/><label for="toctree-checkbox-33"><div class="visually-hidden">Toggle navigation of Migration Guides</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../advanced/migration_guides/ModuleMigration.html">Module Migration from XSIGMA 8.2 to 9+</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../design_documents/index.html">Design Documents</a><input class="toctree-checkbox" id="toctree-checkbox-34" name="toctree-checkbox-34" role="switch" type="checkbox"/><label for="toctree-checkbox-34"><div class="visually-hidden">Toggle navigation of Design Documents</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../design_documents/XSIGMAFileFormats.html">XSIGMA File Formats</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../design_documents/smptools.html">Parallel Processing with XSIGMAs SMP Framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../design_documents/data_assemply.html">Data Assembly</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../developers_guide/index.html">Developers Guide</a><input class="toctree-checkbox" id="toctree-checkbox-35" name="toctree-checkbox-35" role="switch" type="checkbox"/><label for="toctree-checkbox-35"><div class="visually-hidden">Toggle navigation of Developers Guide</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../developers_guide/git/develop.html">Develop</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developers_guide/testing.html">Regression Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developers_guide/git/test.html">Adding Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developers_guide/git/dashboard.html">Dashboard Scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developers_guide/git/thirdparty.html">Imported Third Party Projects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developers_guide/git/thirdparty-projects.html">Imported Third Party Projects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developers_guide/git/deprecation.html">Deprecation Process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developers_guide/release_process.html">Release Process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developers_guide/coding_conventions.html">Coding Conventions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developers_guide/about_this_documentation.html">About this documentation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../resources.html">Resources</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../release_details/index.html">Release Details</a><input class="toctree-checkbox" id="toctree-checkbox-36" name="toctree-checkbox-36" role="switch" type="checkbox"/><label for="toctree-checkbox-36"><div class="visually-hidden">Toggle navigation of Release Details</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../getting_started/index.html">Getting Started</a><input class="toctree-checkbox" id="toctree-checkbox-37" name="toctree-checkbox-37" role="switch" type="checkbox"/><label for="toctree-checkbox-37"><div class="visually-hidden">Toggle navigation of Getting Started</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Market Models</span></p>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="../index.html">1. Market Models Overview</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-38" name="toctree-checkbox-38" role="switch" type="checkbox"/><label for="toctree-checkbox-38"><div class="visually-hidden">Toggle navigation of 1. Market Models Overview</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../ASV/index.html">1.1. Analytical Sigma Volatility (ASV)</a><input class="toctree-checkbox" id="toctree-checkbox-39" name="toctree-checkbox-39" role="switch" type="checkbox"/><label for="toctree-checkbox-39"><div class="visually-hidden">Toggle navigation of 1.1. Analytical Sigma Volatility (ASV)</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../ASV/executive_summary.html">1. Executive Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ASV/scope.html">2. Scope</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ASV/product_and_portfolio.html">3. Product and Portfolio</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ASV/model_methodology.html">4. Model Methodology</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ASV/implementation.html">5. Implementation and Numerical Schema</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ASV/calibration.html">6. Calibration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ASV/risk_analysis.html">7. Risk Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ASV/testing_and_validation.html">8. Testing and Validation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ASV/general_limitations.html">9. General Limitations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ASV/model_monitoring.html">10. Model Monitoring and KPIs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ASV/user_guide.html">11. User Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ASV/references.html">12. References</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ASV/README.html">13. Analytical Sigma Volatility (ASV) Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ASV/executive_summary.html">1. Executive Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ASV/scope.html">2. Scope</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ASV/product_and_portfolio.html">3. Product and Portfolio</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ASV/model_methodology.html">4. Model Methodology</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ASV/implementation.html">5. Implementation and Numerical Schema</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ASV/calibration.html">6. Calibration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ASV/risk_analysis.html">7. Risk Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ASV/testing_and_validation.html">8. Testing and Validation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ASV/general_limitations.html">9. General Limitations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ASV/model_monitoring.html">10. Model Monitoring and KPIs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ASV/user_guide.html">11. User Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ASV/references.html">12. References</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ASV/README.html">13. Analytical Sigma Volatility (ASV) Documentation</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Cheyette/index.html">Cheyette Local Vol Model</a><input class="toctree-checkbox" id="toctree-checkbox-40" name="toctree-checkbox-40" role="switch" type="checkbox"/><label for="toctree-checkbox-40"><div class="visually-hidden">Toggle navigation of Cheyette Local Vol Model</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../Cheyette/executive_summary.html">1. Executive Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cheyette/scope.html">2. Scope</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cheyette/products_and_payoffs.html">1.2.1.3. Products and Payoffs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cheyette/model_methodology.html">3. Model Methodology</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cheyette/implementation.html">4. Implementation / Numerical Schema Description</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cheyette/calibration.html">5. Calibration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cheyette/risk_analysis.html">6. Risk Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cheyette/testing_and_validation.html">7. Testing and Validation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cheyette/assumptions_and_limitations.html">1.2.1.9. Assumptions and Limitations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cheyette/monitoring_and_kpis.html">8. Monitoring and KPIs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cheyette/appendices.html">1.2.1.11. Appendices</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cheyette/README.html">1.2.1.12. Cheyette Local Vol Model Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cheyette/executive_summary.html">1. Executive Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cheyette/scope.html">2. Scope</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cheyette/model_methodology.html">3. Model Methodology</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cheyette/implementation.html">4. Implementation / Numerical Schema Description</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cheyette/calibration.html">5. Calibration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cheyette/risk_analysis.html">6. Risk Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cheyette/testing_and_validation.html">7. Testing and Validation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cheyette/monitoring_and_kpis.html">8. Monitoring and KPIs</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Curve%20Construction/index.html">1.3. Curve Construction and Risk Framework (New Curve Framework)</a><input class="toctree-checkbox" id="toctree-checkbox-41" name="toctree-checkbox-41" role="switch" type="checkbox"/><label for="toctree-checkbox-41"><div class="visually-hidden">Toggle navigation of 1.3. Curve Construction and Risk Framework (New Curve Framework)</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../Curve%20Construction/executive_summary.html">1. Executive Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Curve%20Construction/scope.html">2. Scope</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Curve%20Construction/product_and_portfolio.html">3. Product and Portfolio</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Curve%20Construction/model_methodology.html">4. Model Methodology</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Curve%20Construction/implementation.html">5. Implementation / Numerical Schema Description</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Curve%20Construction/calibration.html">6. Calibration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Curve%20Construction/risk_analysis.html">7. Risk Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Curve%20Construction/testing_and_validation.html">8. Testing and Validation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Curve%20Construction/general_limitations.html">9. General Limitations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Curve%20Construction/model_monitoring.html">10. Model Monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Curve%20Construction/development_feedback.html">11. Development Feedback</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Curve%20Construction/references.html">12. References</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Curve%20Construction/README.html">1.3.1.13. Curve Construction and Risk Framework Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Curve%20Construction/executive_summary.html">1. Executive Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Curve%20Construction/scope.html">2. Scope</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Curve%20Construction/product_and_portfolio.html">3. Product and Portfolio</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Curve%20Construction/model_methodology.html">4. Model Methodology</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Curve%20Construction/implementation.html">5. Implementation / Numerical Schema Description</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Curve%20Construction/calibration.html">6. Calibration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Curve%20Construction/risk_analysis.html">7. Risk Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Curve%20Construction/testing_and_validation.html">8. Testing and Validation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Curve%20Construction/general_limitations.html">9. General Limitations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Curve%20Construction/model_monitoring.html">10. Model Monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Curve%20Construction/development_feedback.html">11. Development Feedback</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Curve%20Construction/references.html">12. References</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../DBOPT-CorrelationSkew/index.html">1.1. DBOPT Correlation Skew Guides</a><input class="toctree-checkbox" id="toctree-checkbox-42" name="toctree-checkbox-42" role="switch" type="checkbox"/><label for="toctree-checkbox-42"><div class="visually-hidden">Toggle navigation of 1.1. DBOPT Correlation Skew Guides</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../DBOPT-CorrelationSkew/DBOPT-CorrelationSkew.html">1.1.1. Deutsche Bank Risk Model Validation Document</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../DBOPT/index.html">1.2. RateDeterministic Inflation Deterministic Guides</a><input class="toctree-checkbox" id="toctree-checkbox-43" name="toctree-checkbox-43" role="switch" type="checkbox"/><label for="toctree-checkbox-43"><div class="visually-hidden">Toggle navigation of 1.2. RateDeterministic Inflation Deterministic Guides</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../DBOPT/RateDeterministic_InflationDeterministic.html">1.2.1. Interest Rate Volatility Model GSABR</a></li>
<li class="toctree-l3"><a class="reference internal" href="../DBOPT/RateDeterministic_InflationDeterministic.html#independent-validation-testing">1.2.2. 4 Independent Validation Testing</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../DBSMC/index.html">1.3. DBSMC Rate terministic FX Market Guides</a><input class="toctree-checkbox" id="toctree-checkbox-44" name="toctree-checkbox-44" role="switch" type="checkbox"/><label for="toctree-checkbox-44"><div class="visually-hidden">Toggle navigation of 1.3. DBSMC Rate terministic FX Market Guides</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../DBSMC/DBSMC-RateDeterministic_FXMarket.html">1.3.1. FX Market Model Validation Document</a></li>
<li class="toctree-l3"><a class="reference internal" href="../DBSMC/DBSMC-RateDeterministic_FXMarket.html#model-uncertainty-identification-measurement-and-management">1.3.2. 5 Model Uncertainty Identification, Measurement, and Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="../DBSMC/DBSMC-RateDeterministic_FXMarket.html#control-assessment">1.3.3. 6 Control Assessment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../DBSMC/DBSMC-RateDeterministic_FXMarket.html#conclusion">1.3.4. 7 Conclusion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../DBSMC/DBSMC-RateDeterministic_FXMarket.html#document-change-history">1.3.5. 8 Document Change History</a></li>
<li class="toctree-l3"><a class="reference internal" href="../DBSMC/DBSMC-RateDeterministic_FXMarket.html#a-fx-sabr3formulapd-interpolation-and-extrapolation-retired">1.3.6. A FX SABR3FORMULAPD interpolation and extrapolation (retired)</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../DBX-ShortRate%20and%20FX%20Skew%20Stochastic%20Volatility%20models/index.html">1.4. DBX-Short Rate and FX Skew StochVol Guides</a><input class="toctree-checkbox" id="toctree-checkbox-45" name="toctree-checkbox-45" role="switch" type="checkbox"/><label for="toctree-checkbox-45"><div class="visually-hidden">Toggle navigation of 1.4. DBX-Short Rate and FX Skew StochVol Guides</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../DBX-ShortRate%20and%20FX%20Skew%20Stochastic%20Volatility%20models/DBX-ShortRate_FXSkewStochVol.html">1.4.1. DBX-ShortRate_FXSkewStochVol Document</a></li>
</ul>
</li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="index.html">1.5. fx_volatility_surface Guides</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-46" name="toctree-checkbox-46" role="switch" type="checkbox"/><label for="toctree-checkbox-46"><div class="visually-hidden">Toggle navigation of 1.5. fx_volatility_surface Guides</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">1.5.1. FX Analytic Volatility Surfaces</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Implied%20Volatility%20Filter/index.html">1.6. Implied Volatility Filter Guides</a><input class="toctree-checkbox" id="toctree-checkbox-47" name="toctree-checkbox-47" role="switch" type="checkbox"/><label for="toctree-checkbox-47"><div class="visually-hidden">Toggle navigation of 1.6. Implied Volatility Filter Guides</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../Implied%20Volatility%20Filter/Implied_Volatility_Filter.html">1.6.1. Implied Volatility Filter</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Ir/index.html">1.7. Linear_Interest_Rate_Swaps Guides</a><input class="toctree-checkbox" id="toctree-checkbox-48" name="toctree-checkbox-48" role="switch" type="checkbox"/><label for="toctree-checkbox-48"><div class="visually-hidden">Toggle navigation of 1.7. Linear_Interest_Rate_Swaps Guides</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../Ir/Linear_Interest_Rate_Swaps.html">1.7.1. Linear Interest Rate Swaps</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../LSV/index.html">1.8. LSV Guides</a><input class="toctree-checkbox" id="toctree-checkbox-49" name="toctree-checkbox-49" role="switch" type="checkbox"/><label for="toctree-checkbox-49"><div class="visually-hidden">Toggle navigation of 1.8. LSV Guides</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../LSV/LSV.html">1.8.1. LSV</a><input class="toctree-checkbox" id="toctree-checkbox-50" name="toctree-checkbox-50" role="switch" type="checkbox"/><label for="toctree-checkbox-50"><div class="visually-hidden">Toggle navigation of 1.8.1. LSV</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../LSV/FX%20LSV%20Markov%20Switching%20%20Monte%20Carlo/FX_LSV_Markov_Switching_Monte_Carlo.html">1.8.1.1. FX LSV Markov Switching : Monte Carlo</a></li>
<li class="toctree-l4"><a class="reference internal" href="../LSV/FX%20LSV%20Markov%20Switching%20PDE/FX_LSV_Markov_Switching_PDE.html">1.8.1.2. FX LSV Markov Switching : PDE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../LSV/Local%20Volatility%20PDE%20and%20MC/Local_Volatility_PDE_and_MC.html">1.8.1.3. Local Volatility: PDE and MC</a></li>
<li class="toctree-l4"><a class="reference internal" href="../LSV/LSV%20Markov%20Switching%20%20Monte%20Carlo/LSV_Markov_Switching_Monte_Carlo.html">1.8.1.4. LSV Markov Switching : Monte Carlo</a></li>
<li class="toctree-l4"><a class="reference internal" href="../LSV/LSV%20Markov%20Switching%20%20PDE/LSV_Markov_Switching_PDE.html">1.8.1.5. LSV Markov Switching : PDE</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Local_Volatility_PDE_MC/index.html">1.9. Local Volatility PDE MC Guides</a><input class="toctree-checkbox" id="toctree-checkbox-51" name="toctree-checkbox-51" role="switch" type="checkbox"/><label for="toctree-checkbox-51"><div class="visually-hidden">Toggle navigation of 1.9. Local Volatility PDE MC Guides</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../Local_Volatility_PDE_MC/Local_Volatility_PDE_MC.html">1.9.1. Local Volatility: PDE and MC</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Model%20Rate%20Deterministic_InflationDeterministic/index.html">1.10. Model Rate Deterministic Inflation Deterministic Guides</a><input class="toctree-checkbox" id="toctree-checkbox-52" name="toctree-checkbox-52" role="switch" type="checkbox"/><label for="toctree-checkbox-52"><div class="visually-hidden">Toggle navigation of 1.10. Model Rate Deterministic Inflation Deterministic Guides</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../Model%20Rate%20Deterministic_InflationDeterministic/RateDeterministic_InflationDeterministic.html">1.10.1. Model Rate Deterministic Document (DBOPT/DBX)</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Model%20RateDeterministic/index.html">1.11. Rate Deterministic Guides</a><input class="toctree-checkbox" id="toctree-checkbox-53" name="toctree-checkbox-53" role="switch" type="checkbox"/><label for="toctree-checkbox-53"><div class="visually-hidden">Toggle navigation of 1.11. Rate Deterministic Guides</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../Model%20RateDeterministic/RateDeterministic.html">1.11.1. The model RateDeterministic</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Model%20Short%20Rate%20Normal/index.html">1.12. Short Rate Normal Guides</a><input class="toctree-checkbox" id="toctree-checkbox-54" name="toctree-checkbox-54" role="switch" type="checkbox"/><label for="toctree-checkbox-54"><div class="visually-hidden">Toggle navigation of 1.12. Short Rate Normal Guides</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../Model%20Short%20Rate%20Normal/Short_Rate_Normal.html">1.12.1. Short Rate Normal Model Validation Document</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../SABR/index.html">1.16. Interest Rate Volatility Model GSABR</a><input class="toctree-checkbox" id="toctree-checkbox-55" name="toctree-checkbox-55" role="switch" type="checkbox"/><label for="toctree-checkbox-55"><div class="visually-hidden">Toggle navigation of 1.16. Interest Rate Volatility Model GSABR</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../SABR/executive_summary.html">1. Executive Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/scope.html">2. Scope and Use</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/product_and_portfolio.html">3. Product and Portfolio</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/model_methodology.html">4. Model Methodology</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/implementation.html">5. Implementation / Numerical Schema Description</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/calibration.html">6. Calibration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/risk_analysis.html">7. Risk Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/testing_and_validation.html">8. Testing and Validation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/general_limitations.html">9. General Limitations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/model_monitoring.html">10. Model Monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/market_data_integration.html">11. Market Data Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/performance_benchmarking.html">12. Performance Benchmarking</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/troubleshooting_guide.html">13. Troubleshooting Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/development_feedback.html">14. Development Feedback</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/references.html">15. References</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/executive_summary.html">1. Executive Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/scope.html">2. Scope and Use</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/product_and_portfolio.html">3. Product and Portfolio</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/model_methodology.html">4. Model Methodology</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/implementation.html">5. Implementation / Numerical Schema Description</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/calibration.html">6. Calibration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/risk_analysis.html">7. Risk Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/testing_and_validation.html">8. Testing and Validation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/general_limitations.html">9. General Limitations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/model_monitoring.html">10. Model Monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/market_data_integration.html">11. Market Data Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/performance_benchmarking.html">12. Performance Benchmarking</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/troubleshooting_guide.html">13. Troubleshooting Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/development_feedback.html">14. Development Feedback</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SABR/references.html">15. References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../SABR/index.html">1.16. SABR/GSABR Models</a><input class="toctree-checkbox" id="toctree-checkbox-56" name="toctree-checkbox-56" role="switch" type="checkbox"/><label for="toctree-checkbox-56"><div class="visually-hidden">Toggle navigation of 1.16. SABR/GSABR Models</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../SABR/executive_summary.html">1. Executive Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../SABR/scope.html">2. Scope and Use</a></li>
<li class="toctree-l2"><a class="reference internal" href="../SABR/product_and_portfolio.html">3. Product and Portfolio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../SABR/model_methodology.html">4. Model Methodology</a></li>
<li class="toctree-l2"><a class="reference internal" href="../SABR/implementation.html">5. Implementation / Numerical Schema Description</a></li>
<li class="toctree-l2"><a class="reference internal" href="../SABR/calibration.html">6. Calibration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../SABR/risk_analysis.html">7. Risk Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../SABR/testing_and_validation.html">8. Testing and Validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../SABR/general_limitations.html">9. General Limitations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../SABR/model_monitoring.html">10. Model Monitoring</a></li>
<li class="toctree-l2"><a class="reference internal" href="../SABR/market_data_integration.html">11. Market Data Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../SABR/performance_benchmarking.html">12. Performance Benchmarking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../SABR/troubleshooting_guide.html">13. Troubleshooting Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../SABR/development_feedback.html">14. Development Feedback</a></li>
<li class="toctree-l2"><a class="reference internal" href="../SABR/references.html">15. References</a></li>
<li class="toctree-l2"><a class="reference internal" href="../SABR/executive_summary.html">1. Executive Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../SABR/scope.html">2. Scope and Use</a></li>
<li class="toctree-l2"><a class="reference internal" href="../SABR/product_and_portfolio.html">3. Product and Portfolio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../SABR/model_methodology.html">4. Model Methodology</a></li>
<li class="toctree-l2"><a class="reference internal" href="../SABR/implementation.html">5. Implementation / Numerical Schema Description</a></li>
<li class="toctree-l2"><a class="reference internal" href="../SABR/calibration.html">6. Calibration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../SABR/risk_analysis.html">7. Risk Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../SABR/testing_and_validation.html">8. Testing and Validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../SABR/general_limitations.html">9. General Limitations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../SABR/model_monitoring.html">10. Model Monitoring</a></li>
<li class="toctree-l2"><a class="reference internal" href="../SABR/market_data_integration.html">11. Market Data Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../SABR/performance_benchmarking.html">12. Performance Benchmarking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../SABR/troubleshooting_guide.html">13. Troubleshooting Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../SABR/development_feedback.html">14. Development Feedback</a></li>
<li class="toctree-l2"><a class="reference internal" href="../SABR/references.html">15. References</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ASV/index.html">1.1. Analytical Sigma Volatility</a><input class="toctree-checkbox" id="toctree-checkbox-57" name="toctree-checkbox-57" role="switch" type="checkbox"/><label for="toctree-checkbox-57"><div class="visually-hidden">Toggle navigation of 1.1. Analytical Sigma Volatility</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../ASV/executive_summary.html">1. Executive Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ASV/scope.html">2. Scope</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ASV/product_and_portfolio.html">3. Product and Portfolio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ASV/model_methodology.html">4. Model Methodology</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ASV/implementation.html">5. Implementation and Numerical Schema</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ASV/calibration.html">6. Calibration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ASV/risk_analysis.html">7. Risk Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ASV/testing_and_validation.html">8. Testing and Validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ASV/general_limitations.html">9. General Limitations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ASV/model_monitoring.html">10. Model Monitoring and KPIs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ASV/user_guide.html">11. User Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ASV/references.html">12. References</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ASV/README.html">13. Analytical Sigma Volatility (ASV) Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ASV/executive_summary.html">1. Executive Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ASV/scope.html">2. Scope</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ASV/product_and_portfolio.html">3. Product and Portfolio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ASV/model_methodology.html">4. Model Methodology</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ASV/implementation.html">5. Implementation and Numerical Schema</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ASV/calibration.html">6. Calibration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ASV/risk_analysis.html">7. Risk Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ASV/testing_and_validation.html">8. Testing and Validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ASV/general_limitations.html">9. General Limitations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ASV/model_monitoring.html">10. Model Monitoring and KPIs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ASV/user_guide.html">11. User Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ASV/references.html">12. References</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ASV/README.html">13. Analytical Sigma Volatility (ASV) Documentation</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Cheyette/index.html">Cheyette Interest Rate Model</a><input class="toctree-checkbox" id="toctree-checkbox-58" name="toctree-checkbox-58" role="switch" type="checkbox"/><label for="toctree-checkbox-58"><div class="visually-hidden">Toggle navigation of Cheyette Interest Rate Model</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Cheyette/executive_summary.html">1. Executive Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Cheyette/scope.html">2. Scope</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Cheyette/products_and_payoffs.html">1.2.1.3. Products and Payoffs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Cheyette/model_methodology.html">3. Model Methodology</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Cheyette/implementation.html">4. Implementation / Numerical Schema Description</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Cheyette/calibration.html">5. Calibration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Cheyette/risk_analysis.html">6. Risk Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Cheyette/testing_and_validation.html">7. Testing and Validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Cheyette/assumptions_and_limitations.html">1.2.1.9. Assumptions and Limitations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Cheyette/monitoring_and_kpis.html">8. Monitoring and KPIs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Cheyette/appendices.html">1.2.1.11. Appendices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Cheyette/README.html">1.2.1.12. Cheyette Local Vol Model Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Cheyette/executive_summary.html">1. Executive Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Cheyette/scope.html">2. Scope</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Cheyette/model_methodology.html">3. Model Methodology</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Cheyette/implementation.html">4. Implementation / Numerical Schema Description</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Cheyette/calibration.html">5. Calibration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Cheyette/risk_analysis.html">6. Risk Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Cheyette/testing_and_validation.html">7. Testing and Validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Cheyette/monitoring_and_kpis.html">8. Monitoring and KPIs</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Curve%20Construction/index.html">1.3. Curve Construction Framework</a><input class="toctree-checkbox" id="toctree-checkbox-59" name="toctree-checkbox-59" role="switch" type="checkbox"/><label for="toctree-checkbox-59"><div class="visually-hidden">Toggle navigation of 1.3. Curve Construction Framework</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Curve%20Construction/executive_summary.html">1. Executive Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Curve%20Construction/scope.html">2. Scope</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Curve%20Construction/product_and_portfolio.html">3. Product and Portfolio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Curve%20Construction/model_methodology.html">4. Model Methodology</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Curve%20Construction/implementation.html">5. Implementation / Numerical Schema Description</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Curve%20Construction/calibration.html">6. Calibration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Curve%20Construction/risk_analysis.html">7. Risk Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Curve%20Construction/testing_and_validation.html">8. Testing and Validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Curve%20Construction/general_limitations.html">9. General Limitations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Curve%20Construction/model_monitoring.html">10. Model Monitoring</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Curve%20Construction/development_feedback.html">11. Development Feedback</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Curve%20Construction/references.html">12. References</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Curve%20Construction/README.html">1.3.1.13. Curve Construction and Risk Framework Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Curve%20Construction/executive_summary.html">1. Executive Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Curve%20Construction/scope.html">2. Scope</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Curve%20Construction/product_and_portfolio.html">3. Product and Portfolio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Curve%20Construction/model_methodology.html">4. Model Methodology</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Curve%20Construction/implementation.html">5. Implementation / Numerical Schema Description</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Curve%20Construction/calibration.html">6. Calibration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Curve%20Construction/risk_analysis.html">7. Risk Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Curve%20Construction/testing_and_validation.html">8. Testing and Validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Curve%20Construction/general_limitations.html">9. General Limitations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Curve%20Construction/model_monitoring.html">10. Model Monitoring</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Curve%20Construction/development_feedback.html">11. Development Feedback</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Curve%20Construction/references.html">12. References</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../api/index.html">API Documentation</a><input class="toctree-checkbox" id="toctree-checkbox-60" name="toctree-checkbox-60" role="switch" type="checkbox"/><label for="toctree-checkbox-60"><div class="visually-hidden">Toggle navigation of API Documentation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../api/cpp.html">1.1. C++</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../api/python.html">1.2. Python</a><input class="toctree-checkbox" id="toctree-checkbox-61" name="toctree-checkbox-61" role="switch" type="checkbox"/><label for="toctree-checkbox-61"><div class="visually-hidden">Toggle navigation of 1.2. Python</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-62" name="toctree-checkbox-62" role="switch" type="checkbox"/><label for="toctree-checkbox-62"><div class="visually-hidden">Toggle navigation of xsigmamodules</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.common.html">1.2.1.1.1.1. <code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.common</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-63" name="toctree-checkbox-63" role="switch" type="checkbox"/><label for="toctree-checkbox-63"><div class="visually-hidden">Toggle navigation of 1.2.1.1.1.1. xsigmamodules.common</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.common.helper.html">1.2.1.1.1.1.1.1. <code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.common.helper</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.common.instrument.html">1.2.1.1.1.1.1.2. <code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.common.instrument</span></code></a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.market.html">1.2.1.1.1.2. <code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.market</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-64" name="toctree-checkbox-64" role="switch" type="checkbox"/><label for="toctree-checkbox-64"><div class="visually-hidden">Toggle navigation of 1.2.1.1.1.2. xsigmamodules.market</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.market.market_data.html">1.2.1.1.1.2.1.1. <code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.market.market_data</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.market.object_factory.html">1.2.1.1.1.2.1.2. <code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.market.object_factory</span></code></a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.simulation.html">1.2.1.1.1.3. <code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.simulation</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-65" name="toctree-checkbox-65" role="switch" type="checkbox"/><label for="toctree-checkbox-65"><div class="visually-hidden">Toggle navigation of 1.2.1.1.1.3. xsigmamodules.simulation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.simulation.simulation.html">1.2.1.1.1.3.1.1. <code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.simulation.simulation</span></code></a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.test.html">1.2.1.1.1.4. <code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.test</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-66" name="toctree-checkbox-66" role="switch" type="checkbox"/><label for="toctree-checkbox-66"><div class="visually-hidden">Toggle navigation of 1.2.1.1.1.4. xsigmamodules.test</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.test.BlackBox.html">1.2.1.1.1.4.1.1. <code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.test.BlackBox</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.test.Testing.html">1.2.1.1.1.4.1.2. <code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.test.Testing</span></code></a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.util.html">1.2.1.1.1.5. <code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.util</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-67" name="toctree-checkbox-67" role="switch" type="checkbox"/><label for="toctree-checkbox-67"><div class="visually-hidden">Toggle navigation of 1.2.1.1.1.5. xsigmamodules.util</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.util.misc.html">1.2.1.1.1.5.1.1. <code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.util.misc</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.util.numpy_support.html">1.2.1.1.1.5.1.2. <code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.util.numpy_support</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.util.object_converter.html">1.2.1.1.1.5.1.3. <code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.util.object_converter</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.util.xsigmaConstants.html">1.2.1.1.1.5.1.4. <code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.util.xsigmaConstants</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.util.xsigmaMethodParser.html">1.2.1.1.1.5.1.5. <code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.util.xsigmaMethodParser</span></code></a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.xlwing.html">1.2.1.1.1.6. <code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.xlwing</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-68" name="toctree-checkbox-68" role="switch" type="checkbox"/><label for="toctree-checkbox-68"><div class="visually-hidden">Toggle navigation of 1.2.1.1.1.6. xsigmamodules.xlwing</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.xlwing.hartman_watson_template.html">1.2.1.1.1.6.1.1. <code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.xlwing.hartman_watson_template</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.xlwing.sabr_template.html">1.2.1.1.1.6.1.2. <code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.xlwing.sabr_template</span></code></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.generate_pyi.html">1.2.1.1.2.1. <code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.generate_pyi</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../api/cmake/cmake-modules.html">1.3. CMake</a><input class="toctree-checkbox" id="toctree-checkbox-69" name="toctree-checkbox-69" role="switch" type="checkbox"/><label for="toctree-checkbox-69"><div class="visually-hidden">Toggle navigation of 1.3. CMake</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/cmake/ModuleSystem.html">1.3.1. Module System</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/cmake/xsigmaModule.html">1.3.2. xsigmaModule</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/cmake/xsigmaModuleTesting.html">1.3.3. xsigmaModuleTesting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/cmake/xsigmaModuleWrapPython.html">1.3.4. xsigmaModuleWrapPython</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/cmake/xsigmaModuleWrapJava.html">1.3.5. xsigmaModuleWrapJava</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/cmake/xsigmaModuleJSON.html">1.3.6. xsigmaModuleJSON</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/cmake/xsigmaModuleGraphviz.html">1.3.7. xsigmaModuleGraphviz</a></li>
</ul>
</li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section class="tex2jax_ignore mathjax_ignore" id="fx-analytic-volatility-surfaces">
<h1><span class="section-number">1.5.1. </span>FX Analytic Volatility Surfaces<a class="headerlink" href="#fx-analytic-volatility-surfaces" title="Link to this heading">#</a></h1>
<section id="table-of-contents">
<h2><span class="section-number">1.5.1.1. </span>Table of Contents<a class="headerlink" href="#table-of-contents" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="#fx-analytic-volatility-surfaces">FX Analytic Volatility Surfaces</a></p>
<ul>
<li><p><a class="reference internal" href="#table-of-contents">Table of Contents</a></p></li>
<li><p><a class="reference internal" href="#executive-summary">2. Executive Summary</a></p></li>
<li><p><a class="reference internal" href="#scope">3. Scope</a></p>
<ul>
<li><p><a class="reference internal" href="#model-purpose-and-intended-usage">3.1. Model Purpose and Intended Usage</a></p></li>
<li><p><a class="reference internal" href="#conceptual-soundness">3.2. Conceptual Soundness</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#product-payoff-portfolio">4. Product / Payoff / Portfolio</a></p>
<ul>
<li><p><a class="reference internal" href="#standard-fx-definitions-and-conventions">4.1. Standard FX Definitions and Conventions</a></p>
<ul>
<li><p><a class="reference internal" href="#currency-pair-fordom">4.1.1. Currency Pair FORDOM</a></p></li>
<li><p><a class="reference internal" href="#at-the-money">4.1.2. At-the-Money</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#description">4.2. Description</a></p>
<ul>
<li><p><a class="reference internal" href="#call-put">4.2.1. Call/Put</a></p></li>
<li><p><a class="reference internal" href="#risk-reversal">4.2.2. Risk Reversal</a></p></li>
<li><p><a class="reference internal" href="#strangle">4.2.3. Strangle</a></p></li>
<li><p><a class="reference internal" href="#straddle">4.2.4. Straddle</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#creation-of-the-volatility-surface">4.3. Creation of the Volatility Surface</a></p></li>
<li><p><a class="reference internal" href="#relationship-to-other-approved-models-payoffs">4.4. Relationship to Other Approved Models / Payoffs</a></p></li>
<li><p><a class="reference internal" href="#inputs">4.5. Inputs</a></p>
<ul>
<li><p><a class="reference internal" href="#at-the-money-volatility">4.5.1. At-the-Money Volatility</a></p></li>
<li><p><a class="reference internal" href="#id1">4.5.2. Strangle</a></p></li>
<li><p><a class="reference internal" href="#id2">4.5.3. Risk Reversal</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#payoff-analysis">4.7. Payoff Analysis</a></p></li>
<li><p><a class="reference internal" href="#the-effect-of-changing-booking-currency-on-risk-measures">4.7.1. The Effect of Changing Booking Currency on Risk Measures</a></p></li>
<li><p><a class="reference internal" href="#the-meaning-of-delta-for-volatility-surfaces">4.7.2. The Meaning of Delta for Volatility Surfaces</a></p></li>
<li><p><a class="reference internal" href="#delta-strike-relationships-by-currency-configuration">Delta/Strike Relationships by Currency Configuration</a></p></li>
<li><p><a class="reference internal" href="#example-conversions">Example Conversions</a></p></li>
<li><p><a class="reference internal" href="#practical-example">Practical Example</a></p></li>
<li><p><a class="reference internal" href="#the-zds-at-the-money-strike">4.7.3. The ZDS At-the-Money Strike</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#model-methodology">5. Model / Methodology</a></p>
<ul>
<li><p><a class="reference internal" href="#id3">5.1. Description</a></p>
<ul>
<li><p><a class="reference internal" href="#smile-models">5.1.1. Smile Models</a></p>
<ul>
<li><p><a class="reference internal" href="#analytic-quartic-smile-model">5.1.1.1. Analytic Quartic Smile Model</a></p></li>
<li><p><a class="reference internal" href="#stochastic-implied-volatility-model-for-a-single-volatility">5.1.1.1.1. Stochastic Implied Volatility Model for a Single Volatility</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#point-analytic-quartic-smile-model">5.1.1.1.2 3-Point Analytic Quartic smile model</a></p></li>
<li><p><a class="reference internal" href="#low-fly-correction-extension-to-the-analytic-quartic-models">5.1.1.1.4 Low-fly correction extension to the Analytic Quartic models</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#skew-curvature-and-skew-curvature-in-3-5-pt-analytic-models">5.1.1.1.5   Skew, curvature and skew curvature in 3/5 PT analytic models</a></p>
<ul>
<li><p><a class="reference internal" href="#quartic-model-in-the-case-of-foreign-booking-currency">5.1.1.1.6    Quartic model in the case of Foreign booking currency</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#asv-model">5.1.1.2. ASV model</a></p>
<ul>
<li><p><a class="reference internal" href="#points-asv-model">5.1.1.2.1   3-points ASV model</a></p></li>
<li><p><a class="reference internal" href="#id4">5.1.1.2.2   5-points ASV model</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#effect-of-asv-five-point-parameters">Effect of ASV five point parameters</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#512----at-the-money-time-models"><span class="xref myst">5.1.2.    At-the-money Time models</span></a></p>
<ul>
<li><p><a class="reference internal" href="#variance-interpolations">5.1.2.1.    Variance Interpolations</a></p></li>
<li><p><a class="reference internal" href="#mean-reverting-atm-time-model">5.1.2.2.    Mean-reverting ATM time model</a></p></li>
<li><p><a class="reference internal" href="#calculation-of-the-atm-implied-volatilities">5.1.2.2.1 Calculation of the ATM implied volatilities</a></p></li>
<li><p><a class="reference internal" href="#mean-reverting-backbone">5.1.2.2.2   Mean-reverting backbone</a></p></li>
<li><p><a class="reference internal" href="#events">5.1.2.2.3   Events</a></p>
<ul>
<li><p><a class="reference internal" href="#we-have-the-daily-volatility">We have the daily volatility:</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#offsets">5.1.2.2.4   Offsets</a></p></li>
<li><p><a class="reference internal" href="#wing-time-models">5.1.3.   Wing Time models</a></p>
<ul>
<li><p><a class="reference internal" href="#call-put-variance-interpolation">5.1.3.1.   Call/Put Variance Interpolation</a></p></li>
<li><p><a class="reference internal" href="#risk-reversal-strangle-quotes-interpolation">5.1.3.2.   Risk Reversal/Strangle quotes Interpolation</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#constant-moneyness-interpolation">5.1.3.3.    Constant-Moneyness Interpolation</a></p></li>
<li><p><a class="reference internal" href="#id5">5.1.3.3.    Constant-Moneyness Interpolation</a></p></li>
<li><p><a class="reference internal" href="#5133----constant-moneyness-interpolation-2"><span class="xref myst">5.1.3.3.    Constant-Moneyness Interpolation</span></a></p></li>
<li><p><a class="reference internal" href="#local-volatility-impact-and-time-arbitrage-cleanup">5.1.3.3.1    Local volatility impact and time arbitrage cleanup</a></p></li>
<li><p><a class="reference internal" href="#skew-event-model">5.1.3.4.    Skew Event Model</a></p></li>
<li><p><a class="reference internal" href="#assumptions-limitations-and-outliers">5.2 Assumptions, Limitations, and Outliers</a></p>
<ul>
<li><p><a class="reference internal" href="#negative-density">5.2.1 Negative Density</a></p></li>
<li><p><a class="reference internal" href="#limitations-on-smile-models">5.2.2 Limitations on Smile Models</a></p>
<ul>
<li><p><a class="reference internal" href="#discussion-on-3-and-5-point-analytic-quartic-smile-models">5.2.2.1 Discussion on 3- and 5-Point Analytic Quartic Smile Models</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#limitations-on-wing-time-models">5.2.3 Limitations on Wing Time Models</a></p>
<ul>
<li><p><a class="reference internal" href="#variance-interpolation-and-rr-st-quote-interpolation">5.2.3.1 Variance Interpolation and RR/ST Quote Interpolation</a></p></li>
<li><p><a class="reference internal" href="#id7">5.2.3.2 Constant-Moneyness Interpolation</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#model-parameters-variables">5.3 Model Parameters / Variables</a></p>
<ul>
<li><p><a class="reference internal" href="#atm-time-model-backbones">5.3.1 ATM Time Model Backbones</a></p>
<ul>
<li><p><a class="reference internal" href="#id8">5.3.1.1 Mean Reverting Backbone</a></p></li>
<li><p><a class="reference internal" href="#event-weights">5.3.1.2 Event Weights</a></p></li>
<li><p><a class="reference internal" href="#variance-interpolated-backbone">5.3.1.3 Variance Interpolated Backbone</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#smooth-capping-extrapolation">5.3.2 Smooth-Capping Extrapolation</a></p></li>
<li><p><a class="reference internal" href="#id9">5.3.3 Skew Event Model</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#model-outputs">5.4 Model Outputs</a></p></li>
<li><p><a class="reference internal" href="#conditions-of-use">5.9 Conditions of Use</a></p>
<ul>
<li><p><a class="reference internal" href="#stressed-market-conditions">5.9.1 Stressed Market Conditions</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#implementation-numerical-schema-description">6. Implementation / Numerical Schema Description</a></p>
<ul>
<li><p><a class="reference internal" href="#id10">6.1 Description</a></p>
<ul>
<li><p><a class="reference internal" href="#solution-of-the-quartic-equations">6.1.1 Solution of the Quartic Equations</a></p>
<ul>
<li><p><a class="reference internal" href="#cubic-equation">6.1.1.1 Cubic Equation</a></p></li>
<li><p><a class="reference internal" href="#quartic-equation">6.1.1.2 Quartic Equation</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#solution-of-the-asv-equations">6.1.2 Solution of the ASV Equations</a></p>
<ul>
<li><p><a class="reference internal" href="#point-asv-equation">6.1.2.1 3-Point ASV Equation</a></p></li>
<li><p><a class="reference internal" href="#id11">6.1.2.2 5-Point ASV Equation</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#id12">6.2 Inputs</a></p></li>
<li><p><a class="reference internal" href="#quality-control">6.3 Quality Control</a></p></li>
<li><p><a class="reference internal" href="#limitations">6.4 Limitations</a></p></li>
<li><p><a class="reference internal" href="#additional-notes">Additional Notes</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#calibration">7.Calibration</a></p>
<ul>
<li><p><a class="reference internal" href="#id13">7.1. Description</a></p>
<ul>
<li><p><a class="reference internal" href="#calibration-of-the-3-point-quartic-model">7.1.1. Calibration of the 3-point quartic model</a></p></li>
<li><p><a class="reference internal" href="#quartic-equation-solutions-discussion-on-3-point-quartic">7.1.1.1. Quartic equation solutions: discussion on 3-point quartic</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#calibration-of-the-5-point-quartic-model">7.1.2. Calibration of the 5-point quartic model</a></p>
<ul>
<li><p><a class="reference internal" href="#calibration-of-the-3-point-asv-model">7.1.3. Calibration of the 3-point ASV model</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#market-strangle-to-theoretical-strangle">7.1.5. Market strangle to theoretical strangle</a></p>
<ul>
<li><p><a class="reference internal" href="#data-sources">7.2.3.1. Data sources</a></p></li>
<li><p><a class="reference internal" href="#data-availability-history">7.2.3.2. Data availability / history</a></p></li>
<li><p><a class="reference internal" href="#data-quality-and-data-checks">7.2.3.3. Data quality and data checks</a></p></li>
<li><p><a class="reference internal" href="#calibration-algorithm-inputs">7.3 Calibration Algorithm Inputs</a></p></li>
<li><p><a class="reference internal" href="#id14">7.4 Quality Control</a></p></li>
<li><p><a class="reference internal" href="#limitations-and-risk-assessment">7.5 Limitations and Risk Assessment</a></p></li>
<li><p><a class="reference internal" href="#justification-against-alternative-approaches">7.6 Justification Against Alternative Approaches</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#risk-assessment-and-calculation-model-driven-payoff-analysis">8. Risk Assessment and Calculation (Model-Driven Payoff Analysis)</a></p>
<ul>
<li><p><a class="reference internal" href="#overview-of-fx-volatility-surface-inputs">Overview of FX Volatility Surface Inputs</a></p></li>
<li><p><a class="reference internal" href="#methodology-for-bumping-fx-volatility-surfaces">8.1 Methodology for Bumping FX Volatility Surfaces</a></p>
<ul>
<li><p><a class="reference internal" href="#at-the-money-atm-volatility-bumping">8.1.1 At-the-Money (ATM) Volatility Bumping</a></p>
<ul>
<li><p><a class="reference internal" href="#variance-interpolated-atm-bumping">8.1.1.1 Variance Interpolated ATM Bumping</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#mean-reverting-at-the-money-bumping">8.1.1.2. Mean Reverting At-the-money bumping</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#wing-bumping">8.1.3. Wing bumping</a></p>
<ul>
<li><p><a class="reference internal" href="#safe-bumping-using-ratios">8.1.3.1. Safe bumping using ratios</a></p></li>
<li><p><a class="reference internal" href="#safe-bumping-default">8.1.3.2. Safe Bumping: Default</a></p></li>
<li><p><a class="reference internal" href="#safe-bumping-keepconvex">8.1.3.3. Safe Bumping: KeepConvex</a></p></li>
<li><p><a class="reference internal" href="#justification-of-rr-and-st-ratio-used-in-bumping">8.1.3.4. Justification of RR and ST ratio used in bumping</a></p></li>
<li><p><a class="reference internal" href="#projection-of-safe-bumps-on-instruments-risks">8.1.3.5. Projection of safe bumps on instruments risks</a></p>
<ul>
<li><p><a class="reference internal" href="#projection-default">8.1.3.5.1 Projection: Default</a></p></li>
<li><p><a class="reference internal" href="#projection-keep-convex">8.1.3.5.2 Projection: Keep Convex</a></p></li>
<li><p><a class="reference internal" href="#additional-remarks">8.1.3.5.3 Additional remarks</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#id15">8.2. Inputs</a></p>
<ul>
<li><p><a class="reference internal" href="#atm-bumps">8.2.1. ATM bumps</a></p></li>
<li><p><a class="reference internal" href="#wing-bumps">8.2.2. Wing bumps</a></p></li>
<li><p><a class="reference internal" href="#limitations-and-risk-considerations">8.3 Limitations and Risk Considerations</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#comprehensive-testing-and-outcome-analysis-of-the-payoff-model-and-portfolio">9. Comprehensive Testing and Outcome Analysis of the Payoff, Model, and Portfolio</a></p>
<ul>
<li><p><a class="reference internal" href="#testing-plan">9.1 Testing Plan</a></p></li>
<li><p><a class="reference internal" href="#repricing-of-fx-volatility-inputs">9.1.1 Repricing of FX Volatility Inputs</a></p></li>
<li><p><a class="reference internal" href="#skew-event-model-implementation">9.1.2 Skew Event Model Implementation</a></p></li>
<li><p><a class="reference internal" href="#atm-time-interpolation-variance-interpolation-backbone">9.1.5 ATM Time Interpolation: Variance Interpolation Backbone</a></p></li>
<li><p><a class="reference internal" href="#atm-time-interpolation-mean-reverting-backbone">9.1.6 ATM Time Interpolation: Mean Reverting Backbone</a></p></li>
<li><p><a class="reference internal" href="#wing-time-interpolation">9.1.7 Wing Time Interpolation</a></p></li>
<li><p><a class="reference internal" href="#extrapolation">9.1.8 Extrapolation</a></p></li>
<li><p><a class="reference internal" href="#bumping">9.1.9 Bumping</a></p></li>
<li><p><a class="reference internal" href="#back-testing">9.2 Back-Testing</a></p></li>
<li><p><a class="reference internal" href="#scenario-and-stress-testing">9.3 Scenario and Stress Testing</a></p></li>
<li><p><a class="reference internal" href="#check-that-the-ratio-of-bumped-volatility-are-correct-fxvol-test-30">9.3.1. Check that the ratio of bumped volatility are correct: FXVol Test 30</a></p></li>
<li><p><a class="reference internal" href="#recalculate-manually-near-far-rega-sega-risk-fxvol-test-32">9.3.2. Recalculate manually Near/Far Rega/Sega Risk: FXVol Test 32</a></p></li>
<li><p><a class="reference internal" href="#check-these-risks-calculated-with-jacobian-against-risk-with-pure-bumps-fxvol-test-33">9.3.3. Check these risks calculated with Jacobian against risk with pure bumps: FXVol Test 33</a></p></li>
<li><p><a class="reference internal" href="#check-volatility-on-a-strike-ladder-for-very-large-bumps-of-volatility-quotes-fxvol-test-34">9.3.4. Check volatility on a strike ladder for very large bumps of volatility quotes: FXVol Test 34</a></p></li>
<li><p><a class="reference internal" href="#bump-atm-volatility-until-the-smile-model-is-not-able-to-build-fxvol-test-36">9.3.6. Bump ATM volatility until the smile model is not able to build: FXVol Test 36</a></p></li>
<li><p><a class="reference internal" href="#bump-simultaneously-atm-risk-reversals-and-strangles-for-a-large-set-of-values-fxvol-test-37">9.3.7. Bump simultaneously ATM, risk reversals and strangles for a large set of values: FXVol Test 37</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#statistical-testing">9.4. Statistical Testing</a></p></li>
<li><p><a class="reference internal" href="#impact-of-assumptions-and-limitations">9.5. Impact of Assumptions and Limitations</a></p></li>
<li><p><a class="reference internal" href="#accuracy-convergence-stability-and-sensitivity">9.6. Accuracy, Convergence, Stability and Sensitivity</a></p>
<ul>
<li><p><a class="reference internal" href="#accuracy-and-convergence">9.6.1. Accuracy and Convergence</a></p></li>
<li><p><a class="reference internal" href="#reconcile-externally-against-qa-a-query-between-2-tenors-in-monotone-cubic-variance-interpolation">9.6.3. Reconcile externally against QA a query between 2 tenors in monotone cubic variance interpolation</a></p></li>
<li><p><a class="reference internal" href="#implement-externally-mr-backbone-computation-5-params-with-ew-and-reconcile-against-qa-query">9.6.4. Implement externally MR backbone computation 5 params with EW and reconcile against QA query</a></p>
<ul>
<li><p><a class="reference internal" href="#repricing-of-market-quotes">9.6.4.1. Repricing of market quotes</a></p></li>
<li><p><a class="reference internal" href="#atm-conventions">9.6.4.2. ATM conventions</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#low-fly-correction-fxvol-test-12">9.7.1. Low fly correction: FXVol Test 12</a></p>
<ul>
<li><p><a class="reference internal" href="#9711-negative-smile-term"><span class="xref myst">9.7.1.1. Negative <span class="math notranslate nohighlight">\(smile\)</span> term</span></a></p>
<ul>
<li><p><a class="reference internal" href="#three-points-low-fly-correction">9.7.1.1.1 Three-points low fly correction</a></p></li>
<li><p><a class="reference internal" href="#five-points-low-fly-correction">9.7.1.1.2 Five-points low fly correction</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#9712-positive-smile-term-and-negative-a"><span class="xref myst">9.7.1.2. Positive <span class="math notranslate nohighlight">\(smile\)</span> term and negative <span class="math notranslate nohighlight">\(a\)</span></span></a></p></li>
<li><p><a class="reference internal" href="#9713-positive-smile-term-and-negative-smile--a"><span class="xref myst">9.7.1.3. Positive <span class="math notranslate nohighlight">\(smile\)</span> term and negative <span class="math notranslate nohighlight">\(smile + a\)</span></span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#local-volatility-quartic-model-vs-low">9.7.2. Local volatility quartic model vs low</a></p>
<ul>
<li><p><a class="reference internal" href="#bucketed-vega-rega-sega-of-a-one-touch-up-option">9.7.2.1. Bucketed Vega/Rega/Sega of a One-touch up option</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#comparison-to-other-models">9.8. Comparison to Other Models</a></p></li>
<li><p><a class="reference internal" href="#other-outcome-analysis-testing">9.9. Other Outcome Analysis / Testing</a></p></li>
<li><p><a class="reference internal" href="#general-limitations">10. General Limitations</a></p>
<ul>
<li><p><a class="reference internal" href="#key-assumptions">Key Assumptions</a></p></li>
<li><p><a class="reference internal" href="#numerical-approximations">Numerical Approximations</a></p></li>
<li><p><a class="reference internal" href="#market-conditions">Market Conditions</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#model-monitoring-kpis">11. Model Monitoring  KPIs</a></p>
<ul>
<li><p><a class="reference internal" href="#monitoring-tests-and-key-performance-indicators-kpi">11.1. Monitoring Tests and Key Performance Indicators (KPI)</a></p></li>
<li><p><a class="reference internal" href="#performance-exceptions">11.2. Performance Exceptions</a></p></li>
<li><p><a class="reference internal" href="#exception-mitigation-plan">11.3. Exception Mitigation Plan</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#summary-of-feedback-received-during-development">12. Summary of Feedback Received During Development</a></p>
<ul>
<li><p><a class="reference internal" href="#recent-feedback-and-actions">Recent Feedback and Actions</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#references">13. References</a></p></li>
</ul>
</li>
</ul>
</section>
<section id="executive-summary">
<h2><span class="section-number">1.5.1.2. </span>2. Executive Summary<a class="headerlink" href="#executive-summary" title="Link to this heading">#</a></h2>
<p>This document presents the model used for the construction of the FX volatility surfaces as marked by the FX Options desk and it is the main model developer document for GMD4181.</p>
<p>The FX volatility surface is used to capture market prices of FX vanilla options, and to provide via internal interpolations in time and strike the implied Black-Scholes volatility of vanilla options for arbitrary strike <span class="math notranslate nohighlight">\( K \)</span> and expiry <span class="math notranslate nohighlight">\( T \)</span>, <span class="math notranslate nohighlight">\( \Theta(K, T) \)</span>.</p>
<p>These implied volatilities are an input to all pricing models of FX option products (either vanilla or exotic) and therefore, the model presented here, is a feeder to all such models whether used for the pricing, or for intraday/end-of-day valuation of FX options books. Furthermore, the FX volatility surface is used for Value-at-Risk (VaR) calculation for those books and for the valuation of cross-currency option products from other (non-FX) asset classes.</p>
<p>Traditionally, the FX option market segmented itself into two separate sections, one being short-dated (<span class="math notranslate nohighlight">\( T &lt; 2 \)</span> years) and the other long-dated. These two market segments tended to trade different products, catering to different market participants and with resulting different trading dynamics. As a result, different volatility marking methodologies and interpolations have been developed over time in order to cater to these differing requirements. So, while logically we talk about a FX volatility surface in practice, we currently have multiple variations being published and used.</p>
<p>This document describes in details the various features (for marking and interpolating) used by both market segments and then describes how they are composed into the actual volatility surfaces objects used by either the short or long dated desks.</p>
<p>The paper begins with a description of the volatility quotes and conventions that are commonly observed in the market and/or that are used to mark the volatility surface.</p>
<p>It then proceeds with a description of the smile models (3-point analytic quartic smile, 5-point analytic quartic smile and the degenerate flat analytic smile). These smile models are common to both the short and long dated surfaces.</p>
<p>This is then followed by the different at-the-money (ATM) backbone models and time interpolation schemes used, which are the features that mostly distinguish short-dated surfaces from long-dated ones.</p>
<p>We then proceed to present the effect of bumping on the volatility surface, which is used to compute sensitivity to volatility changes for the trade population.</p>
<p>And finally, we present tests to show that the FX Analytic Volatility Surface accurately implements the model as described. The tests are conducted using QALib version QA2439.00.</p>
</section>
<hr class="docutils" />
<section id="scope">
<h2><span class="section-number">1.5.1.3. </span>3. Scope<a class="headerlink" href="#scope" title="Link to this heading">#</a></h2>
<section id="model-purpose-and-intended-usage">
<h3><span class="section-number">1.5.1.3.1. </span>3.1. Model Purpose and Intended Usage<a class="headerlink" href="#model-purpose-and-intended-usage" title="Link to this heading">#</a></h3>
<p>This document describes the model used for two flavours of FX volatility surfaces currently (Aug-2017) used in production, respectively by the short and long dated FX option desks:</p>
<ul class="simple">
<li><p><strong>FX Mean-Reverting (MR) volatility surface</strong></p></li>
<li><p><strong>FX Variance Interpolation (VI) volatility surface.</strong></p></li>
</ul>
<p>The two surface types have the same primary purpose: marking liquid vanilla option contracts as observed in the market and provide an interpolation object for the implied volatility of vanilla options not directly observed.</p>
<p>The model is used to query for implied volatility values in order to either price vanilla option trades of arbitrary strike and maturity or to provide the input target price for the calibration of more exotic models. See Section 5.7 for a list of feeder models.</p>
<p>The two surfaces differ in the market features they try to capture.</p>
<p>The MR surface usually extends to 3 years expiry and is primarily used to price vanilla options and first-generation exotics of short maturity. This market is particularly sensitive to short-term effects of events like either economic policy announcements from monetary authorities (e.g. FOMC meetings) or economic activity indicators (e.g. US Non-farm Payroll) or important political events (e.g. Brexit referendum of June 2016) that might affect the daily volatility of the currency pairs. The at-the-money model used for this surface (see Section 5.1.2.2) allows to capture these effects, while wing model (see Section 5.1.3.2) allows for interpolating wing call/put quotes in a manner that takes into account the non-smooth behaviour of the at-the-money volatility backbone.</p>
<p>The VI surface extends to 20 or 40 years, depending on the currency pair. The VI surface uses a smoother time interpolation (linear or cubic in variance, see Section 5.1.3.1) and does not contain information about economic events as this fine-grained structure of the at-the-money backbone is deemed not necessary for longer-dated products.</p>
</section>
<section id="conceptual-soundness">
<h3><span class="section-number">1.5.1.3.2. </span>3.2. Conceptual Soundness<a class="headerlink" href="#conceptual-soundness" title="Link to this heading">#</a></h3>
<p>The Black-Scholes model is inadequate to price vanilla options of all strikes and maturities consistently with the market. It is therefore necessary to construct a volatility surface <span class="math notranslate nohighlight">\( \Theta(K, T) \)</span> which can provide a consistent price for vanilla options at arbitrary strike <span class="math notranslate nohighlight">\( K \)</span> and expiry <span class="math notranslate nohighlight">\( T \)</span>, while matching the market instruments quoted.</p>
<p>This document describes smile models methodology <em>(3-point analytic quartic smile, 5-point analytic quartic smile</em> and the degenerate <em>flat analytic smile</em>) which allow to interpolate the volatility at any strike <span class="math notranslate nohighlight">\( K \)</span> while ensuring a match of the at-the-money, risk reversals and strangles which are marked by the market on 25 and 10 deltas.</p>
<p>Other approaches are possible, like using a smile interpolation polynomial in delta (like cubic spline) or a model based smile interpolation like SABR. The issue with simple polynomial interpolation is that there is no rational reasoning behind it, and it can lead to important smile arbitrage. Model based smile interpolation like SABR are arbitrage free but the shape produced are not flexible enough to fit the FX market instruments, especially on the 10 deltas.</p>
<p>The analytic quartic model have the strong feature that it is completely algebraic, thus making it easy to implement as well as very fast and this has been one of the main reason for the adoption of this model. Over time, as the 10-delta quotes have become more liquid and therefore more frequently observed, the need for a smile model that would easily and perfectly match 5 quotes has lead to the extension from 3-point to 5-point analytic model. The 5-point model retains the very desirable algebraic calibration feature but allows more control over the far wings.</p>
<p>Some other attempts to modify the 3-points were found to produce unsatisfactory or unstable behavior like adding a constant term in the drift of the stochastic implied model, see Section 5.1.1.1.3.</p>
<p>The time interpolation models described in this document apply to the ATM term-structure backbone and the wings. The main constraint of these models is to be able to match the market benchmark tenors and be able to query the volatility at any time while avoiding calendar arbitrage. The FX market is really liquid and the short-term option business requires a precise marking of the daily volatility. Indeed, some days with important business and economic events have more volatility whereas week-end and holidays have less. The approach of the Mean-Reverting ATM backbone using daily Event Weights allow for short-dated surfaces to fine tune the daily volatility and mark properly the days with events. On the long-dated one, this granularity on daily volatility is not necessary and the approach of time interpolation in variance (without events) is sufficiently accurate while extremely simple to mark and manage from day-to-day.</p>
<p>From a consistency standpoint, it would be certainly desirable to eventually converge to a single FX Volatility surface model for both the short and long-dated business, but this aspiration has to be balanced with the current business requirements of trying to best capture the minimum set of salient features appropriate for the market trades being traded.</p>
</section>
</section>
<section id="product-payoff-portfolio">
<h2><span class="section-number">1.5.1.4. </span>4. Product / Payoff / Portfolio<a class="headerlink" href="#product-payoff-portfolio" title="Link to this heading">#</a></h2>
<p>This section outlines fundamental FX conventions and various FX option products.</p>
<p>The products discussed here are essential because their prices, expressed through implied Black-Scholes volatilities, serve as inputs for the FX volatility surface model. The descriptions provided are sufficient to interpret market quotes and populate the internal state of the FX volatility object. This section does not aim to be a comprehensive guide to booked trades of similar types; separate documents will cover those products for pricing purposes.</p>
<section id="standard-fx-definitions-and-conventions">
<h3><span class="section-number">1.5.1.4.1. </span>4.1. Standard FX Definitions and Conventions<a class="headerlink" href="#standard-fx-definitions-and-conventions" title="Link to this heading">#</a></h3>
<section id="currency-pair-fordom">
<h4><span class="section-number">1.5.1.4.1.1. </span>4.1.1. Currency Pair FORDOM<a class="headerlink" href="#currency-pair-fordom" title="Link to this heading">#</a></h4>
<p>A currency pair consists of two currencies linked by a spot rate <span class="math notranslate nohighlight">\( S \)</span>. The spot rate <span class="math notranslate nohighlight">\( S \)</span> represents the value of one unit of foreign currency (FOR) in terms of the domestic currency (DOM).</p>
<p>The standard convention for displaying spot rates on platforms like Reuters is FORDOM, such as USDJPY. Here, the domestic currency is JPY, and the foreign currency is USD. The spot rate indicates the value of 1 USD in JPY terms. For GBPUSD (Cable), the domestic currency is USD, and the foreign currency is GBP. Calls and puts refer to the foreign currency, so a USDJPY call is an option to buy USD and sell JPY at a predetermined strike.</p>
</section>
<section id="at-the-money">
<h4><span class="section-number">1.5.1.4.1.2. </span>4.1.2. At-the-Money<a class="headerlink" href="#at-the-money" title="Link to this heading">#</a></h4>
<p>The at-the-money (ATM) strike can be defined in three ways:</p>
<ul class="simple">
<li><p><strong>ATM spot</strong>: The ATM strike is todays spot FX rate.</p></li>
<li><p><strong>ATM forward</strong>: The ATM strike is todays observed forward rate for the maturity.</p></li>
<li><p><strong>ATM zero-delta-straddle (ZDS)</strong>: The strike is set such that the straddle has zero delta.</p></li>
</ul>
<p>The definition of ATM ZDS depends on the interpretation of delta, which can be:</p>
<ul class="simple">
<li><p><strong>Spot delta</strong>: The amount of spot FX required to delta-hedge the FX option.</p></li>
<li><p><strong>Forward delta</strong>: The amount of forward FX contracts needed to delta-hedge the FX option.</p></li>
</ul>
<p>Additionally, two currencies must be specified:</p>
<ul class="simple">
<li><p><strong>Premium currency</strong>: The currency in which the FX option is valued. For example, a USD call-JPY put is a call option on the USDJPY FX rate, typically valued in yen, but it can also be valued in dollars. Also known as the booking currency.</p></li>
<li><p><strong>Face currency</strong>: The currency in which the notional amount of the FX option is expressed. For instance, a USDJPY option is usually specified in USD notional but can also be expressed in JPY notional.</p></li>
</ul>
<p>The choice of premium and face currency affects the definition of delta.</p>
</section>
</section>
<hr class="docutils" />
<section id="description">
<h3><span class="section-number">1.5.1.4.2. </span>4.2. Description<a class="headerlink" href="#description" title="Link to this heading">#</a></h3>
<section id="call-put">
<h4><span class="section-number">1.5.1.4.2.1. </span>4.2.1. Call/Put<a class="headerlink" href="#call-put" title="Link to this heading">#</a></h4>
<p>The basic option products are vanilla call and put options.</p>
<p>The payoff for call and put options with expiry <span class="math notranslate nohighlight">\( T \)</span>, strike <span class="math notranslate nohighlight">\( K \)</span>, and notional <span class="math notranslate nohighlight">\( A \)</span> is:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
Call(K,T) = A(S_T - K)^+ \tag{4.1}
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
Put(K,T) = A(K - S_T)^+ \tag{4.2}
\]</div>
</div>
<p>This payoff is settled at time <span class="math notranslate nohighlight">\( T \)</span> (or shortly after, following FX market conventions).</p>
<p>When quoting the price of a call or put option, market convention specifies the volatility value <span class="math notranslate nohighlight">\( \Theta(K,T) \)</span> that, when plugged into the Black-Scholes formula, yields the options present value (PV). For example:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
PV(Call(K,T)) = C(K,T,\Theta(K,T)) \tag{4.3}
\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\( C(\cdot) \)</span> represents the Black-Scholes formula for a call option (see Equation 4.11).</p>
<p>Call and put prices (or volatilities) are not directly observed in the FX option market. Instead, these options are used to define more liquid instruments like Risk Reversals and Strangles, described below. Liquid instruments are typically quoted for a given delta rather than a fixed strike <span class="math notranslate nohighlight">\( K \)</span>. See Section 4.7.2 for a detailed explanation of delta in FX options.</p>
</section>
<section id="risk-reversal">
<h4><span class="section-number">1.5.1.4.2.2. </span>4.2.2. Risk Reversal<a class="headerlink" href="#risk-reversal" title="Link to this heading">#</a></h4>
<p>A Risk Reversal (RR) is a key FX trading strategy involving a long call and a short put. In FX, the call and put are selected to match a specific delta (in absolute terms).</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
RR_{25} = Call_{25\Delta} - Put_{25\Delta}. \tag{4.4}
\]</div>
</div>
<p>In the FX market, the risk reversal is quoted as the difference between the Black-Scholes implied volatility of the call and that of the put. For example, the 25-delta risk reversal is:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\sigma_{25}^{RR} = \sigma_{25\Delta}^{Call} - \sigma_{25\Delta}^{Put}. \tag{4.5}
\]</div>
</div>
</section>
<section id="strangle">
<h4><span class="section-number">1.5.1.4.2.3. </span>4.2.3. Strangle<a class="headerlink" href="#strangle" title="Link to this heading">#</a></h4>
<p>A <strong>Strangle</strong> (ST), also known as a butterfly or fly, is a strategy where one is long both a call and a put. In FX, the call and put are chosen to have the same delta.</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
ST_{25} = Call_{25\Delta} + Put_{25\Delta}. \tag{4.6}
\]</div>
</div>
<p>The FX market quotes strangles in two ways:</p>
<ul>
<li><p><strong>Theoretical strangle</strong>: The average of the call and put volatilities minus the ATM volatility:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
  \sigma_{25}^{ST-Th} = \frac{1}{2}(\sigma_{25\Delta}^{Call} + \sigma_{25\Delta}^{Put}) - \sigma_{ATM} \tag{4.7}
  \]</div>
</div>
</li>
<li><p><strong>Market strangle</strong>: The volatility adjustment needed on top of the ATM volatility to match the market cash value of the strangle:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
  C(K_{25\Delta}, \sigma_{ATM} + \sigma_{25}^{ST-Mkt}) + P(K_{25\Delta}, \sigma_{ATM} + \sigma_{25}^{ST-Mkt}) = C(K_{25\Delta}, \sigma_{25\Delta}^{Call}) + P(K_{25\Delta}, \sigma_{25\Delta}^{Put}) \tag{4.8}
  \]</div>
</div>
</li>
</ul>
<p>The theoretical strangle is a first-order approximation to the market strangle. Both definitions depend on the interpretation of at-the-money. The difference between them is usually small for expiries under 1 year but can become significant for longer maturities.</p>
</section>
<section id="straddle">
<h4><span class="section-number">1.5.1.4.2.4. </span>4.2.4. Straddle<a class="headerlink" href="#straddle" title="Link to this heading">#</a></h4>
<p>A straddle involves being long both a call and a put at the same strike. In FX, the straddle is used to find a structure with zero delta, known as the Zero-Delta-Straddle (ZDS). See Section 4.7.3 for details on the ZDS at-the-money strike.</p>
</section>
</section>
<hr class="docutils" />
<section id="creation-of-the-volatility-surface">
<h3><span class="section-number">1.5.1.4.3. </span>4.3. Creation of the Volatility Surface<a class="headerlink" href="#creation-of-the-volatility-surface" title="Link to this heading">#</a></h3>
<p>FX volatility surfaces are constructed using volatility quotes against delta.</p>
<p>For each tenor <span class="math notranslate nohighlight">\( T \)</span>, the volatility surface is typically specified using the following liquidly observed options:</p>
<ul class="simple">
<li><p>At-the-money option</p></li>
<li><p>25-delta RR</p></li>
<li><p>25-delta ST</p></li>
<li><p>10-delta RR</p></li>
<li><p>10-delta ST</p></li>
</ul>
<p>The term 25-delta means the delta hedge is 25% of the notional in absolute terms.</p>
<p>From the RR and ST quotes, the 25-delta put and call volatilities can be deduced, and from there, the corresponding strikes. Care must be taken when interpreting delta, as it varies depending on the valuation currency.</p>
</section>
<section id="relationship-to-other-approved-models-payoffs">
<h3><span class="section-number">1.5.1.4.4. </span>4.4. Relationship to Other Approved Models / Payoffs<a class="headerlink" href="#relationship-to-other-approved-models-payoffs" title="Link to this heading">#</a></h3>
<p>N/A</p>
</section>
<hr class="docutils" />
<section id="inputs">
<h3><span class="section-number">1.5.1.4.5. </span>4.5. Inputs<a class="headerlink" href="#inputs" title="Link to this heading">#</a></h3>
<p>This section outlines the inputs required to specify the instruments used for constructing the volatility surface, including at-the-money volatility, strangle, and risk reversal. Acceptable values are provided.</p>
<section id="at-the-money-volatility">
<h4><span class="section-number">1.5.1.4.5.1. </span>4.5.1. At-the-Money Volatility<a class="headerlink" href="#at-the-money-volatility" title="Link to this heading">#</a></h4>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Input Name</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Values</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ATM style</p></td>
<td><p>At-the-money convention (see 4.1.2)</p></td>
<td><p>ATM Zero delta straddle, ATM Forward, ATM Spot</p></td>
</tr>
<tr class="row-odd"><td><p>Booking currency</p></td>
<td><p>Premium amount convention (see 4.1.2)</p></td>
<td><p>Domestic, Foreign</p></td>
</tr>
<tr class="row-even"><td><p>Face currency</p></td>
<td><p>Face amount convention (see 4.1.2)</p></td>
<td><p>Domestic, Foreign</p></td>
</tr>
<tr class="row-odd"><td><p>Maturity reference date</p></td>
<td><p>Reference date to compute time to expiry</p></td>
<td><p>Date</p></td>
</tr>
<tr class="row-even"><td><p>Maturity date</p></td>
<td><p>Expiry date of the instrument</p></td>
<td><p>Date</p></td>
</tr>
<tr class="row-odd"><td><p>Observed level</p></td>
<td><p>Market value of the instrument:<span class="math notranslate nohighlight">\( \sigma_{ATM} \)</span></p></td>
<td><p>Double</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<hr class="docutils" />
<section id="id1">
<h4><span class="section-number">1.5.1.4.5.2. </span>4.5.2. Strangle<a class="headerlink" href="#id1" title="Link to this heading">#</a></h4>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Input Name</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Values</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Strangle style</p></td>
<td><p>Strangle convention (see 4.2.3)</p></td>
<td><p>Theoretical strangle, Market strangle</p></td>
</tr>
<tr class="row-odd"><td><p>Booking currency</p></td>
<td><p>Premium amount convention (see 4.1.2)</p></td>
<td><p>Domestic, Foreign</p></td>
</tr>
<tr class="row-even"><td><p>Face currency</p></td>
<td><p>Face amount convention (see 4.1.2)</p></td>
<td><p>Domestic, Foreign</p></td>
</tr>
<tr class="row-odd"><td><p>Delta type</p></td>
<td><p>Delta convention (see 4.1.2)</p></td>
<td><p>Spot delta, Forward delta</p></td>
</tr>
<tr class="row-even"><td><p>Maturity reference date</p></td>
<td><p>Reference date to compute time to expiry</p></td>
<td><p>Date</p></td>
</tr>
<tr class="row-odd"><td><p>Maturity date</p></td>
<td><p>Expiry date of the instrument</p></td>
<td><p>Date</p></td>
</tr>
<tr class="row-even"><td><p>Delta level</p></td>
<td><p>Delta level of the instrument</p></td>
<td><p>0.25 or 0.10 (usually)</p></td>
</tr>
<tr class="row-odd"><td><p>Observed level</p></td>
<td><p>Market value of the instrument:<span class="math notranslate nohighlight">\( \sigma_{25}^{ST} \)</span> and <span class="math notranslate nohighlight">\( \sigma_{10}^{ST} \)</span></p></td>
<td><p>Double</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="id2">
<h4><span class="section-number">1.5.1.4.5.3. </span>4.5.3. Risk Reversal<a class="headerlink" href="#id2" title="Link to this heading">#</a></h4>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Input Name</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Values</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Booking currency</p></td>
<td><p>Premium amount convention (see 4.1.2)</p></td>
<td><p>Domestic, Foreign</p></td>
</tr>
<tr class="row-odd"><td><p>Face currency</p></td>
<td><p>Face amount convention (see 4.1.2)</p></td>
<td><p>Domestic, Foreign</p></td>
</tr>
<tr class="row-even"><td><p>Delta type</p></td>
<td><p>Delta convention (see 4.1.2)</p></td>
<td><p>Spot delta, Forward delta</p></td>
</tr>
<tr class="row-odd"><td><p>Maturity reference date</p></td>
<td><p>Reference date to compute time to expiry</p></td>
<td><p>Date</p></td>
</tr>
<tr class="row-even"><td><p>Maturity date</p></td>
<td><p>Expiry date of the instrument</p></td>
<td><p>Date</p></td>
</tr>
<tr class="row-odd"><td><p>Delta level</p></td>
<td><p>Delta level of the instrument</p></td>
<td><p>0.25 or 0.10 (usually)</p></td>
</tr>
<tr class="row-even"><td><p>Observed level</p></td>
<td><p>Market value of the instrument:<span class="math notranslate nohighlight">\( \sigma_{25}^{RR} \)</span> and <span class="math notranslate nohighlight">\( \sigma_{10}^{RR} \)</span></p></td>
<td><p>Double</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<hr class="docutils" />
<section id="payoff-analysis">
<h3><span class="section-number">1.5.1.4.6. </span>4.7. Payoff Analysis<a class="headerlink" href="#payoff-analysis" title="Link to this heading">#</a></h3>
<p>This section derives formulae to relate the delta of an input volatility quote to a corresponding strike, based on the conventions associated with the quote. These formulae are not used for direct pricing but for calibrating smile models (see Section 7, particularly Sections 7.1.1 and 7.1.2).</p>
</section>
<section id="the-effect-of-changing-booking-currency-on-risk-measures">
<h3><span class="section-number">1.5.1.4.7. </span>4.7.1. The Effect of Changing Booking Currency on Risk Measures<a class="headerlink" href="#the-effect-of-changing-booking-currency-on-risk-measures" title="Link to this heading">#</a></h3>
<p>A key difference between FX and other asset classes (e.g., equities) is that deals can be valued in either the domestic or foreign currency. This affects the price and sensitivities (Greeks), but simple formulae relate the two sets of results. For example, a JPY price of a derivative is the product of the USD price and the USDJPY spot rate. This impacts the creation of a volatility surface, as discussed later.</p>
<p>We detail the calculation of delta when booking in the foreign currency. Let <span class="math notranslate nohighlight">\( P \)</span> be the price of a derivative when booking in the domestic currency. Assuming deterministic interest rates, booking in the foreign currency yields a price of <span class="math notranslate nohighlight">\( P^* = P / S = S^* P \)</span> in foreign units, where <span class="math notranslate nohighlight">\( 1 / S = S^* \)</span>. The delta when booking in the foreign currency is the PV move in foreign currency <span class="math notranslate nohighlight">\( \delta P^* \)</span> for an infinitesimal move <span class="math notranslate nohighlight">\( \delta S \)</span> of the spot <span class="math notranslate nohighlight">\( S \)</span>, expressed in foreign currency. Thus:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\Delta^* = \frac{\delta P^*}{S^* \delta S}. \tag{4.9}
\]</div>
</div>
<p>Simplifying and expressing in terms of derivatives:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\Delta^* = S \frac{\partial P^*}{\partial S} = S \frac{\partial}{\partial S} (S^* P) = S \left( \frac{-P}{S^2} + \frac{dP}{dS} \right) = \frac{\partial P}{\partial S} - P^* = \Delta - P^*. \tag{4.10}
\]</div>
</div>
</section>
<hr class="docutils" />
<section id="the-meaning-of-delta-for-volatility-surfaces">
<h3><span class="section-number">1.5.1.4.8. </span>4.7.2. The Meaning of Delta for Volatility Surfaces<a class="headerlink" href="#the-meaning-of-delta-for-volatility-surfaces" title="Link to this heading">#</a></h3>
<p>Given a volatility and delta for an option, the strike can be calculated. The calculation depends on whether the delta is calculated in the domestic or foreign currency and whether the delta is expressed as a percentage of the domestic or foreign notional.</p>
<p>For example, valuing vanilla deals in the domestic currency with a notional of <span class="math notranslate nohighlight">\( A \)</span> foreign units yields a price of:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
P = \phi A \left( S \exp(-r_f t) N(\phi d_1) - K \exp(-r_d t) N(\phi d_2) \right) \tag{4.11}
\]</div>
</div>
<p>in DOM units, where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( r_d \)</span>: Continuous domestic interest rate</p></li>
<li><p><span class="math notranslate nohighlight">\( r_f \)</span>: Continuous foreign interest rate</p></li>
<li><p><span class="math notranslate nohighlight">\( t \)</span>: Time to maturity</p></li>
<li><p><span class="math notranslate nohighlight">\( K \)</span>: Strike</p></li>
<li><p><span class="math notranslate nohighlight">\( \phi \)</span>: 1 for a call on the foreign principal, -1 for a put on the foreign principal</p></li>
</ul>
<p>and:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
d_1 = \frac{\ln(S / K) + (r_d - r_f + 0.5 \sigma^2) t}{\sigma \sqrt{t}} \tag{4.12}
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
d_2 = \frac{\ln(S / K) + (r_d - r_f - 0.5 \sigma^2) t}{\sigma \sqrt{t}} \tag{4.13}
\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\( N(\cdot) \)</span> is the standard cumulative normal distribution function.</p>
<p>The delta is:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\frac{\partial P}{\partial S} = \phi A \exp(-r_f t) N(\phi d_1) \tag{4.14}
\]</div>
</div>
<p>in FOR units.</p>
<p>For a 25-delta call, the strike <span class="math notranslate nohighlight">\( K_C \)</span> satisfies:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
0.25 = \exp(-r_f t) N\left( \frac{\ln(S / K_C) + (r_d - r_f + 0.5 \sigma_{25\Delta}^2) t}{\sigma_{25\Delta} \sqrt{t}} \right). \tag{4.15}
\]</div>
</div>
<p>Similarly, the 25-delta put strike <span class="math notranslate nohighlight">\( K_P \)</span> satisfies:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
0.25 = \exp(-r_f t) N\left( -\frac{\ln(S / K_P) + (r_d - r_f + 0.5 \sigma_{25\Delta}^2) t}{\sigma_{25\Delta} \sqrt{t}} \right). \tag{4.16}
\]</div>
</div>
<p>These equations can be inverted to find the strikes.</p>
<p>When valuing deals in the foreign currency, the delta is:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\Delta^* = \Delta - P^* = \phi A \frac{K}{S} \exp(-r_d t) N(\phi d_2). \tag{4.17}
\]</div>
</div>
<p>For a 25-delta call strike:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
0.25 = \frac{K}{S} \exp(-r_d t) N(d_2). \tag{4.18}
\]</div>
</div>
<p>A root-finding algorithm, such as Newton-Raphson, is used to solve this equation:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
K_{n+1} = K_n - \frac{\Delta(K_n)}{\Delta'(K_n)}, \tag{4.20}
\]</div>
</div>
<p>until convergence.</p>
<p>When specifying the volatility surface for a currency pair, its important to note the booking (premium) currency and the face (notional) currency.</p>
</section>
<section id="delta-strike-relationships-by-currency-configuration">
<h3><span class="section-number">1.5.1.4.9. </span>Delta/Strike Relationships by Currency Configuration<a class="headerlink" href="#delta-strike-relationships-by-currency-configuration" title="Link to this heading">#</a></h3>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Booking currency</p></th>
<th class="head"><p>Face Currency</p></th>
<th class="head"><p>Delta/Strike relationship</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Domestic</p></td>
<td><p>Foreign</p></td>
<td><p><span class="math notranslate nohighlight">\(\Delta = \phi e^{-r_f t}N(\phi d_1)\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Foreign</p></td>
<td><p>Foreign</p></td>
<td><p><span class="math notranslate nohighlight">\(\Delta = \phi\frac{K}{S}e^{-r_d t}N(\phi d_2)\)</span></p></td>
</tr>
<tr class="row-even"><td><p>Domestic</p></td>
<td><p>Domestic</p></td>
<td><p><span class="math notranslate nohighlight">\(\Delta = \phi\frac{S}{K}e^{-r_f t}N(\phi d_1)\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Foreign</p></td>
<td><p>Domestic</p></td>
<td><p><span class="math notranslate nohighlight">\(\Delta = \phi e^{-r_d t}N(\phi d_2)\)</span></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="example-conversions">
<h3><span class="section-number">1.5.1.4.10. </span>Example Conversions<a class="headerlink" href="#example-conversions" title="Link to this heading">#</a></h3>
<p>For the case when both booking and face currency are domestic with domestic currency amount B:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
A = \frac{B}{K} \text{ units of FOR.} \quad (4.19)
\]</div>
</div>
<p>Using the above means that the delta in foreign units is:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\frac{\phi Be^{-r_f t}N(\phi d_1)}{K} \quad (4.20)
\]</div>
</div>
<p>Recalling that delta is expressed as a percentage of the notional:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\Delta B = S\frac{\phi Be^{-r_f t}N(\phi d_1)}{K} \quad (4.21)
\]</div>
</div>
<p>Spot-converting the delta to express it in domestic currency:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\Delta = \frac{S}{K}\phi e^{-r_f t}N(\phi d_1). \quad (4.22)
\]</div>
</div>
</section>
<section id="practical-example">
<h3><span class="section-number">1.5.1.4.11. </span>Practical Example<a class="headerlink" href="#practical-example" title="Link to this heading">#</a></h3>
<p>In USD/JPY, option contracts are priced in USD terms and notionals are quoted in USD terms too, so the second equation in the table would be used.</p>
</section>
<hr class="docutils" />
<section id="the-zds-at-the-money-strike">
<h3><span class="section-number">1.5.1.4.12. </span>4.7.3. The ZDS At-the-Money Strike<a class="headerlink" href="#the-zds-at-the-money-strike" title="Link to this heading">#</a></h3>
<p>The ATM point can be defined as the strike where a straddle has zero delta. A straddle involves being long a call and a put at the same strike. When the booking currency is domestic and the notional is in foreign terms, the straddle delta is:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
A \exp(-r_f t) N(d_1) - A \exp(-r_f t) N(-d_1) = A \exp(-r_f t) (N(d_1) - N(-d_1)). \tag{4.25}
\]</div>
</div>
<p>This is zero if <span class="math notranslate nohighlight">\( d_1 = 0 \)</span>, implying:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\frac{\ln(S / K) + (r_d - r_f + 0.5 \sigma_{ATM}^2) t}{\sigma_{ATM} \sqrt{t}} = 0. \tag{4.26}
\]</div>
</div>
<p>Solving for the ATM strike:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
K_{ATM} = S \exp((r_d - r_f + 0.5 \sigma_{ATM}^2) t). \tag{4.27}
\]</div>
</div>
<p>The ATM delta is:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\Delta_{ATM} = \exp(-r_f t) N(d_1) = \exp(-r_f t) \cdot 0.5. \tag{4.28}
\]</div>
</div>
<p>When the booking and face currencies are foreign, the straddle delta is:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
-A K \exp(-r_d t) N(d_2) + A K \exp(-r_d t) N(-d_2) = A K \exp(-r_d t) (N(-d_2) - N(d_2)). \tag{4.29}
\]</div>
</div>
<p>This is zero if <span class="math notranslate nohighlight">\( d_2 = 0 \)</span>, implying:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\frac{\ln(S / K) + (r_d - r_f - 0.5 \sigma_{ATM}^2) t}{\sigma_{ATM} \sqrt{t}} = 0. \tag{4.30}
\]</div>
</div>
<p>Solving for the ATM strike:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
K_{ATM} = S \exp((r_d - r_f - 0.5 \sigma_{ATM}^2) t). \tag{4.31}
\]</div>
</div>
<p>The ATM delta is:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\Delta_{ATM} = \frac{K_{ATM}}{S} \exp(-r_d t) N(d_2) = \exp(-r_d t) \cdot 0.5. \tag{4.32}
\]</div>
</div>
<p>These results are summarized in Table 4.1.</p>
<p><strong>Table 4.1: ZDS Conventions</strong></p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Booking Currency</p></th>
<th class="head"><p>Face Currency</p></th>
<th class="head"><p>ATM Strike</p></th>
<th class="head"><p>ATM Delta</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Domestic</p></td>
<td><p>Foreign</p></td>
<td><p><span class="math notranslate nohighlight">\( S \exp((r_d - r_f + 0.5 \sigma_{ATM}^2) t) \)</span></p></td>
<td><p><span class="math notranslate nohighlight">\( \exp(-r_f t) \cdot 0.5 \)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Foreign</p></td>
<td><p>Foreign</p></td>
<td><p><span class="math notranslate nohighlight">\( S \exp((r_d - r_f - 0.5 \sigma_{ATM}^2) t) \)</span></p></td>
<td><p><span class="math notranslate nohighlight">\( \exp(-(r_f + 0.5 \sigma_{ATM}^2) t) \cdot 0.5 \)</span></p></td>
</tr>
<tr class="row-even"><td><p>Domestic</p></td>
<td><p>Domestic</p></td>
<td><p><span class="math notranslate nohighlight">\( S \exp((r_d - r_f + 0.5 \sigma_{ATM}^2) t) \)</span></p></td>
<td><p><span class="math notranslate nohighlight">\( \exp(-(r_d + 0.5 \sigma_{ATM}^2) t) \cdot 0.5 \)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Foreign</p></td>
<td><p>Domestic</p></td>
<td><p><span class="math notranslate nohighlight">\( S \exp((r_d - r_f - 0.5 \sigma_{ATM}^2) t) \)</span></p></td>
<td><p><span class="math notranslate nohighlight">\( \exp(-r_d t) \cdot 0.5 \)</span></p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<hr class="docutils" />
<section id="model-methodology">
<h2><span class="section-number">1.5.1.5. </span>5. Model / Methodology<a class="headerlink" href="#model-methodology" title="Link to this heading">#</a></h2>
<section id="id3">
<h3><span class="section-number">1.5.1.5.1. </span>5.1. Description<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<p>This section provides a detailed explanation of the fundamental components of FX volatility surfaces. The volatility surface, represented as a 2-dimensional interpolator <span class="math notranslate nohighlight">\( \Theta(K, T) \)</span>, consists of two key elements:</p>
<ul class="simple">
<li><p><strong>Smile Model</strong>: Determines the volatility for any strike <span class="math notranslate nohighlight">\( K \)</span> at a fixed time to expiry <span class="math notranslate nohighlight">\( T \)</span>. This is discussed in Section 5.1.1 and is common to both short-dated and long-dated surfaces.</p></li>
<li><p><strong>Time Model</strong>: Determines how, after calibrating the smile model for a set of marked tenors <span class="math notranslate nohighlight">\( T_i \)</span>, a smile is constructed for a maturity <span class="math notranslate nohighlight">\( T \)</span> not included in the set of marked tenors. The general approach is to interpolate in time either 3 or 5 quotes (ATM plus 25/10-delta, depending on the smile model) and then construct a smile model for the given expiry <span class="math notranslate nohighlight">\( T \)</span>. ATM time interpolation is typically handled differently from wing quotes. Sections 5.1.2 and 5.1.3 describe the time interpolation for ATM and wing volatilities, respectively.</p></li>
</ul>
<p>Short-dated and long-dated surfaces differ primarily in the time models used.</p>
<section id="smile-models">
<h4><span class="section-number">1.5.1.5.1.1. </span>5.1.1. Smile Models<a class="headerlink" href="#smile-models" title="Link to this heading">#</a></h4>
<p>Smile models are defined by the number of input points (1, 3, or 5) and the underlying analytic model. Five models are commonly used:</p>
<ol class="arabic simple">
<li><p><strong>Flat Analytic (Single Point Model)</strong>: Assumes a flat volatility smile, ignoring any specified smile quotes (e.g., RR and ST). This is useful for pricing without considering the smile effect.</p></li>
<li><p><strong>3-Point Analytic Quartic Smile Model</strong>: Calibrated to ATM and 25-delta quotes. It provides a robust benchmark for risk calculations like VaR.</p></li>
<li><p><strong>5-Point Analytic Quartic Smile Model</strong>: Calibrated to ATM, 25-delta, and 10-delta quotes. It offers better control over the wings.</p></li>
<li><p><strong>3-Point ASV Model</strong>: A 3-point model based on the Analytic Stochastic Volatility (ASV) framework.</p></li>
<li><p><strong>5-Point ASV Model</strong>: A 5-point model based on the ASV framework.</p></li>
</ol>
<p>These models can be categorized into two main classes:</p>
<ol class="arabic simple">
<li><p><strong>Analytic Quartic Smile Model</strong>: Based on Schnbuchers stochastic implied volatility model, providing fast, analytic solutions for FX volatility smiles.</p></li>
<li><p><strong>ASV Model</strong>: Based on the Analytic Stochastic Volatility framework, offering a more flexible approach to modeling the volatility smile.</p></li>
</ol>
<p>The <strong>Flat Analytic</strong> model assumes a flat volatility smile and ignores any specified smile quotes. It is internally implemented as a fully-fledged smile model, but the volatility for any strike <span class="math notranslate nohighlight">\( K \)</span> is set equal to the ATM volatility.</p>
<p>A <strong>3-point model</strong> (Analytic Quartic or ASV) is calibrated to ATM and 25-delta quotes. While simplistic, it provides a robust benchmark for risk calculations like VaR and serves as a fallback model for numerical investigations.</p>
<p>A <strong>5-point model</strong> is calibrated to ATM, 25-delta, and 10-delta quotes, offering better control over the wings.</p>
<section id="analytic-quartic-smile-model">
<h5><span class="section-number">1.5.1.5.1.1.1. </span>5.1.1.1. Analytic Quartic Smile Model<a class="headerlink" href="#analytic-quartic-smile-model" title="Link to this heading">#</a></h5>
<p>This section begins with an overview of Schnbuchers stochastic implied volatility model, followed by a description of the <strong>3-Point Analytic Quartic Smile Model</strong> and the <strong>5-Point Analytic Quartic Smile Model</strong>, which provides additional degrees of freedom for better fitting extreme wing strikes.</p>
</section>
<section id="stochastic-implied-volatility-model-for-a-single-volatility">
<h5><span class="section-number">1.5.1.5.1.1.2. </span>5.1.1.1.1. Stochastic Implied Volatility Model for a Single Volatility<a class="headerlink" href="#stochastic-implied-volatility-model-for-a-single-volatility" title="Link to this heading">#</a></h5>
<p>In this section we describe the salient features of the Schnbucher paper. The essence of the modelling approach is in the same spirit as that of Brace, Gatarek, and Musiela [2], that is a market-based approach rather than modelling fundamental quantities like instantaneous volatility.</p>
<p>Assume a locally log-normal stochastic process for spot in the risk neutral measure.</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
dS = (r_d - r_f)Sdt + \sigma SdW \quad (5.1)
\]</div>
</div>
<p>Here the instantaneous spot volatility <span class="math notranslate nohighlight">\(\sigma\)</span> is assumed to be stochastic and follows some unspecified process. However, we shall assume that is depends on the Brownian motion <span class="math notranslate nohighlight">\(W\)</span> and a second uncorrelated Brownian motion <span class="math notranslate nohighlight">\(W'\)</span>.</p>
<p>Consider the implied volatility of a European option with strike <span class="math notranslate nohighlight">\(K\)</span>, <span class="math notranslate nohighlight">\(\Theta(K)\)</span>. As observed from the market this implied vol will appear to be stochastic. In principle, we can derive its process from the processes for <span class="math notranslate nohighlight">\(S\)</span> and <span class="math notranslate nohighlight">\(\sigma\)</span> using It.</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
d\Theta = \frac{\partial\Theta}{\partial S}dS + \frac{\partial\Theta}{\partial\sigma}d\sigma + \frac{1}{2}\frac{\partial^2\Theta}{\partial S^2}d\langle S\rangle + \frac{1}{2}\frac{\partial^2\Theta}{\partial\sigma^2}d\langle\sigma\rangle + \frac{\partial^2\Theta}{\partial\sigma\partial S}d\langle\sigma, S\rangle
\]</div>
</div>
<p>Schnbuchers idea is to turn this argument around and instead, write down a form for the risk-neutral process for <span class="math notranslate nohighlight">\(\Theta(K)\)</span> directly, from which the process for <span class="math notranslate nohighlight">\(\sigma\)</span> can in principle be inferred.</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
d\Theta(K) = u(K, S)dt + v(K, S)\left[p(K, S)dW + \sqrt{1-p(K, S)^2}dW'\right] \quad (5.2)
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
= u(K, S)dt + v(K, S)d\tilde{W}
\]</div>
</div>
<p>Note that the implied correlation <span class="math notranslate nohighlight">\(p\)</span> is in general a function of <span class="math notranslate nohighlight">\(S\)</span> and <span class="math notranslate nohighlight">\(K\)</span>. The process (5.2) can be thought of as the result of some sort of two factor principle component analysis of the motion of the implied volatility smile.</p>
<p>The price of a call option <span class="math notranslate nohighlight">\(C(K, S, \Theta)\)</span> is by definition written directly in terms of the spot <span class="math notranslate nohighlight">\(S\)</span> and implied volatility <span class="math notranslate nohighlight">\(\Theta(K)\)</span> using the BlackScholes formula. Using the dynamics of the implied volatility and the spot, Its lemma gives</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
dC = \frac{\partial C}{\partial t}dt + \frac{\partial C}{\partial S}dS + \frac{1}{2}\sigma^2S^2\frac{\partial^2C}{\partial S^2}dt + \frac{\partial C}{\partial\Theta}d\Theta + \frac{1}{2}\frac{\partial^2C}{\partial\Theta^2}dt + p\sigma S\frac{\partial^2C}{\partial S\partial\Theta}dt. \quad (5.3)
\]</div>
</div>
<p>For the absence of arbitrage, we need the discounted option price to be martingale under the risk-neutral measure associated with the premium currency numraire. This is equivalent to</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
E[dC] = r_pCdt.
\]</div>
</div>
<p>Applying this to Equation (5.3) yields the following two dimensional PDE:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\frac{\partial C}{\partial t} + (r_d - r_f)S\frac{\partial C}{\partial S} + \frac{1}{2}\sigma^2S^2\frac{\partial^2 C}{\partial S^2} + u\frac{\partial C}{\partial \Theta} + \frac{1}{2}v^2\frac{\partial^2 C}{\partial \Theta^2} + pv\sigma S\frac{\partial^2 C}{\partial S\partial\Theta} - r_d C = 0. \quad (5.4)
\]</div>
</div>
<p>The BlackScholes equation for <span class="math notranslate nohighlight">\(C\)</span> is</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\frac{1}{2}\Theta^2S^2\frac{\partial^2 C}{\partial S^2} + (r_d - r_f)S\frac{\partial C}{\partial S} + \frac{\partial C}{\partial t} - r_d C = 0. \quad (5.5)
\]</div>
</div>
<p>Using the above equation we can simplify further to give</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\frac{1}{2}(\sigma^2 - \Theta^2)S^2\frac{\partial^2 C}{\partial S^2} + u\frac{\partial C}{\partial \Theta} + \frac{1}{2}v^2\frac{\partial^2 C}{\partial \Theta^2} + pv\sigma S\frac{\partial^2 C}{\partial S\partial\Theta} = 0 \quad (5.6)
\]</div>
</div>
<p>The BlackScholes expressions for the derivatives are:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\frac{\partial^2 C}{\partial S^2} = \frac{e^{-r_f t} \cdot e^{-\frac{1}{2}d_1^2}}{S\Theta\sqrt{t} \cdot \sqrt{2\pi}}
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\frac{\partial^2 C}{\partial S\partial\Theta} = -\frac{e^{-r_f t}d_2 \cdot e^{-\frac{1}{2}d_1^2}}{\Theta \cdot \sqrt{2\pi}}
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\frac{\partial^2 C}{\partial \Theta^2} = \frac{e^{-r_f t}S\sqrt{t}d_1d_2 \cdot e^{-\frac{1}{2}d_1^2}}{\Theta \cdot \sqrt{2\pi}}
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\frac{\partial C}{\partial \Theta} = e^{-r_f t}S\sqrt{t}\frac{e^{-\frac{1}{2}d_1^2}}{\sqrt{2\pi}}
\]</div>
</div>
<p>Inserting these and simplifying gives</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
(\sigma^2 - \Theta^2) - 2p\sigma vd_2\sqrt{t} + v^2td_1d_2 + 2u\Theta t = 0 \quad (5.7)
\]</div>
</div>
<p>This is our fundamental equation. Note that this equation is algebraic. Equation (5.7) defines the smile <span class="math notranslate nohighlight">\(\Theta(K)\)</span> given <span class="math notranslate nohighlight">\(S\)</span> and <span class="math notranslate nohighlight">\(\sigma\)</span> and a functional form for <span class="math notranslate nohighlight">\(u, v\)</span>, and <span class="math notranslate nohighlight">\(p\)</span>. The problem is that we do not know what these functional forms are. In this approach we have to posit a reasonable form for these functionals and then judge the validity of these choices by comparing the resulting smile shapes to the observed market.</p>
<p>Schnbucher analyses the behaviour of Equation (5.7) in the limit as <span class="math notranslate nohighlight">\(t \to 0\)</span>. It turns out that if the implied volatility of a given strike is different to the instantaneous volatility, then the implied volatility will have a singularity as <span class="math notranslate nohighlight">\(t \to 0\)</span> unless the restriction <span class="math notranslate nohighlight">\(u \to 0\)</span> as <span class="math notranslate nohighlight">\(t \to 0\)</span> is imposed.</p>
<p>The next two sections describe how different choices of <span class="math notranslate nohighlight">\(u\)</span> and <span class="math notranslate nohighlight">\(v\)</span> are used to match the 3 and 5 points.</p>
</section>
</section>
</section>
<section id="point-analytic-quartic-smile-model">
<h3><span class="section-number">1.5.1.5.2. </span>5.1.1.1.2 3-Point Analytic Quartic smile model<a class="headerlink" href="#point-analytic-quartic-smile-model" title="Link to this heading">#</a></h3>
<p>A very simple choice is to set <span class="math notranslate nohighlight">\(u = 0\)</span> and <span class="math notranslate nohighlight">\(v, p\)</span> to be constant. We therefore have three constant unknowns in Equation (5.7), namely <span class="math notranslate nohighlight">\(\sigma, v, p\)</span>. These can be thought of as the spot volatility, the vol-of-vol and a measure of the spot-volatility correlation. As such they are largely independent</p>
<p>With the above points in mind we have found that functions of the form</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\frac{f^2}{V_{ATM} + f^2} \quad (5.9)
\]</div>
</div>
<p>and</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\frac{f}{\sqrt{\gamma_B V_{ATM} + f^2}}
\]</div>
</div>
<p>are useful. At small <span class="math notranslate nohighlight">\(f\)</span> they have <span class="math notranslate nohighlight">\(f^2\)</span> and <span class="math notranslate nohighlight">\(f\)</span> character but become constant for very large <span class="math notranslate nohighlight">\(f\)</span>. The constant <span class="math notranslate nohighlight">\(\gamma_B\)</span> is called the scale factor B, and need to be chosen ad-hoc, we do not wish to fit it to market quotes as that would give us too many parameters. The scaling with the at-the-money-variance appears to be a good scale. Indeed, when the at-the-money variance is large, the wings are usually dampened, and the convexity reduced. When the at-the-money variance is small the opposite behavior can be observed and the wings are more pronounced.</p>
<p>Empirically the 10/25 delta risk reversal problem was best fixed by making</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
2u = \beta\frac{f}{\sqrt{\gamma_B V_{ATM} + f^2}}
\]</div>
</div>
<p>Here <span class="math notranslate nohighlight">\(\beta\)</span> is the new parameter. This leads to a modification of the <span class="math notranslate nohighlight">\(\Theta^3\)</span> term in the smile equation. The constant <span class="math notranslate nohighlight">\(\gamma_B\)</span> is presently set to 49 in QALib. In fact, the actual choice of this parameter is not very important and affects only the extreme wing as can be seen in the following graphs plotted on EURIPY MeanRevertingNykOpen volatility surface of 1st December 2016. moniker : official&#64;20161201/volsurface.fx/pivot/euripy/MeanRevertingNykOpen/builder</p>
<p><img alt="name" src="../../_images/11.png" /></p>
<p>Figure 5.1: Impact of the ATM scale factor B <span class="math notranslate nohighlight">\(\gamma_B\)</span> on EURIPY volatility surface, 6M expiry: 01 June 2017. We can see that the scale factor has only an impact on extreme wings of the smile, and this impact is fairly limited: for value of 100 to 20 we have almost same wings.</p>
<p><img alt="Figure 5.2" src="../../_images/21.png" /></p>
<p>Figure 5.2: Impact of the ATM scale factor B <span class="math notranslate nohighlight">\(\gamma_B\)</span> on EURIPY volatility surface, 2 Business day expiry: 05 Dec 2016. We can see that the scale factor has almost no impact on the wings, apart for a very low value of 8.</p>
<p>The main reason to choose this big value for <span class="math notranslate nohighlight">\(\gamma_B\)</span> of around 50 lies in the resolution of the five linear equations we have with the calibration of the 5-points quartic model. This is basically a system of five linear equations and five unknowns, resolved building the coefficients matrix and performing a singular matrix decomposition. What we want to avoid is to have the determinant of the coefficients matrix equal to zero, because otherwise this system cannot be solved.</p>
<p>Plotting some value of the determinant of the coefficients matrix for different time to expiry, we can see that the value where it crosses zero is higher for lower time to expiry query. We see that for a value of <span class="math notranslate nohighlight">\(\gamma_B = 49\)</span> the determinant does not cross zero and we have a good buffer from having this issue.</p>
<hr class="docutils" />
<p><img alt="Figure 5.3" src="../../_images/31.png" /></p>
<p>Figure 5.3: Impact of <span class="math notranslate nohighlight">\(\gamma_B\)</span> on the coefficients matrix determinant of the quartic. We plot the graphs of the determinant for the 1D maturity</p>
<p><img alt="Figure 5.4" src="../../_images/41.png" /></p>
<p>Figure 5.4: Impact of <span class="math notranslate nohighlight">\(\gamma_B\)</span> on the coefficients matrix determinant of the quartic. We plot the graphs of the determinant for the 5M maturity</p>
<p>For a short query, the value where the determinant crosses zero is higher than for longer query. We can see that on all the graphs, the determinant crosses zero with value much lower than 49.</p>
<p>An intuitive understanding is by considering Equation (7.6). In order to have several positive solutions with the polynomial having a W shape crossing the x- axis for small time to expiry t, one needs a</p>
<hr class="docutils" />
<p>big <span class="math notranslate nohighlight">\(\gamma_B \times Cross\theta\)</span>. Indeed, if we neglect the term <span class="math notranslate nohighlight">\(\Theta^3 (Cross \times t)\)</span> assuming a short expiry, one needs an extreme value for the Cross term. <span class="math notranslate nohighlight">\(\gamma_B\)</span> shares some similarities with the Cross term as they both effect the skew of the smile shape. When, <span class="math notranslate nohighlight">\(\gamma_B\)</span> is small, the term</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\frac{f}{\sqrt{\gamma_B V_{ATM} + f^2}}
\]</div>
</div>
<p>becomes larger and can give rise to several positive solutions.</p>
<p>The turn up in the smile in the wings was best dealt with by modifying the vol-of-vol part <span class="math notranslate nohighlight">\(v^2\)</span> to give it the following functional form.</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
v^2 = v_0^2 + \alpha \frac{f^2}{V_{ATM} + f^2}
\]</div>
</div>
<p>Here <span class="math notranslate nohighlight">\(\alpha\)</span> is a new parameter.</p>
<p>In the following graphs on the same EURIPY MeanRevertingNykOpen volatility surface of 1st December 2016, we plot the influence of <span class="math notranslate nohighlight">\(\gamma_A\)</span>.
moniker : official&#64;20161201/volsurface.fx/pivot/euripy/MeanRevertingNykOpen/builder</p>
<p><img alt="Figure 5.5" src="../../_images/5.png" /></p>
<p>Figure 5.5: Impact of the ATM scale factor A <span class="math notranslate nohighlight">\(\gamma_A\)</span> on EURIPY volatility surface, 6 M expiry: 01 June 2017. We can see that the scale factor has only an impact on extreme wings of the smile, and this impact is fairly limited.</p>
<p><img alt="Figure 5.6" src="../../_images/6.png" /></p>
<p>Figure 5.6: Impact of the ATM scale factor A <span class="math notranslate nohighlight">\(\gamma_A\)</span> on EURIPY volatility surface, 2 Business day expiry: 05 Dec 2016. We can see that the scale factor has only impact on the extreme wings of the smile, and this impact is fairly limited.</p>
<p>With the new assumptions, Equation (5.7) becomes:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\left(\sigma^2 - \Theta^2\right) - 2p\sigma v_0 d_2\sqrt{t} + v^2 td_1d_2 + 2u\Theta t = 0. \quad (5.10)
\]</div>
</div>
<p>Note the appearance of both <span class="math notranslate nohighlight">\(v\)</span> and <span class="math notranslate nohighlight">\(v_0\)</span>. This is deliberate as we dont want to change the parameter <span class="math notranslate nohighlight">\(p\sigma v_0\)</span>, corresponding to the ATM point. We call this term the Cross and it is a measure of the spot-volatility covariance. The smile equation then becomes:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\Theta^4\left[1+\frac{1}{4}\left(v_0^2 + \alpha\frac{f^2}{V_{ATM} + f^2}\right)t^2\right] - \Theta^3\left[p\sigma v_0 + \beta\frac{f}{\sqrt{\gamma_B V_{ATM} + f^2}}\right]t
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
-\Theta^2\sigma^2 + \Theta 2f p\sigma v_0 - \left(v_0^2 + \alpha\frac{f^2}{V_{ATM} + f^2}\right)t^2 = 0. \quad (5.11)
\]</div>
</div>
<p>This is still a quartic equation for <span class="math notranslate nohighlight">\(\Theta\)</span> but now all but the quadratic coefficient has a strike dependence. The form is still simple enough so as not to incur a speed penalty.</p>
<p>For given at-the-money and 25 delta points, there is a range of acceptable 10 deltas that we can fit. This is reasonable as a given arbitrary smile may not be compatible with a stochastic model or even no-arbitrage.</p>
<p>We will detail in the calibration section, see Section 7.1, how this 5-point quartic model is calibrated in order to match the input volatility quotes.</p>
<p>See Section 5.8 for some alternative approaches that were attempted in the specification of the 5-point quartic analytic smile model but that were deemed unsatisfactory.</p>
<p>Effect of quartic five point parameters</p>
<p>In this section we show graphically the effect of the various parameters used to define the model. Each graph displays a base value smile, as well as the smiles resulting from bumping up and bumping down one parameter at a time. On the right y-axis we graph the difference between the bumped smiles and the base case, to visualize the impact of the parameters bumps. We use the following
surface. The moniker used for these tests is :
official&#64;20161201/volsurface.fx/pivot/eurusd/meanrevertingfiveparms/builder</p>
<p><img alt="Figure 5.7" src="../../_images/7.png" /></p>
<p>Figure 5.7: Effect of the spot var parameter <span class="math notranslate nohighlight">\(\sigma^2\)</span>. We see that the spot var parameter determines the
level of the ATM implied volatility of the smile. A change of this parameters results in a parallel shift
of the volatility smile. The difference curves are as expected parallel for the plus and minus move.</p>
<p><img alt="Figure 5.8" src="../../_images/8.png" /></p>
<p>Figure 5.8: Effect of the var of implied vol parameter <span class="math notranslate nohighlight">\(v_0\)</span>. This term can been seen as the vol of vol
squared of standard stochastic-volatility. So as expected, an increase of this parameter increases
the convexity of the wings of the smile, and a decrease flattens the wings. You can see the changes
are applied to the wings looking at the difference plot and the impact is greater the more you are
out in the wings.</p>
<hr class="docutils" />
<p><img alt="Figure 5.9" src="../../_images/9.png" /></p>
<p>Figure 5.9: Effect of the spot vol-implied vol covariance, Cross parameter <span class="math notranslate nohighlight">\(p\sigma v_0\)</span>. This parameter we
call Cross determines the covariance between spot and volatility, it would be similar to correlation
effect in standard stochastic-volatility model. So, as expected, this parameter influences the skew
of the volatility smile. If we increase the Cross, it implies an increase of the skew slope, and if we
decrease the Cross, it implies a decrease of the skew slope.</p>
<p><img alt="Figure 5.10" src="../../_images/10.png" /></p>
<p>Figure 5.10: Effect of the parameter <span class="math notranslate nohighlight">\(\alpha\)</span>. This parameter is supposed to capture the convexity of the
smile for the far strikes only, so that it calibrates the far wing smile part (10 deltas ST). We can see on
the graph, that the behavior is as expected: an increase of alpha increases the convexity on the far
wings (Abs. diff. up graph) and a decreased alpha parameter decreases the convexity of the smile
on the far wing only (Abs. diff. down graph). The fact that it affects the far wings only is quite clear
when we look at the difference graphs which is equal to almost zero between 0.2 and 0.8 deltas.</p>
<hr class="docutils" />
<p><img alt="Figure 5.11" src="../../_images/111.png" /></p>
<p>Figure 5.11: Effect of the parameter <span class="math notranslate nohighlight">\(\beta\)</span>. This parameter is supposed to capture the skew of the smile
for the very far strike from the money only, so that it calibrates the far wing skew RR part (10 deltas
RR). We can see on the graph, that the behavior is as expected: an increase of beta increase the
skew mainly on the far wings (Abs. diff. up graph) and a decreased beta parameter decreases the
skew of the smile on the far wing mainly(Abs. diff. down graph). The fact that it affect the far wings
only is quite clear when we look at the diff plot which is very low between 0.2 and 0.8 deltas.</p>
</section>
<section id="low-fly-correction-extension-to-the-analytic-quartic-models">
<h3><span class="section-number">1.5.1.5.3. </span>5.1.1.1.4 Low-fly correction extension to the Analytic Quartic models<a class="headerlink" href="#low-fly-correction-extension-to-the-analytic-quartic-models" title="Link to this heading">#</a></h3>
<p>As it will be discussed in Section 7.1.1.1, the calibration of the quartic parameters can be quite
problematic when the smile term is negative as this leads frequently to a failure because you may
have no positve real solution. Also in the quartic parameters calibration stage it is not sure that the
implied vol corresponds all the time to the largest solution of the polynomial.</p>
<p>In this section we present an extension of the quartic model that ensures the ability to always find
an implied volatility, even in the case of low strangle quotes (hence the name low-fly correction).
This usually occur for some emerging market volatility surfaces, or smile in the vicinity of big events
(e.g. French elections).</p>
<p><strong>3-point Analytic Quartic model</strong></p>
<p>To remediate the issue we can amend the 3-point quartic polynomial to become:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
P(\Theta) = \Theta^4 \left(1 + \frac{1}{4}smile \times t^2\right) - \Theta^3 (Cross \times t) - \Theta^2\sigma^2 + 2f \times Cross \times \frac{\Theta^3}{\Theta^2} - smile f^2 \times \frac{\Theta^3}{\Theta^5}
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
(5.12)
\]</div>
</div>
<p>where</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\Theta^4 \left(1 + \frac{1}{4}smile \times t^2\right) - \Theta^3 (Cross \times t) - \Theta^2\sigma^2 + 1_{{smile&lt;0}}(2fCross \times \Theta - smile f^2) = 0 \quad (5.13)
\]</div>
</div>
<p> We can see if the smile is positive we end up having <span class="math notranslate nohighlight">\(\hat{\Theta} = \Theta\)</span></p>
<p> We can really see that in that case the real positive solution is unique for <span class="math notranslate nohighlight">\(\Theta\)</span> and <span class="math notranslate nohighlight">\(\hat{\Theta}\)</span> if the smile
is negative</p>
<p> <span class="math notranslate nohighlight">\(\hat{\Theta}\)</span> is actually the ATM forward implied volatility</p>
<p>In the case of negative smile we can see that we end up solving quadratic equation:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
P(\Theta) = \Theta^2 \left(1 + \frac{1}{4}smile \times t^2\right) - \Theta \left((Cross \times t) - 2f \times Cross\frac{1}{\Theta^2} + smile\frac{1}{\Theta^3}f^2\right) - \sigma^2 = 0 \quad (5.14)
\]</div>
</div>
<p>Where:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\Theta = \frac{Cross \times t + \sqrt{\Delta}}{2\left(1 + \frac{1}{4}smile \times t^2\right)} \quad (5.15)
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\Delta = (Cross \times t)^2 + 4\sigma^2\left(1+\frac{1}{4}smile \times t^2\right) \quad (5.16)
\]</div>
</div>
<p>We then define new cross term:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
NewCross = (Cross \times t) - 2fCross \times \frac{1}{\Theta^2} + smile\frac{1}{\Theta^3}f^2 \quad (5.17)
\]</div>
</div>
<p>We can finally express the implied volatility in term of the new cross since we have reduced the
problem to a second order equation:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\Theta(f) = \frac{NewCross + \sqrt{\delta}}{2(1 + \frac{1}{4}smile \times t^2)} \quad (5.18)
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\delta = (NewCross)^2 + 4\sigma^2 \left(1 + \frac{1}{4}smile \times t^2\right) \quad (5.19)
\]</div>
</div>
<p>The main interest of this new representation is that it allows to generate concave smile. Otherwise,
the parametrization with <span class="math notranslate nohighlight">\(smile &gt; 0\)</span> cannot fit this type of smile.</p>
<p>Below we show some example of parametrization which generate concave smile vol, with a negative
smile term:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>t</p></th>
<th class="head"><p>0.002739726</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>cross</p></td>
<td><p>-4%</p></td>
</tr>
<tr class="row-odd"><td><p>smile</p></td>
<td><p>-60%</p></td>
</tr>
<tr class="row-even"><td><p>sigma</p></td>
<td><p>25%</p></td>
</tr>
</tbody>
</table>
</div>
<p><img alt="Figure 5.12" src="../../_images/12.png" /></p>
<p>Figure 5.12: Shape of a concave smile generated using negative smile term for the quartic. The x
axis represents <span class="math notranslate nohighlight">\(\ln(\frac{F}{K})\)</span> and the y axis the volatility</p>
<p><strong>5-point Analytic Quartic model</strong></p>
<p>The same analysis and technique done for the 3-point quartic can be used for 5-point quartic polynomial.</p>
<p>The smile shape is a sum of two parts:</p>
<p> ATM smile part <span class="math notranslate nohighlight">\(v_0^2\)</span> which can be seen as variance volatility and capture smile effect on all strikes</p>
<p> One capturing the convexity for far strikes only so it calibrates the far wings smile part: <span class="math notranslate nohighlight">\(\frac{f^2}{V_{ATM}+f^2}\)</span></p>
<p>The far wing is more important for low ATM vol. It is an even function to control the left and right wings in the same way.</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
smile_{5pts} = smile + \frac{f^2}{V_{ATM}+f^2}
\]</div>
</div>
<p>The skew is also a sum of two parts:</p>
<p> One Part detecting the skew very close to ATM strikes called Cross, <span class="math notranslate nohighlight">\(p\sigma v_0\)</span></p>
<p> One detecting the skew very far from the money. It is an odd function:
<span class="math notranslate nohighlight">\(Cross_{5pts} = Cross + \frac{f}{\sqrt{\gamma_B V_{ATM}+f^2}}\)</span></p>
<p>The way we treat the resolution of the quartic equation is this way:</p>
<p> If <span class="math notranslate nohighlight">\(smile &lt; 0\)</span> we go to the new polynomial</p>
<p> If <span class="math notranslate nohighlight">\(\alpha &lt; 0\)</span> and <span class="math notranslate nohighlight">\(smile + \alpha &lt; 0\)</span> we go to the new polynomial even if the smile is positive</p>
<p>We can write formally this condition as:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
Cond = 1_{{smile&lt;0}} + 1_{{smile+\alpha&lt;0}} \quad (5.20)
\]</div>
</div>
<p>The new 5 pts quartic polynomial is given by:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
P (\Theta) = \Theta^4 \left(1 + \frac{1}{4}smile_{5pts} \times t^2\right) - \Theta^3 (Cross_{5pts} \times t) - \Theta^2\sigma^2 + 2f \times Cross \times \frac{\Theta^3}{\Theta^2} - smile_{5pts}f^2 \times \frac{\Theta^3}{\Theta^5} \quad (5.21)
\]</div>
</div>
<p>This can be rewritten as:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
P(\Theta) = \Theta^4 \left(1 + \frac{1}{4}smile_{5pts} \times t^2\right) - \Theta^3 \left(Cross_{5pts} \times t + 2f \times Cross \times \frac{1}{\Theta^2} - smile_{5pts}f^2 \times \frac{1}{\Theta^3}\right) - \Theta^2\sigma^2 \quad (5.22)
\]</div>
</div>
<p>Where:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\Theta^4 \left(1 + \frac{1}{4}smile_{5pts} \times t^2\right) - \Theta^3 (Cross_{5pts} \times t) - \Theta^2\sigma^2 + 1_{{Cond=0}}(2fCross \times \Theta - smile_{5pts}f^2) = 0 \quad (5.23)
\]</div>
</div>
<p>If <span class="math notranslate nohighlight">\(Cond = 0\)</span> we can see that <span class="math notranslate nohighlight">\(\hat{\Theta} = \Theta\)</span>.
However if the <span class="math notranslate nohighlight">\(Cond = 1\)</span> is negative we have to solve the equation:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\hat{\Theta}^2 \left(1 + \frac{1}{4}smile_{5pts} \times t^2\right) - \hat{\Theta} (Cross_{5pts} \times t) - \sigma^2 = 0 \quad (5.24)
\]</div>
</div>
<p>That gives:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\hat{\Theta}(f) = \frac{Cross_{5pts} \times t + \sqrt{\Delta}}{2\left(1 + \frac{1}{4}smile_{5pts} \times t^2\right)} \quad (5.25)
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\Delta = (Cross_{5pts} \times t)^2 + 4\sigma^2\left(1 + \frac{1}{4}smile_{5pts} \times t^2\right) \quad (5.26)
\]</div>
</div>
<p>Then knowing <span class="math notranslate nohighlight">\(\hat{\Theta}\)</span> we end up solving:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
0 = \Theta^2 \left(1 + \frac{1}{4}smile_{5pts} \times t^2\right) - \Theta \left(Cross_{5pts} \times t + 2f \times Cross \times \frac{1}{\hat{\Theta}^2} - smile_{5pts}f^2 \times \frac{1}{\hat{\Theta}^3}\right) - \sigma^2 \quad (5.27)
\]</div>
</div>
<p>So we have the solution:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\Theta (f) = \frac{NewCross + \sqrt{\delta}}{2\left(1 + \frac{1}{4}smile_{5pts} \times t^2\right)} \quad (5.28)
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\delta = (NewCross)^2 + 4\sigma^2 \left(1 + \frac{1}{4}smile \times t^2\right) \quad (5.29)
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
NewCross = Cross_{5PTS} \times t - 2fCross \times \frac{1}{\hat{\Theta}^2} + smile_{5pts}f^2 \frac{1}{\hat{\Theta}^3} \quad (5.30)
\]</div>
</div>
<p>The new representation allows to generate a concave smile while maintaining the flexibility to mark and match the far wings quotes as the original 5-points analytic quartic model.</p>
<p>Below we show some example of parametrization which generate concave smile volatility, with a negative smile term:</p>
<p>Beta Impact:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>t</p></th>
<th class="head"><p>0.002739726</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>cross</p></td>
<td><p>-10%</p></td>
</tr>
<tr class="row-odd"><td><p>smile</p></td>
<td><p>-60%</p></td>
</tr>
<tr class="row-even"><td><p>sigma</p></td>
<td><p>25%</p></td>
</tr>
<tr class="row-odd"><td><p>beta</p></td>
<td><p>0 or 10 or 20</p></td>
</tr>
<tr class="row-even"><td><p>alpha</p></td>
<td><p>0%</p></td>
</tr>
</tbody>
</table>
</div>
<p><img alt="Figure 5.13" src="../../_images/13.png" /></p>
<p>Figure 5.13: Shape of a concave smile generated using negative smile term for the quartic 5 pts. The x axis represents ln(<span class="math notranslate nohighlight">\(\frac{F}{K}\)</span>) and the y axis the volatility. The ATM level is 25% and we can see that the impact of Beta is on the far wings. The skew is impacted far away from the money.</p>
<p>Alpha Impact:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>t</p></th>
<th class="head"><p>0.002739726</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>cross</p></td>
<td><p>-10%</p></td>
</tr>
<tr class="row-odd"><td><p>smile</p></td>
<td><p>-60%</p></td>
</tr>
<tr class="row-even"><td><p>sigma</p></td>
<td><p>25%</p></td>
</tr>
<tr class="row-odd"><td><p>beta</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>alpha</p></td>
<td><p>0, -0.1, -0.2, -0.3</p></td>
</tr>
</tbody>
</table>
</div>
<p><img alt="Figure 5.14" src="../../_images/14.png" /></p>
<p>Figure 5.14: Shape of a concave smile generated using negative smile term for the quartic 5 pts. The x axis represents ln(F/K) and the y axis the volatility. We can see that the smile around the money is almost the same however it is more concave far way from the money and it is more concave when alpha is lower.</p>
</section>
</section>
<section id="skew-curvature-and-skew-curvature-in-3-5-pt-analytic-models">
<h2><span class="section-number">1.5.1.6. </span>5.1.1.1.5   Skew, curvature and skew curvature in 3/5 PT analytic models<a class="headerlink" href="#skew-curvature-and-skew-curvature-in-3-5-pt-analytic-models" title="Link to this heading">#</a></h2>
<p>This section details the calculations for the first (skew), second (curvature) and third (skew curvature) derivatives of the implied volatility  for a given tenor as a function of the log of the strike, ln(K). These derivatives, specially the skew and the curvature, are important for several reasons: they are used to compute the PDF of the vol surface, to price digitals with on-smile and so forth</p>
<p>We will distinguish two cases, the 3 point analytic quartic equation, given by Equation (5.8), and the 5 point smooth analytic quartic equation, given in Equation (5.11). The definitions of this three derivatives are</p>
<p>skew = K = <span class="math notranslate nohighlight">\(\frac{d\Theta}{d\ln(K)}\)</span> (5.31)</p>
<p>curvature = KK = <span class="math notranslate nohighlight">\(\frac{d^2\Theta}{d\ln^2(K)}\)</span> (5.32)</p>
<p>skew curvature = KKK = <span class="math notranslate nohighlight">\(\frac{d^3\Theta}{d\ln^3(K)}\)</span> (5.33)</p>
<p>From now on, we will use the notation <span class="math notranslate nohighlight">\(X_a = dX/da\)</span>. In both quartic equations, the only quantities that depend on the strike K are the implied vol itself, , and the quantity <span class="math notranslate nohighlight">\(f = ln(F/K)\)</span>. Therefore, we can find K, KK and KKK by computing the derivatives of the quartic equation Q with respect to ln(K) (the superscript <span class="math notranslate nohighlight">\(X^p\)</span> denotes partial derivative)</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
Q_K = Q_\Theta^p \Theta_K + Q_f^p f_K \tag{5.34}
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
Q_{KK} = Q_{\Theta K}^p \Theta_K + Q_\Theta^p \Theta_{KK} + Q_{fK}^p f_K + Q_f^p f_{KK} \tag{5.35}
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
Q_{KKK} = Q_{\Theta KK}^p \Theta_K + 2Q_{\Theta K}^p \Theta_{KK} + Q_\Theta^p \Theta_{KKK} + Q_{fKK}^p f_K + 2Q_{fK}^p f_{KK} + Q_f^p f_{KKK} \tag{5.36}
\]</div>
</div>
<p>Since by construction the quartic equation is equal to 0 regardless of the strike, we get that <span class="math notranslate nohighlight">\(Q_K = Q_{KK} = Q_{KKK} = 0\)</span>, from which we obtain</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\Theta_K = -Q_f^p f_K (Q_\Theta^p)^{-1} \tag{5.37}
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\Theta_{KK} = -(Q_{fK}^p f_K + Q_f^p f_{KK} + Q_{\Theta K}^p \Theta_K)(Q_\Theta^p)^{-1} \tag{5.38}
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\Theta_{KKK} = -(Q_{\Theta KK}^p \Theta_K + 2Q_{\Theta K}^p \Theta_{KK} - Q_{fKK}^p f_K - 2Q_{fK}^p f_{KK} - Q_f^p f_{KKK})(Q_\Theta^p)^{-1} \tag{5.39}
\]</div>
</div>
<p>The only thing remaining is to compute the unknowns in the above equations. This will be different for 3PT and 5PT. We have <span class="math notranslate nohighlight">\(f = \ln(F/K)\)</span>, so that <span class="math notranslate nohighlight">\(f_K = -1\)</span> and <span class="math notranslate nohighlight">\(f_{KK} = f_{KKK} = 0\)</span>. Partial derivatives of <span class="math notranslate nohighlight">\(Q\)</span> are easily obtained from Equations (5.8) and (5.11). Other quantities of interest are</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
Q_{fK}^p = Q_{f\Theta}^p \Theta_K + Q_{ff}^p f_K \tag{5.40}
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
Q_{\Theta K}^p = Q_{\Theta\Theta}^p \Theta_K + Q_{f\Theta}^p f_K \tag{5.41}
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
Q_{\Theta KK}^p = (Q_{\Theta K}^p) *K^p = Q* {\Theta\Theta K}^p \Theta_K + Q_{\Theta\Theta}^p \Theta_{KK} + Q_{f\Theta K}^p f_K + Q_{f\Theta}^p f_{KK}
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
= Q_{\Theta\Theta\Theta}^p \Theta_K^2 + 2Q_{f\Theta\Theta}^p \Theta_K f_K + Q_{\Theta\Theta}^p \Theta_{KK} + Q_{ff\Theta}^p f_K^2 + Q_{f\Theta}^p f_{KK} \tag{5.42}
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
Q_{fKK}^p = (Q_{fK}^p) *K^p = Q* {f\Theta K}^p \Theta_K + Q_{f\Theta}^p \Theta_{KK} + Q_{ffK}^p f_K + Q_{ff}^p f_{KK}
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
= Q_{f\Theta\Theta}^p \Theta_K^2 + 2Q_{ff\Theta}^p \Theta_K f_K + Q_{f\Theta}^p \Theta_{KK} + Q_{fff}^p f_K^2 + Q_{ff}^p f_{KK} \tag{5.43}
\]</div>
</div>
<p>In the above expressions we have assumed that the partial derivatives are commutative.</p>
<section id="quartic-model-in-the-case-of-foreign-booking-currency">
<h3><span class="section-number">1.5.1.6.1. </span>5.1.1.1.6    Quartic model in the case of Foreign booking currency<a class="headerlink" href="#quartic-model-in-the-case-of-foreign-booking-currency" title="Link to this heading">#</a></h3>
<p>Contracts with foreign booking currency are priced in foreign risk-neutral measure. The choice of the risk-neutral measure to price the contract affects the quartic equation only in the cubic coefficient. Further we discuss the steps to derive the quartic equation using foreign risk-neutral measure.</p>
<p>Consider the inverse spot:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\hat{S} = \frac{1}{S} \tag{5.44}
\]</div>
</div>
<p>and assume the inverse spot follows log-normal process in the foreign risk neutral measure</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
d\hat{S} = (r_f - r_d){\hat{S}}dt + \sigma{\hat{S}}dW^F,
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
dW^F = \rho dt - dW^D. \tag{5.45}
\]</div>
</div>
<p>This specification for the inverse spot process is consistent with the dynamics of spot process (5.1). Particularly, both spot and inverse spot have the same instantaneous volatility <span class="math notranslate nohighlight">\(\sigma\)</span>.</p>
<p>Next, let <span class="math notranslate nohighlight">\(K\)</span> be the strike of European option expressed in units of foreign currency per 1 unit of domestic currency. The implied volatility <span class="math notranslate nohighlight">\(\Theta(K)\)</span> is a stochastic process which follows in the foreign risk-neutral measure:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
d\Theta(K) = \bar{a}(K, \hat{S})dt + \bar{v}(K, \hat{S})\left[ \bar{\rho}(K, \hat{S})dW^F + \sqrt{1-\bar{\rho}(K, \hat{S})^2}dW^{F\perp}\right] \tag{5.46}
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
= \bar{a}(K, \hat{S})dt + \bar{v}(K, \hat{S})dW^F.
\]</div>
</div>
<p>Note that BlackScholes formula implies that <span class="math notranslate nohighlight">\(\Theta(\hat{K}) = \Theta(K)\)</span> where <span class="math notranslate nohighlight">\(\hat{K} = K^{-1}\)</span> and <span class="math notranslate nohighlight">\(\Theta(K)\)</span> is the implied volatility of vanilla European option with DOM booking currency and follows Equation (5.2). In terms of specifications for the implied volatility (5.2) and (5.46) it means that:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\bar{a}(K, \hat{S}) = a(K, S) + v\sigma(K, S)
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\bar{\rho}(K, \hat{S}) = -\rho(K, S)
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\bar{v}(K, \hat{S}) = v(K, S).
\]</div>
</div>
<p>Next we refer to the implied volatility as simply <span class="math notranslate nohighlight">\(\Theta(K)\)</span>.</p>
<p>The FOR price of a call option <span class="math notranslate nohighlight">\(C(K, S, \Theta)\)</span> on 1 unit of DOM currency satisfies:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
dC = \frac{\partial C}{\partial t}dt + \frac{\partial C}{\partial S}dS + \frac{1}{2}\sigma^2S^2\frac{\partial^2 C}{\partial S^2}dt + \frac{\partial C}{\partial \Theta}d\Theta + \frac{1}{2}v^2\frac{\partial^2 C}{\partial \Theta^2}dt + \rho v\sigma S\frac{\partial^2 C}{\partial S \partial \Theta}dt. \tag{5.47}
\]</div>
</div>
<p>Due to the absence of arbitrage</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
E[dC] = r_fCdt.
\]</div>
</div>
<p>Applying this to Equation (5.47) yields the following two dimensional PDE:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\frac{\partial C}{\partial t} + (r_f - r_d)S\frac{\partial C}{\partial S} + \frac{1}{2}\sigma^2S^2\frac{\partial^2 C}{\partial S^2} + \bar{a}\frac{\partial C}{\partial \Theta} + \frac{1}{2}v^2\frac{\partial^2 C}{\partial \Theta^2} + \bar{\rho}v\sigma S\frac{\partial^2 C}{\partial S\partial \Theta} - r_fC = 0. \tag{5.48}
\]</div>
</div>
<p>The BlackScholes equation for C is</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\frac{1}{2}\sigma^2S^2\frac{\partial^2 C}{\partial S^2} + (r_f - r_d)S\frac{\partial C}{\partial S} - \frac{\partial C}{\partial t} - r_fC = 0. \tag{5.49}
\]</div>
</div>
<p>Plugging the above equation in (5.48) gives</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\frac{1}{2}\left(\sigma^2 - \Theta^2\right)S^2\frac{\partial^2 C}{\partial S^2} + \bar{a}\frac{\partial C}{\partial \Theta} + \frac{1}{2}v^2\frac{\partial^2 C}{\partial \Theta^2} + \bar{\rho}v\sigma S\frac{\partial^2 C}{\partial S\partial \Theta} = 0. \tag{5.50}
\]</div>
</div>
<p>The Black-Scholes expressions for the derivatives are:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\frac{\partial^2 C}{\partial S^2} = \frac{e^{-r_d t}e^{-\frac{1}{2}d_1^2}}{S\Theta\sqrt{t}\sqrt{2\pi}}
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\frac{\partial^2 C}{\partial S\partial \Theta} = \frac{-e^{-r_d t}d_2 e^{-\frac{1}{2}d_1^2}}{\Theta\sqrt{2\pi}}
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\frac{\partial^2 C}{\partial \Theta^2} = \frac{e^{-r_d t}S\sqrt{t}d_1d_2 e^{-\frac{1}{2}d_1^2}}{\Theta\sqrt{2\pi}}
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\frac{\partial C}{\partial \Theta} = e^{-r_d t}S\sqrt{t}\frac{e^{-\frac{1}{2}d_1^2}}{\sqrt{2\pi}}
\]</div>
</div>
<p>Inserting these and simplifying gives</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\left(\sigma^2 - \Theta^2\right) - 2\bar{\rho}v\sigma d_2\sqrt{t} + v^2td_1d_2 + 2\bar{a}\Theta t = 0 \tag{5.51}
\]</div>
</div>
<p>Up to this stage the derivation of quartic equation in FOR measure was very similar to the derivation of equation in DOM measure described in Section 5.1.1.1.3. As a result, the smile Equations (5.7) and (5.51) are identical with respect to the pricing measure.</p>
<p>The coefficients <span class="math notranslate nohighlight">\(\hat{d}_1\)</span> and <span class="math notranslate nohighlight">\(\hat{d}_2\)</span> can be expressed in terms of <span class="math notranslate nohighlight">\(d_1\)</span> and <span class="math notranslate nohighlight">\(d_2\)</span> used in BlackScholes formula with DOM booking currency</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\hat{d}_1 = \hat{d}_1(K, \hat{S}, \Theta) = \frac{1}{\Theta\sqrt{t}}(\ln(\hat{S}/\hat{K}) + (r_f - r_d)t + \frac{1}{2}\Theta^2t) = -d_2(S, K, \Theta)
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\hat{d}_2 = \hat{d}_2(K, \hat{S}, \Theta) = \frac{1}{\Theta\sqrt{t}}(\ln(\hat{S}/\hat{K}) + (r_f - r_d)t - \frac{1}{2}\Theta^2t) = -d_1(S, K, \Theta).
\]</div>
</div>
<p>The smile Equation (5.51) rewritten in terms of domestic booking parameters takes the form</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\left(\sigma^2 - \Theta^2\right) - 2\rho v\sigma d_1\sqrt{t} + v^2td_1d_2 + 2(u + v\sigma)\Theta t = 0. \tag{5.52}
\]</div>
</div>
<p>The three point smile equation corresponds to the case when <span class="math notranslate nohighlight">\(u = -v\sigma\)</span> and constant <span class="math notranslate nohighlight">\(v, \rho\)</span>:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\Theta^4\left[1 + \frac{1}{4}v^2t^2\right] + \Theta^3\rho v\sigma t - \Theta^2\sigma^2 + 2\Theta f\rho v\sigma - v^2f^2 = 0. \tag{5.53}
\]</div>
</div>
<p>For the five point smile we take <span class="math notranslate nohighlight">\(f = \ln\frac{F}{K} = \ln\frac{F}{K} = -f\)</span> and re-use the original specification for <span class="math notranslate nohighlight">\(u\)</span> and <span class="math notranslate nohighlight">\(v\)</span>:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
2\bar{a} = -\beta\frac{\bar{f}}{\sqrt{\gamma_a V_{ATM} + \bar{f}^2}} = \beta\frac{f}{\sqrt{\gamma_a V_{ATM} + f^2}}
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
v^2 = v_0^2 + \alpha\frac{\bar{f}^2}{V_{ATM} + \bar{f}^2} = v_0^2 + \alpha\frac{f^2}{V_{ATM} + f^2}.
\]</div>
</div>
<p>The five point smile equation takes the form</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\Theta^4\left[1 + \frac{1}{4}\left(v_0^2 + \alpha\frac{f^2}{V_{ATM} + f^2}\right)t^2\right] + \Theta^3\left[\rho v v_0 - \beta\frac{f}{\sqrt{\gamma_a V_{ATM} + f^2}}\right]t +
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
-\Theta^2\sigma^2 + 2\Theta f\rho v v_0 - \left(v_0^2 + \alpha\frac{f^2}{V_{ATM} + f^2}\right)f^2 = 0. \tag{5.54}
\]</div>
</div>
<p>Comparing Equations (5.53) and (5.54) to the original quartic equations (5.8) and (5.11) we can notice that the cubic coefficient changes sign when the booking currency is changed to FOR. For the five point smile <span class="math notranslate nohighlight">\(\bar{a}\)</span> was chosen to match it completely, causing <span class="math notranslate nohighlight">\(\beta\)</span> to change the sign inside the cubic coefficient to compensate the change of the coefficients sign. For the three point smile the setting which assumes zero drift for the implied volatility process in the foreign risk-neutral measure leaves the process with non-zero drift <span class="math notranslate nohighlight">\(u = -v\sigma\)</span> in domestic risk-neutral measure. In case of five point smile the drift in the domestic risk-neutral measure takes the form:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
u = \beta\frac{f}{2\sqrt{\gamma_a V_{ATM} + f^2}} - v\sigma. \tag{5.55}
\]</div>
</div>
</section>
</section>
<section id="asv-model">
<h2><span class="section-number">1.5.1.7. </span>5.1.1.2. ASV model<a class="headerlink" href="#asv-model" title="Link to this heading">#</a></h2>
<p>The ASV models are parametric smile models inspired by the SVI parameterization which is very popular. While parametric the SVI is not arbitrary in the sense that the large-maturity limit of the Heston implied volatility smile is exactly SVI. Gatheral and Jacquier [6] reduced this model to a 3-parameters to guarantee the absence of static arbitrage. Their smile has the following parameterization:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\sigma^2(k) = \frac{\sigma_0^2}{2}\left(1 + \rho\phi k + \sqrt{((\rho k + \rho)^2 + (1 - \rho^2))}\right) \tag{5.56}
\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(k = \ln(K/F)\)</span> and F the forward</p>
<p>We can rewrite it as:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\sigma^2(k) = \sigma_0^2(1 + \rho\phi k) + \frac{\phi^2(1 - \rho^2)\sigma_0^4}{4\sigma^2(k)}k^2 \tag{5.57}
\]</div>
</div>
<p>It was the starting point in the development of the ASV model.</p>
<section id="points-asv-model">
<h3><span class="section-number">1.5.1.7.1. </span>5.1.1.2.1   3-points ASV model<a class="headerlink" href="#points-asv-model" title="Link to this heading">#</a></h3>
<p>The original 3-points ASV model relies on the following quadratic equation:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\sigma^2(z) = \sigma_0^2 + 2(skew)\sigma_0 z + \frac{(smile)\sigma_0^2}{\sigma^2(z)}z^2 \tag{5.58}
\]</div>
</div>
<p>where here <span class="math notranslate nohighlight">\(z = \frac{\ln(K/K_{ATM})}{\sigma_0\sqrt{t}}\)</span> and <span class="math notranslate nohighlight">\(K_{ATM}\)</span> the ATM strike.</p>
<p><span class="math notranslate nohighlight">\(z\)</span> is a natural variable as the smile usually scales in standardized moneyness, ie FX market quotes in delta space rather than in strike space.</p>
<p>We can see that the model is actually a reparametrization of Gatheral and Jacquiers SVI model.</p>
<p>As this form could only support positive smile, we added an adjustment for negative smile:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\sigma^2(z) = \sigma_0^2 + 2(skew)\sigma_0 z + \frac{(smile)\sigma_0^2}{\tilde{\sigma}^4(z)}z^2 \tag{5.59}
\]</div>
</div>
<p>with</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\tilde{\sigma}^2(z) = \sigma_0^2 + 2(skew)\sigma_0 z + \frac{Max (0, smile) \sigma_0^2}{\sigma^2(z)}z^2 \tag{5.60}
\]</div>
</div>
<p>If the smile parameter is positive, <span class="math notranslate nohighlight">\(\sigma\)</span> and <span class="math notranslate nohighlight">\(\tilde{\sigma}\)</span> are equal. This adjustment guarantees that the equation always has a solution.</p>
<p>In this parameterization, all parameters have a clear meaning and are largely independent:</p>
<p> <span class="math notranslate nohighlight">\(\sigma_0\)</span> is the ATM volatility
<span class="math notranslate nohighlight">\(\sigma_0 = \sigma(0)\)</span></p>
<p> skew is the ATM skew
<span class="math notranslate nohighlight">\(skew = \frac{d\sigma}{dz}|_{z=0}\)</span></p>
<p> smile is a proxy to the ATM smile
<span class="math notranslate nohighlight">\(smile = \frac{d^2\sigma}{dz^2}|_{z=0} + \frac{(skew)^2}{\sigma_0}\)</span></p>
</section>
<section id="id4">
<h3><span class="section-number">1.5.1.7.2. </span>5.1.1.2.2   5-points ASV model<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<p>As in the analytic quartic model, we want to control the wings (10-Delta quotes). We define an extra parameter for each wing:
<span class="math notranslate nohighlight">\(wing(z) = 1_{z&lt;0}Put + 1_{z&gt;0}Call\)</span></p>
<p>The model now relies on the following equation:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\sigma^2(z) =\sigma_0^2 + 2(skew)\sigma_0 z + (smile)\sigma_0^2\left(1_{smile&gt;0}\frac{1}{\sigma^2(z)} + 1_{smile&lt;0}\frac{\sigma^2(z)}{\tilde{\sigma}^4(z)}\right)z^2
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
+ wing(z)\sigma_0^2\left(1_{wing(z)&gt;0}\frac{1}{\sigma^4(z)} + 1_{wing(z)&lt;0}\frac{\sigma^2(z)}{v^6(z)}\right)z^4 \tag{5.61}
\]</div>
</div>
<p>where</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\tilde{\sigma}^2(z) = \sigma_0^2 + 2(skew)\sigma_0 z + \frac{Max(0, smile)\sigma_0^2}{\sigma^2(z)}z^2 + \frac{Max(0, wing(z))}{\sigma^4(z)}\sigma_0^2 z^4 \tag{5.62}
\]</div>
</div>
<p>The second equation is to guarantee that we always have a solution to the first equation. Without that, when the wing parameter (Call or Put) is negative, the wing correction for out-the-money strikes will make the volatility collapse to 0.</p>
<p>This form gives us an easy-to-solve and continuous function.</p>
<p>Call and put parameters allows to control each wing separately.</p>
<section id="effect-of-asv-five-point-parameters">
<h4><span class="section-number">1.5.1.7.2.1. </span>Effect of ASV five point parameters<a class="headerlink" href="#effect-of-asv-five-point-parameters" title="Link to this heading">#</a></h4>
<p>In this section we show graphically the effect of the various parameters used to define the model. Each graph displays a base value smile, as well as the smiles resulting from bumping up and bumping down one parameter at a time. On the right y-axis we graph the difference between the bumped smiles and the base case, to visualize the impact of the parameters bumps. We use the following surface. The moniker used for these tests is :
official&#64;20161201/volsurface.fx/pivot/eurusd/meanrevertingfiveparms/builder</p>
<p><img alt="Figure 5.15" src="../../_images/15.png" /></p>
<p>Figure 5.15: Effect of the ATM vol parameter . We see that it naturally determines the level of the ATM implied volatility of the smile. A change of this parameters results in a parallel shift of the volatility smile. The difference curves are as expected parallel for the plus and minus move.</p>
<p><img alt="Figure 5.16" src="../../_images/15.png" /></p>
<p>Figure 5.16: Effect of the skew parameter. As expected, this parameter influences the skew of the volatility smile. If we increase the skew, it implies an increase of the skew slope, and if we decrease the skew, it implies a decrease of the skew slope.</p>
<p><img alt="Figure 5.17" src="../../_images/17.png" /></p>
<p>Figure 5.17: Effect of the smile parameter. As expected, this parameter influences the convexity of the volatility smile. An increase of this parameter increases the convexity of the wings of the smile, and a decrease flattens the wings. You can see the changes are applied to the wings looking at the difference plot and the impact is greater the more you are out in the wings.</p>
<p><img alt="Figure 5.18" src="../../_images/17.png" /></p>
<p>Figure 5.18: Effect of the parameter call. This parameter controls the call wing of the smile. We can see on the graph, that the behavior is as expected: an increase of call increases the convexity on the far call wing (Abs. diff. up graph) and a decreased call parameter decreases the convexity of the smile on the far call wing only (Abs. diff. down graph). The effect is null for delta lower than 0.5 and small until 0.8.</p>
</section>
<section id="at-the-money-time-models">
<h4><span class="section-number">1.5.1.7.2.2. </span>5.1.2. At-the-money Time models<a class="headerlink" href="#at-the-money-time-models" title="Link to this heading">#</a></h4>
<p>The at-the-money time interpolations are made of two main models: a variance interpolation which uses only the ATM market data container marks and a more refined model called Mean-reverting ATM time model.</p>
<section id="variance-interpolations">
<h5><span class="section-number">1.5.1.7.2.2.1. </span>5.1.2.1.    Variance Interpolations<a class="headerlink" href="#variance-interpolations" title="Link to this heading">#</a></h5>
<p>The simple variance interpolation is mainly used for FX long-dated volatility surfaces. The maturity interpolation is in variance for the ATM. For queries with start time after the diffusion start date (i.e. forward vol queries) it will calculate the spot starting variances to the start and end date individually for that strike, and take the difference.
We have two types of variance interpolation in place:</p>
<p> Linear variance Interpolation</p>
<p> Monotone Cubic variance Interpolation</p>
<p>The linear interpolation is straightforward:</p>
<p>Suppose that <span class="math notranslate nohighlight">\(t_1 \leq t \leq t_2\)</span>, where <span class="math notranslate nohighlight">\(\sigma_{imp}(t_1) = \sigma_1\)</span> and <span class="math notranslate nohighlight">\(\sigma_{imp}(t_2) = \sigma_2\)</span>. Linear interpolation in total variance locates <span class="math notranslate nohighlight">\(\sigma_{imp}(t)\)</span> at a point such that <span class="math notranslate nohighlight">\([\sigma_{imp}(t)]^2t\)</span> lies directly on the line segment connecting <span class="math notranslate nohighlight">\(\sigma_1^2t_1\)</span> with <span class="math notranslate nohighlight">\(\sigma_2^2t_2\)</span>, i.e :</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
[\sigma_{imp}(t)]^2t = \frac{t_2-t}{t_2-t_1}\sigma_1^2t_1 + \frac{t-t_1}{t_2-t_1}\sigma_2^2t_2 \tag{5.63}
\]</div>
</div>
<p>For the case of flat forward volatility, we attempt to avoid introducing any additional bias or expectations about where the forward volatility arises by supposing flat forward volatility between the tenors <span class="math notranslate nohighlight">\(t_1\)</span> and <span class="math notranslate nohighlight">\(t_2\)</span>, i.e: <span class="math notranslate nohighlight">\(\sigma_{fwd}(t) = \sigma v(t)\)</span>, <span class="math notranslate nohighlight">\(\forall t \in (t_1,t_2)\)</span></p>
<p>We can then write with this assumption of flat forward volatility:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\sigma_{imp}^{flat,fwd}(t) = \sqrt{\frac{[\sigma_1^2t_1 + \sigma v^2(t-t_1)]}{t}} \tag{5.64}
\]</div>
</div>
<p>In case of Monotone Cubic variance interpolation, the interpolation ensures a smooth variance term structure while guaranteeing the monotonicity between input points. To do this, QA uses the NAG library, specifically <em>NAG routine library E01BFF</em> [8], which relies on Piecewise Cubic Hermite Interpolating Polynomial.</p>
<p>To sum up the algorithm:</p>
<p> The monotonic cubic interpolator works by means of having a set of <span class="math notranslate nohighlight">\(x_i\)</span> values, <span class="math notranslate nohighlight">\(y_i = \psi(x_i)\)</span> values and <span class="math notranslate nohighlight">\(\psi'_i = \psi'(x_i)\)</span> values. In our case the <span class="math notranslate nohighlight">\(x_i\)</span> are time to expiry for the market tenors and the <span class="math notranslate nohighlight">\(y_i\)</span> are variances.</p>
<p> The interpolator computes the <span class="math notranslate nohighlight">\(\psi'(x_i)\)</span> at construction time, and each derivative <span class="math notranslate nohighlight">\(\psi'(x_i)\)</span> is a function of <span class="math notranslate nohighlight">\(x_{i-1}\)</span>, <span class="math notranslate nohighlight">\(x_i\)</span>, <span class="math notranslate nohighlight">\(x_{i+1}\)</span>, <span class="math notranslate nohighlight">\(y_{i-1}\)</span>, <span class="math notranslate nohighlight">\(y_i\)</span> and <span class="math notranslate nohighlight">\(y_{i+1}\)</span>.</p>
<p> To compute the variance at date <span class="math notranslate nohighlight">\(x_i &lt; x &lt; x_{i+1}\)</span>, we need to provide the interpolator with the tenors, variances and derivatives of the variance on the input tenors to either side of x. Thus any given variance depends on the variances of two tenors either side of it.</p>
<p>To illustrate the difference between the two interpolation mode, we plot the variance of the Long Dated EUR USD volatility surface between 7Y and 15Y tenors.
moniker: official&#64;20161201/volsurface.fx/pivot/eurusd/longdate/builder</p>
<p><img alt="Figure 5.20" src="../../_images/20.png" /></p>
<p>Figure 5.20: Wing time interpolation for ATM backbone for Long Dated EUR USD volatility surface, on tenor 10Y between 7Y and 15Y. As expected, the variance plot for the linear mode is a straight line between the tenors and the variance for the monotone cubic mode is using the monotone cubic interpolation.</p>
<p>We have also checked externally that the mode Linear in Variance interpolation is linear in variance. We compare a QA query for tenor 12Y (01/12/2028) with a manual linear interpolation in variance of the 2 tenors 10Y and 15Y which bracket 12Y, we see that we match perfectly.</p>
<p>Table 5.1:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Tenor</p></th>
<th class="head"><p>ATM variance</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>10-Year QA: 03/12/2026</p></td>
<td><p>0.147402201803</p></td>
</tr>
<tr class="row-odd"><td><p>15-Year QA: 03/12/2031</p></td>
<td><p>0.251737528219</p></td>
</tr>
<tr class="row-even"><td><p>12-Year QA: 01/12/2028</p></td>
<td><p>0.189056338143</p></td>
</tr>
<tr class="row-odd"><td><p>12-Year ext: 01/12/2028</p></td>
<td><p>0.189056338143</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
</section>
<section id="mean-reverting-atm-time-model">
<h3><span class="section-number">1.5.1.7.3. </span>5.1.2.2.    Mean-reverting ATM time model<a class="headerlink" href="#mean-reverting-atm-time-model" title="Link to this heading">#</a></h3>
<p>The Mean-reverting ATM time model is a model with parameters to define fully the shape of the ATM volatility backbone. So once the parameters of the backbone are set, we can retrieve the value of the daily volatility for any date.</p>
<p>The interest of having a more complex time model than a simple variance interpolation is that volatility is not delivered smoothly between tenors and we cannot assume a flat forward volatility between tenors. Indeed the forward volatility will be higher on days with important economic events and lower on week-ends or holidays. The main advantage of the Mean-reverting time model described here is that trader can mark a volatility shape very quickly with the parametrization of the backbone and, afterwards, fine tune the forward volatility marking for each day if they want via the use of daily events.</p>
<p>First, we detail in the next paragraph, how the ATM implied volatility is computed from these daily volatilities.</p>
<p>The mean reverting ATM time model is built a sum of three effects:</p>
<ol class="arabic simple">
<li><p>The mean reverting backbone, that builds a daily volatility to define the underlying term-structure as per Section 5.1.2.2.2.</p></li>
<li><p>The event weights, that weights the daily volatility depending on particular dates to account for special events as per Section 5.1.2.2.3.</p></li>
<li><p>The offsets, to make the event weighted daily backbone to match the market ATM term-structure, or apply an arbitrary shift to the implied volatility, as per Section 5.1.2.2.3.</p></li>
</ol>
</section>
<section id="calculation-of-the-atm-implied-volatilities">
<h3><span class="section-number">1.5.1.7.4. </span>5.1.2.2.1 Calculation of the ATM implied volatilities<a class="headerlink" href="#calculation-of-the-atm-implied-volatilities" title="Link to this heading">#</a></h3>
<p>We will detail in the next section Mean-reverting backbone how the daily volatilities are computed by the model. All the plots in the next section show the ATM implied volatility backbone generated from the mean reverting parameters models.</p>
<p>Using the adjusted daily volatilities, we can then calculate the corresponding ATM volatilities for each quoted pillar. The ATM volatility <span class="math notranslate nohighlight">\(\Theta(T_i)\)</span> for the quoted maturity <span class="math notranslate nohighlight">\(T_i\)</span>, that corresponds to <span class="math notranslate nohighlight">\(n_{T_i} = T_i \times 365\)</span> days is found by calculating the total variance by summing up the daily variances:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\Theta(T_i) = \sqrt{\frac{1}{n_{T_i}}\sum_{i=1}^{n_{T_i}} \sigma_i^2 + \Delta_{offset}(i)}, \tag{5.65}
\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(\sigma_i\)</span> is the daily volatility as defined below in Equation (5.68), based on the mean-reverting backbone which includes event weights, and <span class="math notranslate nohighlight">\(\Delta_{offset}(i)\)</span> are defined as in Section 5.1.2.2.4. When the implied volatility surface is built, the ATM volatilities are computed from the mean-reverting backbone and then stored. The squared volatility at non-quoted time <span class="math notranslate nohighlight">\(t\)</span> (that falls at end of day), in between two quoted pillars <span class="math notranslate nohighlight">\(T_1\)</span> and <span class="math notranslate nohighlight">\(T_2\)</span> is</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\Theta(t)^2 = \frac{(1-a_t)\Theta(T_1)^2T_1 + a_t\Theta(T_2)^2T_2}{t},
\]</div>
</div>
<p>with</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
a_t = \frac{\sum_{i=T_1 \times 365}^{t \times 365} \sigma_i^2}{\sum_{i=T_1 \times 365}^{T_2 \times 365} \sigma_i^2}.
\]</div>
</div>
<p>This corresponds to a weighted interpolation in variance where the weight <span class="math notranslate nohighlight">\(a_t\)</span> is a ratio between 0 and 1 that measures the amount of accumulated daily variance up to time <span class="math notranslate nohighlight">\(t\)</span> relatively to the total variance in the interval <span class="math notranslate nohighlight">\([T_1, T_2]\)</span>.</p>
<p>Again, this is the discrete version of the usual term-structure BlackScholes. Since the daily volatilities are real positive numbers, then one can immediately observe that the variance is assured to be increasing in maturities, and therefore they are arbitrage-free by construction (for ATM forward convention).</p>
<p>Finally, the implied volatility for expiries intraday are interpolated in total variance between the closing of two surroundings days.</p>
</section>
<section id="mean-reverting-backbone">
<h3><span class="section-number">1.5.1.7.5. </span>5.1.2.2.2   Mean-reverting backbone<a class="headerlink" href="#mean-reverting-backbone" title="Link to this heading">#</a></h3>
<p>The mean-reverting backbone allows to specify and quickly re-mark the whole ATM curve using just few parameters. Two version of the mean-reverting are available:</p>
<p> 3-params Mean-reverting backbone</p>
<p> 5-params Mean-reverting backbone.</p>
<p>We have both 3-params and 5-params Mean-reverting, because initially the 3-params was used for end of day marking. Traders prefer 5-params Mean-reverting because it allows more degree of freedom to independently control the front end of the curve (short term expiry) which move frequently and therefore quickly remark the market ATM backbone. With the 3-params, it is difficult to match observed very short-dated quotes without affecting the longer end expiries just with the mean-reverting parameters and the user has to use more Events weights described below to fit the observed market quotes shape.</p>
<p>3-params Mean-reverting backbone   Lets designate i by the i-th calendar day from today, and t is naturally the valuation date (today). We naturally have t - t = 1calendar day</p>
<p>Lets designate by  the daily volatility for the i-th day. The first step is therefore to build those daily volatilities recursively using a mean reversion function:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\sigma_i^{MR} = \sigma_{\infty} + (\sigma_0 - \sigma_{\infty})exp(-\lambda\frac{ln4}{730}),,\forall i \geq 2 \tag{5.66}
\]</div>
</div>
<p>where:</p>
<p> : is the initial daily volatility (i.e. on day 1), annualized</p>
<p> : is the mean reversion level of the daily volatility, annualized</p>
<p> : is the mean reversion rate, in units of per day.</p>
<p>The initial vol  is the initial level of the atm backbone parametrization.
The reversion rate  determines the speed how the atm backbone revert from the initial volatility to the reversion level.
The reversion level  is the asymptotic value of the volatility.</p>
<p>The term F = exp(- ln4/730) represents the decay factor over one day. The term ln4/730 simply comes from the fact that: exp(-ln(4)) = 1/4 = Friday_call/Monday_call so for a  equal to one we have a decay of one half for one year (365days).</p>
<p>This is the discrete form of a decaying function in continuous time  =  + ( - )exp(-t).
There are therefore three parameters to this model, which are , , . These parameters are provided by the user. In practice they will be chosen to reflect the market, but the choice is left entirely to the user.
We plot the influence of each parameters on Mean Reverting 3 params volatility surface Nyk Close for currency pair EURUSD, of 1st Dec 2016:
moniker official&#64;20161201/volsurface.fx/pivot/eurusd/MeanRevertingNykClose/builder</p>
<p><img alt="Figure 5.21" src="../../_images/211.png" /></p>
<p>Figure 5.21: Influence of the Initial Daily Vol  on the MR backbone. The initial daily vol determines the level of the short end of the ATM volatility backbone. If this is greater than the reversion level, the ATM backbone will have a downward slope and if it is smaller than the reversion level, it will have an upward slope.</p>
<p><img alt="Figure 5.22" src="../../_images/22.png" /></p>
<p>Figure 5.22: Influence of the Reversion Level  on the MR backbone. The reversion level represents the asymptotic value of the ATM volatility when time tends to infinity. In other terms, it determines the long term volatility value of the volatility surface.</p>
<p><img alt="Figure 5.23" src="../../_images/23.png" /></p>
<p>Figure 5.23: Influence of the Reversion Rate  on the MR backbone. We see on the graph that the higher the reversion rate is, the faster the short end volatility converge to the reversion level, and the short end slope of the volatility is higher.</p>
<p>5-params Mean-reverting backbone   In the case of the five parameters, the daily volatility  for the i-th day is enriched with 2 short term parameters: a short initial volatility and a short reversion rate which allow to give a hump to the short dated part of the backbone.</p>
<p> : is the initial daily volatility (i.e. on day 1), annualized</p>
<p> : is the mean reversion level of the daily volatility, annualized</p>
<p> _{decay}: is the exponential decay, in units of per day</p>
<p> _{short,0}: is the short initial volatility, annualized</p>
<p> _{shortdecay}: is the short exponential decay, in units of per day</p>
<p>In this case, we rewrote,</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\gamma_{decay} = 1 - exp(-\lambda\frac{ln4}{730}),
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\gamma_{shortdecay} = 1 - exp(-\lambda_{short}\frac{ln4}{730}).
\]</div>
</div>
<p>Only positive exponential decays _{decay}, _{shortdecay} are considered to be valid. Values of ,  must be non-negative, _{short,0} must be positive.</p>
<p>Parameters for base volatility curve are defined with respect to midnight at the start of a given specific day (DSD-ATM for Diffusion Start Date).</p>
<p>First the decay rates are adjusted for a discrete time.</p>
<p>The basic mean reverting underlying daily volatility is following this function:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\sigma_i^{MR} = (\sigma_0 - \sigma_{\infty})\left(1-\gamma_{decay}\right)^i + \sigma_{\infty} + \sigma_{short,0}\left(1-\gamma_{shortdecay}\right)^i \tag{5.67}
\]</div>
</div>
<p>We plot the influence of each parameters on Mean Reverting 5-params Volsurface Nyk Close for currency pair EURUSD, of 1st Dec 2016, which as the following two new parameters on the short end of the curve, the other three parameters have the same behavior:
moniker official&#64;20161201/volsurface.fx/pivot/eurusd/meanrevertingfiveparms/builder</p>
<p><img alt="Figure 5.24" src="../../_images/24.png" /></p>
<p>Figure 5.24: Influence of the Short Initial Vol _{short,0} on the MR backbone. This short initial volatility allows to calibrate better the very short end of the volatility backbone as it allows to give a hump shape to the short end.</p>
<p><img alt="Influence of Short Exponential Decay" src="../../_images/25.png" /></p>
<p>Figure 5.25: Influence of the Short Exponential Decay <span class="math notranslate nohighlight">\(\gamma_{short,decay}\)</span> on the MR backbone.The higher the short decay is, the more the hump shape is emphasized on the front.</p>
</section>
<section id="events">
<h3><span class="section-number">1.5.1.7.6. </span>5.1.2.2.3   Events<a class="headerlink" href="#events" title="Link to this heading">#</a></h3>
<p>The mean reverting surfaces builds a daily ATM vol vector (between consecutive days) which allows for modifying daily volatility values depending on all the event and weekend information. This adjustment attempt to take into account the fact that the observed daily volatility is lower if we are on the week-end or holidays and higher during a day with important economic policy announcements which impact the market (ECB rates), economic activity indicators or important political events (Brexit referendum, French Election).</p>
<section id="we-have-the-daily-volatility">
<h4><span class="section-number">1.5.1.7.6.1. </span>We have the daily volatility:<a class="headerlink" href="#we-have-the-daily-volatility" title="Link to this heading">#</a></h4>
<p><span class="math notranslate nohighlight">\(\sigma_i = \sigma_i^{MR} (1 + \mathbf{1} *{weeknd}(\omega (\omega - 1) + \mathbf{1}* {event}(\varepsilon_i - 1))\)</span>                     (5.68)</p>
<p>where <span class="math notranslate nohighlight">\(\sigma^{MR}\)</span> is defined in either Equation (5.66) or (5.67) and with <span class="math notranslate nohighlight">\(\omega\)</span> and <span class="math notranslate nohighlight">\(\varepsilon_i\)</span> the weekend and event weights respectively. While the model allows for both events and weekend weights, in production only the events are used, because they can be specified for each single calendar day.</p>
<p>Below an example of event weights value for EURUSD FX volatility on 01 Dec 2016 for the post French elections days (1st and 2nd rounds).</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>EventDates</p></th>
<th class="head"><p>Events</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>24-Apr-17</p></td>
<td><p>1.9446</p></td>
</tr>
<tr class="row-odd"><td><p>08-May-17</p></td>
<td><p>4.1737</p></td>
</tr>
</tbody>
</table>
</div>
<p>This daily granularity of the event weights can change quite substantially the shape of the MR backbone. We plot below the the ATM backbone with and without Event Weights of a EURUSD volsurface for the 01/12/2016.</p>
<p><img alt="MR Backbone 3 and 5 params with Events" src="../../_images/26.png" /></p>
<p>Figure 5.26: Impact of the Event Weights on the MR backbone. We see that the 5-params allows much more flexibility to match the front end of the ATM backbone, whereas the raw 3-params cannot fit the hump at all. So the events weights adjustments will be much more important with the MR 3 params and they will be less stable.</p>
<p>If we zoom on the graph to see better what is happening on the front end of the curve:</p>
<p><img alt="MR Backbone 3 and 5 params with Events zoomed" src="../../_images/27.png" /></p>
<p>Figure 5.27: Impact of the Event Weights on the MR backbone. We see that the 5-params allows much more flexibility to match the front end of the ATM backbone, whereas the raw 3-params cannot fit the hump at all. The value of the backbones with Events Weight are almost identical for 3 and 5 params which is expected.</p>
</section>
</section>
<section id="offsets">
<h3><span class="section-number">1.5.1.7.7. </span>5.1.2.2.4   Offsets<a class="headerlink" href="#offsets" title="Link to this heading">#</a></h3>
<p>The offsets, which are provided in the FX vol input, are values that can shift the ATM tenor points. When offsets are provided, the market data container of the volatility surface (which contains the ATM tenor points) is not used and the ATM values are generated only by using MR backbone and the offsets.</p>
<p>If no offset are provided, the offsets will be calculated so that added to the volatility MR backbone it matches the ATM tenor points. This is a way to force to match ATM pillar backbone.</p>
<p>In the graph below, we plot a graph where we have an initial MR backbone (blue curve), we change the MR and Event Weights parameters with offsets equal to zero so it does not use market data container (red curve) and we plot the ATM curve with new MR parameters but no offset so it uses the market data container with the initial ATM volatilities (green curve). We see that this ATM backbone under ATM pillar constraints matches the initial ATM tenor points which are the red dots, but the global shape of the backbone is using the new MR and event weights parameters.</p>
<p><img alt="MR from ME : EURUSD ATM volatility" src="../../_images/28.png" /></p>
<p>Figure 5.28: Impact of providing no offsets to force the backbone to match the ATM tenor points (represented by red dots). We see that the curve atm EW MR const is forced to match the initial tenor point while changing the parametrization and the instantaneous volatility between the tenors.</p>
</section>
<section id="wing-time-models">
<h3><span class="section-number">1.5.1.7.8. </span>5.1.3.   Wing Time models<a class="headerlink" href="#wing-time-models" title="Link to this heading">#</a></h3>
<p>As mentioned earlier in this chapter, when building the smile for an expiry T that was not explicitly marked, we need to determine 3 or 5 volatility quotes for time T, and then use these to calibrate the smile model for the given expiry. The ATM volatility is specified by the ATM time model whereas the wing (non-ATM) volatility quotes are computed according to the chosen wing model.</p>
<p>There are three wing interpolation models available in the QA Library:</p>
<ul class="simple">
<li><p>Call/Put Variance Interpolation</p></li>
<li><p>Risk Reversal/Strangle quotes Interpolation</p></li>
<li><p>Constant-moneyness.</p></li>
</ul>
<section id="call-put-variance-interpolation">
<h4><span class="section-number">1.5.1.7.8.1. </span>5.1.3.1.   Call/Put Variance Interpolation<a class="headerlink" href="#call-put-variance-interpolation" title="Link to this heading">#</a></h4>
<p>This methodology is currently used in production only for long-dated volatility surfaces.</p>
<p>The quantities being interpolated in time are the call and put variances at 25/10-delta in the same way described in the previous section on At-the-money Time models. Once the call/put variances have been interpolated they are converted to call/put volatilites and together with the ATM volatility they are used to calibrate the smile model.</p>
<p>We have the same two types of variance interpolation in place:</p>
<ul class="simple">
<li><p>Linear variance Interpolation</p></li>
<li><p>Monotone Cubic variance Interpolation</p></li>
</ul>
<p>In production, the Monotone Cubic variance interpolation is the only one used.</p>
<p>We plot below some graphs showing the variance interpolation on Long dated EUR USD Volatility Surface of 12/01/2016. We plot the interpolation in Variance on the 25/10 delta Call/Put for the smooth variance interpolation mode (monotone cubic) and the linear interpolation.</p>
<p><img alt="EURUSD LD variance_25 Delta Call interpolation at tenor 10Y between 7Y and 15 Y tenors" src="../../_images/29.png" /></p>
<p>Figure 5.29: Wing time interpolation in 0.25 delta Call for Long Dated EUR USD volatility surface, on tenor 10Y between 7Y and 15Y. As expected, the variance plot for the linear mode is a straight line between the tenors and the variance for the monotone cubic mode is using the same monotone cubic interpolation used for ATM backbone.</p>
<p><img alt="EURUSD LD variance_25 Delta Put interpolation at tenor 10Y between 7Y and 15 Y tenors" src="../../_images/30.png" /></p>
<p>Figure 5.30: Wing time interpolation in 0.25 delta Put for Long Dated EUR USD volatility surface, on tenor 10Y between 7Y and 15Y. As expected, the variance plot for the linear mode is a straight line between the tenors and the variance for the monotone cubic mode is using the same monotone cubic interpolation used for ATM backbone.</p>
<p><img alt="EURUSD LD variance_10 Delta Call interpolation at tenor 10Y between 7Y and 15 Y tenors" src="../../_images/311.png" /></p>
<p>Figure 5.31: Wing time interpolation in 0.10 delta Call for Long Dated EUR USD volatility surface, on tenor 10Y between 7Y and 15Y. As expected, the variance plot for the linear mode is a straight line between the tenors and the variance for the monotone cubic mode is using the same monotone cubic interpolation used for ATM backbone.</p>
<p><img alt="EURUSD LD variance_10 Delta Put interpolation at tenor 10Y between 7Y and 15 Y tenors" src="../../_images/32.png" /></p>
<p>Figure 5.32: Wing time interpolation in 0.10 delta Put for Long Dated EUR USD volatility surface, on tenor 10Y between 7Y and 15Y. As expected, the variance plot for the linear mode is a straight line between the tenors and the variance for the monotone cubic mode is using the same monotone cubic interpolation used for ATM backbone.</p>
</section>
<section id="risk-reversal-strangle-quotes-interpolation">
<h4><span class="section-number">1.5.1.7.8.2. </span>5.1.3.2.   Risk Reversal/Strangle quotes Interpolation<a class="headerlink" href="#risk-reversal-strangle-quotes-interpolation" title="Link to this heading">#</a></h4>
<p>This methodology is currently used in production for mean reverting volatility surface.</p>
<p>We suppose that we have two pillars t and t with a smile constructed via the 3 or 5 points analytics and we have a time t between t and t and our aim is to build the smile at that time. For the two pillars at time t and t, we know the value of RR and ST for the 25/10-delta values (usually called respectively Near and Far).</p>
<p>The Risk Reversals and Strangles volatilities are interpolated linearly in time and the resulting values are then used to compute the call and put volatilities. Once we have the call and put variances for this expiry t, we can build a smile interpolation model for the expiry in question. As the call and put volatilities are associated to a certain value of delta (25 or 10, usually) the corresponding strike is computed by solving using the formulae given in Section 4.
So we have:</p>
<div class="math-wrapper docutils container" id="equation-5-69">
<div class="math notranslate nohighlight" id="equation-5-69">
<span class="eqno">(1)<a class="headerlink" href="#equation-5-69" title="Link to this equation">#</a></span>\[
RR_t = \frac{(t - t_1)}{(t_2 - t_1)} RR_{t_2} + \frac{(t_2 - t)}{(t_2 - t_1)} RR_{t_1}\]</div>
</div>
<div class="math-wrapper docutils container" id="equation-5-70">
<div class="math notranslate nohighlight" id="equation-5-70">
<span class="eqno">(2)<a class="headerlink" href="#equation-5-70" title="Link to this equation">#</a></span>\[ST_t = \frac{(t - t_1)}{(t_2 - t_1)} ST_{t_2} + \frac{(t_2 - t)}{(t_2 - t_1)} ST_{t_1}\]</div>
</div>
<p>In the case where the query on risk reversal / strangle is before the first pillar available, we use the values of the first pillar for RR/ST and a volatility adjustment where:</p>
<div class="math-wrapper docutils container" id="equation-5-71">
<div class="math notranslate nohighlight" id="equation-5-71">
<span class="eqno">(3)<a class="headerlink" href="#equation-5-71" title="Link to this equation">#</a></span>\[VolatilityAdjustment = \sqrt{\frac{Var(DSD, D_T) \times (Mat_1 - DSD)}{Var(DSD, Mat_1) \times (Mat_1 - DSD)}}\]</div>
</div>
<div class="math-wrapper docutils container" id="equation-5-72">
<div class="math notranslate nohighlight" id="equation-5-72">
<span class="eqno">(4)<a class="headerlink" href="#equation-5-72" title="Link to this equation">#</a></span>\[RR_t = RR_{t_1} \times VolatilityAdjustment\]</div>
</div>
<div class="math-wrapper docutils container" id="equation-5-73">
<div class="math notranslate nohighlight" id="equation-5-73">
<span class="eqno">(5)<a class="headerlink" href="#equation-5-73" title="Link to this equation">#</a></span>\[ST_t = ST_{t_1} \times VolatilityAdjustment\]</div>
</div>
<p>DSD is the start date of the volatility surface, <span class="math notranslate nohighlight">\(Mat_1\)</span> is the maturity date of the first pillar available. <span class="math notranslate nohighlight">\(D_T\)</span> is the query date where we query the volatility in case this date is before the first tenor pillar available.</p>
<p>To convert the RR/ST into variance, we use:</p>
<div class="math-wrapper docutils container" id="equation-5-74">
<div class="math notranslate nohighlight" id="equation-5-74">
<span class="eqno">(6)<a class="headerlink" href="#equation-5-74" title="Link to this equation">#</a></span>\[\sigma_{Call} = \sigma_{ATM} + ST + 0.5 \times RR\]</div>
</div>
<div class="math-wrapper docutils container" id="equation-5-75">
<div class="math notranslate nohighlight" id="equation-5-75">
<span class="eqno">(7)<a class="headerlink" href="#equation-5-75" title="Link to this equation">#</a></span>\[\sigma_{Put} = \sigma_{ATM} + ST - 0.5 \times RR\]</div>
</div>
<div class="math-wrapper docutils container" id="equation-5-76">
<div class="math notranslate nohighlight" id="equation-5-76">
<span class="eqno">(8)<a class="headerlink" href="#equation-5-76" title="Link to this equation">#</a></span>\[Var_{Call/Put} = \sigma^2_{Call/Put} \times T\]</div>
</div>
<p>We plot below an example of wing time interpolation in RiskReversal/Strangle for EURUSD Volatility Surface as of 1-Dec-2016, the interpolation is done between 1M and 2M tenors. We see on the graph that the behaviour of the interpolation is linear for both RR and ST in 10 and 25 deltas. We plot another wing interpolation type Constant-moneyness, presented in the next section, on the same graph to compare, this one is obviously not linear in RR/ST.
<img alt="Linear interpolation in 0.25 Strangle for interpolation RR STR mode" src="../../_images/33.png" /></p>
<p>Figure 5.33:  Wing time interpolation in 0.25 Strangle for RR/ST mode and ConstantMoneyness. As expected RR/ST model is linear. We see that the interpolation type has an important impact on the value of the Near Strangle
<img alt="Linear interpolation in 0.10 delta Risk-Reversal for interpolation RR-STR mode" src="../../_images/34.png" /></p>
<p>Figure 5.36: Wing time interpolation in 0.10 Risk Reversal for RR/ST mode and ConstantMoneyness. As expected RR/ST model is linear.</p>
</section>
</section>
<section id="constant-moneyness-interpolation">
<h3><span class="section-number">1.5.1.7.9. </span>5.1.3.3.    Constant-Moneyness Interpolation<a class="headerlink" href="#constant-moneyness-interpolation" title="Link to this heading">#</a></h3>
<p>In this section, we will describe a methodology to perform a time interpolation with limited risk of arbitrages while taking into account the diffusive behavior of the spot.</p>
<p>We recall that the absence of calendar arbitrage is satisfied via: <span class="math notranslate nohighlight">\(\frac{\partial w(k,T)}{\partial T} &gt; 0\)</span>,</p>
<p>where <span class="math notranslate nohighlight">\(k = \ln(\frac{F}{K})\)</span> and <span class="math notranslate nohighlight">\(w(k,T) = \sigma^2 (k,T)T\)</span> is the variance.</p>
<p>From Yendapalli <a class="reference internal" href="#"><span class="xref myst">[10]</span></a> and Gatheral <a class="reference internal" href="#"><span class="xref myst">[5]</span></a>, we know that the local variance can be expressed as:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[Local\_Variance = \frac{\frac{\partial w}{\partial T}}{1 - \frac{k}{\sigma}\frac{\partial \sigma}{\partial k} + \frac{1}{4}(\frac{\partial \sigma}{\partial k})^2(-1-\frac{1}{v}\frac{k^2}{\sigma^2}) + \frac{1}{2}\frac{\partial^2 \sigma}{\partial k^2}}
\]</div>
</div>
<p>The numerator of the local variance is the time derivative of the implied variance at a constant log moneyness. To construct a time interpolation avoiding calendar arbitrage the interpolation scheme must ensure that implied variance is a non-decreasing function of time along each line of log moneyness.</p>
<p>The curves of variance versus log moneyness corresponding to successive time should be continuous and not intersecting.</p>
<p>The only drawback of interpolating in log-moneyness scale is that we do not take into account the diffusive behavior of the spot. The log-moneyness scale only incorporates the drifting. Therefore, we introduce a quantity consistent with both the log-moneyness and the added variance that appear
<img alt="Linear interpolation in 0.10 delta Risk-Reversal for interpolation RR-STR mode" src="../../_images/35.png" /></p>
<p>Figure 5.36: Wing time interpolation in 0.10 Risk Reversal for RR/ST mode and ConstantMoneyness. As expected RR/ST model is linear.</p>
</section>
<section id="id5">
<h3><span class="section-number">1.5.1.7.10. </span>5.1.3.3.    Constant-Moneyness Interpolation<a class="headerlink" href="#id5" title="Link to this heading">#</a></h3>
<p>In this section, we will describe a methodology to perform a time interpolation with limited risk of arbitrages while taking into account the diffusive behavior of the spot.</p>
<p>We recall that the absence of calendar arbitrage is satisfied via: <span class="math notranslate nohighlight">\(\frac{\partial w(k,T)}{\partial T} &gt; 0\)</span>,</p>
<p>where <span class="math notranslate nohighlight">\(k = \ln(\frac{F}{K})\)</span> and <span class="math notranslate nohighlight">\(w(k,T) = \sigma^2 (k,T)T\)</span> is the variance.</p>
<p>From Yendapalli <a class="reference internal" href="#"><span class="xref myst">[10]</span></a> and Gatheral <a class="reference internal" href="#"><span class="xref myst">[5]</span></a>, we know that the local variance can be expressed as:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
Local\_Variance = \frac{\frac{\partial w}{\partial T}}{1 - \frac{k}{\sigma}\frac{\partial \sigma}{\partial k} + \frac{1}{4}(\frac{\partial \sigma}{\partial k})^2(-1-\frac{1}{v}\frac{k^2}{\sigma^2}) + \frac{1}{2}\frac{\partial^2 \sigma}{\partial k^2}}
\]</div>
</div>
<p>The numerator of the local variance is the time derivative of the implied variance at a constant log moneyness. To construct a time interpolation avoiding calendar arbitrage the interpolation scheme must ensure that implied variance is a non-decreasing function of time along each line of log moneyness.</p>
<p>The curves of variance versus log moneyness corresponding to successive time should be continuous and not intersecting.</p>
<p>The only drawback of interpolating in log-moneyness scale is that we do not take into account the diffusive behavior of the spot. The log-moneyness scale only incorporates the drifting. Therefore, we introduce a quantity consistent with both the log-moneyness and the added variance that appear</p>
<p>in between <span class="math notranslate nohighlight">\(t_1\)</span> and <span class="math notranslate nohighlight">\(t_2\)</span>. We define the Quick Delta QD,</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
QD(t) = \frac{\log(\frac{K}{F(t)T})}{\sigma_{ATM}(t)\sqrt{t}}.
\]</div>
</div>
<p>We suppose that we have two pillars <span class="math notranslate nohighlight">\(t_1\)</span> and <span class="math notranslate nohighlight">\(t_2\)</span> with a smile constructed via the 3 or 5 points analytics and we have a time t between <span class="math notranslate nohighlight">\(t_1\)</span> and <span class="math notranslate nohighlight">\(t_2\)</span> and our aim is to build the smile at that time.</p>
<p>The idea is to select five points on: <span class="math notranslate nohighlight">\(x_i,i = 1,2,3,4,5\)</span></p>
<p>We want to find <span class="math notranslate nohighlight">\(y_i\)</span> the implied volatilities on the points : <span class="math notranslate nohighlight">\(y_i,i = 1,2,3,4,5\)</span>
where <span class="math notranslate nohighlight">\((x_3,y_3) = ATM_{point}\)</span></p>
<p>For each of the other four points, we choose a moneyness: <span class="math notranslate nohighlight">\(x = \ln(\frac{K}{F})\)</span> and <span class="math notranslate nohighlight">\(w (x,T)\)</span>.
The choice of the four moneyness is done, trying to have points close the standard FX markets points in 10,25 delta. This approach is called fixed shape in delta and we detail it below.</p>
<p>A variance ratio or weight is calculated using the observation of ATM variance between 2 tenors as given by the ATM interpolation scheme chosen:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
f = \frac{w (x_{ATM}, t) - w(x_{ATM}, t_1)}{w (x_{ATM}, t_2) - w(x_{ATM}, t_1)}
\]</div>
</div>
<p>Once the variance ratio is calculated, we calculate an estimation of the delta strikes using this quick delta approximation for the two time slice <span class="math notranslate nohighlight">\(t_1\)</span> and <span class="math notranslate nohighlight">\(t_2\)</span>.</p>
<p>For each <span class="math notranslate nohighlight">\(i = 1, 2, 4, 5\)</span> we have on each time slice,</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
QD_i(t1) = \frac{\log(\frac{k_{i1}}{F1})}{\sigma_{ATM}(t_1)\sqrt{t_1}}
\]</div>
</div>
<p>(5.77)</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
QD_i(t2) = \frac{\log(\frac{k_{i2}}{F2})}{\sigma_{ATM}(t_2)\sqrt{t_2}}
\]</div>
</div>
<p>(5.78)</p>
<p>We then interpolate these quick delta linearly at time t, so for <span class="math notranslate nohighlight">\(i = 1, 2, 4, 5\)</span> we have:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
QD_i (t) = (1  f) QD_i (t_1) + f QD_i (t_2),
\]</div>
</div>
<p>This allows to stay in line with the ATM backbone.</p>
<p>These Quick-delta points correspond to four moneyness levels. The variance at time t for these four moneyness with <span class="math notranslate nohighlight">\(i = 1, 2, 4, 5\)</span> is given by:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
w(\tilde{x}_i(t),t) = (1  f) w(\tilde{x}_i(t),t_1) + fw(\tilde{x}_i(t), t_2),
\]</div>
</div>
<p>with</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\tilde{x}_i(t) = QD_i (t) \sigma_{ATM}(t)\sqrt{t}.
\]</div>
</div>
<p>The volatility is determined as <span class="math notranslate nohighlight">\(\sigma(\tilde{x}_i(t),t) = \sqrt{\frac{w(\tilde{x}_i(t),t)}{t}}\)</span>, where time t is time of the query (which can be fractional) when converting between volatility and variances.</p>
<p>Therefore, we interpolated in variance on the same line of moneyness, which guarantees absence of calendar spread arbitrages.</p>
<p>The procedure described here ensures that:</p>
<p> The variance ratio is based on the at-the-money variances, and so ensures that the economic time and events already built into the ATM curve interpolation are incorporated into the whole surface. This is an improvement on the wing interpolation scheme RiskReversal/Strangle quotes interpolations. Indeed, a problem RiskReversal/Strangle quotes interpolations scheme exhibits is that since the ATM variance is interpolated in economic time, while the other parameters are interpolated in calendar time, then as the surface crosses a weekend the calendar time, the ATM variance is pinned (low variance on weekend) while the Strangle and Risk Reversal move. This result in a twist in the variance-moneyness contours around a central pivot, and it could cause negative forward variance.</p>
<p> The scheme is constructed explicitly to limit calendar spread arbitrages</p>
<p>Note that the Constant-moneyness interpolation can be done moneyness by moneyness instead of sampling the five known points and using the strike interpolator.</p>
<p>We compare in the next graph below, the shape of wing time extrapolations obtained by the two methodology RR/ST and Constant-moneyness interpolation. We are using the same MR volatility surface EURUSD as of 1 Dec 2016.</p>
<p><img alt="Wing time interpolation between 1M and 2M, EURUSD MR surface, in variance, for 1-7 months" src="../../_images/36.png" /></p>
<p>Figure 5.37: Wing time smile interpolation between the 2 pillars 1M and 2M (1.7 M) for RR/ST mode and Constant-moneyness. The plot is in variance as it is easier to visualize arbitrage. We see that 2 interpolations gives slightly different smiles.</p>
<p>The different wing interpolation models can lead to different smile shapes for the interpolated dates, both the RR/ST and Constant-moneyness takes in account the ATM backbone shape with events in their interpolation but the RR/ST methodology does not guarantee the absence of calendar arbitrage. We can see that the difference between the 2 interpolations methodology will be higher when the ATM has bumps with days with big events like the French Elections, see graph below.</p>
<p><img alt="Wing time interpolation for MR EUR/USD infinite space on 08 may 2017, French Election Event" src="../../_images/37.png" /></p>
<p>Figure 5.38: Wing time smile interpolation for French Election date 8 May 2017 for RR/ST mode and Constant-moneyness. The plot is in variance as it is easier to visualize arbitrage. We see that 2 interpolations gives significantly different smiles, the difference is higher due to the big event.</p>
<p>In order to visualize better the term structure interpolation on the wings, we plot the volatility on the 10,25 delta call and put for the time between 1M and 2M. We see that the difference can be significant, like on the 10 delta put, see graph below.</p>
<p><img alt="Wing time interpolation for 0.10 delta Put between 1m-2m" src="../../_images/37.png" /></p>
<p>Figure 5.39: Wing time interpolation in 0.10 Delta Put for RR/ST mode and ConstantMoneyness.
<img alt="Linear interpolation in 0.10 delta Risk-Reversal for interpolation RR-STR mode" src="../../_images/35.png" /></p>
<p>Figure 5.36: Wing time interpolation in 0.10 Risk Reversal for RR/ST mode and ConstantMoneyness. As expected RR/ST model is linear.</p>
</section>
<section id="id6">
<h3><span class="section-number">1.5.1.7.11. </span>5.1.3.3.    Constant-Moneyness Interpolation<a class="headerlink" href="#id6" title="Link to this heading">#</a></h3>
<p>In this section, we will describe a methodology to perform a time interpolation with limited risk of arbitrages while taking into account the diffusive behavior of the spot.</p>
<p>We recall that the absence of calendar arbitrage is satisfied via: <span class="math notranslate nohighlight">\(\frac{\partial w(k,T)}{\partial T} &gt; 0\)</span>,</p>
<p>where <span class="math notranslate nohighlight">\(k = \ln(\frac{F}{K})\)</span> and <span class="math notranslate nohighlight">\(w(k,T) = \sigma^2 (k,T)T\)</span> is the variance.</p>
<p>From Yendapalli <a class="reference internal" href="#"><span class="xref myst">[10]</span></a> and Gatheral <a class="reference internal" href="#"><span class="xref myst">[5]</span></a>, we know that the local variance can be expressed as:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
Local\_Variance = \frac{\frac{\partial w}{\partial T}}{1 - \frac{k}{\sigma}\frac{\partial \sigma}{\partial k} + \frac{1}{4}(\frac{\partial \sigma}{\partial k})^2(-1-\frac{1}{v}\frac{k^2}{\sigma^2}) + \frac{1}{2}\frac{\partial^2 \sigma}{\partial k^2}}
\]</div>
</div>
<p>The numerator of the local variance is the time derivative of the implied variance at a constant log moneyness. To construct a time interpolation avoiding calendar arbitrage the interpolation scheme must ensure that implied variance is a non-decreasing function of time along each line of log moneyness.</p>
<p>The curves of variance versus log moneyness corresponding to successive time should be continuous and not intersecting.</p>
<p>The only drawback of interpolating in log-moneyness scale is that we do not take into account the diffusive behavior of the spot. The log-moneyness scale only incorporates the drifting. Therefore, we introduce a quantity consistent with both the log-moneyness and the added variance that appear</p>
<p>in between <span class="math notranslate nohighlight">\(t_1\)</span> and <span class="math notranslate nohighlight">\(t_2\)</span>. We define the Quick Delta QD,</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
QD(t) = \frac{\log(\frac{K}{F(t)T})}{\sigma_{ATM}(t)\sqrt{t}}.
\]</div>
</div>
<p>We suppose that we have two pillars <span class="math notranslate nohighlight">\(t_1\)</span> and <span class="math notranslate nohighlight">\(t_2\)</span> with a smile constructed via the 3 or 5 points analytics and we have a time t between <span class="math notranslate nohighlight">\(t_1\)</span> and <span class="math notranslate nohighlight">\(t_2\)</span> and our aim is to build the smile at that time.</p>
<p>The idea is to select five points on: <span class="math notranslate nohighlight">\(x_i,i = 1,2,3,4,5\)</span></p>
<p>We want to find <span class="math notranslate nohighlight">\(y_i\)</span> the implied volatilities on the points : <span class="math notranslate nohighlight">\(y_i,i = 1,2,3,4,5\)</span>
where <span class="math notranslate nohighlight">\((x_3,y_3) = ATM_{point}\)</span></p>
<p>For each of the other four points, we choose a moneyness: <span class="math notranslate nohighlight">\(x = \ln(\frac{K}{F})\)</span> and <span class="math notranslate nohighlight">\(w (x,T)\)</span>.
The choice of the four moneyness is done, trying to have points close the standard FX markets points in 10,25 delta. This approach is called fixed shape in delta and we detail it below.</p>
<p>A variance ratio or weight is calculated using the observation of ATM variance between 2 tenors as given by the ATM interpolation scheme chosen:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
f = \frac{w (x_{ATM}, t) - w(x_{ATM}, t_1)}{w (x_{ATM}, t_2) - w(x_{ATM}, t_1)}
\]</div>
</div>
<p>Once the variance ratio is calculated, we calculate an estimation of the delta strikes using this quick delta approximation for the two time slice <span class="math notranslate nohighlight">\(t_1\)</span> and <span class="math notranslate nohighlight">\(t_2\)</span>.</p>
<p>For each <span class="math notranslate nohighlight">\(i = 1, 2, 4, 5\)</span> we have on each time slice,</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
QD_i(t1) = \frac{\log(\frac{k_{i1}}{F1})}{\sigma_{ATM}(t_1)\sqrt{t_1}}
\]</div>
</div>
<p>(5.77)</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
QD_i(t2) = \frac{\log(\frac{k_{i2}}{F2})}{\sigma_{ATM}(t_2)\sqrt{t_2}}
\]</div>
</div>
<p>(5.78)</p>
<p>We then interpolate these quick delta linearly at time t, so for <span class="math notranslate nohighlight">\(i = 1, 2, 4, 5\)</span> we have:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
QD_i (t) = (1  f) QD_i (t_1) + f QD_i (t_2),
\]</div>
</div>
<p>This allows to stay in line with the ATM backbone.</p>
<p>These Quick-delta points correspond to four moneyness levels. The variance at time t for these four moneyness with <span class="math notranslate nohighlight">\(i = 1, 2, 4, 5\)</span> is given by:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
w(\tilde{x}_i(t),t) = (1  f) w(\tilde{x}_i(t),t_1) + fw(\tilde{x}_i(t), t_2),
\]</div>
</div>
<p>with</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\tilde{x}_i(t) = QD_i (t) \sigma_{ATM}(t)\sqrt{t}.
\]</div>
</div>
<p>The volatility is determined as <span class="math notranslate nohighlight">\(\sigma(\tilde{x}_i(t),t) = \sqrt{\frac{w(\tilde{x}_i(t),t)}{t}}\)</span>, where time t is time of the query (which can be fractional) when converting between volatility and variances.</p>
<p>Therefore, we interpolated in variance on the same line of moneyness, which guarantees absence of calendar spread arbitrages.</p>
<p>The procedure described here ensures that:</p>
<p> The variance ratio is based on the at-the-money variances, and so ensures that the economic time and events already built into the ATM curve interpolation are incorporated into the whole surface. This is an improvement on the wing interpolation scheme RiskReversal/Strangle quotes interpolations. Indeed, a problem RiskReversal/Strangle quotes interpolations scheme exhibits is that since the ATM variance is interpolated in economic time, while the other parameters are interpolated in calendar time, then as the surface crosses a weekend the calendar time, the ATM variance is pinned (low variance on weekend) while the Strangle and Risk Reversal move. This result in a twist in the variance-moneyness contours around a central pivot, and it could cause negative forward variance.</p>
<p> The scheme is constructed explicitly to limit calendar spread arbitrages</p>
<p>Note that the Constant-moneyness interpolation can be done moneyness by moneyness instead of sampling the five known points and using the strike interpolator.</p>
<p>We compare in the next graph below, the shape of wing time extrapolations obtained by the two methodology RR/ST and Constant-moneyness interpolation. We are using the same MR volatility surface EURUSD as of 1 Dec 2016.</p>
<p><img alt="Wing time interpolation between 1M and 2M, EURUSD MR surface, in variance, for 1-7 months" src="../../_images/36.png" /></p>
<p>Figure 5.37: Wing time smile interpolation between the 2 pillars 1M and 2M (1.7 M) for RR/ST mode and Constant-moneyness. The plot is in variance as it is easier to visualize arbitrage. We see that 2 interpolations gives slightly different smiles.</p>
<p>The different wing interpolation models can lead to different smile shapes for the interpolated dates, both the RR/ST and Constant-moneyness takes in account the ATM backbone shape with events in their interpolation but the RR/ST methodology does not guarantee the absence of calendar arbitrage. We can see that the difference between the 2 interpolations methodology will be higher when the ATM has bumps with days with big events like the French Elections, see graph below.</p>
<p><img alt="Wing time interpolation for MR EUR/USD infinite space on 08 may 2017, French Election Event" src="../../_images/37.png" /></p>
<p>Figure 5.38: Wing time smile interpolation for French Election date 8 May 2017 for RR/ST mode and Constant-moneyness. The plot is in variance as it is easier to visualize arbitrage. We see that 2 interpolations gives significantly different smiles, the difference is higher due to the big event.</p>
<p>In order to visualize better the term structure interpolation on the wings, we plot the volatility on the 10,25 delta call and put for the time between 1M and 2M. We see that the difference can be significant, like on the 10 delta put, see graph below.</p>
<p><img alt="Wing time interpolation for 0.10 delta Put between 1m-2m" src="../../_images/37.png" /></p>
<p>Figure 5.39: Wing time interpolation in 0.10 Delta Put for RR/ST mode and ConstantMoneyness.</p>
<p><img alt="Wing time interpolation in 0.25 Delta Put for RR/ST mode and ConstantMoneyness" src="../../_images/38.png" /></p>
<p>Figure 5.40: Wing time interpolation in 0.25 Delta Put for RR/ST mode and ConstantMoneyness.</p>
<p><img alt="Wing time interpolation in 0.25 Delta Call for RR/ST mode and ConstantMoneyness" src="../../_images/39.png" /></p>
<p>Figure 5.41: Wing time interpolation in 0.25 Delta Call for RR/ST mode and ConstantMoneyness.</p>
<p><img alt="Wing time interpolation in 0.10 Delta Call for RR/ST mode and ConstantMoneyness" src="../../_images/40.png" /></p>
<p>Figure 5.42: Wing time interpolation in 0.10 Delta Call for RR/ST mode and ConstantMoneyness.</p>
</section>
<section id="local-volatility-impact-and-time-arbitrage-cleanup">
<h3><span class="section-number">1.5.1.7.12. </span>5.1.3.3.1    Local volatility impact and time arbitrage cleanup<a class="headerlink" href="#local-volatility-impact-and-time-arbitrage-cleanup" title="Link to this heading">#</a></h3>
<p>On some market data set, the advantages of using the constant-moneyness interpolation is clear, the improvement over RR-STR interpolation is significant and the time arbitrages problem effectively removed. This can be efficiently monitored on the generated local volatility surface of which we output a few time slices below. We recall that a local volatility floored at zero (and therefore actually negative), means that an arbitrage is present.</p>
<p>The market data used is the EURJPY currency pair for the 02-03-2017:</p>
<p><img alt="EURJPY 2M Local Volatility and EURJPY 4M Local Volatility comparison" src="../../_images/411.png" /></p>
<p>Figure 5.43: Constant-moneyness Local Volatility correction</p>
<p>A similar improvement can be noticed on the Vega and Volga of a EURJPY double no-touch option where we display the bucketed risk in the following Table. We can note that on the 02/06/2017 pillar, the risk is not blowing-up anymore for both Vega and Volga especially.</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Pillar</p></th>
<th class="head"><p>Vega before</p></th>
<th class="head"><p>Vega after</p></th>
<th class="head"><p>Volga before</p></th>
<th class="head"><p>Volga after</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>03/03/2017</p></td>
<td><p>40.14</p></td>
<td><p>28.6</p></td>
<td><p>-2.35</p></td>
<td><p>-5.11</p></td>
</tr>
<tr class="row-odd"><td><p>06/03/2017</p></td>
<td><p>-14.48</p></td>
<td><p>2.05</p></td>
<td><p>-8.07</p></td>
<td><p>-4.91</p></td>
</tr>
<tr class="row-even"><td><p>07/03/2017</p></td>
<td><p>-22.79</p></td>
<td><p>-16.44</p></td>
<td><p>53.8</p></td>
<td><p>51.23</p></td>
</tr>
<tr class="row-odd"><td><p>08/03/2017</p></td>
<td><p>67.43</p></td>
<td><p>67.05</p></td>
<td><p>-16.02</p></td>
<td><p>-14.16</p></td>
</tr>
<tr class="row-even"><td><p>09/03/2017</p></td>
<td><p>164</p></td>
<td><p>124.71</p></td>
<td><p>17.53</p></td>
<td><p>10.59</p></td>
</tr>
<tr class="row-odd"><td><p>16/03/2017</p></td>
<td><p>411.07</p></td>
<td><p>562.19</p></td>
<td><p>292.57</p></td>
<td><p>319.09</p></td>
</tr>
<tr class="row-even"><td><p>04/04/2017</p></td>
<td><p>178525.32</p></td>
<td><p>176659.33</p></td>
<td><p>16649.61</p></td>
<td><p>13771.62</p></td>
</tr>
<tr class="row-odd"><td><p>01/05/2017</p></td>
<td><p>140245.33</p></td>
<td><p>142396.5</p></td>
<td><p>4337.73</p></td>
<td><p>7784.6</p></td>
</tr>
<tr class="row-even"><td><p>02/06/2017</p></td>
<td><p>15820.9</p></td>
<td><p>-335.22</p></td>
<td><p>-46946.45</p></td>
<td><p>412.88</p></td>
</tr>
<tr class="row-odd"><td><p>03/07/2017</p></td>
<td><p>-187.97</p></td>
<td><p>-1165.05</p></td>
<td><p>-882.39</p></td>
<td><p>40.28</p></td>
</tr>
<tr class="row-even"><td><p>03/08/2017</p></td>
<td><p>-239174.93</p></td>
<td><p>-236008.88</p></td>
<td><p>32613.83</p></td>
<td><p>32753.92</p></td>
</tr>
<tr class="row-odd"><td><p>04/09/2017</p></td>
<td><p>-63616.72</p></td>
<td><p>-63238.35</p></td>
<td><p>8578.25</p></td>
<td><p>8712.42</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="skew-event-model">
<h3><span class="section-number">1.5.1.7.13. </span>5.1.3.4.    Skew Event Model<a class="headerlink" href="#skew-event-model" title="Link to this heading">#</a></h3>
<p>This section describes the approach developed to model the impact of events on volatility skew and smile parameters.  The goal is that traders can mark a calendar of upcoming events that are expected to affect the FX options smile.</p>
<p>The aim of this model is to have stable parameters as the event approaches, not requiring frequent by-hand adjustment as long as the view of the anticipated event does not change.
In terms of volatility quotes instruments (Risk-Reversal (RR) or Butterfly (Fly), we expect to see an increasing impact of a skew event as the event date approaches.</p>
<p>The skew event model is designed to have the flexibility to allow the traders to match different kind of event impacts observed in the market on the smile instruments. More precisely, this model allows to have different event sizes for each of the affected smile instrument. The increase or decrease of the smile instruments compared to the bare smile that is not affected by the skew event is controlled by the sign of the event size of each affected instrument.</p>
<p>In addition to the natural decay of the skew event as time-to-expiry increases, the model allows to control the speed of that decay by using an exponential decay function controlled by the decay constant.</p>
<p>Theory
The skew event will have an impact on the forward daily volatility  (25/10 Delta - Call/Put) which is used to update the affected instrument (Risk Reversal or Strangle).
This impact is marked by the input event size p, defined as the relative forward daily volatility change at the event date <span class="math notranslate nohighlight">\(T_E\)</span>:</p>
<p><span class="math notranslate nohighlight">\(\sigma(T_E, T_E + 1D) = (1 + p)\tilde{\sigma}(T_E, T_E + 1D)\)</span>
(5.79)</p>
<p>where the bare notion (represented by the tilde symbol) in this section represents the vol surface without skew events. The market forward daily variance (that includes the impact of the skew event) at the event date can then be given:</p>
<p><span class="math notranslate nohighlight">\(Var(T_E, T_E + 1D) = \widetilde{Var}(T_E, T_E + 1D) + p(p + 2)\widetilde{Var}(T_E, T_E + 1D)\)</span>
(5.80)</p>
<p>The second term of the above equation is the additional forward variance generated by the skew event.</p>
<p>Given a valuation date t, a query date T, with time to expiry <span class="math notranslate nohighlight">\(\tau = T - t\)</span>, the market total variance from t to T (i.e. including the skew event) can be computed as:</p>
<p><span class="math notranslate nohighlight">\(Var(t,T) = \int_t^T \sigma^2(s)ds\)</span>
(5.81)</p>
<p><span class="math notranslate nohighlight">\(= \widetilde{Var}(t, T) + p(p + 2)\widetilde{Var}(T_E, T_E + 1D)\)</span>
(5.82)</p>
<p>To control the speed of the decay of the skew event, the additional variance term of the event is multiplied by the exponential decay function <span class="math notranslate nohighlight">\(Decay(T_E, T)\)</span> given by</p>
<p><span class="math notranslate nohighlight">\(Decay(T_E, T) = exp(-\frac{ln(2)}{365}\lambda(T - T_E))\)</span>
(5.83)</p>
<p>where  is the constant decay rate. The market total variance from t to T is then given by:</p>
<p><span class="math notranslate nohighlight">\(Var(t, T) = \widetilde{Var}(t, T) + p(p + 2)\widetilde{Var}(T_E, T_E + 1D)Decay(T_E, T)\)</span>
(5.84)</p>
<p>The daily accumulated forward bare variance at the event date can be computed as:</p>
<p><span class="math notranslate nohighlight">\(\widetilde{Var}(T_E, T_E + 1D) = \widetilde{Var}(DSD(t), T_E + 1D) - \widetilde{Var}(DSD(t), T_E)\)</span>
(5.85)</p>
<p>where in the above equation DSD(t) is the diffusion start date of time t. From Eq.5.84, one can get the implied volatity from t to T:</p>
<p><span class="math notranslate nohighlight">\(\sigma(t, T) = \sqrt{(\widetilde{Var}(t, T) + p(p + 2)\widetilde{Var}(T_E, T_E + 1D)Decay(T_E, T))/\tau}\)</span>
(5.86)</p>
<p>Note that when the val date is after the event date or if the expiry date is before the event date, then the skew event will not be applied.</p>
<p>Instruments
The above section describes the theory on how to update the volatility in the presence of an event. This section describes how to use this approach in order to update the marked instruments affected by the event.</p>
<p>In total there are four instruments: 25D-RR, 10D-RR, 25D-ST, and 10D-ST. The approach allows to mark combination of instruments at the same time, with different event size for each instrument.</p>
<p> Risk Reversal
To adjust a Risk Reversal RR (25-D or 10-D), the call / put volatility will be first updated using Eq. 5.86.
The indicator function is used in the additional call / put variances that arise from the event respectively in order to control the increase / decrease of the RR compared to the Bare RR with the sign of the event size p. The superscript RR used in the sigma call/put reflects that the below sigmas are just used in order to update the RR instrument. Once all instruments are updated, then the final sigma call/put are computed as shown later in this section.</p>
<p><span class="math notranslate nohighlight">\(\sigma_c^{RR}(t, T) = \sqrt{(\widetilde{Var} *c(t, T) + 1* {p&gt;0}(p^2 + 2|p|)\widetilde{Var}_c(T_E, T_E + 1D)Decay(T_E, T))/\tau}\)</span></p>
<p><span class="math notranslate nohighlight">\(\sigma_p^{RR}(t, T) = \sqrt{(\widetilde{Var} *p(t, T) + 1* {p&lt;0}(p^2 + 2|p|)\widetilde{Var}_p(T_E, T_E + 1D)Decay(T_E, T))/\tau}\)</span></p>
<p><span class="math notranslate nohighlight">\(RR(t, T) = \sigma_c(t, T) - \sigma_p(t, T)\)</span>
(5.87)</p>
<p> Strangle
To adjust the Strangle ST (25-D or 10-D), the call / put volatility will be first updated using Eq. 5.86.</p>
<p><span class="math notranslate nohighlight">\(\sigma_c^{ST}(t, T) = \sqrt{(\widetilde{Var}_c(t, T) + sign(p)(p^2 + 2|p|)\widetilde{Var}_c(T_E, T_E + 1D)Decay(T_E, T))/\tau}\)</span></p>
<p><span class="math notranslate nohighlight">\(\sigma_p^{ST}(t, T) = \sqrt{(\widetilde{Var}_p(t, T) + sign(p)(p^2 + 2|p|)\widetilde{Var}_p(T_E, T_E + 1D)Decay(T_E, T))/\tau}\)</span></p>
<p><span class="math notranslate nohighlight">\(ST(t, T) = \frac{\sigma_c(t, T) + \sigma_p(t, T)}{2} - \sigma_{ATM}(t, T)\)</span>
(5.88)</p>
<p>For negative sign of p, an error will be thrown in case the additional variance generated by the event (second term in the above two equations for the call and put variances) is bigger than the bare variance.</p>
<p>In case only one delta-instrument is marked for the event, the other delta-instrument will be updated by conserving the ratio. For instance, if <span class="math notranslate nohighlight">\(ST_{25D}\)</span> is only defined for the event by marking its event size, the <span class="math notranslate nohighlight">\(ST_{10D}\)</span> will be updated according to:</p>
<p><span class="math notranslate nohighlight">\(\widetilde{ST(Ratio)} := \frac{\widetilde{ST_{10D}}}{\widetilde{ST_{25D}}} = ST(Ratio) := \frac{ST_{10D}}{ST_{25D}}\)</span>
(5.89)</p>
<p>where the <span class="math notranslate nohighlight">\(\widetilde{ST(Ratio)}\)</span> is computed using the bare smile that doesnt include the skew event.</p>
<p>The skew event is also implemented for the Inverted vol surface by inverting the sign of p. In this case, ST of the inverted vol surface will stay the same and the RR will have opposite sign when compared to the non-inverted vol surface.</p>
<p>It should be noted that the skew event will not adjust the ATM vol <span class="math notranslate nohighlight">\(\sigma_{ATM}\)</span>. Once the instruments are updated as described above, the <span class="math notranslate nohighlight">\(\sigma_c\)</span> and <span class="math notranslate nohighlight">\(\sigma_p\)</span> needs to be updated as:</p>
<p><span class="math notranslate nohighlight">\(\sigma_c(t, T) = ST(t, T) + \sigma_{ATM}(t, T) + \frac{RR(t, T)}{2}\)</span>
(5.90)</p>
<p><span class="math notranslate nohighlight">\(\sigma_p(t, T) = ST(t, T) + \sigma_{ATM}(t, T) - \frac{RR(t, T)}{2}\)</span>
(5.91)</p>
<p>The corresponding 25D/10D strikes can be then deduced from the updated 25D/10D call/put vols.</p>
<p>The Multi-Event case
The skew event model handles the case where several events impact the volatility surface. Events are first sorted according to their event dates. Then for a given query date, the model will loop over every event and updates the smile according to the theory described above. The adjusted smile is then used as an entry point for the next event.</p>
<p>Skew events defined in terms of Currency
The section above describes the approach used when the skew event is defined explicitly for a given currency pair.</p>
<p>To allow traders to mark the impact of a given event on multiple vol surfaces at once, the event input interface allows to define the skew event in terms of a given currency similar to what is done for the ATM event model.</p>
<p>To map the impact of the event currency on currency-pairs, the ATM Response Table already maintained by the desk is used. This is to avoid the need of maintaining two response tables.</p>
<p>The currency specified in the skew event is only mapped to the currency pairs in the response table that have this currency as Domestic or Foreign. This restriction is needed in order to have control on the increase or decrease of the RR/ST compared to the bare smile, where in the current interface the sign of the event size is used as a guide</p>
<p>The effective event size for the skew event applied on each impacted currency pair is given by:</p>
<p><span class="math notranslate nohighlight">\(p = sgn(EventCurrency) \times R(EventCurrency \rightarrow CurrencyPair) \times p\)</span>
(5.92)</p>
<p>where</p>
<p> <span class="math notranslate nohighlight">\(sgn(EventCurrency)\)</span> is equal to:</p>
<ul class="simple">
<li><p>1 if the instrument is ST.</p></li>
<li><p>1 if the instrument is RR and the Event Currency corresponds to the Foreign Currency of the vol surface currency pair</p></li>
<li><p>-1 if the instrument is RR and the Event Currency is the Domestic Currency of the vol surface.</p></li>
</ul>
<p> <span class="math notranslate nohighlight">\(R(EventCurrency \rightarrow CurrencyPair)\)</span> is the Response of the Event Currency to the vol surface Currency Pair taken from the ATM Response Table.</p>
<p> p is the event size specified for the Event Currency in the skew event input data</p>
<p>Note that there is a preference rule in the case of same event is explicitly defined for a currency pair and also found in the response table for that currency-pair. In such case, the former (i.e. event defined for that currency pair) will have priority and will be applied.</p>
<p>To give an example, consider a skew event registered for MXN with a given event size p for RR25.</p>
<p> The response table maps MXN to [USDMXN, MXNJPY, GBPUSD], with response factors [R1,R2,R3], respectively.</p>
<p> As USDMXN has MXN as DOM, then skew event will be applied to it with effective event size for RR25 = - R1  p</p>
<p> As MXNJPY has MXN as FOR, then skew event will be applied to it with positive effective event size for RR25 = + R2  p</p>
<p> As GBPUSD doesnt have MXN as FOR or DOM then the MXN skew event will not be applied to it.</p>
<p> To be impacted by the MXN event, then skew event for GBPUSD should be explicitly defined using the current interface.</p>
<p>Implementation
The skew event model is supported for the Vol-Engine, Time-Aware and Unified vol surfaces.</p>
<p>The skew event is defined using the property page: FXSingleVolatilitySkewEventPP, where the required inputs are:</p>
<p> EventName: The event name</p>
<p> EventDate: The event date/time where the effect of the skew event is applied</p>
<p> EventCurrency: The event currency</p>
<p> EventCurrencyPair: The event currency pair</p>
<p> EventInstrumentDetails: collection of [Event Instrument Type / Delta, and Event Size]</p>
<p>In addition there are optional parameters that can be also set such as:</p>
<p> EventExpDecay: The exponential decay constant of the event</p>
<p> EventTimeZoneID: The relevant time-zone for the provided skew event dates</p>
<p>To verify that the model has been implemented correctly, we have performed the following tests:</p>
<p> SE Test 1: Event has no impact when query date is before the event date
For this test, we consider the following event:
[EventName: Brazil Election, EventDate: 2022-10-31T08:00:00, EventCurrencyPair: USDBRL, EventInstrumentDetails: (RR25: -0.5; ST25: -0.1) ]</p>
<p>We performed a validation date ladder, with last validation date taken to 2022-10-19. The below graphs show the (Market-Bare) RR25 and ST25 difference for three different query dates displayed in the legend relative to the Event Date. Market corresponds to vol surface with skew event, and Bare without.</p>
<p><img alt="Figure 5.44: Difference between Market and Bare RR25 and ST25 for val date ladder and for query dates before the event date." src="../../_images/44.png" /></p>
<p>Figure 5.44: Difference between Market and Bare RR25 and ST25 for val date ladder and for query dates before the event date.</p>
<p> SE Test 2: Event Size with time-to-Expiry ladder
We consider the same event described above, but with doing time-to-expiry ladder for several event sizes. Valuation date is set to 2022-10-19. The below graphs show the (Market-Bare) RR25 and ST25 where one can observe:</p>
<p> The event has no impact when the event size p =0 as expected
 For positive (negative) event size p, the market instrument, RR or ST, increases (decreases) compare to the bare one as expected
 The impact of event decreases with increasing time-to-expiry</p>
<p>We also did this test with 3-point analytic smile where we got same results as above.</p>
<p><img alt="Figure 5.45: Difference between Market and Bare RR25 and ST25 for time-to-expiry ladder for different event sizes." src="../../_images/45.png" /></p>
<p>Figure 5.45: Difference between Market and Bare RR25 and ST25 for time-to-expiry ladder for different event sizes.</p>
<p> RR(USDBRL) = - RR(BRLUSD) for any event size and expiry date. This is confirmed by taking the sum of both RRs.
 ST(USDBRL) = ST(BRLUSD) for any event size and expiry date. This is confirmed by taking the difference of both STs.</p>
<p><img alt="Figure 5.48: Time to expiry ladder for different event sizes for RR on USDBRL and BRLUSD." src="../../_images/48.png" /></p>
<p>Figure 5.48: Time to expiry ladder for different event sizes for RR on USDBRL and BRLUSD.</p>
<p><img alt="Figure 5.49: Time to expiry ladder for different event sizes for ST on USDBRL and BRLUSD." src="../../_images/49.png" /></p>
<p>Figure 5.49: Time to expiry ladder for different event sizes for ST on USDBRL and BRLUSD.</p>
<p><img alt="Figure 5.50: Sum of RR and Diff of ST of USDBRL and BRLUSD." src="../../_images/50.png" /></p>
<p>Figure 5.50: Sum of RR and Diff of ST of USDBRL and BRLUSD.</p>
<p> Testing Multi-Event
The following tests have been performed for the multi-event case</p>
<p> SE Test 6: Multi-Event on different Currency Pairs
We consider the following Multi-Event = [Event1, Event2] defined for different currency pairs, where:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Event1</span> <span class="o">=</span> <span class="p">[</span><span class="n">EventName</span><span class="p">:</span> <span class="n">Brazil</span> <span class="n">Election</span><span class="p">,</span> <span class="n">EventDate</span><span class="p">:</span> <span class="mi">2022</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">31</span><span class="n">T08</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">,</span> <span class="n">EventCurrencyPair</span><span class="p">:</span> <span class="n">USDBRL</span><span class="p">,</span> <span class="n">EventInstrumentDetails</span><span class="p">:</span> <span class="p">(</span><span class="n">RR25</span> <span class="p">:</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">;</span> <span class="n">ST25</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">)</span> <span class="p">]</span>

<span class="n">Event2</span> <span class="o">=</span> <span class="p">[</span><span class="n">EventName</span><span class="p">:</span> <span class="n">Brazil</span> <span class="n">Election</span><span class="p">,</span> <span class="n">EventDate</span><span class="p">:</span> <span class="mi">2022</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">31</span><span class="n">T08</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">,</span> <span class="n">EventCurrencyPair</span><span class="p">:</span> <span class="n">EURBRL</span><span class="p">,</span> <span class="n">EventInstrumentDetails</span><span class="p">:</span> <span class="p">(</span><span class="n">RR25</span> <span class="p">:</span> <span class="mi">10000</span><span class="p">;</span> <span class="n">ST25</span><span class="p">:</span> <span class="mi">10000</span><span class="p">)</span> <span class="p">]</span>

<span class="n">The</span> <span class="n">graph</span> <span class="n">below</span> <span class="n">shows</span> <span class="n">the</span> <span class="n">impact</span> <span class="n">on</span> <span class="n">USDBRL</span> <span class="n">vol</span> <span class="n">surface</span> <span class="n">where</span> <span class="n">the</span> <span class="n">vol</span> <span class="n">surface</span> <span class="ow">is</span> <span class="n">only</span> <span class="n">impacted</span> <span class="n">by</span> <span class="n">Event1</span> <span class="k">as</span> <span class="n">expected</span><span class="o">.</span> <span class="n">This</span> <span class="ow">is</span> <span class="n">because</span> <span class="n">Event2</span> <span class="n">should</span> <span class="ow">not</span> <span class="n">have</span> <span class="n">an</span> <span class="n">impact</span> <span class="k">as</span> <span class="n">its</span> <span class="n">acts</span> <span class="n">on</span> <span class="n">EURBRL</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">on</span> <span class="n">USDBRL</span><span class="o">.</span> <span class="k">if</span> <span class="n">Event2</span> <span class="n">has</span> <span class="n">an</span> <span class="n">impact</span><span class="p">,</span> <span class="n">then</span> <span class="n">errors</span> <span class="n">would</span> <span class="n">be</span> <span class="n">thrown</span> <span class="k">as</span> <span class="n">the</span> <span class="n">event</span> <span class="n">sizes</span> <span class="n">of</span> <span class="n">Event2</span> <span class="n">are</span> <span class="nb">set</span> <span class="n">to</span> <span class="n">very</span> <span class="n">high</span> <span class="n">numbers</span><span class="o">.</span>
</pre></div>
</div>
<p> SE Test 7: Multi-Event on same Currency Pairs: Degeneration
The following test consider the following multi-event [Event1, Event2] on the same currency pairs, where:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Event1</span> <span class="o">=</span> <span class="p">[</span><span class="n">EventName</span><span class="p">:</span> <span class="n">Brazil</span> <span class="n">Election</span><span class="p">,</span> <span class="n">EventDate</span><span class="p">:</span> <span class="mi">2022</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">31</span><span class="n">T08</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">,</span> <span class="n">EventCurrencyPair</span><span class="p">:</span> <span class="n">USDBRL</span><span class="p">,</span> <span class="n">EventInstrumentDetails</span><span class="p">:</span> <span class="p">(</span><span class="n">RR25</span> <span class="p">:</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">)</span> <span class="p">]</span>

<span class="n">Event2</span> <span class="o">=</span> <span class="p">[</span><span class="n">EventName</span><span class="p">:</span> <span class="n">Brazil</span> <span class="n">Election</span><span class="p">,</span> <span class="n">EventDate</span><span class="p">:</span> <span class="mi">2022</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">07</span><span class="n">T08</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">,</span> <span class="n">EventCurrencyPair</span><span class="p">:</span> <span class="n">USDBRL</span><span class="p">,</span> <span class="n">EventInstrumentDetails</span><span class="p">:</span> <span class="p">(</span><span class="n">ST25</span> <span class="p">:</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">)</span> <span class="p">]</span>
</pre></div>
</div>
<p><img alt="Figure 5.51: Difference between USDBRL Market and Bare RR25 for time-to-expiry ladder when considering two events on different currency pairs" src="../../_images/51.png" /></p>
<p>Figure 5.51: Difference between USDBRL Market and Bare RR25 for time-to-expiry ladder when considering two events on different currency pairs</p>
<p>The graphs below show the impact on (Market-Bare) RR25 and ST25 when the Multi-Event is applied on the USDBRL vol surface. The graphs also show the cases where the individual events are applied on the surface independently. As Event1 only affect the RR25, then the multi-event case degenerates to the Event1 case for RR25. Similar as Event2 is only applied on ST25, the multi-event case degenerates to the Event2 case for ST25</p>
<p><img alt="Figure 5.52: Difference between Market and Bare RR25 and ST25 for time-to-expiry ladder for the multi-event case on same currency pair where each event impacts different instrument." src="../../_images/52.png" /></p>
<p>Figure 5.52: Difference between Market and Bare RR25 and ST25 for time-to-expiry ladder for the multi-event case on same currency pair where each event impacts different instrument.</p>
<p> SE Test 8: Multi-Event on same Currency Pairs: Sum of Events
The following test consider the following multi-event [Event1, Event2] on the same currency pairs, where:
We now consider the same event as above but by changing the EventCurrency to USD that corresponds to the Foreign currency of USDBRL. As expected, in the graphs below, RR25 and ST25 move in the same direction as the sign of the event size.</p>
<p>ST25. The graphs also show the cases where the individual events are applied on the surface independently. Once can observe that the sum of the instrument (Market-Bare) difference obtained by applying the events independently is equal to the multi-event case.</p>
<p><img alt="Figure 5.53" src="../../_images/53.png" /></p>
<p>Figure 5.53: Difference between Market and Bare RR25 and ST25 for time-to-expiry ladder for the two events both impacting RR25 and ST25.</p>
<ul class="simple">
<li><p>SE Test 9: Event specification in terms of Currency
The following tests have been performed for the case where event is specified in terms of a given currency.</p>
<ul>
<li><p>Checking the Foreign / Domestic rule
Consider the following Event:
Event1 = [EventName: Brazil Election, EventDate: 2022-10-31T08:00:00, EventCurrency: BRL, EventInstrumentDetails: (RR25 : -0.5; ST25: -0.1) ]
The graphs belows show the difference (Market-Bare) for RR25 and ST25 for time-to-expiry ladder on USDBRL vol surface. ST moves in the same direction. RR moves in the opposite direction of the sign of the event size as expected. That is because the event currency (BRL) is the Domestic currency in USDBRL.</p></li>
</ul>
</li>
</ul>
<p><img alt="Figure 5.54" src="../../_images/54.png" /></p>
<p>Figure 5.54: Difference between Market and Bare RR25 and ST25 for time-to-expiry ladder for the Domestic currency event representation.</p>
<p>We now consider the same event as above but by changing the EventCurrency to USD that corresponds to the Foreign currency of USDBRL. As expected, in the graphs below, RR25 and ST25 move in the same direction as the sign of the event size.</p>
<p><img alt="Figure 5.55" src="../../_images/55.png" /></p>
<p>Figure 5.55: Difference between Market and Bare RR25 and ST25 for time-to-expiry ladder for the Foreign currency event representation.</p>
<p>Finally, we consider the same event by with EventCurrency set to EUR. As it is neither Domestic or Foreign currency in USDBRL, then this event will not impact RR25 and ST25 as shown in the below graphs.</p>
<p><img alt="Figure 5.56" src="../../_images/56.png" /></p>
<p>Figure 5.56: Difference between Market and Bare RR25 and ST25 for time-to-expiry ladder for the neither For nor Dom currency event representation.</p>
<ul class="simple">
<li><p>SE Test 10: Checking the Preference rule
In this case we consider the Multi-Event case = [Event1, Event2] where:
Event1 = [EventName: Brazil Election, EventDate: 2022-10-31T08:00:00, EventCurrency-Pair: USDBRL, EventInstrumentDetails: (RR25 : -0.5; ST25 = -0.1) ]
Event2 = [EventName: Brazil Election, EventDate: 2022-10-31T08:00:00, EventCurrency: BRL, EventInstrumentDetails: (RR25 : 10000; ST25 = 10000) ]
The graphs below show the difference (Market-Bare) for RR25 and ST25 for time-to-expiry ladder on USDBRL vol surface. One can observe that the preference is applied where USDBRL instruments are only impacted by Event1. If they had been impacted also or only by Event2, then error will be thrown as their event sizes are set to very high numbers.</p></li>
</ul>
<p><img alt="Figure 5.57" src="../../_images/57.png" /></p>
<p>Figure 5.57: Difference between Market and Bare RR25 and ST25 for time-to-expiry ladder when testing the Preference rule.</p>
<ul class="simple">
<li><p>SE Test 11: Applying the event on the cross pair
For this test, consider the following event represented in terms of the EUR currency where we are interested in its impact on the EURGBP vol surface driven from EURUSD and GBPUSD:
Event1 = [EventName: Eur Event, EventDate: 2022-10-31T08:00:00, EventCurrency: EUR, EventInstrumentDetails: (RR25 : -0.5; ST25 = -0.2) ]
The skew event will impact EURGBP and its driver EURUSD (as both smiles have EUR in their currency pair) but will not impact the driver GBPUSD as it doesnt contain EUR.
The impact on EURGBP (the cross) would not be influenced by the skew impact on EURUSD. This is because the skew event is applied when querying the vol, which is done after the drivers smiles have been built.
To prove that consider the following event specified in terms of the currency pair EURGBP:
Event2 = [EventName: Eur Event, EventDate: 2022-10-31T08:00:00, EventCurrencyPair: EURGBP, EventInstrumentDetails: (RR25 : -0.3; ST25 = -0.12) ]
where the event sizes for that event were adjusted to equal the effective event size of the currency representation, where the response of EUR to EURGBP is 0.6.
The below graphs show that both events lead to the same results.</p></li>
</ul>
<p><img alt="Figure 5.58" src="../../_images/58.png" /></p>
<p>Figure 5.58: Difference between EURGBP Market and Bare RR25 and ST25 for time-to-expiry ladder when specifying the event on EURGBP or in terms of EUR.</p>
<p>Applying the Skew Event model on real cases
In this section, we apply the skew event model on two real cases: Brexit and Bank Of Japan (BOJ) events.</p>
<p>The aim is to show the capability of the skew event model, with stable instruments event size, of matching what has been frequently marked for those events.</p>
<ul class="simple">
<li><p>SE Test 12: Brexit Event
We set the following skew event applied on EURGBP vol surface:
Event = [EventName: Brexit, EventDate: 2016-06-23T08:00:00, EventCurrencyPair: EURGBP, EventInstrumentDetails: (RR25 : 0.06; ST25 = 0.005) ]
We perform valuation date ladder up to one date pre-Brexit.
The below graphs show the production instruments marks at the Brexit date (0B), and one day post Brexit (1B). We note that in production, the curve at the Brexit date shows no event impact while 1B curve shows a sizeable event impact, with the RR and Fly quotes both increasing strongly as the event nears. In addition, those graphs show the skew event model applied when querying the instruments on the Brexit date. In other words, we consider the prod 0B smile as a Bare smile, then the instruments are queried at 0B with the skew event model to mimic the marked event at 1B.
We observe a very good fit between the skew event model at 0B and the prod 1B with using only one event size for each of RR25 and ST25 and without the need of remarking it. In addition, the model was able to fit well RR10 and ST10 without the need of explicitly setting event sizes for them.</p></li>
</ul>
<p><img alt="Figure 5.59" src="../../_images/59.png" /></p>
<p>Figure 5.59: Valuation date ladder for the Brexit event.</p>
<ul class="simple">
<li><p>SE Test 13: Bank of Japan Event
We set the following skew event applied on USDJPY vol surface:
Event = [EventName: BOJ, EventDate: 2023-04-28T04:00:00, EventCurrencyPair: USDJPY, EventInstrumentDetails: (RR25 : -0.195; ST25 = 0.004) ]
We start with the valuation date at 2023-04-27&#64;09:24 which corresponds to the 1-day before the event.
In order to apply the skew event, we manually changed the 1B RR25 and 1BST25 quotes to sensible (i.e.bare) quotes. This is shown in the blue Bare Smile curve in the graph below.
The above skew event is then applied on that bare smile to produce the red skew smile shown in the graph below. It is clear the skew event model was able to fit very well the prod marked smile (green curve).
In addition, rolling the skew smile to the next day (the orange curve) was successful whereas rolling the prod case on the date 2023-04-27 failed.
In addition the below graph shows the smile taken from the prod at val date 2023-04-28</p></li>
</ul>
<p>&#64;08:14 which is 04h:14min post the event (the bottom red curve). We apply the skew event on that smile (black curve) and one can observe no impact of the skew event as the val date in this case is after the event date.</p>
<p><img alt="Figure 5.60" src="../../_images/60.png" /></p>
<p>Figure 5.60: Prod and Skew event smiles for BOJ event.</p>
<p>Checking Arbitrage in the Skew Event Model</p>
<ul>
<li><p>SE Test 14: Arbitrage check with Skew Event
In this test, we perform arbitrage analysis to see whether skew event will cause arbitrage in the extreme cases.
For that, we price two call options with maturity T1 and T2 with skew event. The valuation date is set 1W before T1. We consider the following two cases:</p>
<ul class="simple">
<li><p>Case 1: Event Date is set 1B before T1, and T1 is set 1B before T2</p></li>
<li><p>Case 2: T1 is set 1W before T2 and Event Date is set 1B before T2</p></li>
</ul>
<p>The graphs below show the constant decay ladder for different event instruments sizes.
The no-arbitrage condition requires C(T2) &gt; C(T1) which is shown in below graphs to be satisfied for both tested cases.
We note that for arbitrage to possibly occur for case 1, it would require high constant decay, as this can violate the requirement of the total variance to increase with time. However, increasing the constant decay will cause the additional variance contributed by the event to decrease to zero, hence converging to the the case as if there is no event applied (shown in purple line in the below graphs).</p>
</li>
</ul>
<p><img alt="Figure 5.61" src="../../_images/61.png" /></p>
<p>Figure 5.61: Arbitrage check with skew event</p>
<p>5.1.4. Extrapolation</p>
<p>5.1.4.1. Extrapolation in strike</p>
<p>The extrapolation in strike for the 3- and 5-points quartic analytic smile models is completely determined by the calibrated quartic parameters. After the calibration is performed on the quoted volatilities, the analytical formula allows to compute the smile, at any strike, using Equation (5.8) or (5.11). There is no control of the values in the far wings and therefore, the behavior far-in and -out of the money may not behave as desired.</p>
<p>5.1.4.1.1 Quartic behaviour</p>
<p>It has been reported that this can be a limitation for far wings dependent products like volatility or variance swaps. And it is possible that in some cases, the resulting smile is mis-behaved, and arbitrageable in time, as one can see in the Figure 5.62 below.</p>
<p><img alt="Figure 5.62" src="../../_images/62.png" /></p>
<p>Figure 5.62: 2M and 3M implied variances are plotted on a log-moneyness scale for a 5-points quartic model. We notice an arbitrage in time on the far wings for this market data set.</p>
<p>We refer to the Section 5.1.4.1.2 below, for a solution to this problem where a capped smoothing is applied on the wings to limit arbitrage issues.</p>
<p>5.1.4.1.2 Smooth Capping extrapolation</p>
<p>In order to give more control on the behavior of the volatility smile on the wings, especially to avoid some wings explosion which would break Lee [7] conditions and give arbitrage, we introduce this extrapolation function called Smooth Capping.</p>
<p>The smooth capping is an extrapolation function on put (Left) and call (Right) side where we have defined volatility thresholds:</p>
<p><span class="math notranslate nohighlight">\(\sigma_L = \lambda \times \sigma_1\)</span>                 (5.93)
<span class="math notranslate nohighlight">\(\sigma_R = \lambda \times \sigma_5\)</span>                 (5.94)</p>
<p>Where <span class="math notranslate nohighlight">\(\sigma_1\)</span> and <span class="math notranslate nohighlight">\(\sigma_5\)</span> are the volatility of the X-delta call put in the quartic: this cut X can be parametrized. (can be 10 delta , so we start extrapolating after the 10 delta marks) We set <span class="math notranslate nohighlight">\(\lambda\)</span> as a value greater than 1 (like 1.1) such that <span class="math notranslate nohighlight">\(\sigma_L\)</span> and <span class="math notranslate nohighlight">\(\sigma_R\)</span> are higher than <span class="math notranslate nohighlight">\(\sigma_1\)</span> and <span class="math notranslate nohighlight">\(\sigma_5\)</span>. Capping occurs by smoothly mapping the volatilities in the extrapolation region that exceed the respective thresholds volatilities <span class="math notranslate nohighlight">\(\sigma_L\)</span> and <span class="math notranslate nohighlight">\(\sigma_R\)</span>, to some finite open interval, <span class="math notranslate nohighlight">\([\sigma_L,\sigma_L^{max})\)</span> and <span class="math notranslate nohighlight">\([\sigma_R,\sigma_R^{max})\)</span> where:</p>
<p><span class="math notranslate nohighlight">\(\sigma_L^{max} = (1 + \beta) \times \sigma_L\)</span>                 (5.95)
<span class="math notranslate nohighlight">\(\sigma_R^{max} = (1 + \beta) \times \sigma_R\)</span>                 (5.96)</p>
<p>So we end up with a capping function defined by four parameters : <span class="math notranslate nohighlight">\(\lambda\)</span>, <span class="math notranslate nohighlight">\(\beta\)</span> and the delta cut offs for call and put. <span class="math notranslate nohighlight">\(\lambda\)</span> parametrizes the volatility lower bound on both the left and right wing. <span class="math notranslate nohighlight">\(\beta\)</span> has a similar role for the upper bound and define how far the upper bound of volatility is from the lower bound. <span class="math notranslate nohighlight">\(\beta\)</span> is positive to ensure the lower bound is strictly lower than upper bound.</p>
<p><span class="math notranslate nohighlight">\(\sigma_C(\sigma) = \sigma_L + \beta\sigma_L \times \tanh[(\beta\sigma_L)^{-1}(\sigma - \sigma_L)]\)</span> for <span class="math notranslate nohighlight">\(\sigma &gt; \sigma_L \wedge K &lt; K_1\)</span>                 (5.97)
<span class="math notranslate nohighlight">\(\sigma_C(\sigma) = \sigma_R + \beta\sigma_R \times \tanh[(\beta\sigma_R)^{-1}(\sigma - \sigma_R)]\)</span> for <span class="math notranslate nohighlight">\(\sigma &gt; \sigma_R \wedge K &gt; K_5\)</span>                 (5.98)</p>
<p>The capping function ensures the volatility to be a <span class="math notranslate nohighlight">\(C^2\)</span> function of strike.</p>
<p>We plot below an example of extrapolations with Smooth Capping for EURIPY 3 months query (<span class="math notranslate nohighlight">\(\lambda\)</span> at 1.1).
moniker: official&#64;20170302/volsurface.fx/pivot/euripy/meanrevertingextratenors/builder?version=15</p>
<p><img alt="Figure 5.63" src="../../_images/63.png" /></p>
<p>Figure 5.63: Smooth Capping extrapolation for MR EUR JPY 3 months on 02 March 2017. We see that the parameter <span class="math notranslate nohighlight">\(\beta\)</span> defines the cap level which is the asymptotic of the wings. This cap constraint guarantees no explosion on the wings.</p>
<p><img alt="Figure 5.64" src="../../_images/64.png" /></p>
<p>Figure 5.64: Smooth Capping extrapolation for MR EUR JPY 3 months on 02 March 2017. We see that the parameter <span class="math notranslate nohighlight">\(\beta\)</span> defines the cap level which is the asymptotic of the wings.</p>
<p><img alt="Figure 5.65" src="../../_images/65.png" /></p>
<p>Figure 5.65: Smooth Capping extrapolation for MR EUR JPY 3 months on 02 March 2017. We see that the parameter <span class="math notranslate nohighlight">\(\lambda\)</span> defines the volatility threshold where the capping is applied. We see the more we increase the parameter the further on the wing the capping is applied.</p>
<p>5.1.4.2. Extrapolation in time</p>
<p>5.1.4.2.1 Before one day expiry</p>
<p>MapTo3PTS</p>
<p>For any query below the 1D point (note that this is not necessarily the first tenor), we calibrate the quartic parameters at the 1D point, and use those parameters to obtain the volatility. The only difference with a query at the 1D point will therefore be the time t and the forward that go into the solution of the quartic for the given strike. Therefore, the smile will not change much between t = 0 and t = 1D (being in this sense similar to the MR case), but the behaviour will be completely different.</p>
<p>However, we have noticed that this behaviour for the smile 5-point has introduced some instability in the risks below the first tenor (usually set to 1-Day). Indeed, we can see that the smile generated with this smile interpolation below one day generates some discontinuity for the smile shape, which leads to arbitrage and risk explosion.</p>
<p>To illustrate this effect, we plot EURUSD Smile Mean Reverting 5-point querying with dates at one day Tenor and below one day.
moniker: official&#64;20161201/volsurface.fx/pivot/eurusd/MeanRevertingNykOpen/builder We see in Figure 5.66 that there is a discontinuity with smiles generated, which can trigger issues in risks for the first 1-Day Tenor bucket.</p>
<p><img alt="Figure 5.66" src="../../_images/66.png" /></p>
<p>Figure 5.66: We plot the EURUSD MR 5-point smiles for One Day Tenor but also below 1 day: 0.99 D, 0.75D, 0.5D, 0.1D . We see that 0.99D is very close to 1D but there is an important discontinuity with the smiles queried at 0.75D and before.</p>
<p>This issue does not happen below 1 day with the 3-point quartic, so to remediate this issue, we have added a feature to use the 3-point smile for queries below one day, called MapTo3PTS. The idea is:</p>
<ul class="simple">
<li><p>Calibrate the tenor 1-Day expiry (1D) to the 3-point quartic.</p></li>
<li><p>Keep the same quartic parameters below 1D and we use the 3-point smile analytics for any query below 1D.</p></li>
<li><p>The 1D smile is still on 5-points, but it uses the 3-points for expiry &lt; 1D</p></li>
</ul>
<p>This solution has proven to solve this issue. The smile generated below 1-Day are consistent with the one day Tenor with it. Plotting the same set of EURUSD smiles as above with the remediation in Figure 5.67, we see that the smile shapes are preserved, preventing from having this instability in risks for 1 day bucket.</p>
<p><img alt="Figure 5.67" src="../../_images/67.png" /></p>
<p>Figure 5.67: We plot the EURUSD MR 5 points smiles with the Map to 3 points remediation below 1D for One Day Tenor but also below 1 day: 0.99 D, 0.75D, 0.5D, 0.1D . We see with this remediation, all the smiles generated below 1 Day have a preserved shape.</p>
<p>To illustrate further, this issue and the improvement on the risks this remediation brings, we compare here the ATM Vega buckets for a 500 M One Touch on this volatility surface EURUSD using Local Volatility model.</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>FXVega</p></th>
<th class="head"><p>Current Behaviour</p></th>
<th class="head"><p>Mapto3Pts below 1D</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>02-Dec-16</p></td>
<td><p>1,476,013</p></td>
<td><p>2,656</p></td>
</tr>
<tr class="row-odd"><td><p>08-Dec-16</p></td>
<td><p>3,663</p></td>
<td><p>2,769</p></td>
</tr>
<tr class="row-even"><td><p>15-Dec-16</p></td>
<td><p>-12,596</p></td>
<td><p>-12,887</p></td>
</tr>
<tr class="row-odd"><td><p>03-Jan-17</p></td>
<td><p>-28,118</p></td>
<td><p>-28,713</p></td>
</tr>
<tr class="row-even"><td><p>02-Feb-17</p></td>
<td><p>-121,827</p></td>
<td><p>-121,763</p></td>
</tr>
<tr class="row-odd"><td><p>02-Mar-17</p></td>
<td><p>8,653,561</p></td>
<td><p>8,638,023</p></td>
</tr>
<tr class="row-even"><td><p>01-Jun-17</p></td>
<td><p>6,173,443</p></td>
<td><p>6,162,310</p></td>
</tr>
</tbody>
</table>
</div>
<p>We can see that this blow up of the Vega ATM risk has disappeared with the remediation, this option is a one Touch expiry 4 Months so you expect to have some residual risk on the lower tenor but not at the level you see for the 1-Day tenor with the current behaviour. The map to 3 points solves the issue and the risk on the one day bucket is as expected very low.</p>
<p>One issue concerning this method is with the timeaware unified vol surface. Since the ATM backbone is sampled from the timeaware surface, intraday events within the first day can cause large changes in the implied volatility. The MapTo3PTS approach of constructing the smile below 1D from the 3-params implied at the 1D tenor and then adjusting them to match the ATM can lead to significant distortions of the smile below 1D due to the ATM calculated from the timeaware backbone as shown in Figure 5.68. This naturally has important implications for risk, particularly short-dated options.</p>
<p><img alt="Figure 5.68" src="../../_images/68.png" /></p>
<p>Figure 5.68: ExtrapolateBelow1D set to MapTo3PTS for EURUSD unified surface on 10 Nov 2020 with a 16:00 start time set on the surface. Note the deformation of the smile as the query date approaches, but remains just below, 1D.</p>
<p>RR_STR_Constant_3Pts and RR_STR_Extrapolation_3Pts</p>
<p>For the unified volatility surface, two further ExtrapolateBelow1D options are available that construct a 3-parameter smile for the same reasons of stability as described in the previous Section, but calculate the parameters using assuming different extrapolation of the Risk Reversals and Strangles below 1D.</p>
<ul class="simple">
<li><p>RR_STR_Constant_3Pts: extrapolate the near RRs and STRs flat below 1D.</p></li>
<li><p>RR_STR_Extrapolation_3Pts: extrapolate the near RRs and STRs linearly in ATM variance below 1D from midnight.</p></li>
</ul>
<p>In both cases, the near put and call variances are calculated at the query time from the interpolated RRs and STRs. Using these values as well as the strikes inferred from those variances, we construct a 3-point analytic smile curve.</p>
<p>In Figures 5.69 and 5.70 it is clear that the shape of the smile is conserved at different query times below 1D, but the absolute level is a function of the vols calculated from the ATM backbone, containing the event information from the timeaware volatility surface. RR_STR_Extrapolation_3Pts extrapolates the RR and STR from midnight, so for a surface queried from a time close to midnight as in Figure 5.70 the smile flattens closer to the query start time.</p>
<p>To emphasise the impact of different ExtrapolateBelow1D, the PV of a short-dated single EURUSD barrier option with 1D expiry was calculated and shown in Table 5.2. Note the large impact of MapTo3PTS compared to the other methods of extrapolating the smile below 1D, due to the sensitivity of the option to the shape of the smile in that region.</p>
<p><img alt="Figure 5.69" src="../../_images/69.png" /></p>
<p>Figure 5.69: ExtrapolateBelow1D set to RR_STR_Constant_3Pts for EURUSD unified surface on 10 Nov 2020 with a 16:00 start time set on the surface. Note the shape of the smile remains unchanged, however the absolute vol levels change as the smile follows the timeaware ATM backbone</p>
<p><img alt="Figure 5.70" src="../../_images/70.png" /></p>
<p>Figure 5.70: ExtrapolateBelow1D set to RR_STR_Extrapolation_3Pts for EURUSD unified surface on 10 Nov 2020 with a 08:00 start time set on the surface. Note the smile flattens close to the start date of the surface but in this instance doesnt approach a flat smile because the extrapolation starts from midnight and this surface is queried as of 08:00. Again, the absolute level of the smile increases or decreases along the timeaware ATM backbone.</p>
</section>
<section id="assumptions-limitations-and-outliers">
<h3><span class="section-number">1.5.1.7.14. </span>5.2 Assumptions, Limitations, and Outliers<a class="headerlink" href="#assumptions-limitations-and-outliers" title="Link to this heading">#</a></h3>
<p>This section discusses the main assumptions and limitations of the volatility models described in this document.</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Type</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
<th class="head"><p><strong>Comments</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Assumption</strong></p></td>
<td><p>No Arbitrage</p></td>
<td><p>No arbitrage is a fundamental assumption in mathematical finance and pricing models.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Assumption</strong></p></td>
<td><p>Frictionless Trading</p></td>
<td><p>Frictionless trading is a fundamental assumption in mathematical finance and pricing models.</p></td>
</tr>
<tr class="row-even"><td><p><strong>Limitation</strong></p></td>
<td><p>Negative Density</p></td>
<td><p>Negative implied density (butterfly spread arbitrages) may arise locally in the volatility surface. See<strong>5.2.1</strong>.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Limitation</strong></p></td>
<td><p>Calendar Spread Arbitrages</p></td>
<td><p>The condition for no calendar spread arbitrage (increasing variance on a moneyness scale) can be violated if market data are arbitrageable in maturity or locally impacted by the smile model. See<strong>5.2.3.2</strong>.</p></td>
</tr>
<tr class="row-even"><td><p><strong>Weakness</strong></p></td>
<td><p>Market Quotes Misfit under 3- and 5-Point Analytic Smile Models</p></td>
<td><p>The 3-point analytic smile model, and to a lesser extent the 5-point analytic model, do not fit all FX market quotes in the wings perfectly. See<strong>5.2.2.1</strong>.</p></td>
</tr>
</tbody>
</table>
</div>
<hr class="docutils" />
<section id="negative-density">
<h4><span class="section-number">1.5.1.7.14.1. </span>5.2.1 Negative Density<a class="headerlink" href="#negative-density" title="Link to this heading">#</a></h4>
<p>The market-implied density function is defined as:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\text{Density} = \frac{\partial^2 C(K, T)}{\partial K^2} \times D_p
\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\( D_p \)</span> is the premium currency discount factor.</p>
<p>For some sets of strikes and maturities, the construction of the volatility surface by strike and time interpolation may generate negative density values. By writing the finite difference approximation as:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\text{Density} \approx \frac{C(K + \Delta K, T) - 2C(K, T) + C(K - \Delta K, T)}{(\Delta K)^2} \times D_p
\]</div>
</div>
<p>Negative density values indicate the presence of butterfly spread arbitrages, which violate the no-arbitrage condition. This issue can arise due to the interpolation or extrapolation methods used in constructing the volatility surface.</p>
</section>
<hr class="docutils" />
<section id="limitations-on-smile-models">
<h4><span class="section-number">1.5.1.7.14.2. </span>5.2.2 Limitations on Smile Models<a class="headerlink" href="#limitations-on-smile-models" title="Link to this heading">#</a></h4>
<section id="discussion-on-3-and-5-point-analytic-quartic-smile-models">
<h5><span class="section-number">1.5.1.7.14.2.1. </span>5.2.2.1 Discussion on 3- and 5-Point Analytic Quartic Smile Models<a class="headerlink" href="#discussion-on-3-and-5-point-analytic-quartic-smile-models" title="Link to this heading">#</a></h5>
<p>The <strong>3-point analytic quartic model</strong> is known for its simplicity and computational efficiency, as it is entirely algebraic. However, its main drawback is that it may not fit all market-observed wing quotes accurately. For example, it may struggle to match USDJPY options at the 10-delta level.</p>
<p>To address this limitation, the <strong>5-point analytic quartic model</strong> was developed. This model introduces an additional parameter to better fit the increasingly liquid 10-delta quotes. However, even the 5-point model may face challenges in calibrating to certain market conditions, such as low-fly quotes.</p>
<p>To mitigate these issues, the <strong>low-fly correction extension</strong> was introduced. This extension ensures that the model can handle negative smile terms, which are common in emerging markets or around significant events. For more details, see <strong>Section 5.1.1.1.4</strong>.</p>
</section>
</section>
<hr class="docutils" />
<section id="limitations-on-wing-time-models">
<h4><span class="section-number">1.5.1.7.14.3. </span>5.2.3 Limitations on Wing Time Models<a class="headerlink" href="#limitations-on-wing-time-models" title="Link to this heading">#</a></h4>
<section id="variance-interpolation-and-rr-st-quote-interpolation">
<h5><span class="section-number">1.5.1.7.14.3.1. </span>5.2.3.1 Variance Interpolation and RR/ST Quote Interpolation<a class="headerlink" href="#variance-interpolation-and-rr-st-quote-interpolation" title="Link to this heading">#</a></h5>
<p>Both the <strong>variance interpolation</strong> and <strong>RR/ST quote interpolation</strong> models can introduce calendar spread arbitrages, even if the bracketing marked tenors are arbitrage-free. This limitation is particularly evident when valuing trades using Local-Vol models on PDEs, often manifesting as exploding vega sensitivities.</p>
<p>To address this issue, the <strong>constant-moneyness interpolation</strong> method was developed. This method ensures that the interpolation is consistent with the diffusive behavior of the spot and minimizes the risk of calendar arbitrage. For more details, see <strong>Section 5.1.3.3</strong>.</p>
</section>
<section id="id7">
<h5><span class="section-number">1.5.1.7.14.3.2. </span>5.2.3.2 Constant-Moneyness Interpolation<a class="headerlink" href="#id7" title="Link to this heading">#</a></h5>
<p>While the <strong>constant-moneyness interpolation</strong> scheme is designed to avoid arbitrage, it is not entirely foolproof:</p>
<ul class="simple">
<li><p><strong>Variance Interpolation</strong>: The interpolation of variance is not exactly along the same line of moneyness, meaning the no-arbitrage condition is not guaranteed. However, the methods consistency in space, accounting for the spots diffusive behavior, significantly reduces the risk of arbitrage.</p></li>
<li><p><strong>Strike Interpolation</strong>: Although the constant-moneyness scheme ensures sensible interpolation between known points at five log-moneyness levels, the scheme relies on the five-point strike interpolation between and beyond these levels. In some cases, this can lead to negative local volatility out-of-the-money, suggesting butterfly spread arbitrages. However, the <strong>low-fly correction</strong> ensures smoother and always positive local volatility, guaranteeing the absence of butterfly spread arbitrages.</p></li>
</ul>
</section>
</section>
</section>
<hr class="docutils" />
<section id="model-parameters-variables">
<h3><span class="section-number">1.5.1.7.15. </span>5.3 Model Parameters / Variables<a class="headerlink" href="#model-parameters-variables" title="Link to this heading">#</a></h3>
<p>This section lists the parameters used in the definition of the volatility surface. It describes the relevant inputs for the different available volatility backbones, namely, mean-reverting and variance-interpolated, as well as the parameters used to control the smooth-capping extrapolation.</p>
<section id="atm-time-model-backbones">
<h4><span class="section-number">1.5.1.7.15.1. </span>5.3.1 ATM Time Model Backbones<a class="headerlink" href="#atm-time-model-backbones" title="Link to this heading">#</a></h4>
<section id="id8">
<h5><span class="section-number">1.5.1.7.15.1.1. </span>5.3.1.1 Mean Reverting Backbone<a class="headerlink" href="#id8" title="Link to this heading">#</a></h5>
<p>The mean-reverting backbone is specified by either 3 or 5 parameters, as detailed below.</p>
<p><strong>3-Parameter Case</strong>:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Parameter / Variable Name</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
<th class="head"><p><strong>Type - Data (Define) / Input / Calibration</strong></p></th>
<th class="head"><p><strong>Impact</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong></strong></p></td>
<td><p>Initial daily volatility</p></td>
<td><p>Input</p></td>
<td><p>Impacts the short-term ATM level</p></td>
</tr>
<tr class="row-odd"><td><p><strong></strong></p></td>
<td><p>Mean reversion level of the daily volatility</p></td>
<td><p>Input</p></td>
<td><p>Impacts the long-term ATM level</p></td>
</tr>
<tr class="row-even"><td><p><strong></strong></p></td>
<td><p>Mean reversion rate</p></td>
<td><p>Input</p></td>
<td><p>Determines how fast the long-term regime is reached</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>5-Parameter Case</strong>:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Parameter / Variable Name</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
<th class="head"><p><strong>Type - Data (Define) / Input / Calibration</strong></p></th>
<th class="head"><p><strong>Impact</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong></strong></p></td>
<td><p>Initial daily volatility</p></td>
<td><p>Input</p></td>
<td><p>Impacts the short-term ATM level</p></td>
</tr>
<tr class="row-odd"><td><p><strong></strong></p></td>
<td><p>Mean reversion level of the daily volatility</p></td>
<td><p>Input</p></td>
<td><p>Impacts the long-term ATM level</p></td>
</tr>
<tr class="row-even"><td><p><strong></strong></p></td>
<td><p>Mean reversion rate</p></td>
<td><p>Input</p></td>
<td><p>Determines how fast the long-term regime is reached</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Cshort,0</strong></p></td>
<td><p>Short rate initial volatility</p></td>
<td><p>Input</p></td>
<td><p>Impacts the position of the short-term hump</p></td>
</tr>
<tr class="row-even"><td><p><strong>Yshort,decay</strong></p></td>
<td><p>Short rate exponential decay</p></td>
<td><p>Input</p></td>
<td><p>Impacts the hump amplitude</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="event-weights">
<h5><span class="section-number">1.5.1.7.15.1.2. </span>5.3.1.2 Event Weights<a class="headerlink" href="#event-weights" title="Link to this heading">#</a></h5>
<p>Event weights are additional parameters that impact the construction of the volatility surface.</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Parameter / Variable Name</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
<th class="head"><p><strong>Type - Data (Define) / Input / Calibration</strong></p></th>
<th class="head"><p><strong>Impact</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Event dates</strong></p></td>
<td><p>Dates of the event that require weighting</p></td>
<td><p>Input</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><strong>Event weights</strong></p></td>
<td><p>Weight for the associated event date</p></td>
<td><p>Input</p></td>
<td><p>Impacts the ATM term-structure</p></td>
</tr>
<tr class="row-even"><td><p><strong>Offset</strong></p></td>
<td><p>Offset the ATM tenor points</p></td>
<td><p>Input</p></td>
<td><p>Impacts the ATM term-structure</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="variance-interpolated-backbone">
<h5><span class="section-number">1.5.1.7.15.1.3. </span>5.3.1.3 Variance Interpolated Backbone<a class="headerlink" href="#variance-interpolated-backbone" title="Link to this heading">#</a></h5>
<p>The variance-interpolated backbone requires only one additional parameter:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Parameter / Variable Name</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
<th class="head"><p><strong>Type - Data (Define) / Input / Calibration</strong></p></th>
<th class="head"><p><strong>Impact</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Interpolation type</strong></p></td>
<td><p>Select whether to interpolate linearly or monotonic cubic in variance</p></td>
<td><p>Input</p></td>
<td><p>Impacts the volatility in between quoted pillars</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="smooth-capping-extrapolation">
<h4><span class="section-number">1.5.1.7.15.2. </span>5.3.2 Smooth-Capping Extrapolation<a class="headerlink" href="#smooth-capping-extrapolation" title="Link to this heading">#</a></h4>
<p>The smooth-capping extrapolation method controls the extrapolation in strike level outside a delta threshold.</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Parameter / Variable Name</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
<th class="head"><p><strong>Type - Data (Define) / Input / Calibration</strong></p></th>
<th class="head"><p><strong>Impact</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong></strong></p></td>
<td><p>Scaling factor for volatility lower bound</p></td>
<td><p>Input</p></td>
<td><p>Impacts the volatility threshold</p></td>
</tr>
<tr class="row-odd"><td><p><strong></strong></p></td>
<td><p>Scaling factor for volatility upper bound</p></td>
<td><p>Input</p></td>
<td><p>Impacts the volatility threshold</p></td>
</tr>
<tr class="row-even"><td><p><strong>Delta cutoffs</strong></p></td>
<td><p>Delta level at which extrapolation starts</p></td>
<td><p>Input</p></td>
<td><p>Impacts the strike extrapolation threshold</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="id9">
<h4><span class="section-number">1.5.1.7.15.3. </span>5.3.3 Skew Event Model<a class="headerlink" href="#id9" title="Link to this heading">#</a></h4>
<p>The skew event model is specified by the following inputs:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Parameter / Variable Name</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
<th class="head"><p><strong>Type - Data (Define) / Input / Calibration</strong></p></th>
<th class="head"><p><strong>Impact</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>EventDate</strong></p></td>
<td><p>The event end date/time where the effect of the skew event is fully applied</p></td>
<td><p>Input</p></td>
<td><p>Impacts the volatility smile</p></td>
</tr>
<tr class="row-odd"><td><p><strong>EventName</strong></p></td>
<td><p>The event name</p></td>
<td><p>Input</p></td>
<td><p>Impacts the volatility smile</p></td>
</tr>
<tr class="row-even"><td><p><strong>EventInstrumentDetails</strong></p></td>
<td><p>Event Instrument Type (Risk Reversal or Strangle), Delta (0.1 or 0.25), and Event Size</p></td>
<td><p>Input</p></td>
<td><p>Impacts the volatility smile</p></td>
</tr>
<tr class="row-odd"><td><p><strong>EventCurrencyPair</strong></p></td>
<td><p>The vol surface currency pair on which the event will apply. Only EventCurrencyPair or EventCurrency should be provided.</p></td>
<td><p>Input</p></td>
<td><p>Impacts the volatility smile</p></td>
</tr>
<tr class="row-even"><td><p><strong>EventCurrency</strong></p></td>
<td><p>The currency on which the event will apply. Only EventCurrencyPair or EventCurrency should be provided.</p></td>
<td><p>Input</p></td>
<td><p>Impacts the volatility smile</p></td>
</tr>
<tr class="row-odd"><td><p><strong>EventExpDecay</strong></p></td>
<td><p>The decay exponential parameter of the event (optional)</p></td>
<td><p>Input</p></td>
<td><p>Impacts the volatility smile</p></td>
</tr>
<tr class="row-even"><td><p><strong>EventTimeZoneID</strong></p></td>
<td><p>The relevant time-zone for the provided skew event dates (optional)</p></td>
<td><p>Input</p></td>
<td><p>Impacts the volatility smile</p></td>
</tr>
</tbody>
</table>
</div>
<hr class="docutils" />
<p>This concludes the discussion of the assumptions, limitations, and parameters of the FX volatility surface models.</p>
</section>
</section>
<section id="model-outputs">
<h3><span class="section-number">1.5.1.7.16. </span>5.4 Model Outputs<a class="headerlink" href="#model-outputs" title="Link to this heading">#</a></h3>
<p>The <strong>primary output</strong> of the volatility model is <strong>implied volatilities</strong>, which are provided for every given strike and maturity <span class="math notranslate nohighlight">\( \Theta(K, T) \)</span>. These implied volatilities are then used in Black-Scholes formulas to calculate option prices. The model provides a fully interpolated volatility surface, which can be utilized by dependent models for pricing, risk management, and other financial applications.</p>
</section>
<hr class="docutils" />
<section id="conditions-of-use">
<h3><span class="section-number">1.5.1.7.17. </span>5.9 Conditions of Use<a class="headerlink" href="#conditions-of-use" title="Link to this heading">#</a></h3>
<p>Both the <strong>five-point</strong> and <strong>three-point quartic smile models</strong> are versatile and can be applied in various market settings due to their analytical and parametric nature. However, limitations arise when the model cannot fit market quotes or when no real positive roots exist for Equation (5.11). To address these issues, the <strong>low-fly correction</strong> has been developed, making the framework robust and efficient in all market conditions.</p>
<section id="stressed-market-conditions">
<h4><span class="section-number">1.5.1.7.17.1. </span>5.9.1 Stressed Market Conditions<a class="headerlink" href="#stressed-market-conditions" title="Link to this heading">#</a></h4>
<p>The <strong>low-fly correction</strong> is specifically designed to handle stressed market conditions, such as extreme volatility or illiquidity. For more details, refer to:</p>
<ul class="simple">
<li><p><strong>Section 5.1.1.1.4</strong>: Explanation of the low-fly correction.</p></li>
<li><p><strong>Section 9.3.6</strong>: A test where ATM volatilities are bumped until the volatility surface breaks for different strike models.</p></li>
<li><p><strong>Section 9.7.1</strong>: Additional tests related to stressed market conditions.</p></li>
</ul>
</section>
</section>
</section>
<hr class="docutils" />
<section id="implementation-numerical-schema-description">
<h2><span class="section-number">1.5.1.8. </span>6. Implementation / Numerical Schema Description<a class="headerlink" href="#implementation-numerical-schema-description" title="Link to this heading">#</a></h2>
<section id="id10">
<h3><span class="section-number">1.5.1.8.1. </span>6.1 Description<a class="headerlink" href="#id10" title="Link to this heading">#</a></h3>
<section id="solution-of-the-quartic-equations">
<h4><span class="section-number">1.5.1.8.1.1. </span>6.1.1 Solution of the Quartic Equations<a class="headerlink" href="#solution-of-the-quartic-equations" title="Link to this heading">#</a></h4>
<p>The <strong>3-point</strong> and <strong>5-point quartic models</strong> require solving for the largest positive real root of a quartic polynomial, as defined in Equations (5.8) and (5.11), respectively. The algorithm used to compute the roots of the quartic equation is based on <strong>Cardanos method</strong>, as described in Abramowitz and Stegun [1, Chapter 3.7]. Below is a summary of the method.</p>
<section id="cubic-equation">
<h5><span class="section-number">1.5.1.8.1.1.1. </span>6.1.1.1 Cubic Equation<a class="headerlink" href="#cubic-equation" title="Link to this heading">#</a></h5>
<p>Given a cubic equation:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
z^3 + a_2 z^2 + a_1 z + a_0 = 0,
\]</div>
</div>
<p>define:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
q = \frac{1}{3}a_1 - \frac{1}{9}a_2^2, \quad r = \frac{1}{6}(a_1 a_2 - 3a_0) - \frac{1}{27}a_2^2,
\]</div>
</div>
<p>and:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
s_1 = \sqrt[3]{r + \sqrt{q^3 + r^2}}, \quad s_2 = \sqrt[3]{r - \sqrt{q^3 + r^2}}.
\]</div>
</div>
<p>The roots of the polynomial are:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
z_1 = (s_1 + s_2) - \frac{a_2}{3},
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
z_2 = -\frac{(s_1 + s_2)}{2} - \frac{a_2}{3} + \frac{i\sqrt{3}}{2}(s_1 - s_2),
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
z_3 = -\frac{(s_1 + s_2)}{2} - \frac{a_2}{3} - \frac{i\sqrt{3}}{2}(s_1 - s_2).
\]</div>
</div>
<p>With <span class="math notranslate nohighlight">\( \Delta = q^3 + r^2 \)</span>, the cases are:</p>
<ul class="simple">
<li><p><strong><span class="math notranslate nohighlight">\( \Delta &gt; 0 \)</span></strong>: One real root and a pair of complex conjugate roots.</p></li>
<li><p><strong><span class="math notranslate nohighlight">\( \Delta = 0 \)</span></strong>: All roots are real, and at least two are equal.</p></li>
<li><p><strong><span class="math notranslate nohighlight">\( \Delta &lt; 0 \)</span></strong>: All roots are real.</p></li>
</ul>
</section>
<section id="quartic-equation">
<h5><span class="section-number">1.5.1.8.1.1.2. </span>6.1.1.2 Quartic Equation<a class="headerlink" href="#quartic-equation" title="Link to this heading">#</a></h5>
<p>Given a quartic equation:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
z^4 + a_3 z^3 + a_2 z^2 + a_1 z + a_0 = 0,
\]</div>
</div>
<p>first find the real root <span class="math notranslate nohighlight">\( u_1 \)</span> of the cubic equation:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
u^3 - a_2 u^2 + (a_1 a_3 - 4a_0) u - (a_1^2 + a_0 a_3^2 - 4a_0 a_2) = 0.
\]</div>
</div>
<p>The roots of the quartic polynomial are the four roots of the two quadratic equations:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
v^2 + \left( \frac{a_3}{2} + \sqrt{\frac{a_3^2}{4} + u_1 - a_2} \right) v + \frac{u_1}{2} + \sqrt{\left( \frac{u_1}{2} \right)^2 - a_0} = 0,
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
v^2 - \left( \frac{a_3}{2} + \sqrt{\frac{a_3^2}{4} + u_1 - a_2} \right) v + \frac{u_1}{2} - \sqrt{\left( \frac{u_1}{2} \right)^2 - a_0} = 0.
\]</div>
</div>
<p>If all roots of the cubic equation are real, follow the selection criteria described in Abramowitz and Stegun [1].</p>
</section>
</section>
<hr class="docutils" />
<section id="solution-of-the-asv-equations">
<h4><span class="section-number">1.5.1.8.1.2. </span>6.1.2 Solution of the ASV Equations<a class="headerlink" href="#solution-of-the-asv-equations" title="Link to this heading">#</a></h4>
<section id="point-asv-equation">
<h5><span class="section-number">1.5.1.8.1.2.1. </span>6.1.2.1 3-Point ASV Equation<a class="headerlink" href="#point-asv-equation" title="Link to this heading">#</a></h5>
<p>Equation (5.59) is a quadratic or linear equation:</p>
<ul class="simple">
<li><p><strong>If the smile parameter is positive</strong>, its a quadratic equation with one positive solution:</p></li>
</ul>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\sigma^2 = \frac{1}{2} \left( \sigma_0^2 + 2(\text{skew})\sigma_0 z + \sqrt{(\sigma_0^2 + 2(\text{skew})\sigma_0 z)^2 + 4(\text{smile})\sigma_0^2 z^2} \right).
\]</div>
</div>
<ul class="simple">
<li><p><strong>If the smile parameter is negative</strong>, its a linear equation:</p></li>
</ul>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\sigma^2 = \frac{\sigma_0^2 + 2(\text{skew})\sigma_0 z}{1 - \frac{(\text{smile})\sigma_0^2 z^2}{(\sigma_0^2 + 2(\text{skew})\sigma_0 z)^2}}.
\]</div>
</div>
</section>
<section id="id11">
<h5><span class="section-number">1.5.1.8.1.2.2. </span>6.1.2.2 5-Point ASV Equation<a class="headerlink" href="#id11" title="Link to this heading">#</a></h5>
<p>Equation (5.61) is solved in two steps:</p>
<ol class="arabic simple">
<li><p><strong>Find <span class="math notranslate nohighlight">\( \hat{v} \)</span></strong> if the smile or wing parameter is negative. <span class="math notranslate nohighlight">\( \hat{v} \)</span> is the largest positive root of a cubic equation.</p></li>
<li><p><strong>Update coefficients</strong> in the main equation using <span class="math notranslate nohighlight">\( \hat{v} \)</span> and solve another cubic equation.</p></li>
</ol>
<p>The algorithm for the cubic equation is the same as described for the quartic smile model.</p>
</section>
</section>
</section>
<hr class="docutils" />
<section id="id12">
<h3><span class="section-number">1.5.1.8.2. </span>6.2 Inputs<a class="headerlink" href="#id12" title="Link to this heading">#</a></h3>
<p>There are no input parameters for the algorithm. It is an internal process.</p>
</section>
<hr class="docutils" />
<section id="quality-control">
<h3><span class="section-number">1.5.1.8.3. </span>6.3 Quality Control<a class="headerlink" href="#quality-control" title="Link to this heading">#</a></h3>
<p>The quality of results, particularly the existence of the root of the polynomial, is tested in <strong>Section 9.7.1</strong>.</p>
</section>
<hr class="docutils" />
<section id="limitations">
<h3><span class="section-number">1.5.1.8.4. </span>6.4 Limitations<a class="headerlink" href="#limitations" title="Link to this heading">#</a></h3>
<p>The limitations of the numerical schema are discussed in <strong>Section 9.7.1</strong>. These include potential issues with convergence, stability, and the existence of real roots under certain market conditions.</p>
</section>
<hr class="docutils" />
<section id="additional-notes">
<h3><span class="section-number">1.5.1.8.5. </span>Additional Notes<a class="headerlink" href="#additional-notes" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>Robustness in Stressed Markets</strong>: The <strong>low-fly correction</strong> ensures that the model remains robust even in stressed market conditions, such as during periods of extreme volatility or illiquidity. This correction is critical for maintaining the integrity of the volatility surface.</p></li>
<li><p><strong>Efficiency of the Algorithm</strong>: The use of <strong>Cardanos method</strong> for solving cubic and quartic equations ensures computational efficiency, making the model suitable for real-time applications.</p></li>
<li><p><strong>Flexibility of the ASV Model</strong>: The <strong>ASV model</strong> provides additional flexibility by allowing for more complex smile shapes, particularly in the wings. This makes it suitable for markets where extreme strikes are actively traded.</p></li>
<li><p><strong>Testing and Validation</strong>: Extensive testing, as outlined in <strong>Section 9.7.1</strong>, ensures that the model performs well under a wide range of market conditions. This includes stress testing and validation against market data.</p></li>
</ol>
</section>
</section>
<section id="calibration">
<h2><span class="section-number">1.5.1.9. </span>7.Calibration<a class="headerlink" href="#calibration" title="Link to this heading">#</a></h2>
<section id="id13">
<h3><span class="section-number">1.5.1.9.1. </span>7.1. Description<a class="headerlink" href="#id13" title="Link to this heading">#</a></h3>
<section id="calibration-of-the-3-point-quartic-model">
<h4><span class="section-number">1.5.1.9.1.1. </span>7.1.1. Calibration of the 3-point quartic model<a class="headerlink" href="#calibration-of-the-3-point-quartic-model" title="Link to this heading">#</a></h4>
<p>Three implied volatilities <span class="math notranslate nohighlight">\(\Theta_1, \Theta_2, \Theta_3\)</span> at three different strikes <span class="math notranslate nohighlight">\(K_1, K_2, K_3\)</span> are required for each tenor to calibrate to. We define</p>
<p><span class="math notranslate nohighlight">\(A(K, \Theta) = d_1 d_2 t\)</span>
<span class="math notranslate nohighlight">\(B(K, \Theta) = -2d_2 \sqrt{t}\)</span>
<span class="math notranslate nohighlight">\(C(K, \Theta) = \Theta^2\)</span>
<span class="math notranslate nohighlight">\(X = \sigma^2\)</span>
<span class="math notranslate nohighlight">\(Y = v_0^2\)</span>
<span class="math notranslate nohighlight">\(Z = \rho v_0\)</span>.</p>
<p>With <span class="math notranslate nohighlight">\(u = 0\)</span>, Equation (5.7) becomes</p>
<p><span class="math notranslate nohighlight">\(X + A(K, \Theta)Y + B(K, \Theta)Z = C(K, \Theta)\)</span>.                 (7.1)</p>
<p>For three different strikes and their implied volatilities, Equation (7.1) represents a linear system of three equations in three unknowns <span class="math notranslate nohighlight">\(X, Y, Z\)</span>. It is then a simple matter to back out <span class="math notranslate nohighlight">\(\sigma, v_0, \rho\)</span> from <span class="math notranslate nohighlight">\(X, Y, Z\)</span>.</p>
<p>Now that the model parameters at a given tenor are known, we have to solve the quartic equation (5.8) to find the implied volatilities at other strikes.</p>
</section>
<section id="quartic-equation-solutions-discussion-on-3-point-quartic">
<h4><span class="section-number">1.5.1.9.1.2. </span>7.1.1.1. Quartic equation solutions: discussion on 3-point quartic<a class="headerlink" href="#quartic-equation-solutions-discussion-on-3-point-quartic" title="Link to this heading">#</a></h4>
<p>When it comes to solve the quartic equation, there are some considerations that we can make. As we know, the quartic equation has 4 solutions. Since the root we are looking for is a volatility, we know that we are only interested in the real and positive roots. Is there anything we can say about which root we should pick?</p>
<p>A very useful thing to do is to look at the behavior of the quartic equation when <span class="math notranslate nohighlight">\(f = 0\)</span>, i.e. when the strike is set to be the ATM forward. Clearly, in that case we should have a real, positive volatility. Looking at the quartic equation for <span class="math notranslate nohighlight">\(f = 0\)</span> for the 3PT case, we obtain</p>
<p><span class="math notranslate nohighlight">\(\Theta^2 \left[\Theta^2 \left(1 + \frac{1}{4}v_0^2t^2\right) - \Theta \rho v_0 t - \sigma^2\right] = 0\)</span>.                 (7.2)</p>
<p>Automatically we know that the above equation has a double root at <span class="math notranslate nohighlight">\(\Theta = 0\)</span>. Moreover, the first and second derivatives of the quartic at <span class="math notranslate nohighlight">\(f = 0\)</span> and <span class="math notranslate nohighlight">\(\Theta = 0\)</span> reveal that that point is actually a maximum. This means that the quartic for <span class="math notranslate nohighlight">\(f = 0\)</span> can either diverge to <span class="math notranslate nohighlight">\(-\infty\)</span> in both directions (inverted <span class="math notranslate nohighlight">\(U\)</span> shape, two extra complex solutions) or have a <span class="math notranslate nohighlight">\(W\)</span> shape (two extra real solutions, one positive and one negative). In order to have two extra real roots we must have</p>
<p><span class="math notranslate nohighlight">\((\rho v_0 t)^2 + 4\sigma^2 \left(1 + \frac{1}{4}v_0^2t^2\right) &gt; 0\)</span>.                 (7.3)</p>
<p>Actually, by looking at the sign of the quartic coefficient for <span class="math notranslate nohighlight">\(f = 0\)</span>, this condition reduces to</p>
<p><span class="math notranslate nohighlight">\(1 + \frac{1}{4}v_0^2t^2 &gt; 0\)</span>.                 (7.4)</p>
<p><img alt="Figure 7.1" src="../../_images/71.png" /></p>
<p>Figure 7.1: Shape of the Quartic equation as a function of the implied vol (30Y. USDMXN surface). In the left, a normal profile of the quartic, with 2 roots (one positive, one negative) and therefore two complex roots. In the right, the quartic for the case <span class="math notranslate nohighlight">\(f = 0\)</span>: note that in this case <span class="math notranslate nohighlight">\(\sigma = 0\)</span> is a double root (i.e., <span class="math notranslate nohighlight">\(Q(\sigma = 0) = Q'(\sigma = 0) = 0\)</span>), which means that all roots are real, because in the graph we also see two more roots (one positive and one negative again).</p>
<p>If this holds, then we are guaranteed to have 1 and only 1 real positive solution, which would correspond to the highest real root. Therefore, if we assume that the real roots of the quartic do never cross each other (which is quite reasonable), then we should always pick the largest real root as our volatility.</p>
<p>Looking in more detail at the quartic equation, the implied volatility in 3-point quartic models is then the largest real solution of the polynomial:</p>
<p><span class="math notranslate nohighlight">\(P(\Theta) = \Theta^4 \left(1 + \frac{1}{4}v_0^2t^2\right) - \Theta^3 (\rho v_0 t) - \Theta^2 \sigma^2 + 2f \rho v_0 \Theta - v_0^2f^2 = 0\)</span>                 (7.5)</p>
<p>We want to look further at the different solutions of the equation, lets rewrite for ease as:</p>
<p><span class="math notranslate nohighlight">\(P(\Theta) = \Theta^4 \left(1 + \frac{1}{4}smile \times t^2\right) - \Theta^3 (Cross \times t) - \Theta^2 \sigma^2 + 2f \times Cross\Theta - smile \times f^2\)</span>                 (7.6)</p>
<p>We separate the study with 2 cases, <span class="math notranslate nohighlight">\(smile &gt; 0\)</span> and <span class="math notranslate nohighlight">\(smile &lt; 0\)</span>. According to the assumption of the parametrization which relies on a stochastic volatility model, only a positive smile term should be allowed. However in practice, we encounter some concave smile input that we need to fit and requires having a negative smile term in the equation. We will show some of these shapes later in the section.</p>
<p>case <span class="math notranslate nohighlight">\(smile &gt; 0\)</span>:</p>
<ul class="simple">
<li><p>If the smile is positive <span class="math notranslate nohighlight">\(P(0) &lt; 0\)</span> since <span class="math notranslate nohighlight">\(P(+\infty) = +\infty\)</span> and <span class="math notranslate nohighlight">\(P(-\infty) = +\infty\)</span> then the polynomial has at least one positive real solution and one negative real solution.</p></li>
<li><p>The polynomial <span class="math notranslate nohighlight">\(P\)</span> cannot have 2 negative solutions and 2 positive solutions because the product of all the solution equal <span class="math notranslate nohighlight">\(-smile \times f^2\)</span> to would be positive which is not the case</p></li>
</ul>
<p>Therefore the polynomial can have:</p>
<ul class="simple">
<li><p>2 complex solutions and 2 real solutions (one negative and one positive). There is a unique acceptable solution.</p></li>
<li><p>3 positive solutions and one negative solution: the acceptable solution is not unique. If we calibrate the 3-point to ATM and 25 delta ST and RR, and for consistency reason, we always pick the solution that corresponds to the largest root.</p></li>
<li><p>3 negative solution and one positive one. There is a unique acceptable solution.</p></li>
</ul>
<p>To understand how often we can have the 3 cases above we have two ways to analyze the problem
If the cross is set to zero which means no skew (symmetric smile) we end up having a polynomial with:</p>
<p><span class="math notranslate nohighlight">\(P(\Theta) = \Theta^4 \left(1 + \frac{1}{4}smile \times t^2\right) - \Theta^2 \sigma^2 - smile \times f^2\)</span>                 (7.7)</p>
<p>In this case, the polynomial has only 2 real solutions, one negative and one positive, and two complex solutions and its value at zero is negative so actually this polynomial has a W shape that crosses the x-axis only in two points.</p>
<p>In Equation (7.6), and in order to have several positive solutions with the polynomial having a W shape crossing the x- axis for small time to expiry t, one needs a big <span class="math notranslate nohighlight">\(2f \times Cross\theta\)</span>. Indeed, if we neglect the term <span class="math notranslate nohighlight">\(\Theta^3 (Cross \times t)\)</span> due to short expiry, one needs an extreme value for the Cross term. This case where the positive solution is not unique is very rare and almost never happens with the input data the smile model has to fit.</p>
<p>That makes the case the 3-point quartic with a positive smile term very stable and almost never failing when the volatility surface is calibrated to ATM and 25 deltas RR and ST.</p>
<p>case <span class="math notranslate nohighlight">\(smile &lt; 0\)</span>:
We discuss this case of negative smile because although it should not happen with respect to the theoretical assumption of Schnbuchers model, we have seen in production some input smile with a concave shape which requires a negative smile term for the quartic to be able to be fitted.</p>
<p>If the smile is negative that leads frequently to a failure because you may have no real solution You may have also many real solutions (4 real solutions). The case of no positive real solution happens most of the time. In order to address these limitations, we introduced an extension of the quartic model that ensures the ability to always find an implied volatility, see Section 5.1.1.1.4.</p>
</section>
</section>
<section id="calibration-of-the-5-point-quartic-model">
<h3><span class="section-number">1.5.1.9.2. </span>7.1.2. Calibration of the 5-point quartic model<a class="headerlink" href="#calibration-of-the-5-point-quartic-model" title="Link to this heading">#</a></h3>
<p>The five parameters that need to be fitted are thus <span class="math notranslate nohighlight">\(\sigma, v_0, \rho v_0, \alpha, \beta\)</span>. The new parameters <span class="math notranslate nohighlight">\(\alpha\)</span> and <span class="math notranslate nohighlight">\(\beta\)</span> are fairly orthogonal to each other and the standard three.</p>
<p>From Equation (5.7) we obtain our new system of 5 equation. Let us first define</p>
<p><span class="math notranslate nohighlight">\(A(K, \Theta) = d_1 d_2 t\)</span>
<span class="math notranslate nohighlight">\(B(K, \Theta) = -2d_2 \sqrt{t}\)</span>
<span class="math notranslate nohighlight">\(C(K, \Theta) = d_1 d_2t \frac{f^2}{V_{ATM} + f^2}\)</span>
<span class="math notranslate nohighlight">\(D(K, \Theta) = \Theta t \frac{f}{\sqrt{V_0 V_{ATM} + f^2}}\)</span>
<span class="math notranslate nohighlight">\(E(K, \Theta) = \Theta^2\)</span>
<span class="math notranslate nohighlight">\(X = \sigma^2\)</span>
<span class="math notranslate nohighlight">\(Y = v_0^2\)</span>
<span class="math notranslate nohighlight">\(Z = \rho v_0 \sigma\)</span>
<span class="math notranslate nohighlight">\(V = \alpha\)</span>
<span class="math notranslate nohighlight">\(W = \beta\)</span>.</p>
<p>With the above, Equation (5.7) becomes</p>
<p><span class="math notranslate nohighlight">\(X + A(K, \Theta)Y + B(K, \Theta)Z + C(K, \Theta)V + D(K, \Theta)W = E(K, \Theta)\)</span>.                 (7.8)</p>
<p>Given five different strikes and their implied volatilities, Equation (7.8) represents a linear system of five equations equations in five unknowns <span class="math notranslate nohighlight">\(X, Y, Z, V, W\)</span>. It is then a simple matter to back out <span class="math notranslate nohighlight">\(\sigma, v_0, \rho, \alpha, \beta\)</span> from <span class="math notranslate nohighlight">\(X, Y, Z, V, W\)</span>.</p>
<p>Now that the model parameters at a given tenor are known, we have to solve the quartic equation (5.11) to find the implied volatilities at other strikes.</p>
<section id="calibration-of-the-3-point-asv-model">
<h4><span class="section-number">1.5.1.9.2.1. </span>7.1.3. Calibration of the 3-point ASV model<a class="headerlink" href="#calibration-of-the-3-point-asv-model" title="Link to this heading">#</a></h4>
<p>We always have ATM vol as input, so <span class="math notranslate nohighlight">\(K_{ATM}\)</span> and <span class="math notranslate nohighlight">\(\sigma_0\)</span> are defined directly. We only need to calibrate <span class="math notranslate nohighlight">\(skew\)</span> and <span class="math notranslate nohighlight">\(smile\)</span> with the other two volatilities supplied. We compute <span class="math notranslate nohighlight">\(z\)</span> for these two strikes.</p>
<p>In a first step, we assume that the smile is positive and try the solve the linear system of two equations</p>
<p><span class="math notranslate nohighlight">\(zX + \frac{z^2}{\sigma^2}Y = \sigma^2 - \sigma_0^2\)</span>.                 (7.9)</p>
<p>with</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
X = 2(skew)v_0
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
Y = (smile)v_0^3
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
C = (Call)v_0^6
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
P = (Put)v_0^6.
\]</div>
</div>
<p>NAG algorithm DGESV is used to solve this system.</p>
<p>If the resulting smile, call or put parameter is negative, it means that we can simply solve a linear system. We use a Levenberg-Marquardt solver to find the four parameters using the exact ASV Equation (5.61), ie taking into account whether the parameters are positive or not.</p>
</section>
</section>
</section>
<section id="market-strangle-to-theoretical-strangle">
<h2><span class="section-number">1.5.1.10. </span>7.1.5. Market strangle to theoretical strangle<a class="headerlink" href="#market-strangle-to-theoretical-strangle" title="Link to this heading">#</a></h2>
<p>In this section, we explain how the market strangle quotes are used, converted to theoretical strangle and then incorporated in the smile parametrization. The implementation is in line with the construction proposed in Clark [[4, Chapter 3]]. We recall the definition of the market strangle (see Section 4.2.3),</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\Delta_C \left( K^{ST} *{25\Delta-C}, T, \sigma* {ATM} + \sigma^{ST-Mkt}_{25} \right) = 0.25 \tag{7.11}
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\Delta_P \left( K^{ST} *{25\Delta-P}, T, \sigma* {ATM} + \sigma^{ST-Mkt}_{25} \right) = -0.25, \tag{}
\]</div>
</div>
<p>and</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\sigma^{ST-Th} *{25} = \frac{1}{2}(\sigma^{Call}* {25\Delta} + \sigma^{Put} *{25\Delta}) - \sigma* {ATM}, \tag{7.12}
\]</div>
</div>
<p>and we emphasize that <span class="math notranslate nohighlight">\(K^{ST} *{25\Delta-C/P}\)</span> are different from <span class="math notranslate nohighlight">\(K* {25\Delta-C/P}\)</span> inverted after the smile construction. However, the following equality holds and links the prices of the strangle with and without smile (i.e. flat volatility),</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
V_{MS-25} = C(K^{ST} *{25\Delta-C},T,\sigma* {ATM} + \sigma^{ST-Mkt} *{25}) + P(K^{ST}* {25\Delta-P},T,\sigma_{ATM} + \sigma^{ST-Mkt}_{25}) \tag{7.13}
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
= C(K^{ST} *{25\Delta-C},T,\sigma^{Call}* {25\Delta}) + P(K^{ST} *{25\Delta-P},T,\sigma^{Put}* {25\Delta}). \tag{7.14}
\]</div>
</div>
<p>Denote <span class="math notranslate nohighlight">\(\sigma_X(K)\)</span>, the quartic smile form of the volatility for a given maturity slice <span class="math notranslate nohighlight">\(T\)</span> and strike <span class="math notranslate nohighlight">\(K\)</span>. The calibrated smile has to satisfy three conditions:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\sigma_{ATM} = \sigma_X(K_{ATM}), \tag{7.15}
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
V_{MS-25} = C(K^{ST} *{25\Delta-C},T,\sigma_X(K^{ST}* {25\Delta-C})) + P(K^{ST} *{25\Delta-P},T,\sigma_X(K^{ST}* {25\Delta-P})), \tag{7.16}
\]</div>
</div>
<p>The calibrated smile model at the marked tenors is supposed to match input 3 or five quotes provided, as described in Section 5.3.</p>
<section id="data-sources">
<h3><span class="section-number">1.5.1.10.1. </span>7.2.3.1. Data sources<a class="headerlink" href="#data-sources" title="Link to this heading">#</a></h3>
<p>Data inputs are marked directly by the desk in line with observed market quotes/conditions.</p>
</section>
<section id="data-availability-history">
<h3><span class="section-number">1.5.1.10.2. </span>7.2.3.2. Data availability / history<a class="headerlink" href="#data-availability-history" title="Link to this heading">#</a></h3>
</section>
<section id="data-quality-and-data-checks">
<h3><span class="section-number">1.5.1.10.3. </span>7.2.3.3. Data quality and data checks<a class="headerlink" href="#data-quality-and-data-checks" title="Link to this heading">#</a></h3>
<p>Data quaity is controlled and monitored by the desk.</p>
</section>
<section id="calibration-algorithm-inputs">
<h3><span class="section-number">1.5.1.10.4. </span>7.3 Calibration Algorithm Inputs<a class="headerlink" href="#calibration-algorithm-inputs" title="Link to this heading">#</a></h3>
<p>The calibration process requires the following inputs:</p>
<ol class="arabic simple">
<li><p><strong>Market Data</strong>:</p>
<ul class="simple">
<li><p>ATM volatilities.</p></li>
<li><p>Risk reversals (RR) and strangles (ST) for 25-delta and 10-delta.</p></li>
</ul>
</li>
<li><p><strong>Tolerance</strong>:</p>
<ul class="simple">
<li><p>A tolerance level <span class="math notranslate nohighlight">\( tol \)</span> (e.g., <span class="math notranslate nohighlight">\( 10^{-10} \)</span>) is used to ensure convergence in the calibration process.</p></li>
</ul>
</li>
<li><p><strong>Bumping Parameters</strong>:</p>
<ul class="simple">
<li><p>Bump size (e.g., 10 basis points for ATM, 5 basis points for wings).</p></li>
<li><p>Ratios for risk reversals (RR) and strangles (ST) (e.g., 1.9 for RR, 4.2 for ST).</p></li>
</ul>
</li>
</ol>
</section>
<hr class="docutils" />
<section id="id14">
<h3><span class="section-number">1.5.1.10.5. </span>7.4 Quality Control<a class="headerlink" href="#id14" title="Link to this heading">#</a></h3>
<p>The calibration results are monitored by the desk to ensure accuracy and reliability. Key quality control measures include:</p>
<ol class="arabic simple">
<li><p><strong>Consistency Checks</strong>:</p>
<ul class="simple">
<li><p>Ensure that the calibrated smile matches market quotes within the specified tolerance.</p></li>
</ul>
</li>
<li><p><strong>Arbitrage Checks</strong>:</p>
<ul class="simple">
<li><p>Verify that the volatility surface is free from arbitrage (e.g., no negative densities or calendar spread arbitrages).</p></li>
</ul>
</li>
<li><p><strong>Stress Testing</strong>:</p>
<ul class="simple">
<li><p>Test the calibration under stressed market conditions to ensure robustness.</p></li>
</ul>
</li>
</ol>
</section>
<hr class="docutils" />
<section id="limitations-and-risk-assessment">
<h3><span class="section-number">1.5.1.10.6. </span>7.5 Limitations and Risk Assessment<a class="headerlink" href="#limitations-and-risk-assessment" title="Link to this heading">#</a></h3>
<p>The calibration process has some limitations and risks:</p>
<ol class="arabic simple">
<li><p><strong>Negative Smile Terms</strong>:</p>
<ul class="simple">
<li><p>In stressed market conditions, the smile term may become negative, leading to calibration failures. The <strong>low-fly correction</strong> addresses this issue.</p></li>
</ul>
</li>
<li><p><strong>Arbitrage Risks</strong>:</p>
<ul class="simple">
<li><p>The calibrated surface may introduce arbitrage, particularly in the wings or for non-quoted expiries. The <strong>constant-moneyness interpolation</strong> method helps mitigate this risk.</p></li>
</ul>
</li>
<li><p><strong>Model Limitations</strong>:</p>
<ul class="simple">
<li><p>The 3-point and 5-point quartic models may not fit all market quotes perfectly, particularly in the wings. The <strong>ASV models</strong> provide additional flexibility but are more computationally intensive.</p></li>
</ul>
</li>
</ol>
</section>
<hr class="docutils" />
<section id="justification-against-alternative-approaches">
<h3><span class="section-number">1.5.1.10.7. </span>7.6 Justification Against Alternative Approaches<a class="headerlink" href="#justification-against-alternative-approaches" title="Link to this heading">#</a></h3>
<p>The calibration process is designed to be <strong>fast</strong>, <strong>accurate</strong>, and <strong>robust</strong>. The use of analytical solutions (e.g., Cardanos method for quartic equations) ensures computational efficiency, while the <strong>low-fly correction</strong> and <strong>constant-moneyness interpolation</strong> methods address common calibration challenges.</p>
</section>
</section>
<hr class="docutils" />
<section id="risk-assessment-and-calculation-model-driven-payoff-analysis">
<h2><span class="section-number">1.5.1.11. </span>8. Risk Assessment and Calculation (Model-Driven Payoff Analysis)<a class="headerlink" href="#risk-assessment-and-calculation-model-driven-payoff-analysis" title="Link to this heading">#</a></h2>
<p>While the model does not directly compute risk, it employs a technique known as bumping FX volatility surfaces to generate risk measures for all dependent pricing models. This section provides a detailed explanation of how the FX volatility surface is perturbed during this process, the methodologies employed, and the implications for risk measurement.</p>
<section id="overview-of-fx-volatility-surface-inputs">
<h3><span class="section-number">1.5.1.11.1. </span>Overview of FX Volatility Surface Inputs<a class="headerlink" href="#overview-of-fx-volatility-surface-inputs" title="Link to this heading">#</a></h3>
<p>The FX volatility surface is constructed using two primary components:</p>
<ol class="arabic simple">
<li><p><strong>At-the-Money (ATM) Volatility</strong>:</p>
<ul class="simple">
<li><p>Expressed either through <strong>Mean Reverting (MR) parameters</strong> combined with events and offsets, or directly as ATM volatilities.</p></li>
</ul>
</li>
<li><p><strong>Volatility Smile</strong>:</p>
<ul class="simple">
<li><p>Defined by <strong>Risk Reversals (RR)</strong> and <strong>Strangles (ST)</strong> for 25-delta and 10-delta options.</p></li>
</ul>
</li>
</ol>
<p>The bumping framework focuses on quantifying the impact of changes (i.e., risks) to:</p>
<ul class="simple">
<li><p><strong>ATM volatilities</strong></p></li>
<li><p><strong>Near and far Risk Reversal (RR) volatilities</strong> (commonly referred to as <em>Rega</em>)</p></li>
<li><p><strong>Near and far Strangle (ST) volatilities</strong> (commonly referred to as <em>Sega</em>)</p></li>
</ul>
<p>This section first outlines the methodology for calculating risk with respect to ATM quotes, whether directly specified or derived from Mean Reverting backbone parameters. It then delves into the more nuanced process of bumping RR and ST quotes while maintaining the integrity of the volatility surface.</p>
</section>
<hr class="docutils" />
<section id="methodology-for-bumping-fx-volatility-surfaces">
<h3><span class="section-number">1.5.1.11.2. </span>8.1 Methodology for Bumping FX Volatility Surfaces<a class="headerlink" href="#methodology-for-bumping-fx-volatility-surfaces" title="Link to this heading">#</a></h3>
<section id="at-the-money-atm-volatility-bumping">
<h4><span class="section-number">1.5.1.11.2.1. </span>8.1.1 At-the-Money (ATM) Volatility Bumping<a class="headerlink" href="#at-the-money-atm-volatility-bumping" title="Link to this heading">#</a></h4>
<p>ATM volatility bumping involves perturbing the ATM market data volatility for both the <strong>Mean Reverting (MR)</strong> and <strong>Variance Interpolated</strong> surfaces. The process applies a finite difference approach, typically using a central bump size of <strong>10 basis points (bps)</strong>, to each tenor. The goal is to ensure that the variance remains increasing on a moneyness scale after the bump.</p>
<section id="variance-interpolated-atm-bumping">
<h5><span class="section-number">1.5.1.11.2.1.1. </span>8.1.1.1 Variance Interpolated ATM Bumping<a class="headerlink" href="#variance-interpolated-atm-bumping" title="Link to this heading">#</a></h5>
<p>For the <strong>Variance Interpolated</strong> surface, ATM volatility bumps are applied by directly modifying the ATM volatility tenor points stored in the market data container. The backbone is then reconstructed using these updated points.</p>
<p>To illustrate, consider the following example:</p>
<ul class="simple">
<li><p><strong>Moniker</strong>: <code class="docutils literal notranslate"><span class="pre">official&#64;20161201/volsurface.fx/pivot/eurusd/longdate/builder</span></code></p></li>
<li><p><strong>Figure 8.1</strong>: Shows the shape of the Variance Interpolated ATM backbone after applying a bump to the first tenor (1 day, 02-12-2016). The bump is applied to the tenor, and the curve is refitted using the new points (represented by red dots).</p></li>
<li><p><strong>Figure 8.2</strong>: Demonstrates the effect of bumping the 20-Year tenor. The bump is applied to the 20Y tenor, and the ATM curve is refitted, with adjacent tenors (matched) shown as red dots.</p></li>
</ul>
<p><img alt="EURUSD 1D ATM backbone shape bumping ATM 1 day Tenor up and Down" src="../../_images/73.png" /></p>
<p>Figure 8.1: Shape of the volatility Variance Interpolated ATM backbone with a ATM bumping applied on the first Tenor 1 day, 02-12-2016. We see that the bump is applied to the tenor and the curve is then refitted on the new points (tenors are the red dots).</p>
<p><img alt="EURUSD LD ATM backbone shape bumping ATM 20 Y Tenor up and Down" src="../../_images/74.png" /></p>
<p>Figure 8.2: Shape of the volatility Variance Interpolated ATM backbone with a ATM bumping applied on tenor 20-Year. We see that the bump is applied to the tenor 20Y and the ATM curve is refitted with this new point. The next and previous tenors which are matched are in red dots.</p>
</section>
</section>
</section>
<section id="mean-reverting-at-the-money-bumping">
<h3><span class="section-number">1.5.1.11.3. </span>8.1.1.2. Mean Reverting At-the-money bumping<a class="headerlink" href="#mean-reverting-at-the-money-bumping" title="Link to this heading">#</a></h3>
<p>On the other hand, the Mean Reverting surface is bumped by shifting the ATM volatility at the quoted pillar and compute the shifted volatility at non-quoted maturities using the Mean-Reverting backbone described in Section 5.1.2.2. A bump we denote</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\Delta\Theta_i = \Theta_{ATM}(T_i) - \Theta(T_i) ,
\]</div>
</div>
<p>is applied to the ATM tenor point for given maturity <span class="math notranslate nohighlight">\(T_i\)</span>. The bump of volatility at a non-quoted time <span class="math notranslate nohighlight">\(t\)</span> (that falls at end of day) in between <span class="math notranslate nohighlight">\(T_i\)</span> and <span class="math notranslate nohighlight">\(T_{i+1}\)</span> is</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\Delta\Theta (T) = \sqrt{\frac{(1 - a_T) \Theta_{ATM}(T_i)^2 T_i + a_T \Theta(T_{i+1})^2 T_{i+1}}{T}} - \sqrt{\frac{(1 - a_T) \Theta(T_i)^2 T_i + a_T \Theta(T_{i+1})^2 T_{i+1}}{T}}.
\]</div>
</div>
<p>In the smile reconstruction after the bump of the ATM, the Risk Reversal and the Strangles are not changed. Therefore, the surface is rebuilt with the new ATM but with the same RR and ST. Since, RR and ST are orthogonal in term of effect on the smile to the ATM, we just create a parallel shift of the smile for each time slice. This is not exactly parallel on the wings because the smile is reconstructed and there are some non linear effects in solving of the volatilities on the wings.</p>
<p>The effect of bumping the MR backbone can be seen on the new ATM backbone generated by the bumped Volsurface. We plot the MR EUR USD backbone of 1 Dec 2016 Day generated by bumping different tenors up and down (we bump each tenor separately):
moniker: official&#64;20161201/volsurface.fx/pivot/eurusd/MeanRevertingMykClose/builder</p>
<p><img alt="EURUSD MR ATM backbone shape bumping ATM 1 day Tenor up and Down" src="../../_images/75.png" /></p>
<p>Figure 8.3: Shape of the volatility MR ATM backbone with a ATM bumping applied on the first Tenor 1 day, 02-12-2016. We see that the bump is applied to the tenor via the offset and that bump is propagated linearly until the next tenor which is the 05-12-2016 (red dot).</p>
<p><img alt="EURUSD ATM backbone shape bumping ATM 6 Months Tenor up and Down" src="../../_images/76.png" /></p>
<p>Figure 8.4: Shape of the volatility MR ATM backbone with a ATM bumping applied on tenor 6 Months 01/06/2017. We see that the bump is applied to the tenor via the offset and that bump is propagated linearly from the previous tenor which is 02/03/2017 and until the next tenor which is the 01-09-2017 (red dots).</p>
<p><img alt="EURUSD ATM backbone bump implied from bumping ATM 6 Months Tenor up and Down" src="../../_images/77.png" /></p>
<p>Figure 8.5: Shape of the bump with a MR ATM bumping applied on tenor 6 Months 01/06/2017. We see that the bump is propagated from the previous tenor which is 02/03/2017 and until the next tenor which is the 01-09-2017.</p>
<p>In essence, the bumps applied do not have a perfect triangular shape since they are impacted by the event weights. If we put all event weights at 1, we obtain the following shape for the same bumping scenario:</p>
<p><img alt="EURUSD ATM backbone bump implied from bumping ATM 6 Months Tenor up and Down with no event weights" src="../../_images/78.png" /></p>
<p>Figure 8.6: Shape of the bump with a MR ATM bumping applied on tenor 6 Months 01/06/2017 and with no event weights. We see that the bump is propagated linearly in variance from the previous tenor which is 02/03/2017 and until the next tenor which is the 01-09-2017.</p>
<p>We plot the EUR USD smile of 1 Dec 2016 for 1 Day generated by bumping the ATM tenor 1 day up and down: moniker: official&#64;20161201/volsurface.fx/pivot/eurusd/MeanRevertingNykClose/builder</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><span class="math notranslate nohighlight">\(T_1\)</span></p></th>
<th class="head"><p>0.498630137</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(T\)</span></p></td>
<td><p>0.583561644</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(T_2\)</span></p></td>
<td><p>0.750684932</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\sum_{i=1}^{T_1 \times 365} \sigma_i^2\)</span></p></td>
<td><p>2.025866138</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\sum_{i=1}^{T \times 365} \sigma_i^2\)</span></p></td>
<td><p>2.400539556</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\sum_{i=1}^{T_2 \times 365} \sigma_i^2\)</span></p></td>
<td><p>3.155245539</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\theta (T_1)\)</span></p></td>
<td><p>0.105504183</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\theta (T)\)</span></p></td>
<td><p>0.10616091</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\theta (T_2)\)</span></p></td>
<td><p>0.107310273</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\theta_{up} (T_1)\)</span></p></td>
<td><p>0.106504183</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(a_T\)</span></p></td>
<td><p>0.331751596</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\theta_{up}^{predicted} (T)\)</span></p></td>
<td><p>0.106729536</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="wing-bumping">
<h2><span class="section-number">1.5.1.12. </span>8.1.3. Wing bumping<a class="headerlink" href="#wing-bumping" title="Link to this heading">#</a></h2>
<section id="safe-bumping-using-ratios">
<h3><span class="section-number">1.5.1.12.1. </span>8.1.3.1. Safe bumping using ratios<a class="headerlink" href="#safe-bumping-using-ratios" title="Link to this heading">#</a></h3>
<p>The methodology aims to preserve a safe shape of the volatility when bumping the far and near wings of the volatility surface. A bumping of the market data quotes would separate the bumping from Near/Far Rega (Risk Reversals) and Near/Far Sega (Strangles) but it would not guarantee that the generated volatility shape is convex. That is why we introduce the concept of safe bumping for the 5-points volatility surface. Naturally, if the surface has only 3-points then safe bumping is not necessary.</p>
<p>The idea of safe bumping is when the five points of a volatility smile are convex in delta space, the smile tends to build and be well behaved. We want to avoid scenario such as, bumping the 25 delta strangle, all the rest kept constant, and introduce a kink in the surface causing the build to fail. There are two approaches implemented to preserve an acceptable shape of the volatility surface:</p>
<ul class="simple">
<li><p>One is called Default. It creates a new orthonormal base of bump vector using a linear combination of pure instruments bump.</p></li>
<li><p>One is called KeepConvex and applies bump on call/put. This is the one used in production as it has demonstrated to be the most stable.</p></li>
</ul>
<p>The default behavior is an above finite difference of 5Bps bump size.</p>
</section>
<section id="safe-bumping-default">
<h3><span class="section-number">1.5.1.12.2. </span>8.1.3.2. Safe Bumping: Default<a class="headerlink" href="#safe-bumping-default" title="Link to this heading">#</a></h3>
<p>For the default mode, we bump first the near (25 delta) and far (10 delta) strangles simultaneously keeping their ratio constant. Then we bump the far strangle only (which only increases the convexity of the surface). Finally we apply a Jacobian to extract the impact of bumping only the near strangle.</p>
<p>The same logic is applied to risk reversals which are a measure of the skew. Empirically, we notice that in the market, risk reversal ratios are often constant. Therefore, it makes sense to do the first bump in ratio and the second bump with far risk-reversals only. If the ratio is smaller than a defined tolerance denoted <span class="math notranslate nohighlight">\(tol\)</span>, then a default ratio is used instead. Empirical findings suggest that a default ratio of <span class="math notranslate nohighlight">\(r_0 = 1.9\)</span> for risk reversals and <span class="math notranslate nohighlight">\(r_1 = 4.2\)</span> for strangles are good starting points. We are giving a justification of this number chosen for the near far ratio in the subsection below, see Section 8.1.3.4.</p>
<p>Below is a summary of how we bump the volatility surface:
Let <span class="math notranslate nohighlight">\(\Delta ST_{25}\)</span>, <span class="math notranslate nohighlight">\(\Delta ST_{10}\)</span>, <span class="math notranslate nohighlight">\(\Delta RR_{25}\)</span> and <span class="math notranslate nohighlight">\(\Delta RR_{10}\)</span> be the 25-delta strangle, 10-delta strangle, 25-delta risk-reversal and 10-delta risk-reversal bumps respectively. Furthermore, let <span class="math notranslate nohighlight">\(ST_{25,min}\)</span> and <span class="math notranslate nohighlight">\(ST_{10,min}\)</span> be the minimum near and far strangle value on the volatility surface to be used by the mutator.
The table below describes for each bump instrument, how the 3/5-point surfaces are modified.</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Bumped instrument</p></th>
<th class="head"><p>3-point Volatility Surface</p></th>
<th class="head"><p>5-point Volatility Surface</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(RR_{25}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(RR_{25,UP} = RR_{25} + \Delta RR_{25}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(RR_{25,UP} = RR_{25} + \Delta RR_{25}\)</span> <code class="docutils literal notranslate"><span class="pre">&lt;br&gt;</span></code> <span class="math notranslate nohighlight">\(r = \frac{RR_{10}}{RR_{25}}\)</span>, <span class="math notranslate nohighlight">\( = 1_{r&gt;tol}r + 1_{rtol}r_0\)</span> <code class="docutils literal notranslate"><span class="pre">&lt;br&gt;</span></code> <span class="math notranslate nohighlight">\(RR_{10,UP} =   RR_{25}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(ST_{25}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(ST_{25,UP} = \max(ST_{25}, ST_{25,min}) + \Delta ST_{25}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(ST_{25,UP} = \max(ST_{25}, ST_{25,min}) + \Delta ST_{25}\)</span> <code class="docutils literal notranslate"><span class="pre">&lt;br&gt;</span></code> <span class="math notranslate nohighlight">\(r = \frac{ST_{10}}{ST_{25}}\)</span>, <span class="math notranslate nohighlight">\( = 1_{r&gt;tol}r + 1_{rtol}r_1\)</span> <code class="docutils literal notranslate"><span class="pre">&lt;br&gt;</span></code> <span class="math notranslate nohighlight">\(ST_{10,UP} =   ST_{25}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(RR_{10}\)</span></p></td>
<td><p>N/A</p></td>
<td><p><span class="math notranslate nohighlight">\(RR_{10,UP} = RR_{10} + \Delta RR_{10}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(ST_{10}\)</span></p></td>
<td><p>N/A</p></td>
<td><p><span class="math notranslate nohighlight">\(ST_{10,UP} = \max(ST_{10}, ST_{10,min}) + \Delta ST_{10}\)</span></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="safe-bumping-keepconvex">
<h3><span class="section-number">1.5.1.12.3. </span>8.1.3.3. Safe Bumping: KeepConvex<a class="headerlink" href="#safe-bumping-keepconvex" title="Link to this heading">#</a></h3>
<p>It has been shown empirically that FX five point analytic surfaces tend to build when they are convex in delta space. Here, delta means domestic booking currency, foreign face currency and forward delta. That is, standard Black-Scholes forward delta.</p>
<p>The Default safe bumping method can make a surface less convex. In particular, the far risk-reversal bump will make the surface more convex at the 10-delta call point, and less convex at the 10-delta put point. Therefore, if a rega/sega bump breaks convexity, it is likely to break the surface. To address this, an alternative safe bumping method is designed to conserve appropriate convexity of the volatility shape. This method is called KeepConvex in QA Lib.</p>
<p>The four bumps applied are:</p>
<ul class="simple">
<li><p>25-delta call vol up by , 10-delta call vol up by   ratio</p></li>
<li><p>25-delta put vol up by , 10-delta put vol up by   ratio</p></li>
<li><p>10-delta call vol up by </p></li>
<li><p>10-delta put vol up by </p></li>
</ul>
<p>Here  is the bump size, and near/far ratio defaults to 4.2, which is supposed to reflect a convexity ratio between 10 Delta and 25 Delta, see Section 8.1.3.4. We see that with this method we bump the Call/Put instruments directly and not the raw ST/RR instruments.</p>
</section>
<section id="justification-of-rr-and-st-ratio-used-in-bumping">
<h3><span class="section-number">1.5.1.12.4. </span>8.1.3.4. Justification of RR and ST ratio used in bumping<a class="headerlink" href="#justification-of-rr-and-st-ratio-used-in-bumping" title="Link to this heading">#</a></h3>
<p>We try to justify the rationale of this risk reversal ratio of 1.9 and the strangle ratio of 4.2 for the safe bumping.</p>
<p>Risk Reversal ratio :</p>
<p>We consider the skew <span class="math notranslate nohighlight">\(s_l\)</span> defined by the derivatives of the volatility to z:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
s_l = \frac{\partial (\sigma(z))}{\partial z} \tag{8.1}
\]</div>
</div>
<p>where we have:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
z = \frac{\ln(\frac{F}{K})}{\sigma_{ATM}\sqrt{T}} - \frac{k}{\sigma_{ATM}\sqrt{T}} \tag{8.2}
\]</div>
</div>
<p>We know that:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\Delta = N (d_1) \Rightarrow k = \frac{1}{2}\sigma^2 T - \sigma\sqrt{T}N^{-1} (\Delta) \Rightarrow k \approx -\sigma_{ATM}\sqrt{T}N^{-1} (\Delta) \Rightarrow z \approx -N^{-1} (\Delta) \tag{8.3}
\]</div>
</div>
<p>The main idea is then to approximate the skew by the skew generated by the 25 Delta:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
s_l \approx \frac{\sigma_{call} (25D) - \sigma_{put} (25D)}{\sigma_{call} (25D) - \sigma_{put} (25D)} \approx \frac{RR(25D)}{-2N^{-1}(0.25)} \tag{8.4}
\]</div>
</div>
<p>We also approximate the skew by the skew generated by the 10 Delta:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
s_l \approx \frac{\sigma_{call} (10D) - \sigma_{put} (10D)}{\sigma_{call} (10D) - \sigma_{put} (10D)} \approx \frac{RR(10D)}{-2N^{-1}(0.10)} \tag{8.5}
\]</div>
</div>
<p>Then we assume that the skew generated by 10 Deltas and 25 Deltas are the same and we end up having:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\frac{RR(25D)}{-2N^{-1}(0.25)} \approx \frac{RR(10D)}{-2N^{-1}(0.10)} \tag{8.6}
\]</div>
</div>
<p>Therefore:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\frac{RR(10D)}{RR(25D)} \approx \frac{N^{-1}(0.10)}{N^{-1}(0.25)} \approx \frac{-1.28155}{-0.67449} \approx 1.9 \tag{8.7}
\]</div>
</div>
<p>If we want to do an average using 5/25 ratio and 15/25 ratio:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\frac{RR(10D)}{RR(25D)} \approx \frac{1}{2} \left( \frac{N^{-1}(0.05)}{N^{-1}(0.25)} + \frac{N^{-1}(0.15)}{N^{-1}(0.25)} \right) \approx 0.5 * (2.43 + 1.53) \approx 1.98 \tag{8.8}
\]</div>
</div>
<p>We can see that overall a ratio of 1.9 is a good choice.</p>
<p>Strangle ratio:</p>
<p>Strangles reflects the smile convexity, we can express the convexity in a simpler way:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\phi_l = \frac{d^2 (\sigma(z))}{dz^2} \tag{8.9}
\]</div>
</div>
<p>Based on that we express the convexity factor as function of ST(25D):</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\phi_l \approx \frac{\sigma_{call} (25D) + \sigma_{put} (25D) - \sigma_{ATM}}{N^{-1}(0.25)^2} \approx \frac{2ST(25D)}{0.455} \tag{8.10}
\]</div>
</div>
<p>We do the same as a function of ST(10D):</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\phi_l \approx \frac{\sigma_{call} (10D) + \sigma_{put} (10D) - \sigma_{ATM}}{N^{-1}(0.10)^2} \approx \frac{2ST(10D)}{1.6423} \tag{8.11}
\]</div>
</div>
<p>We end up with the ratio:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\frac{ST(10D)}{ST(25D)} \approx \frac{N^{-1}(0.10)^2}{N^{-1}(0.25)^2} \approx 3.6666 \tag{8.12}
\]</div>
</div>
<p>Since the convexity ratio is different between 5D 10D 15D we take the average convexity between 5D/25D and 15D/25D :</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\frac{ST(10D)}{ST(25D)} \approx \frac{1}{2} \left( \frac{N^{-1}(0.05)^2}{N^{-1}(0.25)^2} + \frac{N^{-1}(0.15)^2}{N^{-1}(0.25)^2} \right) \approx \frac{(5.95 + 2.36)}{2} \approx 4.2 \tag{8.13}
\]</div>
</div>
<p>We find that 4.2 is a good estimation of the convexity factor between near and far strangle.</p>
</section>
<section id="projection-of-safe-bumps-on-instruments-risks">
<h3><span class="section-number">1.5.1.12.5. </span>8.1.3.5. Projection of safe bumps on instruments risks<a class="headerlink" href="#projection-of-safe-bumps-on-instruments-risks" title="Link to this heading">#</a></h3>
<p>The safe bumping method bumps the instruments in a way which preserves the shape of the volatility smile and ensures the bumped surface will be able to build. Additionally, it moves several instruments at the same time. We need to be able to monitor the risk projected on each single instrument separately. That is why we want to map the safe bumping risk to the pure bumping risk using a Jacobian projection.</p>
<p>We define the pure bumps as the externally modified metrics. More precisely, pure bumps are bumps applied individually to the quoted instruments. The safe bumps are the effective bumps internally used in the library. They can either be on a set of quoted instruments or directly on volatilities. All is afterward re-projected on pure bumps to quoted instruments. The approach is as below:</p>
<p>We denote:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\rho = (e_1, e_2, e_3, e_4, e_5) =\)</span> Pure bumps of <span class="math notranslate nohighlight">\((ATM, RR_{25}, RR_{10}, ST_{25}, ST_{10})\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\theta = (f_1, f_2, f_3, f_4, f_5) =\)</span> Safe bumps Default Mode of <span class="math notranslate nohighlight">\((ATM, RR_{25}, RR_{10}, ST_{25}, ST_{10})\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\eta = (c_1, c_2, c_3, c_4, c_5) =\)</span> Safe bumps KeepConvex Mode of <span class="math notranslate nohighlight">\((ATM, Call_{10}, Put_{25}, Put_{10}, Call_{25})\)</span></p></li>
</ul>
<section id="projection-default">
<h4><span class="section-number">1.5.1.12.5.1. </span>8.1.3.5.1 Projection: Default<a class="headerlink" href="#projection-default" title="Link to this heading">#</a></h4>
<p>For Default mode , we have the following:</p>
<ul class="simple">
<li><p>The safe ATM bump is a pure one as we dont change RRs and STs, so: <span class="math notranslate nohighlight">\(f_1 = e_1\)</span></p></li>
<li><p>In the safe <span class="math notranslate nohighlight">\(RR_{25}\)</span>, we bump <span class="math notranslate nohighlight">\(RR_{25}\)</span> and <span class="math notranslate nohighlight">\(RR_{10}\)</span>: <span class="math notranslate nohighlight">\(f_2 = ae_2 + be_3 + ce_4 + \lambda e_5\)</span></p></li>
<li><p>In the safe <span class="math notranslate nohighlight">\(RR_{10}\)</span>, we bump <span class="math notranslate nohighlight">\(RR_{10}\)</span>: <span class="math notranslate nohighlight">\(f_3 = e_3\)</span></p></li>
<li><p>In the safe <span class="math notranslate nohighlight">\(ST_{25}\)</span>, we bump <span class="math notranslate nohighlight">\(ST_{25}\)</span> and <span class="math notranslate nohighlight">\(ST_{10}\)</span>, and we set a minimum strangle if needed: <span class="math notranslate nohighlight">\(f_4 = ge_4 + he_5\)</span></p></li>
<li><p>In the safe <span class="math notranslate nohighlight">\(ST_{10}\)</span>, we bump <span class="math notranslate nohighlight">\(ST_{10}\)</span>, and we set a minimum strangle if needed: <span class="math notranslate nohighlight">\(f_5 = je_5\)</span></p></li>
</ul>
<p>If the minimum near strangle and far strangles are set to 0, then <span class="math notranslate nohighlight">\(c = \lambda = 0\)</span>. We look at this specific case for simplicity. Hence, we can deduct the Rega and Sega sensitivities to the pure bumps from the sensitivities that we get from the safe bumps as follows:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\Delta_\rho P = (J^T)^{-1} \Delta_\theta P \tag{8.14}
\]</div>
</div>
<p><span class="math notranslate nohighlight">\(\theta\)</span> is the safe bump and <span class="math notranslate nohighlight">\(\rho\)</span> is the pure bump,
<span class="math notranslate nohighlight">\(\Delta_\rho P\)</span> is the gradient of P with respect to <span class="math notranslate nohighlight">\(\rho\)</span>,
<span class="math notranslate nohighlight">\(\Delta_\theta P\)</span> is the gradient of P with respect to <span class="math notranslate nohighlight">\(\theta\)</span>,</p>
<p><span class="math notranslate nohighlight">\((J^T)^{-1}\)</span> is the inverse of the transposed Jacobian <span class="math notranslate nohighlight">\(J\)</span> which converts the bumps from the safe base <span class="math notranslate nohighlight">\(\theta\)</span> to the pure base <span class="math notranslate nohighlight">\(\rho\)</span> defined as</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
J = \left[ \frac{\partial e_j}{\partial f_i} \right]_{i,j} . \tag{8.15}
\]</div>
</div>
</section>
<section id="projection-keep-convex">
<h4><span class="section-number">1.5.1.12.5.2. </span>8.1.3.5.2 Projection: Keep Convex<a class="headerlink" href="#projection-keep-convex" title="Link to this heading">#</a></h4>
<p>For Keep Convex mode, the idea is exactly the same apart that the bump are in terms of Call/Put instruments so in the Jacobian you need to express the Call/Put volatility bump in term of pure bumps:</p>
<ul class="simple">
<li><p>Since the safe ATM bump is a pure one as we dont change RRs and STs, so: <span class="math notranslate nohighlight">\(c_1 = e_1\)</span></p></li>
<li><p>In the safe 10 Delta Call bump: <span class="math notranslate nohighlight">\(c_2 = u_{1,1}e_2 + u_{1,2}e_3 + u_{1,3}e_4 + u_{1,4}e_5\)</span></p></li>
<li><p>In the safe 25 Delta Put bump: <span class="math notranslate nohighlight">\(c_3 = u_{2,1}e_2 + u_{2,2}e_3 + u_{2,3}e_4 + u_{2,4}e_5\)</span></p></li>
<li><p>In the safe 10 Delta Put bump: <span class="math notranslate nohighlight">\(c_4 = u_{3,1}e_2 + u_{3,2}e_3 + u_{3,3}e_4 + u_{3,4}e_5\)</span></p></li>
<li><p>In the safe 25 Delta Call bump: <span class="math notranslate nohighlight">\(c_5 = u_{4,1}e_2 + u_{4,2}e_3 + u_{4,3}e_4 + u_{4,4}e_5\)</span></p></li>
</ul>
<p>The matrix U of elements <span class="math notranslate nohighlight">\((u_{m,n})_{m4,n4}\)</span> is the inverse of the matrix Jacobian <span class="math notranslate nohighlight">\(J\)</span> which converts the bumps from the safe base <span class="math notranslate nohighlight">\(\eta\)</span> to the pure base <span class="math notranslate nohighlight">\(\rho\)</span> with,</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
J = \left[ \frac{\partial e_i}{\partial c_j} \right]_{i,j} \tag{8.16}
\]</div>
</div>
<p>Expressing the bumps of the safe bump <span class="math notranslate nohighlight">\(\eta\)</span> in term of bumps on the pure instruments RR/STR <span class="math notranslate nohighlight">\(\rho\)</span>, we have the tranpose of <span class="math notranslate nohighlight">\(J^T\)</span> equal to:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\begin{pmatrix} RR_{25} &amp; RR_{10} &amp; ST_{25} &amp; ST_{10} \ 0 &amp; 1 &amp; 0 &amp; 0.5 \ -1 &amp; -ratio &amp; 0.5 &amp; 0.5ratio \ 0 &amp; -1 &amp; 0 &amp; 0.5 \ 1 &amp; ratio &amp; 0.5 &amp; 0.5ratio \end{pmatrix} \begin{pmatrix} Call_{10\Delta} \ Put_{25\Delta} \ Put_{10\Delta} \ Call_{25\Delta} \end{pmatrix}
\]</div>
</div>
<p>Indeed, a bump of <span class="math notranslate nohighlight">\(\varepsilon\)</span> for the 10 Delta Call volatility implies a bump of <span class="math notranslate nohighlight">\(\varepsilon\)</span> for the Far RR since:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
RR_{10} = \sigma_{C10\Delta} - \sigma_{P10\Delta} \tag{8.17}
\]</div>
</div>
<p>and a bump of <span class="math notranslate nohighlight">\(\frac{\varepsilon}{2}\)</span> for the Far STR since:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
ST_{10} = 0.5 \times ((\sigma_{C10\Delta} + \sigma_{P10\Delta}) - \sigma_{ATM} . \tag{8.18}
\]</div>
</div>
<p>The other terms of this matrix are calculated with the same reasoning.
We can deduct the Rega Sega sensitivities to the pure bumps from the sensitivities that we get from the safe bumps in Call/Put as follows:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\Delta_\rho P = (J^T)^{-1} \Delta_\eta P \tag{8.19}
\]</div>
</div>
<p><span class="math notranslate nohighlight">\(\eta\)</span> is the base of safe bump in term of Call/Put.
<span class="math notranslate nohighlight">\(\rho\)</span> is the base of pure bump.
<span class="math notranslate nohighlight">\(\Delta_\rho P\)</span> is the gradient of P with respect to <span class="math notranslate nohighlight">\(\rho\)</span>
<span class="math notranslate nohighlight">\(\Delta_\eta P\)</span> is the gradient of P with respect to <span class="math notranslate nohighlight">\(\eta\)</span>
<span class="math notranslate nohighlight">\((J^T)^{-1}\)</span> is the inverse of the transposed Jacobian <span class="math notranslate nohighlight">\(J\)</span>.</p>
</section>
<section id="additional-remarks">
<h4><span class="section-number">1.5.1.12.5.3. </span>8.1.3.5.3 Additional remarks<a class="headerlink" href="#additional-remarks" title="Link to this heading">#</a></h4>
<p>In both Default and Keep Convex mode, the Jacobian is tenor dependent. For example for <span class="math notranslate nohighlight">\(f_2\)</span>: a is equal to the bump size but b depends on the <span class="math notranslate nohighlight">\(RR_{25}\)</span> and <span class="math notranslate nohighlight">\(RR_{10}\)</span> on the relative tenor.</p>
<p>Hence we would need the Asset Vega metrics for each specific tenor. As a result we will end up calculating: <span class="math notranslate nohighlight">\(n\)</span> Jacobians with <span class="math notranslate nohighlight">\(n\)</span> is the number of tenors.</p>
<p>Given the interdependence that we have between the metrics, using the Jacobian, this means that at each time we need to calculate all metrics. This means that if we request one metric (near RR), all the other metrics have to be calculated internally to get the pure sensitivity to near Risk Reversal for example.</p>
<p>As per the wing bump methodology, the input are the safe bumps which are a linear combination of the instruments. In each mode Default or KeepConvex, we calculate an orthogonal base of Bump and for each of this bump a volatility surface is generated.</p>
<p>We plot the EUR USD smile of 1 Dec 2016 for 1 Day with all the bumped volatility surface generated by Default mode and KeepConvex:
moniker: official&#64;20161201/volsurface.fx/pivot/eurusd/meanrevertingfiveparams/builder</p>
<p>For Default:</p>
<p><img alt="EURUSD volatility by delta - Expiry 01 Dec 2016, Bump RR10 Default" src="../../_images/8.1.png" /></p>
<p>Figure 8.8: Shape of the volatility smile with Default wing bump 10 RR on the first Tenor 1 day. We see that that the bump is applied only to the 10 Delta RR.</p>
<p><img alt="EURUSD volatility by delta - Expiry 02-Dec-2016, Bump STR25 Default" src="../../_images/8.9.png" /></p>
<p>Figure 8.9: Shape of the volatility smile with Default wing bump 25 RR on the first Tenor 1 day. We see that that the bump is applied to both the 25 Delta RR and the 10 Delta RR with a RR Ratio.</p>
<p><img alt="EURUSD volatility by delta - Expiry 02-Dec-2016, Bump STR25 Default" src="../../_images/8.10.png" /></p>
<p>Figure 8.10: Shape of the volatility smile with Default wing bump 10 ST on the first Tenor 1 day. We see that that the bump is applied to both the near and far Strangle with a ST Ratio.</p>
<p><img alt="EURUSD volatility by delta - Expiry 02-Dec-2016, Bump STR10 Default" src="../../_images/8.11.png" /></p>
<p>Figure 8.11: Shape of the volatility smile with Default wing bump 10 ST on the first Tenor 1 day. We see that that the bump is applied only to far Strangle.</p>
<p>For KeepConvex:</p>
<p><img alt="EURUSD volatility by delta - Expiry 02-Dec-2016, Bump 10D Call KeepConvex" src="../../_images/8.12.png" /></p>
<p>Figure 8.12: Shape of the volatility smile with Keep Convex bump 10 Delta Call on the first Tenor 1 day. We see the bump is applied only to 10 Delta call</p>
<p><img alt="EURUSD volatility by delta - Expiry 02-Dec-2016, Bump 25D Put KeepConvex" src="../../_images/8.13.png" /></p>
<p>Figure 8.13: Shape of the volatility smile with Keep Convex bump 25 Delta Call on the first Tenor 1 day. We see the bump is applied to 25 Delta call and to 10 Delta call with a ratio</p>
<p><img alt="EURUSD volatility by delta - Expiry 02-Dec-2016, Bump 10D Put KeepConvex" src="../../_images/8.14.png" /></p>
<p>Figure 8.14: Shape of the volatility smile with Keep Convex bump 10 Delta Put on the first Tenor 1 day. We see the bump is applied only to 10 Delta Put.</p>
<p><img alt="EURUSD volatility by delta - Expiry 02-Dec-2016, Bump 25D Put KeepConvex" src="../../_images/8.15.png" /></p>
<p>Figure 8.15: Shape of the volatility smile with Keep Convex bump 25 Delta Call on the first Tenor 1 day. We see the bump is applied to 25 Delta Put and to 10 Delta Put with a ratio</p>
<p>Concerning the behaviour of the smile bumping on broken tenors, i.e. for non quoted expiries, the bump shape is on each tenor and a new volatility surface is constructed with that bump. So when one queries this bumped volatility surface on a broken tenor which after the bumped tenor, the smile shape will have a bump propagated from the tenor. The way the bump is propagated depends of the wing interpolation scheme of the volatility surface, see Section 5.1.3.</p>
<p>We plot bumped smile Tenor 4 Months for KeepConvex and Default and we query it at broken tenor before the next tenor which is 5M.</p>
<p><img alt="EURUSD volatility by delta - Expiry 23-Mar-2017, Behaviour on Broken Tenors, STR25 Bump Default" src="../../_images/8.16.png" /></p>
<p>Figure 8.16: Shape of the volatility smile with query on broken Tenor 23/03/2017 for Default bump 25 STR. We see that the bump is propagated from tenor 02/03/2017 due to the wing time interpolation scheme.</p>
<p><img alt="EURUSD volatility by delta - Expiry 23-Mar-2017, Behaviour on Broken Tenors, 25D Put Bump KeepConvex" src="../../_images/8.17.png" /></p>
<p>Figure 8.17: Shape of the volatility smile with query on broken Tenor 23/03/2017 for KeepConvex 25D Put. We see that the bump is propagated from tenor 02/03/2017 due to the wing time interpolation scheme.</p>
</section>
</section>
</section>
<section id="id15">
<h2><span class="section-number">1.5.1.13. </span>8.2. Inputs<a class="headerlink" href="#id15" title="Link to this heading">#</a></h2>
<p>In this section, we describe the PropertyPage flags relevant for the bumping scenarii used for both the ATM backbone and the smile wings.</p>
<section id="atm-bumps">
<h3><span class="section-number">1.5.1.13.1. </span>8.2.1. ATM bumps<a class="headerlink" href="#atm-bumps" title="Link to this heading">#</a></h3>
<p>For further details see Section 8.1.1.2.</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Input Name</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Values</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BumpSize</p></td>
<td><p>The size of the bump to be applied to the volatility</p></td>
<td><p>Double, Default: 0.01</p></td>
</tr>
<tr class="row-odd"><td><p>Differencing</p></td>
<td><p>Whether to use central or one-sided (above/below) differencing and whether it is relative</p></td>
<td><p>Central <code class="docutils literal notranslate"><span class="pre">&lt;br&gt;</span></code>Above <code class="docutils literal notranslate"><span class="pre">&lt;br&gt;</span></code>Below <code class="docutils literal notranslate"><span class="pre">&lt;br&gt;</span></code>CentralRelative <code class="docutils literal notranslate"><span class="pre">&lt;br&gt;</span></code>AboveRelative <code class="docutils literal notranslate"><span class="pre">&lt;br&gt;</span></code>BelowRelative <code class="docutils literal notranslate"><span class="pre">&lt;br&gt;</span></code>SecondOrder <code class="docutils literal notranslate"><span class="pre">&lt;br&gt;</span></code>SecondOrderRelative</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="wing-bumps">
<h3><span class="section-number">1.5.1.13.2. </span>8.2.2. Wing bumps<a class="headerlink" href="#wing-bumps" title="Link to this heading">#</a></h3>
<p>For further details see Section 8.1.3.</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Input Name</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
<th class="head"><p><strong>Values</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>ApplyJacobianAdjustment</strong></p></td>
<td><p>Whether to apply Jacobian adjustment to results</p></td>
<td><p>Bool, Default: True</p></td>
</tr>
<tr class="row-odd"><td><p><strong>BumpFarOnly</strong></p></td>
<td><p>Apply bumps only to far instruments</p></td>
<td><p>Bool, Default: True</p></td>
</tr>
<tr class="row-even"><td><p><strong>Coefficient</strong></p></td>
<td><p>Coefficient for differentiating near and far RR/ST bumps</p></td>
<td><p>Double, Default: 1.001</p></td>
</tr>
<tr class="row-odd"><td><p><strong>RRratio</strong></p></td>
<td><p>Default ratio for near and far RRs</p></td>
<td><p>Double, Default: 1.9</p></td>
</tr>
<tr class="row-even"><td><p><strong>STRratio</strong></p></td>
<td><p>Default ratio for near and far STs</p></td>
<td><p>Double, Default: 4.2</p></td>
</tr>
<tr class="row-odd"><td><p><strong>SafeBumpingRatioChoice</strong></p></td>
<td><p>Method for calculating ratios</p></td>
<td><p>Default, KeepConvex</p></td>
</tr>
<tr class="row-even"><td><p><strong>VolatilityBumpingType</strong></p></td>
<td><p>Type of volatility bumping</p></td>
<td><p>NearStrangle, NearRiskReversal, FarStrangle, FarRiskReversal</p></td>
</tr>
<tr class="row-odd"><td><p><strong>minFarSTR</strong></p></td>
<td><p>Minimum far strangle value</p></td>
<td><p>Double, Default: 0.0</p></td>
</tr>
<tr class="row-even"><td><p><strong>minNearSTR</strong></p></td>
<td><p>Minimum near strangle value</p></td>
<td><p>Double, Default: 0.0</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<hr class="docutils" />
<section id="limitations-and-risk-considerations">
<h3><span class="section-number">1.5.1.13.3. </span>8.3 Limitations and Risk Considerations<a class="headerlink" href="#limitations-and-risk-considerations" title="Link to this heading">#</a></h3>
<p>The bumping methodology is designed to generate bumped volatility surfaces for risk calculation. While ATM bumping is straightforward, wing bumping requires careful handling to avoid introducing arbitrage or breaking the surface. Key limitations include:</p>
<ul class="simple">
<li><p><strong>Calendar Arbitrage</strong>: Bumped surfaces may introduce calendar arbitrage, particularly for ATM bumps.</p></li>
<li><p><strong>Surface Integrity</strong>: Directly bumping pure instrument inputs can lead to surface breakdowns, necessitating the use of safe bumping methodologies.</p></li>
<li><p><strong>Jacobian Complexity</strong>: The need to calculate multiple Jacobians for different tenors increases computational complexity.</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="comprehensive-testing-and-outcome-analysis-of-the-payoff-model-and-portfolio">
<h2><span class="section-number">1.5.1.14. </span>9. Comprehensive Testing and Outcome Analysis of the Payoff, Model, and Portfolio<a class="headerlink" href="#comprehensive-testing-and-outcome-analysis-of-the-payoff-model-and-portfolio" title="Link to this heading">#</a></h2>
<p>This section provides a detailed overview of the testing framework and outcome analyses conducted to validate the FX volatility model described in Sections 4, 5, and 8. The tests are organized into thematic groups, ensuring comprehensive coverage of the models key features. Each test is designed to evaluate specific aspects of the model, including accuracy, stability, sensitivity, and boundary conditions.</p>
<hr class="docutils" />
<section id="testing-plan">
<h3><span class="section-number">1.5.1.14.1. </span>9.1 Testing Plan<a class="headerlink" href="#testing-plan" title="Link to this heading">#</a></h3>
<p>The testing plan is structured around nine primary themes, each targeting a specific feature or functionality of the FX volatility model:</p>
<ol class="arabic simple">
<li><p><strong>Repricing of FX Volatility Inputs</strong></p></li>
<li><p><strong>Querying Using Different Conventions Than Inputs</strong></p></li>
<li><p><strong>Smile Model Implementation</strong></p></li>
<li><p><strong>Skew Event Model Implementation</strong></p></li>
<li><p><strong>ATM Time Interpolation: Variance Interpolation Backbone</strong></p></li>
<li><p><strong>ATM Time Interpolation: Mean Reverting Backbone</strong></p></li>
<li><p><strong>Wing Time Interpolation</strong></p></li>
<li><p><strong>Extrapolation</strong></p></li>
<li><p><strong>Bumping</strong></p></li>
</ol>
<p>Each theme is further broken down into specific tests, with details on the test type (e.g., accuracy, stability, boundary cases) and the corresponding section of the document that describes the feature being tested.</p>
</section>
<hr class="docutils" />
<section id="repricing-of-fx-volatility-inputs">
<h3><span class="section-number">1.5.1.14.2. </span>9.1.1 Repricing of FX Volatility Inputs<a class="headerlink" href="#repricing-of-fx-volatility-inputs" title="Link to this heading">#</a></h3>
<p>These tests ensure that the market data is correctly integrated into the QALib framework, such that the smile model accurately reproduces the input data when queried.</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Test ID</strong></p></th>
<th class="head"><p><strong>Test Cases</strong></p></th>
<th class="head"><p><strong>Type</strong></p></th>
<th class="head"><p><strong>Section</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>FXVol Test 1</strong></p></td>
<td><p>Verify matching of ATM tenor against market data container</p></td>
<td><p>Accuracy and Convergence</p></td>
<td><p><strong>4.1.2</strong></p></td>
</tr>
<tr class="row-odd"><td><p><strong>FXVol Test 2</strong></p></td>
<td><p>Recompute Risk Reversals (RR) from Call/Put volatilities and compare with QA results</p></td>
<td><p>Accuracy and Convergence</p></td>
<td><p><strong>4.2.2</strong></p></td>
</tr>
<tr class="row-even"><td><p><strong>FXVol Test 3</strong></p></td>
<td><p>Validate quoted market strangle volatility against QA results</p></td>
<td><p>Accuracy and Convergence</p></td>
<td><p><strong>4.2.3</strong></p></td>
</tr>
<tr class="row-odd"><td><p><strong>FXVol Test 4</strong></p></td>
<td><p>Recompute market strangle (STR) externally and compare with QA results</p></td>
<td><p>Accuracy and Convergence</p></td>
<td><p><strong>4.2.3</strong></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<hr class="docutils" />
<section id="skew-event-model-implementation">
<h3><span class="section-number">1.5.1.14.3. </span>9.1.2 Skew Event Model Implementation<a class="headerlink" href="#skew-event-model-implementation" title="Link to this heading">#</a></h3>
<p>These tests evaluate the implementation of the skew event model, ensuring that events are correctly applied and decay as expected.</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Test ID</strong></p></th>
<th class="head"><p><strong>Test Cases</strong></p></th>
<th class="head"><p><strong>Type</strong></p></th>
<th class="head"><p><strong>Section</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>ST Test 1</strong></p></td>
<td><p>Skew event with query date before the event date</p></td>
<td><p>Accuracy</p></td>
<td><p><strong>5.1.3.4</strong></p></td>
</tr>
<tr class="row-odd"><td><p><strong>ST Test 2</strong></p></td>
<td><p>Event size with time-to-expiry ladder</p></td>
<td><p>Accuracy</p></td>
<td><p><strong>5.1.3.4</strong></p></td>
</tr>
<tr class="row-even"><td><p><strong>ST Test 3</strong></p></td>
<td><p>Event decay rate with varying decay constants</p></td>
<td><p>Accuracy</p></td>
<td><p><strong>5.1.3.4</strong></p></td>
</tr>
<tr class="row-odd"><td><p><strong>ST Test 4</strong></p></td>
<td><p>Impact of events on ATM and unspecified instruments</p></td>
<td><p>Sensitivity</p></td>
<td><p><strong>5.1.3.4</strong></p></td>
</tr>
<tr class="row-even"><td><p><strong>ST Test 5</strong></p></td>
<td><p>Skew event for inverted volatility</p></td>
<td><p>Accuracy</p></td>
<td><p><strong>5.1.3.4</strong></p></td>
</tr>
<tr class="row-odd"><td><p><strong>ST Test 6</strong></p></td>
<td><p>Multi-event on different currency pairs</p></td>
<td><p>Accuracy</p></td>
<td><p><strong>5.1.3.4</strong></p></td>
</tr>
<tr class="row-even"><td><p><strong>ST Test 7</strong></p></td>
<td><p>Multi-event on the same currency pair: Degeneration</p></td>
<td><p>Accuracy</p></td>
<td><p><strong>5.1.3.4</strong></p></td>
</tr>
<tr class="row-odd"><td><p><strong>ST Test 8</strong></p></td>
<td><p>Multi-event on the same currency pair: Sum of events</p></td>
<td><p>Accuracy</p></td>
<td><p><strong>5.1.3.4</strong></p></td>
</tr>
<tr class="row-even"><td><p><strong>ST Test 9</strong></p></td>
<td><p>Event specification in terms of currency</p></td>
<td><p>Accuracy</p></td>
<td><p><strong>5.1.3.4</strong></p></td>
</tr>
<tr class="row-odd"><td><p><strong>ST Test 10</strong></p></td>
<td><p>Validation of preference rules</p></td>
<td><p>Accuracy</p></td>
<td><p><strong>5.1.3.4</strong></p></td>
</tr>
<tr class="row-even"><td><p><strong>ST Test 11</strong></p></td>
<td><p>Application of events on cross pairs</p></td>
<td><p>Accuracy</p></td>
<td><p><strong>5.1.3.4</strong></p></td>
</tr>
<tr class="row-odd"><td><p><strong>ST Test 12</strong></p></td>
<td><p>Brexit event simulation</p></td>
<td><p>Accuracy</p></td>
<td><p><strong>5.1.3.4</strong></p></td>
</tr>
<tr class="row-even"><td><p><strong>ST Test 13</strong></p></td>
<td><p>Bank of Japan event simulation</p></td>
<td><p>Accuracy</p></td>
<td><p><strong>5.1.3.4</strong></p></td>
</tr>
<tr class="row-odd"><td><p><strong>ST Test 14</strong></p></td>
<td><p>Arbitrage check with skew events</p></td>
<td><p>Accuracy</p></td>
<td><p><strong>5.1.3.4</strong></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<hr class="docutils" />
<section id="atm-time-interpolation-variance-interpolation-backbone">
<h3><span class="section-number">1.5.1.14.4. </span>9.1.5 ATM Time Interpolation: Variance Interpolation Backbone<a class="headerlink" href="#atm-time-interpolation-variance-interpolation-backbone" title="Link to this heading">#</a></h3>
<p>These tests validate the ATM time interpolation for long-dated volatility surfaces using variance interpolation.</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Test ID</strong></p></th>
<th class="head"><p><strong>Test Cases</strong></p></th>
<th class="head"><p><strong>Type</strong></p></th>
<th class="head"><p><strong>Section</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>FXVol Test 15</strong></p></td>
<td><p>Reconcile externally against QA a query between two tenors using linear variance interpolation</p></td>
<td><p>Accuracy and Convergence</p></td>
<td><p><strong>5.1.2.1</strong></p></td>
</tr>
<tr class="row-odd"><td><p><strong>FXVol Test 16</strong></p></td>
<td><p>Reconcile externally against QA a query between two tenors using monotone cubic variance interpolation</p></td>
<td><p>Accuracy and Convergence</p></td>
<td><p><strong>5.1.2.1</strong></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<hr class="docutils" />
<section id="atm-time-interpolation-mean-reverting-backbone">
<h3><span class="section-number">1.5.1.14.5. </span>9.1.6 ATM Time Interpolation: Mean Reverting Backbone<a class="headerlink" href="#atm-time-interpolation-mean-reverting-backbone" title="Link to this heading">#</a></h3>
<p>These tests validate the ATM time interpolation for mean-reverting volatility surfaces.</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Test ID</strong></p></th>
<th class="head"><p><strong>Test Cases</strong></p></th>
<th class="head"><p><strong>Type</strong></p></th>
<th class="head"><p><strong>Section</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>FXVol Test 17</strong></p></td>
<td><p>Influence of Mean Reverting (MR) parameters (3 parameters)</p></td>
<td><p>Sensitivity</p></td>
<td><p><strong>5.1.2.2.2</strong></p></td>
</tr>
<tr class="row-odd"><td><p><strong>FXVol Test 18</strong></p></td>
<td><p>Influence of Mean Reverting (MR) parameters (5 parameters)</p></td>
<td><p>Sensitivity</p></td>
<td><p><strong>5.1.2.2.2</strong></p></td>
</tr>
<tr class="row-even"><td><p><strong>FXVol Test 19</strong></p></td>
<td><p>Influence of event weights</p></td>
<td><p>Sensitivity</p></td>
<td><p><strong>5.1.2.2.3</strong></p></td>
</tr>
<tr class="row-odd"><td><p><strong>FXVol Test 20</strong></p></td>
<td><p>Implement MR backbone computation externally (5 parameters with event weights) and reconcile against QA query</p></td>
<td><p>Accuracy and Convergence</p></td>
<td><p><strong>5.1.2.2.1</strong></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<hr class="docutils" />
<section id="wing-time-interpolation">
<h3><span class="section-number">1.5.1.14.6. </span>9.1.7 Wing Time Interpolation<a class="headerlink" href="#wing-time-interpolation" title="Link to this heading">#</a></h3>
<p>These tests validate the time interpolation of the wings (RR and STR) for the volatility surface.</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Test ID</strong></p></th>
<th class="head"><p><strong>Test Cases</strong></p></th>
<th class="head"><p><strong>Type</strong></p></th>
<th class="head"><p><strong>Section</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>FXVol Test 21</strong></p></td>
<td><p>Validate Call/Put variance interpolation between tenors using linear variance interpolation</p></td>
<td><p>Accuracy and Convergence</p></td>
<td><p><strong>5.1.3.1</strong></p></td>
</tr>
<tr class="row-odd"><td><p><strong>FXVol Test 22</strong></p></td>
<td><p>Test MR Risk Reversal and Strangle interpolation, ensuring linear interpolation in RR/STR</p></td>
<td><p>Accuracy and Convergence</p></td>
<td><p><strong>5.1.3.2</strong></p></td>
</tr>
<tr class="row-even"><td><p><strong>FXVol Test 23</strong></p></td>
<td><p>Compare MR Risk Reversal and Strangle interpolation with constant-moneyness interpolation</p></td>
<td><p>Comparison to Other Models</p></td>
<td><p><strong>5.1.3.3</strong></p></td>
</tr>
<tr class="row-odd"><td><p><strong>FXVol Test 24</strong></p></td>
<td><p>Compare constant-moneyness interpolated local volatility with RR/STR interpolation</p></td>
<td><p>Comparison to Other Models</p></td>
<td><p><strong>5.1.3.3</strong></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<hr class="docutils" />
<section id="extrapolation">
<h3><span class="section-number">1.5.1.14.7. </span>9.1.8 Extrapolation<a class="headerlink" href="#extrapolation" title="Link to this heading">#</a></h3>
<p>These tests validate the extrapolation of the volatility surface in both strike and maturity dimensions.</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Test ID</strong></p></th>
<th class="head"><p><strong>Test Cases</strong></p></th>
<th class="head"><p><strong>Type</strong></p></th>
<th class="head"><p><strong>Section</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>FXVol Test 25</strong></p></td>
<td><p>Smooth capping and influence of parameters</p></td>
<td><p>Boundary Cases</p></td>
<td><p><strong>5.1.4.1.2</strong></p></td>
</tr>
<tr class="row-odd"><td><p><strong>FXVol Test 26</strong></p></td>
<td><p>Time extrapolation before 1 day, plotting behavior of the map to 3 points</p></td>
<td><p>Boundary Cases</p></td>
<td><p><strong>5.1.4.2.1</strong></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<hr class="docutils" />
<section id="bumping">
<h3><span class="section-number">1.5.1.14.8. </span>9.1.9 Bumping<a class="headerlink" href="#bumping" title="Link to this heading">#</a></h3>
<p>These tests validate the bumping methodology used to compute risk sensitivities, ensuring that bumps are applied correctly and consistently.</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Test ID</strong></p></th>
<th class="head"><p><strong>Test Cases</strong></p></th>
<th class="head"><p><strong>Type</strong></p></th>
<th class="head"><p><strong>Section</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>FXVol Test 27</strong></p></td>
<td><p>ATM bumping for MR surfaces: Show bump applied to each bucket</p></td>
<td><p>Scenario and Stress Testing</p></td>
<td><p><strong>8.1.1</strong></p></td>
</tr>
<tr class="row-odd"><td><p><strong>FXVol Test 28</strong></p></td>
<td><p>ATM bumping for Linear Variance (Long Dated) surfaces</p></td>
<td><p>Scenario and Stress Testing</p></td>
<td><p><strong>8.1.1</strong></p></td>
</tr>
<tr class="row-even"><td><p><strong>FXVol Test 29</strong></p></td>
<td><p>Wing bumping: Effect on each smile tenor for safe bumping modes (Keep Convex and Default)</p></td>
<td><p>Scenario and Stress Testing</p></td>
<td><p><strong>8.1.3.1</strong></p></td>
</tr>
<tr class="row-odd"><td><p><strong>FXVol Test 30</strong></p></td>
<td><p>Validate the ratio of bumped volatilities for 10/25 delta RR and STR</p></td>
<td><p>Scenario and Stress Testing</p></td>
<td><p><strong>8.1.3.1</strong></p></td>
</tr>
<tr class="row-even"><td><p><strong>FXVol Test 31</strong></p></td>
<td><p>Plot smile on broken tenors</p></td>
<td><p>Scenario and Stress Testing</p></td>
<td><p><strong>8.1.3.1</strong></p></td>
</tr>
<tr class="row-odd"><td><p><strong>FXVol Test 32</strong></p></td>
<td><p>Recalculate Near/Far Rega/Sega risk manually using Jacobian and compare with QA results</p></td>
<td><p>Scenario and Stress Testing</p></td>
<td><p><strong>8.1.3.5</strong></p></td>
</tr>
<tr class="row-even"><td><p><strong>FXVol Test 33</strong></p></td>
<td><p>Compare risks calculated with Jacobian against risks from pure bumps</p></td>
<td><p>Scenario and Stress Testing</p></td>
<td><p><strong>8.1.3.5</strong></p></td>
</tr>
<tr class="row-odd"><td><p><strong>FXVol Test 34</strong></p></td>
<td><p>Validate volatility on a strike ladder for large bumps of ATM, RR, and STR</p></td>
<td><p>Scenario and Stress Testing</p></td>
<td><p><strong>9.3</strong></p></td>
</tr>
<tr class="row-even"><td><p><strong>FXVol Test 35</strong></p></td>
<td><p>Validate volatility on a strike ladder for large bumps of spot level, domestic, and foreign rates</p></td>
<td><p>Scenario and Stress Testing</p></td>
<td><p><strong>9.3</strong></p></td>
</tr>
<tr class="row-odd"><td><p><strong>FXVol Test 36</strong></p></td>
<td><p>Bump ATM volatility until the smile model fails to build</p></td>
<td><p>Scenario and Stress Testing</p></td>
<td><p><strong>9.3</strong></p></td>
</tr>
<tr class="row-even"><td><p><strong>FXVol Test 37</strong></p></td>
<td><p>Simultaneously bump ATM, RR, and STR across a wide range of values</p></td>
<td><p>Scenario and Stress Testing</p></td>
<td><p><strong>9.3</strong></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<hr class="docutils" />
<section id="back-testing">
<h3><span class="section-number">1.5.1.14.9. </span>9.2 Back-Testing<a class="headerlink" href="#back-testing" title="Link to this heading">#</a></h3>
<p>No back-testing is performed in this section, as it is not relevant for a market data object like a volatility surface.</p>
</section>
<hr class="docutils" />
<section id="scenario-and-stress-testing">
<h3><span class="section-number">1.5.1.14.10. </span>9.3 Scenario and Stress Testing<a class="headerlink" href="#scenario-and-stress-testing" title="Link to this heading">#</a></h3>
<p>This section focuses on stress-testing the FX volatility surface under extreme conditions, such as large bumps to ATM, RR, and STR quotes. The results are summarized in the table below:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Test ID</p></th>
<th class="head"><p>Test Cases</p></th>
<th class="head"><p>Relevant Section</p></th>
<th class="head"><p>Graphs/Tables</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>FXVol Test 27</p></td>
<td><p>ATM bumping MR: show bump applied to each bucket</p></td>
<td><p>8.1.1</p></td>
<td><p>8.3 to 8.5 and 8.7</p></td>
</tr>
<tr class="row-odd"><td><p>FXVol Test 28</p></td>
<td><p>ATM bumping Linear Variance (Long Dated)</p></td>
<td><p>8.1.1</p></td>
<td><p>8.1 and 8.2</p></td>
</tr>
<tr class="row-even"><td><p>FXVol Test 29</p></td>
<td><p>Wing Bumping : Effect on each smile Tenors for Safe bumping mode (Keep Convex and Default). A Risk computation generate a base of 4 vectors of bumped Vol.</p></td>
<td><p>8.1.3.1</p></td>
<td><p>8.8 to 8.15</p></td>
</tr>
<tr class="row-odd"><td><p>FXVol Test 30</p></td>
<td><p>Check that the ratio of bumped volatility are correct: query the bumped vol on 10/25 and check the STR and RR ratios</p></td>
<td><p>8.1.3.1</p></td>
<td><p>9.1 to 9.4</p></td>
</tr>
<tr class="row-even"><td><p>FXVol Test 31</p></td>
<td><p>Plot Smile on Broken Tenors</p></td>
<td><p>8.1.3.1</p></td>
<td><p>8.16 and 8.17</p></td>
</tr>
<tr class="row-odd"><td><p>FXVol Test 32</p></td>
<td><p>Recalculate manually Near/Far Rega/Sega Risk with external computation of Jacobian, check against QA, for keepConvex.</p></td>
<td><p>8.1.3.5</p></td>
<td><p>9.3.2</p></td>
</tr>
<tr class="row-even"><td><p>FXVol Test 33</p></td>
<td><p>Check this risk with Jacobian against risk with pure bumps</p></td>
<td><p>8.1.3.5</p></td>
<td><p>9.3.3</p></td>
</tr>
<tr class="row-odd"><td><p>FXVol Test 34</p></td>
<td><p>Check volatility on a strike ladder for very large bumps of ATMVol, RR25, RR10, STR25, STR10</p></td>
<td><p>9.3</p></td>
<td><p>9.1 to 9.3</p></td>
</tr>
<tr class="row-even"><td><p>FXVol Test 35</p></td>
<td><p>Check volatility on a strike ladder for very large bump of the spot level, domestic and foreign rates</p></td>
<td><p>9.3</p></td>
<td><p>9.4 to 9.6</p></td>
</tr>
<tr class="row-odd"><td><p>FXVol Test 36</p></td>
<td><p>Bump ATM volatility until the smile model is not able to build</p></td>
<td><p>9.3</p></td>
<td><p>9.7 to 9.9</p></td>
</tr>
<tr class="row-even"><td><p>FXVol Test 37</p></td>
<td><p>Bump simultaneously the ATM, RR25, RR10, STR25, STR10, either up or down in a large range of values</p></td>
<td><p>9.3</p></td>
<td><p>9.10 to 9.12</p></td>
</tr>
</tbody>
</table>
</div>
<p>In this section, we cover the testing of the scenario and Stress-testing behaviour which is defined by the way the FX volatility surface is bumped. Most of the testing result is presented through the document in the relevant sections and the graphs from the test results are summarized in the table above, so we only detail in this section the tests not covered in the other sections of the document.</p>
</section>
<section id="check-that-the-ratio-of-bumped-volatility-are-correct-fxvol-test-30">
<h3><span class="section-number">1.5.1.14.11. </span>9.3.1. Check that the ratio of bumped volatility are correct: FXVol Test 30<a class="headerlink" href="#check-that-the-ratio-of-bumped-volatility-are-correct-fxvol-test-30" title="Link to this heading">#</a></h3>
<p>There are two cases for this test:</p>
<p>The KeepConvex mode where the call/put instruments are bumped in safe mode. With the same FX volatility surface official&#64;20161201/volsurface.fx/pivot/eurusd/meanrevertingfiveparams/builder, we check the ratio of bump for <span class="math notranslate nohighlight">\(Call_{10\Delta} / Call_{25\Delta}\)</span> on the bumped surface vs <span class="math notranslate nohighlight">\(Call_{25\Delta}\)</span>.</p>
<p>We have:</p>
<p><strong>Table 9.1:</strong></p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Bump 10D Call</p></th>
<th class="head"><p>0.00210000000041175595</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Bump 25D Call</p></td>
<td><p>0.00049999999999996257</p></td>
</tr>
<tr class="row-odd"><td><p>ratio Call Bump</p></td>
<td><p>4.20000000838263</p></td>
</tr>
</tbody>
</table>
</div>
<p>So we see that as expected the near/far call ratio is 4.2.</p>
<p>For the put side we have:</p>
<p><strong>Table 9.2:</strong></p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Bump 10D Call</p></th>
<th class="head"><p>0.002099999995276038</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Bump 25D Call</p></td>
<td><p>0.00049999999999994592</p></td>
</tr>
<tr class="row-odd"><td><p>ratio Call Bump</p></td>
<td><p>4.1999999185562</p></td>
</tr>
</tbody>
</table>
</div>
<p>So we see that as expected the near/far put ratio is 4.2.</p>
<p>The Default mode where the RR/STR instruments are bumped in safe mode.</p>
<p>We have for the strangles:</p>
<p><strong>Table 9.3:</strong></p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><span class="math notranslate nohighlight">\(ST_{25}\)</span></p></th>
<th class="head"><p>0.0012409037869897666</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(ST_{10}\)</span></p></td>
<td><p>0.0034113927556408685</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(ratioST_{old}\)</span></p></td>
<td><p>2.7491194655117943</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(ST_{25,up}\)</span></p></td>
<td><p>0.0017412367290147168</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(ST_{10,up}\)</span></p></td>
<td><p>0.004761192199128693</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(ratioST_{up}\)</span></p></td>
<td><p>2.7343738618591082</p></td>
</tr>
</tbody>
</table>
</div>
<p>We see that for ST the old ratio is preserved with the new bumped surface (10<span class="math notranslate nohighlight">\(^{-2}\)</span> diff).</p>
<p>We have for the risk reversals:</p>
<p><strong>Table 9.4:</strong></p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><span class="math notranslate nohighlight">\(RR_{25}\)</span></p></th>
<th class="head"><p>-0.0035264964499491097</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(RR_{10}\)</span></p></td>
<td><p>-0.005289745022824144</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(ratioRR_{old}\)</span></p></td>
<td><p>1.5000000986532906</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(RR_{25,up}\)</span></p></td>
<td><p>-0.003526496449949193</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(RR_{10,up}\)</span></p></td>
<td><p>-0.005289744973445434</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(ratioRR_{up}\)</span></p></td>
<td><p>1.500000084651055</p></td>
</tr>
</tbody>
</table>
</div>
<p>We see that for RR the old ratio is preserved with the new bumped surface (10<span class="math notranslate nohighlight">\(^{-8}\)</span> diff).</p>
</section>
<section id="recalculate-manually-near-far-rega-sega-risk-fxvol-test-32">
<h3><span class="section-number">1.5.1.14.12. </span>9.3.2. Recalculate manually Near/Far Rega/Sega Risk: FXVol Test 32<a class="headerlink" href="#recalculate-manually-near-far-rega-sega-risk-fxvol-test-32" title="Link to this heading">#</a></h3>
<p>We are testing the computation for the Rega/Sega Risk using the Safe bumbing Keep Convex mode which is the one used in production. We use a simple option trade EUR USD 1Y 500M notional which has smile risk exposure on tenor 1Y.</p>
<p>We calculate the Jacobian <span class="math notranslate nohighlight">\(J\)</span> externally, in this case the set is done with default ratio of 4.2.</p>
<p>So we have according to Section 8.1.3.5.2:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
J = \begin{pmatrix} 0 &amp; 1 &amp; 0 &amp; 0.5\ -1 &amp; -4.2 &amp; 0.5 &amp; 2.1\ 0 &amp; -1 &amp; 0 &amp; 0.5\ 1 &amp; 4.2 &amp; 0.5 &amp; 2.1 \end{pmatrix}
\]</div>
</div>
<p>Inverting this matrix we get:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
J^{-1} = \begin{pmatrix} -2.1 &amp; -0.5 &amp; 2.1 &amp; 0.5\ 0.5 &amp; 0 &amp; -0.5 &amp; 0\ -4.2 &amp; 1 &amp; -4.2 &amp; 1\ 1 &amp; 0 &amp; 1 &amp; 0 \end{pmatrix}
\]</div>
</div>
<p>The risks calculated by QA with safe bumps in the base <span class="math notranslate nohighlight">\(\eta\)</span> are the following:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\begin{pmatrix} C_{10\Delta}\ P_{25\Delta}\ P_{10\Delta}\ C_{25\Delta} \end{pmatrix} = \begin{pmatrix} 42271.9916284829\ 111048.070684969\ -59018.760722354\ -41472.7339602361 \end{pmatrix}
\]</div>
</div>
<p>Multiplying this risk vector with the Inverse of the Jacobian, we get the Risk projected on the pure bump base <span class="math notranslate nohighlight">\(\rho\)</span>:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\begin{pmatrix} \text{NearRega}\ \text{FarRega}\ \text{NearSega}\ \text{FarSega} \end{pmatrix} = \begin{pmatrix} -288971\ 50646\ 139912\ -16747 \end{pmatrix} = \begin{pmatrix} -2.1 &amp; -0.5 &amp; 2.1 &amp; 0.5\ 0.5 &amp; 0 &amp; -0.5 &amp; 0\ -4.2 &amp; 1 &amp; -4.2 &amp; 1\ 1 &amp; 0 &amp; 1 &amp; 0 \end{pmatrix} \begin{pmatrix} 42272\ 111048\ -59019\ -41473 \end{pmatrix}
\]</div>
</div>
<p>We see that it matches perfectly the Risk values given by QA using the metrics NearRega, FarRega, NearSega and FarSega in Keep Convex mode.</p>
</section>
<section id="check-these-risks-calculated-with-jacobian-against-risk-with-pure-bumps-fxvol-test-33">
<h3><span class="section-number">1.5.1.14.13. </span>9.3.3. Check these risks calculated with Jacobian against risk with pure bumps: FXVol Test 33<a class="headerlink" href="#check-these-risks-calculated-with-jacobian-against-risk-with-pure-bumps-fxvol-test-33" title="Link to this heading">#</a></h3>
<p>To check the consistency of this KeepConvex mode, we check that the risks obtained with this methodology are reasonably close from the risks obtained by bumping the pure instrument directly. The aim of using the Jacobian is to be able to reproduce the pure bumps with actually bumping the surface safely.</p>
<p>Using the Pure bumps for the Rega/Sega, we have the following risks:
$$</p>
<div class="math-wrapper amsmath docutils container" id="equation-39c4ba9a-10b6-45a1-871e-f4f83f57c392">
<div class="amsmath math notranslate nohighlight" id="equation-39c4ba9a-10b6-45a1-871e-f4f83f57c392">
<span class="eqno">(9)<a class="headerlink" href="#equation-39c4ba9a-10b6-45a1-871e-f4f83f57c392" title="Permalink to this equation">#</a></span>\[\begin{pmatrix} \text{NearRega}\ \text{FarRega}\ \text{FarSega}\ \text{FarSega} \end{pmatrix} = \begin{pmatrix} -200776\ 52019\ 86023\ -16905 \end{pmatrix}\]</div>
</div>
<p>$$</p>
<p>We see that although there are some differences, the risks are in line with the one obtained with the Jacobian.</p>
</section>
<section id="check-volatility-on-a-strike-ladder-for-very-large-bumps-of-volatility-quotes-fxvol-test-34">
<h3><span class="section-number">1.5.1.14.14. </span>9.3.4. Check volatility on a strike ladder for very large bumps of volatility quotes: FXVol Test 34<a class="headerlink" href="#check-volatility-on-a-strike-ladder-for-very-large-bumps-of-volatility-quotes-fxvol-test-34" title="Link to this heading">#</a></h3>
<p>We here plot the volatility on a large strike ladder for heavily bumped ATMVol, RR25, RR10, STR25 and STR10. The moniker used is official&#64;20161201/volsurface.fx/pivot/eurusd/MeanRevertingNykOpen/builder, the valuation date is 01-12-2016 and the spot is 1.06.</p>
<p>Additional ladders are provided in Appendix C, where the outputted value is the NPV under a Black-Scholes model.</p>
<p><img alt="EURUSD Volatility by strike - Expiry: 02-Mar-2017" src="../../_images/9.1.png" /></p>
<p>Figure 9.1: Volatility on a strike ladder for a large bump of volatility ATM.</p>
<p>As expected, when the ATM volatility is bumped up, the convexity of smile gets reduced since both the risk-reversals and strangles are left un-touched. The upside bump is 10% absolute and downside bump is 2% absolute. Both are very high volatility bumps.</p>
<p><img alt="EURUSD Volatility by strike - Expiry: 02-Mar-2017" src="../../_images/9.2.png" /></p>
<p>Figure 9.2: Volatility on a strike ladder for a large bump of Risk-Reversals.</p>
<p>As we expect, when the risk-reversal is bumped down, its value becomes more negative and the resulting smile more skewed. The reverse is true as well. The impact on the smile is larger on the RR10 than on the RR25. The bump size is 0.005 either up or down. This corresponds roughly to 30% bump size relative to the value of the market RR25, and a 18% bump size relative to the value of the market RR10. Those are highly stressed bumps which provide good insights on the 5Pts Quartic model stability.</p>
<p><img alt="EURUSD Volatility by strike - Expiry: 02-Mar-2017" src="../../_images/9.3.png" /></p>
<p>Figure 9.4: Volatility on a strike ladder for a large bump of the spot level.</p>
<p>As expected, the smile is simply slided on a strike ladder due to sticky-delta assumptions in the Quartic model.</p>
<p><img alt="EURUSD Volatility by strike - Expiry: 02-Mar-2017" src="../../_images/9.4.png" /></p>
<p>Figure 9.5: Volatility on a strike ladder for a large parallel bump of the domestic rate  20%.</p>
<p><img alt="EURUSD Volatility by strike - Expiry: 02-Mar-2017" src="../../_images/9.5.png" /></p>
<p>Figure 9.6: Volatility on a strike ladder for a large parallel bump of the foreign rate  20%.</p>
<p>As expected, the smile is also slid on a strike ladder due to sticky-delta assumptions in the Quartic model. Indeed, shifting the rates up or down, implies a move of either the spot or the strike (depending on the rate curve moved).</p>
</section>
<section id="bump-atm-volatility-until-the-smile-model-is-not-able-to-build-fxvol-test-36">
<h3><span class="section-number">1.5.1.14.15. </span>9.3.6. Bump ATM volatility until the smile model is not able to build: FXVol Test 36<a class="headerlink" href="#bump-atm-volatility-until-the-smile-model-is-not-able-to-build-fxvol-test-36" title="Link to this heading">#</a></h3>
<p>The moniker used is official&#64;20161201/volsurface.fx/pivot/eurusd/MeanRevertingNykOpen/builder, the valuation date is 01-12-2016 and the spot is 1.06. The maturity will be one year. In this paragraph, we compare the 3pts Quartic, 5Pts Quartic and 5Pts Quartic with low fly correction for different bumps of the ATM volatility. We bump in absolute volatility from 2% (therefore a volatility of 10% becomes 12%) to 200% and see if the smile model builds properly.</p>
<p><img alt="EURUSD 3Pts Quartic - Expiry: 03-Dec-2017" src="../../_images/9.6.png" /></p>
<p>Figure 9.7: 3Pts Quartic: Volatility on a strike ladder for a set of large parallel bumps of the ATM volatility.</p>
<p>We see that the three points quartic model never fails to build even for a large bump of 200%. We therefore use the 3Pts Quartic model for the volatility scenarios of the PV ladders presented in Appendix C.</p>
<p><img alt="EURUSD 5Pts Quartic - Expiry: 03-Dec-2017" src="../../_images/9.8.png" /></p>
<p>Figure 9.8: 5Pts Quartic: Volatility on a strike ladder for a set of large parallel bumps of the ATM volatility.</p>
<p>We notice that the 5Pts Quartic model fails to build for volatility bumps above 10% ( the strangle values, relative to the ATM level, are becoming too small).</p>
<p><img alt="EURUSD 5Pts Quartic (Low Fly - Strong) - Expiry: 03-Dec-2017" src="../../_images/9.9.png" /></p>
<p>Figure 9.9: 5Pts Quartic with LowFly correction: Volatility on a strike ladder for a set of large parallel bumps of the ATM volatility.</p>
<p>We notice that the 5Pts Quartic model with low fly correction is not able to built the volatility bump of 200%.</p>
</section>
<section id="bump-simultaneously-atm-risk-reversals-and-strangles-for-a-large-set-of-values-fxvol-test-37">
<h3><span class="section-number">1.5.1.14.16. </span>9.3.7. Bump simultaneously ATM, risk reversals and strangles for a large set of values: FXVol Test 37<a class="headerlink" href="#bump-simultaneously-atm-risk-reversals-and-strangles-for-a-large-set-of-values-fxvol-test-37" title="Link to this heading">#</a></h3>
<p>In this subsection, we simultaneously bump up and down, the ATM volatility, the risk-reversals and the strangles for highly stressed scenarios. For negative bumps, the near risk-reversals and near strangles are bumped down, this automatically implies a similar bump of the far risk-reversals and strangles. The ATM downward bump is limited to 35% relative. For positive bumps, the far risk-reversals and strangles are additionally bumped by 1/4 of the relative bump size. All bumps are expressed in relative amount.</p>
<p>In the first stress test, we move the ATM, RRs (near/far), STRs (near/far) all together up and down:</p>
<p><img alt="EURUSD Volatility by strike - Expiry: 02-Mar-2017" src="../../_images/9.10.png" /></p>
<p>Figure 9.10: 5Pts Quartic : Volatility on a strike ladder for a set of large bumps of the ATM volatility, the near and far, risk-reversals and strangles.</p>
<p>In order to isolate the stress applied on the wings, we perform the same exercise but use the market ATM volatility:</p>
<p><img alt="EURUSD Volatility by strike - Expiry: 02-Mar-2017" src="../../_images/9.11.png" /></p>
<p>Figure 9.11: 5Pts Quartic : Volatility on a strike ladder for a set of large bumps of the near and far, risk-reversals and strangles.</p>
<p>Finally, we also show the impact of the latter test near the money, where we clearly see the limit scenarios where, in orange, we have a steep negative pure skew, and in dark blue, a positive skew with stronger convexity:</p>
<p><img alt="EURUSD Volatility by strike - Expiry: 02-Mar-2017" src="../../_images/9.12.png" /></p>
<p>Figure 9.12: 5Pts Quartic : Volatility on a strike ladder for a set of large bumps of the near and far, risk-reversals and strangles: zoomed in near the money.</p>
</section>
</section>
<section id="statistical-testing">
<h2><span class="section-number">1.5.1.15. </span>9.4. Statistical Testing<a class="headerlink" href="#statistical-testing" title="Link to this heading">#</a></h2>
<p>We do not perform any statistical testing in the testing section of this document.</p>
</section>
<section id="impact-of-assumptions-and-limitations">
<h2><span class="section-number">1.5.1.16. </span>9.5. Impact of Assumptions and Limitations<a class="headerlink" href="#impact-of-assumptions-and-limitations" title="Link to this heading">#</a></h2>
<p>The three-point quartic model allows to calibrate the ATM vol, the near risk-reversal and near strangle and neglect the far risk-reversal and far strangle. While in some market setting, the three-points parametrization can be very close to the five-points counterparts, a mismatch is often noticed on far strikes. A striking example is when the market data are less conventional. On can refer to Figure 9.16 for a three-points fit where the market quotes are depicted in red. Alternatively, the five-points model fits the market perfectly in Figure 9.17.</p>
</section>
<section id="accuracy-convergence-stability-and-sensitivity">
<h2><span class="section-number">1.5.1.17. </span>9.6. Accuracy, Convergence, Stability and Sensitivity<a class="headerlink" href="#accuracy-convergence-stability-and-sensitivity" title="Link to this heading">#</a></h2>
<section id="accuracy-and-convergence">
<h3><span class="section-number">1.5.1.17.1. </span>9.6.1. Accuracy and Convergence<a class="headerlink" href="#accuracy-and-convergence" title="Link to this heading">#</a></h3>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Test ID</p></th>
<th class="head"><p>Test Cases</p></th>
<th class="head"><p>Relevant Section</p></th>
<th class="head"><p>Graphs/Tables</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>FXVol Test 1</p></td>
<td><p>Check matching of ATM Tenor against Mkt data container,</p></td>
<td><p>9.6.4.1</p></td>
<td><p>9.6</p></td>
</tr>
<tr class="row-odd"><td><p>FXVol Test 2</p></td>
<td><p>Recompute RR externally from Call/Put Vol, check against QA</p></td>
<td><p>9.6.4.1</p></td>
<td><p>9.6</p></td>
</tr>
<tr class="row-even"><td><p>FXVol Test 3</p></td>
<td><p>Check the quoted market strangle vol against QA</p></td>
<td><p>9.6.4.1</p></td>
<td><p>9.6</p></td>
</tr>
<tr class="row-odd"><td><p>FXVol Test 4</p></td>
<td><p>Recompute Market STR externally, check against QA</p></td>
<td><p>9.6.4.1</p></td>
<td><p>9.6</p></td>
</tr>
<tr class="row-even"><td><p>FXVol Test 5</p></td>
<td><p>Build a surface which has a certain convention ( for EUR USD, DNS forward Delta)</p></td>
<td><p>9.6.4.2</p></td>
<td><p>9.7</p></td>
</tr>
<tr class="row-odd"><td><p>FXVol Test 6</p></td>
<td><p>query ATM spot with QA and reconcile computing strike externally</p></td>
<td><p>9.6.4.2</p></td>
<td><p>9.7</p></td>
</tr>
<tr class="row-even"><td><p>FXVol Test 7</p></td>
<td><p>query ATM forward with QA and reconcile computing strike manually</p></td>
<td><p>9.6.4.2</p></td>
<td><p>9.7</p></td>
</tr>
<tr class="row-odd"><td><p>FXVol Test 8</p></td>
<td><p>query ATM ZDS spot/ forward for domestic/Foreign booking (pips and % deltas) and reconcile computing ATM strike externally</p></td>
<td><p>9.6.4.2</p></td>
<td><p>9.7</p></td>
</tr>
<tr class="row-even"><td><p>FXVol Test 13</p></td>
<td><p>For a given slice, extract quartic params, implement quartic 5 points formula externally and reconcile with QA query</p></td>
<td><p>5.1.1.1.3</p></td>
<td><p>9.13</p></td>
</tr>
<tr class="row-odd"><td><p>FXVol Test 15</p></td>
<td><p>Reconcile externally against QA a query between 2 tenors in linear variance interpolation</p></td>
<td><p>5.1.2.1</p></td>
<td><p>5.20 5.1</p></td>
</tr>
<tr class="row-even"><td><p>FXVol Test 16</p></td>
<td><p>Reconcile externally against QA a query between 2 tenors in monotone cubic variance interpolation</p></td>
<td><p>5.1.2.1</p></td>
<td><p>9.14</p></td>
</tr>
<tr class="row-odd"><td><p>FXVol Test 20</p></td>
<td><p>Implement externally MR backbone computation 5 params with EW and reconcile against QA query</p></td>
<td><p>5.1.2.2</p></td>
<td><p>9.15</p></td>
</tr>
<tr class="row-even"><td><p>FXVol Test 21</p></td>
<td><p>LD Call/Put variance interpolation: Check a query between tenor with Linear variance interpolation.Plot variance between 2 tenors and verify it is linear for 10/25 D call/Put</p></td>
<td><p>5.1.3.1</p></td>
<td><p>5.29 to 5.32</p></td>
</tr>
<tr class="row-odd"><td><p>FXVol Test 22</p></td>
<td><p>Test MR RiskReversal Strangle interpolation and check it is interpolated linearly in RR/STR</p></td>
<td><p>5.1.3.2</p></td>
<td><p>5.33 to 5.36</p></td>
</tr>
</tbody>
</table>
</div>
<p>Most of the testing result is presented through the document in the relevant sections and the graphs from the test results are summarized in the table above, so we only detail in this section the tests not covered in the other sections of the document.</p>
</section>
<section id="reconcile-externally-against-qa-a-query-between-2-tenors-in-monotone-cubic-variance-interpolation">
<h3><span class="section-number">1.5.1.17.2. </span>9.6.3. Reconcile externally against QA a query between 2 tenors in monotone cubic variance interpolation<a class="headerlink" href="#reconcile-externally-against-qa-a-query-between-2-tenors-in-monotone-cubic-variance-interpolation" title="Link to this heading">#</a></h3>
<p>We have reproduced externally the monotone cubic interpolation used for ATM long-dated backbone. We are using the set of ATM market points of the moniker:
official&#64;20161201/volsurface.fx/pivot/eurusd/longdate/builder
We use in the testing the function scipy, scipy.interpolate.PchipInterpolator. PCHIP stands for Piecewise Cubic Hermite Interpolating Polynomial and it uses a 1-d monotonic cubic interpolation, which is the same algorithm as in QA. Checking the difference in volatility between between tenors 3Y and 5Y, we see that the maximum difference is at the order of 10^-5 which is satisfactory.</p>
<p><img alt="EURUSD ATM volatility backbone using Smooth Variance against external Scipy PCHIP interpolator" src="../../_images/9.14.png" /></p>
<p>Figure 9.14: Reconciliation of ATM backbone smooth variance interpolation using QA Lib against external computation with scipy. The plot is between 3Y and 5Y tenor. We see the values of the volatility match very closely.</p>
</section>
<section id="implement-externally-mr-backbone-computation-5-params-with-ew-and-reconcile-against-qa-query">
<h3><span class="section-number">1.5.1.17.3. </span>9.6.4. Implement externally MR backbone computation 5 params with EW and reconcile against QA query<a class="headerlink" href="#implement-externally-mr-backbone-computation-5-params-with-ew-and-reconcile-against-qa-query" title="Link to this heading">#</a></h3>
<p>Using testing data stored in Property page for a mean reverting surface 5 params, we build the FX volatility surface associated with QA Lib. We then query the ATM backbone and we compare it with an external computation of the ATM backbone using the formulas described in Section 5.1.2.2.</p>
<p>We plot the results of the ATM backbone computed by QA Lib and the one calculated externally:</p>
<p><img alt="Reconciliation of MR backbone with and without Events DA against manual computation" src="../../_images/9.15.png" /></p>
<p>Figure 9.15: Reconciliation of MR backbone 5 parameters with and without Events Weights using QA Lib against manual computation. We see we are able to match perfectly the methodology described in the document.</p>
<section id="repricing-of-market-quotes">
<h4><span class="section-number">1.5.1.17.3.1. </span>9.6.4.1. Repricing of market quotes<a class="headerlink" href="#repricing-of-market-quotes" title="Link to this heading">#</a></h4>
<p>For the currency pair EURUSD, we calibrated the volatility smile to the set of market data and performed a few validation tests. We recomputed the ATM volatility by querying the QA Lib and compared it to the market quotes for all pillars. The differences were of the order of the machine precision. We recomputed the RR25 and RR10 volatility by querying the QA Lib and compared it to the market quotes for all pillars. The differences were of the order of the machine precision. We recomputed the market ST25 and ST10 volatility by querying the QA Lib and compared it to the market quotes for all pillars. The differences were of the order of the machine precision. We first computed the market strangle strikes 10D and 25D with the QA Lib and then priced the strangle 10 and 25 strategies, at the market strangle strikes, with a flat volatility <span class="math notranslate nohighlight">\(\sigma_{ATM} + \sigma_{R-25}\)</span> and with the calibrated quartic model smile. The maximum relative difference in prices, over all pillars is 0.13 basis point, showing that the optimization algorithm have converged. The results are provided hereafter:</p>
<p><strong>Table 9.6: Repricing tests</strong></p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Test</p></th>
<th class="head"><p>Abs. Difference (%)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Smile ATM vol vs quoted vol</p></td>
<td><p>ATM: 5.5e-15</p></td>
</tr>
<tr class="row-odd"><td><p>Smile RR vs quoted RR</p></td>
<td><p>25-D: 1.72e-12 | 10-D: 1.30e-07</p></td>
</tr>
<tr class="row-even"><td><p>Smile market ST vol vs quoted market ST vol</p></td>
<td><p>25-D: 1.24e-06 | 10-D: 2.36e-05</p></td>
</tr>
<tr class="row-odd"><td><p>Smile market ST price vs market ST price</p></td>
<td><p>25-D: 0.00072 | 10-D: 0.0013</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="atm-conventions">
<h4><span class="section-number">1.5.1.17.3.2. </span>9.6.4.2. ATM conventions<a class="headerlink" href="#atm-conventions" title="Link to this heading">#</a></h4>
<p>For the currency pair EURUSD, we calibrated the volatility smile to the set of market data and performed conventions related tests. We queried the ATM-Spot in QA Lib as well as the volatility value on the quartic smile for a strike at the spot. The differences were of the order of the machine precision. We queried the ATM-Forward in QA Lib as well as the volatility value on the quartic smile for a strike at the forward. The differences were of the order of the machine precision. We queried the ATM-ZDS in QA Lib in both pips- and %-delta conventions, as well as the volatility value on</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Test ID</p></th>
<th class="head"><p>Test Cases</p></th>
<th class="head"><p>Relevant Section</p></th>
<th class="head"><p>Graphs/Tables</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>FXVol Test 12</p></td>
<td><p>Test a concave smile handling with some input parameters</p></td>
<td><p>9.7.1</p></td>
<td><p>9.16, 9.17 and 9.19</p></td>
</tr>
<tr class="row-odd"><td><p>FXVol Test 14</p></td>
<td><p>For a local volatility that reaches zero under a quartic model, check how the low-fly correction behaves</p></td>
<td><p>9.7.2</p></td>
<td><p>9.20</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="low-fly-correction-fxvol-test-12">
<h3><span class="section-number">1.5.1.17.4. </span>9.7.1. Low fly correction: FXVol Test 12<a class="headerlink" href="#low-fly-correction-fxvol-test-12" title="Link to this heading">#</a></h3>
<section id="negative-smile-term">
<h4><span class="section-number">1.5.1.17.4.1. </span>9.7.1.1. Negative <span class="math notranslate nohighlight">\(smile\)</span> term<a class="headerlink" href="#negative-smile-term" title="Link to this heading">#</a></h4>
<p>If there is no low fly correction, there might be a market data set for which the volatility surface does not build. More specifically, we exhibit a smile for which the calibrated <span class="math notranslate nohighlight">\(v^2\)</span> is negative in Equation (5.8), and where the parameters are calibrated by solving a linear system of equations. This means that the quartic polynomial may have no positive real roots which yields to issues.</p>
<section id="three-points-low-fly-correction">
<h5><span class="section-number">1.5.1.17.4.1.1. </span>9.7.1.1.1 Three-points low fly correction<a class="headerlink" href="#three-points-low-fly-correction" title="Link to this heading">#</a></h5>
<p>In the following Figure 9.16, we plot an EURUSD volatility smile slice of maturity 3 days. The market data used are a forward value of 1.295058, a maturity 0.0082191 and volatilities:</p>
<p><strong>Table 9.8:</strong></p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Strike</p></th>
<th class="head"><p>Volatility</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1.2736</p></td>
<td><p>0.1443</p></td>
</tr>
<tr class="row-odd"><td><p>1.2755</p></td>
<td><p>0.25035</p></td>
</tr>
<tr class="row-even"><td><p>1.2954</p></td>
<td><p>0.28720</p></td>
</tr>
<tr class="row-odd"><td><p>1.3119</p></td>
<td><p>0.20865</p></td>
</tr>
<tr class="row-even"><td><p>1.3172</p></td>
<td><p>0.145710</p></td>
</tr>
</tbody>
</table>
</div>
<p>The calibrated quartic parameters are:</p>
<p><strong>Table 9.9:</strong></p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><span class="math notranslate nohighlight">\(v^2\)</span></p></th>
<th class="head"><p>0.00888590</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(smile\)</span></p></td>
<td><p>-7.8967644289</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(cross\)</span></p></td>
<td><p>0.4938405857</p></td>
</tr>
</tbody>
</table>
</div>
<p>where we clearly notice a very negative smile term <span class="math notranslate nohighlight">\(v^2\)</span> that prevents from finding any positive real roots for Equation (5.8). Therefore, when the smile term <span class="math notranslate nohighlight">\(v^2\)</span> is negative, we switch to the low fly correction, as per Section 5.1.1.1.4. The calibrated three-points, low fly, correction parameters are :</p>
<p><strong>Table 9.10:</strong></p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><span class="math notranslate nohighlight">\(v^2\)</span></p></th>
<th class="head"><p>0.083536507</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(smile\)</span></p></td>
<td><p>-0.223757679</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(cross\)</span></p></td>
<td><p>-17.18113873</p></td>
</tr>
</tbody>
</table>
</div>
<p>In Figure 9.16, we plot the market smile for which the quartic smile model does not build (no positive real roots are found), and for which the low fly correction model fits the three points market smile perfectly.</p>
<p><img alt="Concave smile shape for a three days maturity" src="../../_images/9.16.png" /></p>
<p>Figure 9.16: Concave smile shape for a three days maturity perfectly fitted by the low fly correction three-points model. The quartic smile model fails to build due to negative smile term <span class="math notranslate nohighlight">\(v^2\)</span>.</p>
</section>
<section id="five-points-low-fly-correction">
<h5><span class="section-number">1.5.1.17.4.1.2. </span>9.7.1.1.2 Five-points low fly correction<a class="headerlink" href="#five-points-low-fly-correction" title="Link to this heading">#</a></h5>
<p>Similarly, for the exact same smile slice, we can calibrate a five-points low fly correction model as per Equation (5.11). The five-points quartic model switches to the low fly correction when either:</p>
<ul class="simple">
<li><p>Weak condition : Either the smile term <span class="math notranslate nohighlight">\(v^2\)</span> or <span class="math notranslate nohighlight">\(v^2 + a\)</span> is negative after solving the 5 equations 5 unknowns linear system of the quartic model (5.11).</p></li>
<li><p>Strong condition : Either the smile term <span class="math notranslate nohighlight">\(v^2\)</span> or the <span class="math notranslate nohighlight">\(a\)</span> is negative after solving the 5 equations 5 unknowns linear system of the quartic model (5.11).</p></li>
</ul>
<p>In this test case, both Weak and Strong conditions are satisfied since <span class="math notranslate nohighlight">\(v^2\)</span> is negative. The calibrated five-points low fly correction parameters are:</p>
<p><strong>Table 9.11:</strong></p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><span class="math notranslate nohighlight">\(v^2\)</span></p></th>
<th class="head"><p>0.0866205962</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(smile\)</span></p></td>
<td><p>47.28437036</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(cross\)</span></p></td>
<td><p>-1.044922439</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(a\)</span></p></td>
<td><p>-315.5392161</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\beta\)</span></p></td>
<td><p>-166.7103183</p></td>
</tr>
</tbody>
</table>
</div>
<p>The calibrated five-points low fly correction model is displayed in Figure 9.17 .</p>
<p><img alt="Concave smile shape for a three days maturity" src="../../_images/9.17.png" /></p>
<p>Figure 9.17: Concave smile shape for a three days maturity perfectly fitted by the low fly five-points correction model. The quartic smile model fails to build due to negative smile term <span class="math notranslate nohighlight">\(v^2\)</span>.</p>
<p>Both the three- and five-points low fly correction models have been re-implemented outside QA Lib and the output values perfectly reconciled.</p>
</section>
</section>
<section id="positive-smile-term-and-negative-a">
<h4><span class="section-number">1.5.1.17.4.2. </span>9.7.1.2. Positive <span class="math notranslate nohighlight">\(smile\)</span> term and negative <span class="math notranslate nohighlight">\(a\)</span><a class="headerlink" href="#positive-smile-term-and-negative-a" title="Link to this heading">#</a></h4>
<p>In this Subsection, we want to show an example where the quartic model builds but fail to match the 5 volatility points. More particularly, we see that one of the volatilities, i.e. the highest positive real root, is too high to fit the market. This illustrates why the Strong condition (i.e. smile term or <span class="math notranslate nohighlight">\(a\)</span> is negative) to switch to the low fly correction model is useful in some market settings. The market data used are for the EURUSD currency pair with a forward value of 1.06044, a maturity of 0.017417 and volatilities of:</p>
<p><strong>Table 9.12:</strong></p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Strike</p></th>
<th class="head"><p>Volatility</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1.02846</p></td>
<td><p>0.18177</p></td>
</tr>
<tr class="row-odd"><td><p>1.044145</p></td>
<td><p>0.17693</p></td>
</tr>
<tr class="row-even"><td><p>1.060708</p></td>
<td><p>0.17028</p></td>
</tr>
<tr class="row-odd"><td><p>1.076675</p></td>
<td><p>0.16781</p></td>
</tr>
<tr class="row-even"><td><p>1.091524</p></td>
<td><p>0.16888</p></td>
</tr>
</tbody>
</table>
</div>
<p>The corresponding smiles built are presented in Figure 9.18.</p>
<p><img alt="Implied volatility smile for a 6.35 days maturity" src="../../_images/9.18.png" /></p>
<p>Figure 9.18: Implied volatility smile for a 6.35 days maturity perfectly fitted by the low fly five-points correction model. The quartic smile model builds but fails to perfectly match the far out-of-the-money strike where the highest positive root is too high.</p>
</section>
<section id="positive-smile-term-and-negative-smile-a">
<h4><span class="section-number">1.5.1.17.4.3. </span>9.7.1.3. Positive <span class="math notranslate nohighlight">\(smile\)</span> term and negative <span class="math notranslate nohighlight">\(smile + a\)</span><a class="headerlink" href="#positive-smile-term-and-negative-smile-a" title="Link to this heading">#</a></h4>
<p>In this Subsection, we want to show an example where the quartic model builds but fails to return a volatility, i.e. there is no positive solution for far out-of-the money strikes. This illustrates why the Weak condition (i.e. <span class="math notranslate nohighlight">\(smile\)</span> term or <span class="math notranslate nohighlight">\(smile + a\)</span> is negative) is useful even if the five-points quartic smile model can be calibrated properly. The market data used is for the EURCAD currency pair with a forward value of 1.4928898, a maturity of 0.022083 and volatilities of:</p>
<p><strong>Table 9.13:</strong></p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Strike</p></th>
<th class="head"><p>Volatility</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1.451417</p></td>
<td><p>0.148518</p></td>
</tr>
<tr class="row-odd"><td><p>1.472847</p></td>
<td><p>0.134971</p></td>
</tr>
<tr class="row-even"><td><p>1.492889</p></td>
<td><p>0.122198</p></td>
</tr>
<tr class="row-odd"><td><p>1.510148</p></td>
<td><p>0.11459</p></td>
</tr>
<tr class="row-even"><td><p>1.524362</p></td>
<td><p>0.109225</p></td>
</tr>
</tbody>
</table>
</div>
<p>The calibrated quartic parameters are:</p>
<p><strong>Table 9.14:</strong></p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><span class="math notranslate nohighlight">\(v^2\)</span></p></th>
<th class="head"><p>0.014933774</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(smile\)</span></p></td>
<td><p>0.049173834</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(cross\)</span></p></td>
<td><p>0.000466112</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(a\)</span></p></td>
<td><p>-0.055508258</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(beta\)</span></p></td>
<td><p>9.784504121</p></td>
</tr>
</tbody>
</table>
</div>
<p>The corresponding smiles built are presented in Figure 9.19.</p>
<p><img alt="Implied volatility smile for a 8 days maturity" src="../../_images/9.19.png" /></p>
<p>Figure 9.19: Implied volatility smile for a 8 days maturity perfectly fitted by the low fly five-points correction model. The quartic smile model builds but fails to provide a volatility for far out-of-the-money options. The reason being that no positive roots are found for Equation (5.11).</p>
</section>
</section>
<section id="local-volatility-quartic-model-vs-low">
<h3><span class="section-number">1.5.1.17.5. </span>9.7.2. Local volatility quartic model vs low<a class="headerlink" href="#local-volatility-quartic-model-vs-low" title="Link to this heading">#</a></h3>
<hr class="docutils" />
<p>In this Subsection, we want to show an example where the quartic model builds but yields to arbitrages and poor shapes of the local volatility. This illustrates why the Strong condition (i.e. smile term or <span class="math notranslate nohighlight">\(a\)</span> is negative) to switch to the low fly correction model is useful in some market settings. The market data used are for the EURUSD currency pair with a forward value of 1.06044 and a maturity of 7 days.
The following Figure 9.20 shows that with the quartic model, the local volatility becomes negative out-of-the-money. This suggests butterfly spread arbitrages and therefore a non arbitrage-free implied volatility surface. On the flip side, the local volatility generated with the low fly correction is smoother and always positive. The latter guarantees the absence of butterfly spread arbitrages. Note that the fact that the local volatility is negative can only come from a negative denominator since the weighted variance time interpolation is arbitrage free in time by construction. Therefore the local volatility numerator is positive.
We do not re-discuss the construction of the local volatility in this documentation, however one can refer to Yendapalli [10].</p>
<p><img alt="EURUSD Local volatility - Expiry: 7.0 D" src="../../_images/9.20.png" /></p>
<p>Figure 9.20: Local volatility for a 7D maturity where the quartic model generates arbitrages whereas the low fly model is more robust and gives a strictly positive and smooth local volatility slice.</p>
<section id="bucketed-vega-rega-sega-of-a-one-touch-up-option">
<h4><span class="section-number">1.5.1.17.5.1. </span>9.7.2.1. Bucketed Vega/Rega/Sega of a One-touch up option<a class="headerlink" href="#bucketed-vega-rega-sega-of-a-one-touch-up-option" title="Link to this heading">#</a></h4>
<p>With the same set of Market data, we output the bucketed Vega, Rega (Near and Far) and Sega (Near and Far) for a foreign one-touch up on the EURUSD, with a spot level of 1.06028 and for which the deal parameters are as follows:</p>
<p><strong>Table 9.15:</strong></p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Barrier up</p></th>
<th class="head"><p>1.173</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Start date</p></td>
<td><p>01/12/2016</p></td>
</tr>
<tr class="row-odd"><td><p>Expiry</p></td>
<td><p>30/03/2017</p></td>
</tr>
<tr class="row-even"><td><p>Notional</p></td>
<td><p>500 000 000 EUR</p></td>
</tr>
</tbody>
</table>
</div>
<p>The risk engine is a PDE under a local volatility model under the domestic currency numeraire (USD). The outputted bucketed risks for both the Quartic and the Low Fly correction model are as follows.</p>
<p>First we output the Vega:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Date</p></th>
<th class="head"><p>Tenor</p></th>
<th class="head"><p>Quartic</p></th>
<th class="head"><p>Low Fly Correction</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>02/12/2016</p></td>
<td><p>1D</p></td>
<td><p>1 527 905.00</p></td>
<td><p>58.23</p></td>
</tr>
<tr class="row-odd"><td><p>08/12/2016</p></td>
<td><p>1W</p></td>
<td><p>-15 894.38</p></td>
<td><p>-550.10</p></td>
</tr>
<tr class="row-even"><td><p>15/12/2016</p></td>
<td><p>2W</p></td>
<td><p>-24 635.03</p></td>
<td><p>-5 313.00</p></td>
</tr>
<tr class="row-odd"><td><p>03/01/2017</p></td>
<td><p>1M</p></td>
<td><p>-37 838.02</p></td>
<td><p>-38 257.07</p></td>
</tr>
<tr class="row-even"><td><p>02/02/2017</p></td>
<td><p>2M</p></td>
<td><p>-143 723.83</p></td>
<td><p>-135 989.71</p></td>
</tr>
<tr class="row-odd"><td><p>02/03/2017</p></td>
<td><p>3M</p></td>
<td><p>8 561 526.24</p></td>
<td><p>8 764 238.46</p></td>
</tr>
<tr class="row-even"><td><p>01/06/2017</p></td>
<td><p>6M</p></td>
<td><p>6 471 409.05</p></td>
<td><p>6 746 841.94</p></td>
</tr>
<tr class="row-odd"><td><p>01/09/2017</p></td>
<td><p>9M</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>01/12/2017</p></td>
<td><p>1Y</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>03/12/2018</p></td>
<td><p>2Y</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>03/12/2019</p></td>
<td><p>3Y</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
</tbody>
</table>
</div>
<p>where we notice very high Vega exposure for the 1D pillar for a Quartic model.</p>
<p>Similarly, we output both the near and far Rega:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Date</p></th>
<th class="head"><p>Tenor</p></th>
<th class="head"><p>Quartic / Near</p></th>
<th class="head"><p>Low Fly Correction/ Near</p></th>
<th class="head"><p>Quartic / Far</p></th>
<th class="head"><p>Low Fly Correction / Far</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>02/12/2016</p></td>
<td><p>1D</p></td>
<td><p>16 409 183.51</p></td>
<td><p>-9 693.06</p></td>
<td><p>-5 285 715.22</p></td>
<td><p>2 328.09</p></td>
</tr>
<tr class="row-odd"><td><p>08/12/2016</p></td>
<td><p>1W</p></td>
<td><p>-957 257.23</p></td>
<td><p>5 224.47</p></td>
<td><p>-400 378.17</p></td>
<td><p>-4 449.02</p></td>
</tr>
<tr class="row-even"><td><p>15/12/2016</p></td>
<td><p>2W</p></td>
<td><p>591 580.78</p></td>
<td><p>35 149.21</p></td>
<td><p>-280 448.79</p></td>
<td><p>-26 689.65</p></td>
</tr>
<tr class="row-odd"><td><p>03/01/2017</p></td>
<td><p>1M</p></td>
<td><p>1 182 241.32</p></td>
<td><p>321 049.40</p></td>
<td><p>-609 026.02</p></td>
<td><p>-260 819.06</p></td>
</tr>
<tr class="row-even"><td><p>02/02/2017</p></td>
<td><p>2M</p></td>
<td><p>2 070 412.43</p></td>
<td><p>1 109 710.47</p></td>
<td><p>-1 313 271.54</p></td>
<td><p>-949 625.78</p></td>
</tr>
<tr class="row-odd"><td><p>02/03/2017</p></td>
<td><p>3M</p></td>
<td><p>653 207.79</p></td>
<td><p>-580 294.04</p></td>
<td><p>3 522 396.45</p></td>
<td><p>4 123 335.86</p></td>
</tr>
<tr class="row-even"><td><p>01/06/2017</p></td>
<td><p>6M</p></td>
<td><p>1 810 248.54</p></td>
<td><p>1 417 697.01</p></td>
<td><p>1 596 415.15</p></td>
<td><p>1 874 497.54</p></td>
</tr>
<tr class="row-odd"><td><p>01/09/2017</p></td>
<td><p>9M</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>01/12/2017</p></td>
<td><p>1Y</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>03/12/2018</p></td>
<td><p>2Y</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>03/12/2019</p></td>
<td><p>3Y</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
</tbody>
</table>
</div>
<p>where a very high risk-reversal exposure for the 1D pillar is still present for the Quartic smile model.</p>
<p>Similarly, we output both the near and far Sega:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Date</p></th>
<th class="head"><p>Tenor</p></th>
<th class="head"><p>Quartic / Near</p></th>
<th class="head"><p>Low Fly Correction / Near</p></th>
<th class="head"><p>Quartic / Far</p></th>
<th class="head"><p>Low Fly Correction / Far</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>02/12/2016</p></td>
<td><p>1D</p></td>
<td><p>-7 016 108.22</p></td>
<td><p>15 622.07</p></td>
<td><p>1 938 176.65</p></td>
<td><p>440.92</p></td>
</tr>
<tr class="row-odd"><td><p>08/12/2016</p></td>
<td><p>1W</p></td>
<td><p>-1 125 365.84</p></td>
<td><p>8 678.57</p></td>
<td><p>595 822.09</p></td>
<td><p>-8 562.48</p></td>
</tr>
<tr class="row-even"><td><p>15/12/2016</p></td>
<td><p>2W</p></td>
<td><p>156 786.07</p></td>
<td><p>64 706.10</p></td>
<td><p>-5 318.37</p></td>
<td><p>-50 455.61</p></td>
</tr>
<tr class="row-odd"><td><p>03/01/2017</p></td>
<td><p>1M</p></td>
<td><p>1 295 769.42</p></td>
<td><p>613 486.83</p></td>
<td><p>-582 381.64</p></td>
<td><p>-501 353.90</p></td>
</tr>
<tr class="row-even"><td><p>02/02/2017</p></td>
<td><p>2M</p></td>
<td><p>3 553 512.27</p></td>
<td><p>2 195 637.30</p></td>
<td><p>-1 912 824.94</p></td>
<td><p>-1 861 404.59</p></td>
</tr>
<tr class="row-odd"><td><p>02/03/2017</p></td>
<td><p>3M</p></td>
<td><p>339 834.74</p></td>
<td><p>-1 349 854.74</p></td>
<td><p>7 788 259.13</p></td>
<td><p>8 300 182.55</p></td>
</tr>
<tr class="row-even"><td><p>01/06/2017</p></td>
<td><p>6M</p></td>
<td><p>4 415 537.48</p></td>
<td><p>2 923 388.13</p></td>
<td><p>3 147 440.76</p></td>
<td><p>3 747 896.67</p></td>
</tr>
<tr class="row-odd"><td><p>01/09/2017</p></td>
<td><p>9M</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>01/12/2017</p></td>
<td><p>1Y</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>03/12/2018</p></td>
<td><p>2Y</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>03/12/2019</p></td>
<td><p>3Y</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
</tbody>
</table>
</div>
<p>where a very high Strangle exposure for the 1D pillar is still present for the Quartic smile model. Therefore, we can conclude that the risk sensitivities are better for the Low Fly correction model than a Quartic smile model. We then would advise to use the Strong condition for the switching to the low fly correction.</p>
</section>
</section>
</section>
<section id="comparison-to-other-models">
<h2><span class="section-number">1.5.1.18. </span>9.8. Comparison to Other Models<a class="headerlink" href="#comparison-to-other-models" title="Link to this heading">#</a></h2>
<p>The quartic model (with low fly correction when appropriate) has proven to calibrate all tested market data sets up to very high precision and with good performance. Other approved model in the industry are the three-points quadratic polynomial, SVI parametrization and SABR parametrization, where one can refer to Clark <a class="reference internal" href="#"><span class="xref myst">[4]</span></a> for details. There is no particular advantages to use any of those parametric smile models compared to the quartic (with low fly correction) smile model discussed in this documentation.</p>
</section>
<section id="other-outcome-analysis-testing">
<h2><span class="section-number">1.5.1.19. </span>9.9. Other Outcome Analysis / Testing<a class="headerlink" href="#other-outcome-analysis-testing" title="Link to this heading">#</a></h2>
<p>None.</p>
</section>
<section id="general-limitations">
<h2><span class="section-number">1.5.1.20. </span>10. General Limitations<a class="headerlink" href="#general-limitations" title="Link to this heading">#</a></h2>
<p>All models are approximations of reality and should be evaluated within the context of their intended use. The accuracy of the models must be assessed with consideration of materiality and the specific scenarios in which they are applied.</p>
<section id="key-assumptions">
<h3><span class="section-number">1.5.1.20.1. </span>Key Assumptions<a class="headerlink" href="#key-assumptions" title="Link to this heading">#</a></h3>
<p>The FX volatility model, like most models in mathematical finance, relies on several idealized assumptions, including but not limited to:</p>
<ol class="arabic simple">
<li><p><strong>No Arbitrage</strong>: The model assumes the absence of arbitrage opportunities in the market.</p></li>
<li><p><strong>Frictionless Trading</strong>: It assumes that trading can occur without transaction costs, taxes, or other frictions.</p></li>
<li><p><strong>Unlimited Positions</strong>: There are no restrictions on taking long or short positions in the market.</p></li>
</ol>
</section>
<section id="numerical-approximations">
<h3><span class="section-number">1.5.1.20.2. </span>Numerical Approximations<a class="headerlink" href="#numerical-approximations" title="Link to this heading">#</a></h3>
<p>Numerical methods used in the model provide only approximate solutions to the true theoretical prices or risks. Calibration routines, particularly those involving non-linear optimization, may only approximately reproduce market inputs.</p>
</section>
<section id="market-conditions">
<h3><span class="section-number">1.5.1.20.3. </span>Market Conditions<a class="headerlink" href="#market-conditions" title="Link to this heading">#</a></h3>
<p>The model may not perform adequately under certain market conditions. For example, extreme market stress or illiquidity may render the model inappropriate. Users must exercise judgment when applying the model in such scenarios.</p>
</section>
</section>
<hr class="docutils" />
<section id="model-monitoring-kpis">
<h2><span class="section-number">1.5.1.21. </span>11. Model Monitoring  KPIs<a class="headerlink" href="#model-monitoring-kpis" title="Link to this heading">#</a></h2>
<p>Model monitoring and Key Performance Indicators (KPIs) are not applicable for valuation models like the FX volatility model.</p>
<section id="monitoring-tests-and-key-performance-indicators-kpi">
<h3><span class="section-number">1.5.1.21.1. </span>11.1. Monitoring Tests and Key Performance Indicators (KPI)<a class="headerlink" href="#monitoring-tests-and-key-performance-indicators-kpi" title="Link to this heading">#</a></h3>
<p>Not applicable.</p>
</section>
<section id="performance-exceptions">
<h3><span class="section-number">1.5.1.21.2. </span>11.2. Performance Exceptions<a class="headerlink" href="#performance-exceptions" title="Link to this heading">#</a></h3>
<p>Not applicable.</p>
</section>
<section id="exception-mitigation-plan">
<h3><span class="section-number">1.5.1.21.3. </span>11.3. Exception Mitigation Plan<a class="headerlink" href="#exception-mitigation-plan" title="Link to this heading">#</a></h3>
<p>Not applicable.</p>
</section>
</section>
<hr class="docutils" />
<section id="summary-of-feedback-received-during-development">
<h2><span class="section-number">1.5.1.22. </span>12. Summary of Feedback Received During Development<a class="headerlink" href="#summary-of-feedback-received-during-development" title="Link to this heading">#</a></h2>
<p>The FX volatility model has been a part of the QA Library since 2003. Over the years, feedback from the business has driven several adjustments and extensions to the model. For example, the model was extended from a 3-point Analytic Quartic smile model to a 5-point Analytic Quartic smile model to better capture market dynamics.</p>
<p>The model undergoes an annual review as part of the Annual Model Review process. Any performance issues identified during these reviews are addressed, ensuring continuous improvement.</p>
<section id="recent-feedback-and-actions">
<h3><span class="section-number">1.5.1.22.1. </span>Recent Feedback and Actions<a class="headerlink" href="#recent-feedback-and-actions" title="Link to this heading">#</a></h3>
<p>The table below summarizes recent feedback from the business and the corresponding actions taken to address the identified limitations:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Role</strong></p></th>
<th class="head"><p><strong>Feedback Detail</strong></p></th>
<th class="head"><p><strong>Developer Actions</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Business</p></td>
<td><p>Vega and Volga risk explosion on barrier products due to arbitrage introduced by wing time interpolation.</p></td>
<td><p>Developed the Constant-Moneyness wing time interpolation model. See<strong>Section 5.1.3.3</strong>.</p></td>
</tr>
<tr class="row-odd"><td><p>Business</p></td>
<td><p>Vega and Volga risk explosion on the first tenor bucket, particularly in Local Vol and LSV models, due to issues with smile extrapolation below the first tenor.</p></td>
<td><p>Developed the Below-First-Tenor extrapolation MapTo3Pts. See<strong>Section 5.1.4.2.1</strong>.</p></td>
</tr>
<tr class="row-even"><td><p>Business</p></td>
<td><p>Occasional inability to calibrate the smile model in the presence of low-fly conditions.</p></td>
<td><p>Developed the low-fly correction mechanism. See<strong>Section 5.1.1.1.4</strong>.</p></td>
</tr>
<tr class="row-odd"><td><p>Business</p></td>
<td><p>Lack of control over far wing extrapolation in the 5-point Analytic Quartic model.</p></td>
<td><p>Developed smooth capping extrapolation. See<strong>Section 5.1.4.1.2</strong>.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<hr class="docutils" />
<section id="references">
<h2><span class="section-number">1.5.1.23. </span>13. References<a class="headerlink" href="#references" title="Link to this heading">#</a></h2>
<p>The FX volatility model has evolved significantly over the years, incorporating feedback from the business to address limitations and improve performance. While the model relies on idealized assumptions and numerical approximations, it remains a robust tool for pricing and risk management in FX markets. Continuous monitoring and annual reviews ensure that the model remains relevant and effective in a dynamic market environment.</p>
<p>[1] M. Abramowitz and I. A. Stegun. <em>Handbook of mathematical functions with formulas, graphs, and mathematical tables</em>. Vol. 55. US Government printing office, 1970.</p>
<p>[2] A. Brace, D. Cgtarek, and M. Musiela. The market model of interest rate dynamics. In <em>Mathematical finance</em> 7.2 (1997), pp. 127-155.</p>
<p>[3] A. Castagna and F. Mercurio. Vanna-Volga methods applied to FX derivatives: from theory to market practice. In: <em>Risk Magazine</em> 1 (2007).</p>
<p>[4] I. J. Clark. <em>Foreign exchange option pricing: a practitioners guide</em>. John Wiley &amp; Sons, 2011.</p>
<p>[5] J. Catherai. <em>The volatility surface: a practitioners guide</em>. Vol. 357. John Wiley &amp; Sons, 2011.</p>
<p>[6] J. Catherai and A. Jacquier. Arbitrage-free SVI volatility surfaces. In: <em>Quantitative Finance</em> 14.1 (2014), pp. 59-71.</p>
<p>[7] R. W. Lee. The moment formula for implied volatility at extreme strikes. In: <em>Mathematical Finance: An International Journal of Mathematics, Statistics and Financial Economics</em> 14.3 (2004), pp. 469-480.</p>
<p>[8] <em>NAG routine library E01BFF.</em></p>
<p>[9] P. J. Schonbucher. A market model for stochastic implied volatility. In: <em>Philosophical Transactions of the Royal Society of London. Series A: Mathematical, Physical and Engineering Sciences</em> 357.1758 (1999), pp. 2071-2092.</p>
<p>[10] K. Yendapalli. <em>Local Volatility: PDE and MC</em>. 2016.smiles and the base case, to visualize the impact of the parameters bumps. We use the following</p>
<p>surface. The moniker used for these tests is :
official&#64;20161201/volsurface.fx/pivot/eurusd/meanrevertingfiveparms/builder</p>
<p>moniker: official&#64;20161201/volsurface.fx/pivot/eurusd/longdate/builder</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../Implied%20Volatility%20Filter/index.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title"><span class="section-number">1.6. </span>Implied Volatility Filter Guides</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title"><span class="section-number">1.5. </span>fx_volatility_surface Guides</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023-2025, PRETORIAN Development Team
            </div>
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://github.com/pretorian-project" aria-label="GitHub">
                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
                </svg>
            </a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">1.5.1. FX Analytic Volatility Surfaces</a><ul>
<li><a class="reference internal" href="#table-of-contents">1.5.1.1. Table of Contents</a></li>
<li><a class="reference internal" href="#executive-summary">1.5.1.2. 2. Executive Summary</a></li>
<li><a class="reference internal" href="#scope">1.5.1.3. 3. Scope</a><ul>
<li><a class="reference internal" href="#model-purpose-and-intended-usage">1.5.1.3.1. 3.1. Model Purpose and Intended Usage</a></li>
<li><a class="reference internal" href="#conceptual-soundness">1.5.1.3.2. 3.2. Conceptual Soundness</a></li>
</ul>
</li>
<li><a class="reference internal" href="#product-payoff-portfolio">1.5.1.4. 4. Product / Payoff / Portfolio</a><ul>
<li><a class="reference internal" href="#standard-fx-definitions-and-conventions">1.5.1.4.1. 4.1. Standard FX Definitions and Conventions</a><ul>
<li><a class="reference internal" href="#currency-pair-fordom">1.5.1.4.1.1. 4.1.1. Currency Pair FORDOM</a></li>
<li><a class="reference internal" href="#at-the-money">1.5.1.4.1.2. 4.1.2. At-the-Money</a></li>
</ul>
</li>
<li><a class="reference internal" href="#description">1.5.1.4.2. 4.2. Description</a><ul>
<li><a class="reference internal" href="#call-put">1.5.1.4.2.1. 4.2.1. Call/Put</a></li>
<li><a class="reference internal" href="#risk-reversal">1.5.1.4.2.2. 4.2.2. Risk Reversal</a></li>
<li><a class="reference internal" href="#strangle">1.5.1.4.2.3. 4.2.3. Strangle</a></li>
<li><a class="reference internal" href="#straddle">1.5.1.4.2.4. 4.2.4. Straddle</a></li>
</ul>
</li>
<li><a class="reference internal" href="#creation-of-the-volatility-surface">1.5.1.4.3. 4.3. Creation of the Volatility Surface</a></li>
<li><a class="reference internal" href="#relationship-to-other-approved-models-payoffs">1.5.1.4.4. 4.4. Relationship to Other Approved Models / Payoffs</a></li>
<li><a class="reference internal" href="#inputs">1.5.1.4.5. 4.5. Inputs</a><ul>
<li><a class="reference internal" href="#at-the-money-volatility">1.5.1.4.5.1. 4.5.1. At-the-Money Volatility</a></li>
<li><a class="reference internal" href="#id1">1.5.1.4.5.2. 4.5.2. Strangle</a></li>
<li><a class="reference internal" href="#id2">1.5.1.4.5.3. 4.5.3. Risk Reversal</a></li>
</ul>
</li>
<li><a class="reference internal" href="#payoff-analysis">1.5.1.4.6. 4.7. Payoff Analysis</a></li>
<li><a class="reference internal" href="#the-effect-of-changing-booking-currency-on-risk-measures">1.5.1.4.7. 4.7.1. The Effect of Changing Booking Currency on Risk Measures</a></li>
<li><a class="reference internal" href="#the-meaning-of-delta-for-volatility-surfaces">1.5.1.4.8. 4.7.2. The Meaning of Delta for Volatility Surfaces</a></li>
<li><a class="reference internal" href="#delta-strike-relationships-by-currency-configuration">1.5.1.4.9. Delta/Strike Relationships by Currency Configuration</a></li>
<li><a class="reference internal" href="#example-conversions">1.5.1.4.10. Example Conversions</a></li>
<li><a class="reference internal" href="#practical-example">1.5.1.4.11. Practical Example</a></li>
<li><a class="reference internal" href="#the-zds-at-the-money-strike">1.5.1.4.12. 4.7.3. The ZDS At-the-Money Strike</a></li>
</ul>
</li>
<li><a class="reference internal" href="#model-methodology">1.5.1.5. 5. Model / Methodology</a><ul>
<li><a class="reference internal" href="#id3">1.5.1.5.1. 5.1. Description</a><ul>
<li><a class="reference internal" href="#smile-models">1.5.1.5.1.1. 5.1.1. Smile Models</a><ul>
<li><a class="reference internal" href="#analytic-quartic-smile-model">1.5.1.5.1.1.1. 5.1.1.1. Analytic Quartic Smile Model</a></li>
<li><a class="reference internal" href="#stochastic-implied-volatility-model-for-a-single-volatility">1.5.1.5.1.1.2. 5.1.1.1.1. Stochastic Implied Volatility Model for a Single Volatility</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#point-analytic-quartic-smile-model">1.5.1.5.2. 5.1.1.1.2 3-Point Analytic Quartic smile model</a></li>
<li><a class="reference internal" href="#low-fly-correction-extension-to-the-analytic-quartic-models">1.5.1.5.3. 5.1.1.1.4 Low-fly correction extension to the Analytic Quartic models</a></li>
</ul>
</li>
<li><a class="reference internal" href="#skew-curvature-and-skew-curvature-in-3-5-pt-analytic-models">1.5.1.6. 5.1.1.1.5   Skew, curvature and skew curvature in 3/5 PT analytic models</a><ul>
<li><a class="reference internal" href="#quartic-model-in-the-case-of-foreign-booking-currency">1.5.1.6.1. 5.1.1.1.6    Quartic model in the case of Foreign booking currency</a></li>
</ul>
</li>
<li><a class="reference internal" href="#asv-model">1.5.1.7. 5.1.1.2. ASV model</a><ul>
<li><a class="reference internal" href="#points-asv-model">1.5.1.7.1. 5.1.1.2.1   3-points ASV model</a></li>
<li><a class="reference internal" href="#id4">1.5.1.7.2. 5.1.1.2.2   5-points ASV model</a><ul>
<li><a class="reference internal" href="#effect-of-asv-five-point-parameters">1.5.1.7.2.1. Effect of ASV five point parameters</a></li>
<li><a class="reference internal" href="#at-the-money-time-models">1.5.1.7.2.2. 5.1.2. At-the-money Time models</a><ul>
<li><a class="reference internal" href="#variance-interpolations">1.5.1.7.2.2.1. 5.1.2.1.    Variance Interpolations</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#mean-reverting-atm-time-model">1.5.1.7.3. 5.1.2.2.    Mean-reverting ATM time model</a></li>
<li><a class="reference internal" href="#calculation-of-the-atm-implied-volatilities">1.5.1.7.4. 5.1.2.2.1 Calculation of the ATM implied volatilities</a></li>
<li><a class="reference internal" href="#mean-reverting-backbone">1.5.1.7.5. 5.1.2.2.2   Mean-reverting backbone</a></li>
<li><a class="reference internal" href="#events">1.5.1.7.6. 5.1.2.2.3   Events</a><ul>
<li><a class="reference internal" href="#we-have-the-daily-volatility">1.5.1.7.6.1. We have the daily volatility:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#offsets">1.5.1.7.7. 5.1.2.2.4   Offsets</a></li>
<li><a class="reference internal" href="#wing-time-models">1.5.1.7.8. 5.1.3.   Wing Time models</a><ul>
<li><a class="reference internal" href="#call-put-variance-interpolation">1.5.1.7.8.1. 5.1.3.1.   Call/Put Variance Interpolation</a></li>
<li><a class="reference internal" href="#risk-reversal-strangle-quotes-interpolation">1.5.1.7.8.2. 5.1.3.2.   Risk Reversal/Strangle quotes Interpolation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#constant-moneyness-interpolation">1.5.1.7.9. 5.1.3.3.    Constant-Moneyness Interpolation</a></li>
<li><a class="reference internal" href="#id5">1.5.1.7.10. 5.1.3.3.    Constant-Moneyness Interpolation</a></li>
<li><a class="reference internal" href="#id6">1.5.1.7.11. 5.1.3.3.    Constant-Moneyness Interpolation</a></li>
<li><a class="reference internal" href="#local-volatility-impact-and-time-arbitrage-cleanup">1.5.1.7.12. 5.1.3.3.1    Local volatility impact and time arbitrage cleanup</a></li>
<li><a class="reference internal" href="#skew-event-model">1.5.1.7.13. 5.1.3.4.    Skew Event Model</a></li>
<li><a class="reference internal" href="#assumptions-limitations-and-outliers">1.5.1.7.14. 5.2 Assumptions, Limitations, and Outliers</a><ul>
<li><a class="reference internal" href="#negative-density">1.5.1.7.14.1. 5.2.1 Negative Density</a></li>
<li><a class="reference internal" href="#limitations-on-smile-models">1.5.1.7.14.2. 5.2.2 Limitations on Smile Models</a><ul>
<li><a class="reference internal" href="#discussion-on-3-and-5-point-analytic-quartic-smile-models">1.5.1.7.14.2.1. 5.2.2.1 Discussion on 3- and 5-Point Analytic Quartic Smile Models</a></li>
</ul>
</li>
<li><a class="reference internal" href="#limitations-on-wing-time-models">1.5.1.7.14.3. 5.2.3 Limitations on Wing Time Models</a><ul>
<li><a class="reference internal" href="#variance-interpolation-and-rr-st-quote-interpolation">1.5.1.7.14.3.1. 5.2.3.1 Variance Interpolation and RR/ST Quote Interpolation</a></li>
<li><a class="reference internal" href="#id7">1.5.1.7.14.3.2. 5.2.3.2 Constant-Moneyness Interpolation</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#model-parameters-variables">1.5.1.7.15. 5.3 Model Parameters / Variables</a><ul>
<li><a class="reference internal" href="#atm-time-model-backbones">1.5.1.7.15.1. 5.3.1 ATM Time Model Backbones</a><ul>
<li><a class="reference internal" href="#id8">1.5.1.7.15.1.1. 5.3.1.1 Mean Reverting Backbone</a></li>
<li><a class="reference internal" href="#event-weights">1.5.1.7.15.1.2. 5.3.1.2 Event Weights</a></li>
<li><a class="reference internal" href="#variance-interpolated-backbone">1.5.1.7.15.1.3. 5.3.1.3 Variance Interpolated Backbone</a></li>
</ul>
</li>
<li><a class="reference internal" href="#smooth-capping-extrapolation">1.5.1.7.15.2. 5.3.2 Smooth-Capping Extrapolation</a></li>
<li><a class="reference internal" href="#id9">1.5.1.7.15.3. 5.3.3 Skew Event Model</a></li>
</ul>
</li>
<li><a class="reference internal" href="#model-outputs">1.5.1.7.16. 5.4 Model Outputs</a></li>
<li><a class="reference internal" href="#conditions-of-use">1.5.1.7.17. 5.9 Conditions of Use</a><ul>
<li><a class="reference internal" href="#stressed-market-conditions">1.5.1.7.17.1. 5.9.1 Stressed Market Conditions</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#implementation-numerical-schema-description">1.5.1.8. 6. Implementation / Numerical Schema Description</a><ul>
<li><a class="reference internal" href="#id10">1.5.1.8.1. 6.1 Description</a><ul>
<li><a class="reference internal" href="#solution-of-the-quartic-equations">1.5.1.8.1.1. 6.1.1 Solution of the Quartic Equations</a><ul>
<li><a class="reference internal" href="#cubic-equation">1.5.1.8.1.1.1. 6.1.1.1 Cubic Equation</a></li>
<li><a class="reference internal" href="#quartic-equation">1.5.1.8.1.1.2. 6.1.1.2 Quartic Equation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#solution-of-the-asv-equations">1.5.1.8.1.2. 6.1.2 Solution of the ASV Equations</a><ul>
<li><a class="reference internal" href="#point-asv-equation">1.5.1.8.1.2.1. 6.1.2.1 3-Point ASV Equation</a></li>
<li><a class="reference internal" href="#id11">1.5.1.8.1.2.2. 6.1.2.2 5-Point ASV Equation</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#id12">1.5.1.8.2. 6.2 Inputs</a></li>
<li><a class="reference internal" href="#quality-control">1.5.1.8.3. 6.3 Quality Control</a></li>
<li><a class="reference internal" href="#limitations">1.5.1.8.4. 6.4 Limitations</a></li>
<li><a class="reference internal" href="#additional-notes">1.5.1.8.5. Additional Notes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#calibration">1.5.1.9. 7.Calibration</a><ul>
<li><a class="reference internal" href="#id13">1.5.1.9.1. 7.1. Description</a><ul>
<li><a class="reference internal" href="#calibration-of-the-3-point-quartic-model">1.5.1.9.1.1. 7.1.1. Calibration of the 3-point quartic model</a></li>
<li><a class="reference internal" href="#quartic-equation-solutions-discussion-on-3-point-quartic">1.5.1.9.1.2. 7.1.1.1. Quartic equation solutions: discussion on 3-point quartic</a></li>
</ul>
</li>
<li><a class="reference internal" href="#calibration-of-the-5-point-quartic-model">1.5.1.9.2. 7.1.2. Calibration of the 5-point quartic model</a><ul>
<li><a class="reference internal" href="#calibration-of-the-3-point-asv-model">1.5.1.9.2.1. 7.1.3. Calibration of the 3-point ASV model</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#market-strangle-to-theoretical-strangle">1.5.1.10. 7.1.5. Market strangle to theoretical strangle</a><ul>
<li><a class="reference internal" href="#data-sources">1.5.1.10.1. 7.2.3.1. Data sources</a></li>
<li><a class="reference internal" href="#data-availability-history">1.5.1.10.2. 7.2.3.2. Data availability / history</a></li>
<li><a class="reference internal" href="#data-quality-and-data-checks">1.5.1.10.3. 7.2.3.3. Data quality and data checks</a></li>
<li><a class="reference internal" href="#calibration-algorithm-inputs">1.5.1.10.4. 7.3 Calibration Algorithm Inputs</a></li>
<li><a class="reference internal" href="#id14">1.5.1.10.5. 7.4 Quality Control</a></li>
<li><a class="reference internal" href="#limitations-and-risk-assessment">1.5.1.10.6. 7.5 Limitations and Risk Assessment</a></li>
<li><a class="reference internal" href="#justification-against-alternative-approaches">1.5.1.10.7. 7.6 Justification Against Alternative Approaches</a></li>
</ul>
</li>
<li><a class="reference internal" href="#risk-assessment-and-calculation-model-driven-payoff-analysis">1.5.1.11. 8. Risk Assessment and Calculation (Model-Driven Payoff Analysis)</a><ul>
<li><a class="reference internal" href="#overview-of-fx-volatility-surface-inputs">1.5.1.11.1. Overview of FX Volatility Surface Inputs</a></li>
<li><a class="reference internal" href="#methodology-for-bumping-fx-volatility-surfaces">1.5.1.11.2. 8.1 Methodology for Bumping FX Volatility Surfaces</a><ul>
<li><a class="reference internal" href="#at-the-money-atm-volatility-bumping">1.5.1.11.2.1. 8.1.1 At-the-Money (ATM) Volatility Bumping</a><ul>
<li><a class="reference internal" href="#variance-interpolated-atm-bumping">1.5.1.11.2.1.1. 8.1.1.1 Variance Interpolated ATM Bumping</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#mean-reverting-at-the-money-bumping">1.5.1.11.3. 8.1.1.2. Mean Reverting At-the-money bumping</a></li>
</ul>
</li>
<li><a class="reference internal" href="#wing-bumping">1.5.1.12. 8.1.3. Wing bumping</a><ul>
<li><a class="reference internal" href="#safe-bumping-using-ratios">1.5.1.12.1. 8.1.3.1. Safe bumping using ratios</a></li>
<li><a class="reference internal" href="#safe-bumping-default">1.5.1.12.2. 8.1.3.2. Safe Bumping: Default</a></li>
<li><a class="reference internal" href="#safe-bumping-keepconvex">1.5.1.12.3. 8.1.3.3. Safe Bumping: KeepConvex</a></li>
<li><a class="reference internal" href="#justification-of-rr-and-st-ratio-used-in-bumping">1.5.1.12.4. 8.1.3.4. Justification of RR and ST ratio used in bumping</a></li>
<li><a class="reference internal" href="#projection-of-safe-bumps-on-instruments-risks">1.5.1.12.5. 8.1.3.5. Projection of safe bumps on instruments risks</a><ul>
<li><a class="reference internal" href="#projection-default">1.5.1.12.5.1. 8.1.3.5.1 Projection: Default</a></li>
<li><a class="reference internal" href="#projection-keep-convex">1.5.1.12.5.2. 8.1.3.5.2 Projection: Keep Convex</a></li>
<li><a class="reference internal" href="#additional-remarks">1.5.1.12.5.3. 8.1.3.5.3 Additional remarks</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#id15">1.5.1.13. 8.2. Inputs</a><ul>
<li><a class="reference internal" href="#atm-bumps">1.5.1.13.1. 8.2.1. ATM bumps</a></li>
<li><a class="reference internal" href="#wing-bumps">1.5.1.13.2. 8.2.2. Wing bumps</a></li>
<li><a class="reference internal" href="#limitations-and-risk-considerations">1.5.1.13.3. 8.3 Limitations and Risk Considerations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#comprehensive-testing-and-outcome-analysis-of-the-payoff-model-and-portfolio">1.5.1.14. 9. Comprehensive Testing and Outcome Analysis of the Payoff, Model, and Portfolio</a><ul>
<li><a class="reference internal" href="#testing-plan">1.5.1.14.1. 9.1 Testing Plan</a></li>
<li><a class="reference internal" href="#repricing-of-fx-volatility-inputs">1.5.1.14.2. 9.1.1 Repricing of FX Volatility Inputs</a></li>
<li><a class="reference internal" href="#skew-event-model-implementation">1.5.1.14.3. 9.1.2 Skew Event Model Implementation</a></li>
<li><a class="reference internal" href="#atm-time-interpolation-variance-interpolation-backbone">1.5.1.14.4. 9.1.5 ATM Time Interpolation: Variance Interpolation Backbone</a></li>
<li><a class="reference internal" href="#atm-time-interpolation-mean-reverting-backbone">1.5.1.14.5. 9.1.6 ATM Time Interpolation: Mean Reverting Backbone</a></li>
<li><a class="reference internal" href="#wing-time-interpolation">1.5.1.14.6. 9.1.7 Wing Time Interpolation</a></li>
<li><a class="reference internal" href="#extrapolation">1.5.1.14.7. 9.1.8 Extrapolation</a></li>
<li><a class="reference internal" href="#bumping">1.5.1.14.8. 9.1.9 Bumping</a></li>
<li><a class="reference internal" href="#back-testing">1.5.1.14.9. 9.2 Back-Testing</a></li>
<li><a class="reference internal" href="#scenario-and-stress-testing">1.5.1.14.10. 9.3 Scenario and Stress Testing</a></li>
<li><a class="reference internal" href="#check-that-the-ratio-of-bumped-volatility-are-correct-fxvol-test-30">1.5.1.14.11. 9.3.1. Check that the ratio of bumped volatility are correct: FXVol Test 30</a></li>
<li><a class="reference internal" href="#recalculate-manually-near-far-rega-sega-risk-fxvol-test-32">1.5.1.14.12. 9.3.2. Recalculate manually Near/Far Rega/Sega Risk: FXVol Test 32</a></li>
<li><a class="reference internal" href="#check-these-risks-calculated-with-jacobian-against-risk-with-pure-bumps-fxvol-test-33">1.5.1.14.13. 9.3.3. Check these risks calculated with Jacobian against risk with pure bumps: FXVol Test 33</a></li>
<li><a class="reference internal" href="#check-volatility-on-a-strike-ladder-for-very-large-bumps-of-volatility-quotes-fxvol-test-34">1.5.1.14.14. 9.3.4. Check volatility on a strike ladder for very large bumps of volatility quotes: FXVol Test 34</a></li>
<li><a class="reference internal" href="#bump-atm-volatility-until-the-smile-model-is-not-able-to-build-fxvol-test-36">1.5.1.14.15. 9.3.6. Bump ATM volatility until the smile model is not able to build: FXVol Test 36</a></li>
<li><a class="reference internal" href="#bump-simultaneously-atm-risk-reversals-and-strangles-for-a-large-set-of-values-fxvol-test-37">1.5.1.14.16. 9.3.7. Bump simultaneously ATM, risk reversals and strangles for a large set of values: FXVol Test 37</a></li>
</ul>
</li>
<li><a class="reference internal" href="#statistical-testing">1.5.1.15. 9.4. Statistical Testing</a></li>
<li><a class="reference internal" href="#impact-of-assumptions-and-limitations">1.5.1.16. 9.5. Impact of Assumptions and Limitations</a></li>
<li><a class="reference internal" href="#accuracy-convergence-stability-and-sensitivity">1.5.1.17. 9.6. Accuracy, Convergence, Stability and Sensitivity</a><ul>
<li><a class="reference internal" href="#accuracy-and-convergence">1.5.1.17.1. 9.6.1. Accuracy and Convergence</a></li>
<li><a class="reference internal" href="#reconcile-externally-against-qa-a-query-between-2-tenors-in-monotone-cubic-variance-interpolation">1.5.1.17.2. 9.6.3. Reconcile externally against QA a query between 2 tenors in monotone cubic variance interpolation</a></li>
<li><a class="reference internal" href="#implement-externally-mr-backbone-computation-5-params-with-ew-and-reconcile-against-qa-query">1.5.1.17.3. 9.6.4. Implement externally MR backbone computation 5 params with EW and reconcile against QA query</a><ul>
<li><a class="reference internal" href="#repricing-of-market-quotes">1.5.1.17.3.1. 9.6.4.1. Repricing of market quotes</a></li>
<li><a class="reference internal" href="#atm-conventions">1.5.1.17.3.2. 9.6.4.2. ATM conventions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#low-fly-correction-fxvol-test-12">1.5.1.17.4. 9.7.1. Low fly correction: FXVol Test 12</a><ul>
<li><a class="reference internal" href="#negative-smile-term">1.5.1.17.4.1. 9.7.1.1. Negative <span class="math notranslate nohighlight">\(smile\)</span> term</a><ul>
<li><a class="reference internal" href="#three-points-low-fly-correction">1.5.1.17.4.1.1. 9.7.1.1.1 Three-points low fly correction</a></li>
<li><a class="reference internal" href="#five-points-low-fly-correction">1.5.1.17.4.1.2. 9.7.1.1.2 Five-points low fly correction</a></li>
</ul>
</li>
<li><a class="reference internal" href="#positive-smile-term-and-negative-a">1.5.1.17.4.2. 9.7.1.2. Positive <span class="math notranslate nohighlight">\(smile\)</span> term and negative <span class="math notranslate nohighlight">\(a\)</span></a></li>
<li><a class="reference internal" href="#positive-smile-term-and-negative-smile-a">1.5.1.17.4.3. 9.7.1.3. Positive <span class="math notranslate nohighlight">\(smile\)</span> term and negative <span class="math notranslate nohighlight">\(smile + a\)</span></a></li>
</ul>
</li>
<li><a class="reference internal" href="#local-volatility-quartic-model-vs-low">1.5.1.17.5. 9.7.2. Local volatility quartic model vs low</a><ul>
<li><a class="reference internal" href="#bucketed-vega-rega-sega-of-a-one-touch-up-option">1.5.1.17.5.1. 9.7.2.1. Bucketed Vega/Rega/Sega of a One-touch up option</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#comparison-to-other-models">1.5.1.18. 9.8. Comparison to Other Models</a></li>
<li><a class="reference internal" href="#other-outcome-analysis-testing">1.5.1.19. 9.9. Other Outcome Analysis / Testing</a></li>
<li><a class="reference internal" href="#general-limitations">1.5.1.20. 10. General Limitations</a><ul>
<li><a class="reference internal" href="#key-assumptions">1.5.1.20.1. Key Assumptions</a></li>
<li><a class="reference internal" href="#numerical-approximations">1.5.1.20.2. Numerical Approximations</a></li>
<li><a class="reference internal" href="#market-conditions">1.5.1.20.3. Market Conditions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#model-monitoring-kpis">1.5.1.21. 11. Model Monitoring  KPIs</a><ul>
<li><a class="reference internal" href="#monitoring-tests-and-key-performance-indicators-kpi">1.5.1.21.1. 11.1. Monitoring Tests and Key Performance Indicators (KPI)</a></li>
<li><a class="reference internal" href="#performance-exceptions">1.5.1.21.2. 11.2. Performance Exceptions</a></li>
<li><a class="reference internal" href="#exception-mitigation-plan">1.5.1.21.3. 11.3. Exception Mitigation Plan</a></li>
</ul>
</li>
<li><a class="reference internal" href="#summary-of-feedback-received-during-development">1.5.1.22. 12. Summary of Feedback Received During Development</a><ul>
<li><a class="reference internal" href="#recent-feedback-and-actions">1.5.1.22.1. Recent Feedback and Actions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#references">1.5.1.23. 13. References</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=454d727b"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=32e29ea5"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=ab308175"></script>
    <script src="../../_static/custom.js?v=92eda4d4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="../../_static/design-tabs.js?v=36754332"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "displayMath": [["$$", "$$"], ["\\[", "\\]"]], "processEscapes": true, "processEnvironments": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/custom.js?v=92eda4d4"></script>
    </body>
</html>