<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="author" title="About these documents" href="../../about.html" /><link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="FX Analytic Volatility Surfaces" href="../Fx/fx_volatility_surface.html" /><link rel="prev" title="Cheyette Local Vol Model" href="../Cheyette/Cheyette_Model.html" />

    <link rel="shortcut icon" href="../../_static/xsigma_favicon.png"/><!-- Generated with Sphinx 7.2.6 and Furo 2023.09.10 -->
        <title>Curve Construction and Risk Framework (New Curve Framework) - XSIGMA documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">XSIGMA  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../../_static/Logo.ico" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">XSIGMA  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../about.html">About</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../index.html">Market</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Market</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../Cheyette/Cheyette_Model.html">Cheyette Local Vol Model</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Curve Construction and Risk Framework (New Curve Framework)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Fx/fx_volatility_surface.html">FX Analytic Volatility Surfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ir/Linear_Interest_Rate_Swaps.html">Linear Interest Rate Swaps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Local_Volatility_PDE_MC/Local_Volatility_PDE_MC.html">Local Volatility: PDE and MC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Implied%20Volatility%20Filter/Implied_Volatility_Filter.html">Implied Volatility Filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Model%20RateDeterministic/RateDeterministic.html">The model RateDeterministic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Model%20Short%20Rate%20Normal/Short_Rate_Normal.html">Short Rate Normal Model Validation Document</a></li>
<li class="toctree-l2"><a class="reference internal" href="../DBX-ShortRate%20and%20FX%20Skew%20Stochastic%20Volatility%20models/DBX-ShortRate_FXSkewStochVol.html">DBX-ShortRate_FXSkewStochVol Document</a></li>
<li class="toctree-l2"><a class="reference internal" href="../DBX-ShortRate%20and%20FX%20Skew%20Stochastic%20Volatility%20models/DBX-ShortRate_FXSkewStochVol.html#table-102-difference-in-implied-volatility-between-the-market-and-model-for-different-starting-localvols-in-the-domestic-jpy-ir-vol-object">Table 102: Difference in implied volatility between the market and model for different starting LocalVols in the domestic (JPY) IR vol object.</a></li>
<li class="toctree-l2"><a class="reference internal" href="../DBX-ShortRate%20and%20FX%20Skew%20Stochastic%20Volatility%20models/DBX-ShortRate_FXSkewStochVol.html#table-103-difference-in-price-between-the-market-and-model-for-different-starting-localvols-in-the-domestic-jpy-ir-vol-object">Table 103: Difference in price between the market and model for different starting LocalVols in the domestic (JPY) IR vol object.</a></li>
<li class="toctree-l2"><a class="reference internal" href="../DBX-ShortRate%20and%20FX%20Skew%20Stochastic%20Volatility%20models/DBX-ShortRate_FXSkewStochVol.html#table-104-difference-in-implied-volatility-between-the-market-and-model-for-different-starting-localvols-in-the-foreign-aud-ir-vol-object">Table 104: Difference in implied volatility between the market and model for different starting LocalVols in the foreign (AUD) IR vol object.</a></li>
<li class="toctree-l2"><a class="reference internal" href="../DBX-ShortRate%20and%20FX%20Skew%20Stochastic%20Volatility%20models/DBX-ShortRate_FXSkewStochVol.html#table-105-difference-in-price-between-the-market-and-model-for-different-starting-localvols-in-the-foreign-aud-ir-vol-object">Table 105: Difference in price between the market and model for different starting LocalVols in the foreign (AUD) IR vol object.</a></li>
<li class="toctree-l2"><a class="reference internal" href="../SABR/SABR.html">Interest Rate Volatility Model GSABR</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../LSV/LSV.html">LSV</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of LSV</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../LSV/FX%20LSV%20Markov%20Switching%20%20Monte%20Carlo/FX_LSV_Markov_Switching_Monte_Carlo.html">FX LSV Markov Switching : Monte Carlo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../LSV/FX%20LSV%20Markov%20Switching%20PDE/FX_LSV_Markov_Switching_PDE.html">FX LSV Markov Switching : PDE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../LSV/Local%20Volatility%20PDE%20and%20MC/Local_Volatility_PDE_and_MC.html">Local Volatility: PDE and MC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../LSV/LSV%20Markov%20Switching%20%20Monte%20Carlo/LSV_Markov_Switching_Monte_Carlo.html">LSV Markov Switching : Monte Carlo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../LSV/LSV%20Markov%20Switching%20%20PDE/LSV_Markov_Switching_PDE.html">LSV Markov Switching : PDE</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../learning.html">Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../supported_data_formats.html">Supported Data Formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../supported_hardware.html">Supported Hardware</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../modules/index.html">Modules</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Modules</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../modules/xsigma-modules/Wrapping/PythonCore/README.html">Python Wrapper Core Classes</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../build_instructions/index.html">Building</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Building</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../build_instructions/build_settings.html">Build Settings</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../api/index.html">API</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of API</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../api/cpp.html">C++</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../api/python.html">Python</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Python</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of xsigmamodules</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.common.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.common</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of xsigmamodules.common</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.common.helper.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.common.helper</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.common.instrument.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.common.instrument</span></code></a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.market.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.market</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of xsigmamodules.market</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.market.market_data.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.market.market_data</span></code></a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.simulation.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.simulation</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of xsigmamodules.simulation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.simulation.simulation.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.simulation.simulation</span></code></a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.test.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.test</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of xsigmamodules.test</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.test.BlackBox.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.test.BlackBox</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.test.Testing.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.test.Testing</span></code></a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.util.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.util</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of xsigmamodules.util</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.util.misc.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.util.misc</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.util.numpy_support.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.util.numpy_support</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.util.object_converter.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.util.object_converter</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.util.xsigmaConstants.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.util.xsigmaConstants</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.util.xsigmaMethodParser.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.util.xsigmaMethodParser</span></code></a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.xlwing.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.xlwing</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of xsigmamodules.xlwing</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.xlwing.hartman_watson_template.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.xlwing.hartman_watson_template</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.xlwing.sabr_template.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.xlwing.sabr_template</span></code></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../api/python/xsigmamodules/xsigmamodules.generate_pyi.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">xsigmamodules.generate_pyi</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../api/cmake/cmake-modules.html">CMake</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of CMake</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/cmake/ModuleSystem.html">Module System</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/cmake/xsigmaModule.html">xsigmaModule</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/cmake/xsigmaModuleTesting.html">xsigmaModuleTesting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/cmake/xsigmaModuleWrapPython.html">xsigmaModuleWrapPython</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/cmake/xsigmaModuleWrapJava.html">xsigmaModuleWrapJava</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/cmake/xsigmaModuleJSON.html">xsigmaModuleJSON</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/cmake/xsigmaModuleGraphviz.html">xsigmaModuleGraphviz</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../advanced/index.html">Advanced Topics</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle navigation of Advanced Topics</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../advanced/available_python_wheels.html">Additional Python Wheels</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../advanced/spdx_and_sbom.html">SPDX &amp; SBOM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../advanced/build_python_wheels.html">Building Python Wheels</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../advanced/build_wasm_emscripten.html">Building using emscripten for WebAssembly</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../advanced/build_for_mobile.html">Cross-compiling for Mobile devices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../advanced/build_documentation.html">Building documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../advanced/marshalling_hints.html">Marshalling Hints</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../advanced/object_manager.html">Object manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../advanced/object_serialization.html">Auto serialization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../advanced/PythonWrappers.html">Python Wrappers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../advanced/runtime_settings.html">Runtime settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../advanced/WrappingTools.html">Wrapping Tools</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../advanced/migration_guides/index.html">Migration Guides</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle navigation of Migration Guides</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../advanced/migration_guides/ModuleMigration.html">Module Migration from XSIGMA 8.2 to 9+</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../design_documents/index.html">Design Documents</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle navigation of Design Documents</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../design_documents/XSIGMAFileFormats.html">XSIGMA File Formats</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../design_documents/smptools.html">Parallel Processing with XSIGMA’s SMP Framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../design_documents/data_assemply.html">Data Assembly</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../developers_guide/index.html">Developer’s Guide</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle navigation of Developer’s Guide</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../developers_guide/git/develop.html">Develop</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developers_guide/testing.html">Regression Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developers_guide/git/test.html">Adding Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developers_guide/git/dashboard.html">Dashboard Scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developers_guide/git/thirdparty.html">Imported Third Party Projects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developers_guide/git/thirdparty-projects.html">Imported Third Party Projects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developers_guide/git/deprecation.html">Deprecation Process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developers_guide/release_process.html">Release Process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developers_guide/coding_conventions.html">Coding Conventions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developers_guide/about_this_documentation.html">About this documentation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../resources.html">Resources</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../release_details/index.html">Release Details</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle navigation of Release Details</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section class="tex2jax_ignore mathjax_ignore" id="curve-construction-and-risk-framework-new-curve-framework">
<h1>Curve Construction and Risk Framework (New Curve Framework)<a class="headerlink" href="#curve-construction-and-risk-framework-new-curve-framework" title="Link to this heading">#</a></h1>
<section id="table-of-contents">
<h2>Table of Contents<a class="headerlink" href="#table-of-contents" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="#curve-construction-and-risk-framework-new-curve-framework">Curve Construction and Risk Framework (New Curve Framework)</a></p>
<ul>
<li><p><a class="reference internal" href="#table-of-contents">Table of Contents</a></p></li>
<li><p><a class="reference internal" href="#executive-summary">1. Executive Summary</a></p></li>
<li><p><a class="reference internal" href="#scope">2. Scope</a></p>
<ul>
<li><p><a class="reference internal" href="#model-purpose-and-intended-usage">2.1 Model Purpose and Intended Usage</a></p>
<ul>
<li><p><a class="reference internal" href="#model-purpose">2.1.1 Model Purpose</a></p></li>
<li><p><a class="reference internal" href="#curve-construction">2.1.2 Curve Construction</a></p></li>
<li><p><a class="reference internal" href="#risk-generation">2.1.3 Risk Generation</a></p></li>
<li><p><a class="reference internal" href="#curve-construction-requirements">2.1.4 Curve Construction Requirements</a></p>
<ul>
<li><p><a class="reference internal" href="#date-node-structure">2.1.4.1 Date/Node Structure</a></p></li>
<li><p><a class="reference internal" href="#arbitrage-free-single-set-of-market-data">2.1.4.2 Arbitrage-Free (Single Set of Market Data)</a></p></li>
<li><p><a class="reference internal" href="#global-consistency">2.1.4.3 Global Consistency</a></p></li>
<li><p><a class="reference internal" href="#correct-cross-currency-basis">2.1.4.4 Correct Cross-Currency Basis</a></p></li>
<li><p><a class="reference internal" href="#complex-interpolation">2.1.4.5 Complex Interpolation</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#intended-use">2.1.5 Intended Use</a></p>
<ul>
<li><p><a class="reference internal" href="#valuation-and-curve-usage">2.1.5.1 Valuation and Curve Usage</a></p></li>
<li><p><a class="reference internal" href="#risk">2.1.5.2 Risk</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#conceptual-soundness">2.2 Conceptual Soundness</a></p>
<ul>
<li><p><a class="reference internal" href="#literature-review">2.2.1 Literature Review</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#product-payoff-portfolio">3. Product / Payoff / Portfolio</a></p>
<ul>
<li><p><a class="reference internal" href="#description">3.1 Description</a></p>
<ul>
<li><p><a class="reference internal" href="#curve-engine">3.1.1 Curve Engine</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#relationship-to-other-approved-models-payoffs">3.2 Relationship to Other Approved Models/Payoffs</a></p></li>
<li><p><a class="reference internal" href="#inputs">3.3 Inputs</a></p>
<ul>
<li><p><a class="reference internal" href="#ad-or-fd">3.3.1 AD or FD</a></p></li>
<li><p><a class="reference internal" href="#curve-queries">3.3.2 Curve Queries</a></p>
<ul>
<li><p><a class="reference internal" href="#discount-factor">3.3.2.1 Discount Factor</a></p></li>
<li><p><a class="reference internal" href="#forward-rate">3.3.2.2 Forward Rate</a></p></li>
<li><p><a class="reference internal" href="#index-value">3.3.2.3 Index Value</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#notation">3.3.3 Notation</a></p></li>
<li><p><a class="reference internal" href="#curve-types-internal-representation">3.3.4 Curve Types - Internal Representation</a></p>
<ul>
<li><p><a class="reference internal" href="#discount-factor-curves">3.3.4.1 Discount Factor Curves</a></p></li>
<li><p><a class="reference internal" href="#forward-rate-curves">3.3.4.2 Forward Rate Curves</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#curve-types-external-usage-taxonomy">3.3.5 Curve Types - External Usage (Taxonomy)</a></p>
<ul>
<li><p><a class="reference internal" href="#discount-curve">3.3.5.1 Discount Curve</a></p></li>
<li><p><a class="reference internal" href="#forecast-curve">3.3.5.2 Forecast Curve</a></p></li>
<li><p><a class="reference internal" href="#inflation-index-curves">3.3.5.3 Inflation (Index) Curves</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#table">3.3.6 Table</a></p></li>
<li><p><a class="reference internal" href="#price-rate">3.3.7 Price/Rate</a></p></li>
<li><p><a class="reference internal" href="#instruments">3.3.8 Instruments</a></p>
<ul>
<li><p><a class="reference internal" href="#convexity">3.3.8.1 Convexity</a></p></li>
<li><p><a class="reference internal" href="#3382-daycount-fraction-tau"><span class="xref myst">3.3.8.2 Daycount Fraction (<span class="math notranslate nohighlight">\(\\tau\)</span>)</span></a></p></li>
<li><p><a class="reference internal" href="#deposit-forward-rate">3.3.8.3 Deposit/Forward Rate</a></p></li>
<li><p><a class="reference internal" href="#future">3.3.8.4 Future</a></p>
<ul>
<li><p><a class="reference internal" href="#m-3m-future">3.3.8.4.1 1m/3m Future</a></p></li>
<li><p><a class="reference internal" href="#averaging-future">3.3.8.4.2 Averaging Future</a></p></li>
<li><p><a class="reference internal" href="#compounding-future">3.3.8.4.3 Compounding Future</a></p></li>
<li><p><a class="reference internal" href="#convexity-and-the-front-future">3.3.8.4.4 Convexity and the Front Future</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#payoff">3.3.8.4.5. Payoff</a></p></li>
<li><p><a class="reference internal" href="#penalty-function-scaling">3.3.8.4.6. Penalty function scaling</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#swap">3.3.8.5. Swap</a></p></li>
<li><p><a class="reference internal" href="#forward-spread">3.3.8.6. Forward Spread</a></p></li>
<li><p><a class="reference internal" href="#basis-swap-may-be-referred-to-as-tenor-basis-swap">3.3.8.7. Basis Swap (may be referred to as Tenor Basis Swap)</a></p></li>
<li><p><a class="reference internal" href="#fx-forward">3.3.8.8. FX Forward</a>
- <a class="reference internal" href="#id1">3.3.8.8.1 Penalty function scaling</a>
- <a class="reference internal" href="#cross-currency-basis-swap">3.3.8.9. Cross Currency Basis Swap</a>
- <a class="reference internal" href="#i-o-mtm-cross-currency-basis-swap">3.3.8.10 I/O MTM Cross Currency Basis Swap</a>
- <a class="reference internal" href="#cross-currency-swap">3.3.8.11 Cross Currency Swap</a>
- <a class="reference internal" href="#33812-mtm-gross-currency-swap"><span class="xref myst">3.3.8.12 MTM Gross Currency Swap</span></a>
- <a class="reference internal" href="#33813-swap-spread-spread-between-two-swaps"><span class="xref myst">3.3.8.13 (Swap) Spread (spread between two swaps)</span></a>
- <a class="reference internal" href="#spread-constraint">3.3.8.14 Spread Constraint</a>
- <a class="reference internal" href="#id2">3.3.8.14.1 Payoff</a>
- <a class="reference internal" href="#id3">3.3.8.14.2 Penalty function scaling</a>
- <a class="reference internal" href="#fly-butterfly-between-three-swaps">3.3.8.15 Fly (butterfly between three swaps)</a>
- <a class="reference internal" href="#fly-constraint-butterfly-between-any-other-three-instruments">3.3.8.16 Fly Constraint (butterfly between any other three instruments)</a>
- <a class="reference internal" href="#id4">3.3.8.16.1. Payoff</a>
- <a class="reference internal" href="#calculate-coefficients">3.3.8.16.2. Calculate Coefficients</a>
- <a class="reference internal" href="#id5">3.3.8.16.3. Penalty function scaling</a>
- <a class="reference internal" href="#term-deposit">3.3.8.17. Term Deposit</a>
- <a class="reference internal" href="#turn">3.3.8.18. Turn</a>
- <a class="reference internal" href="#jump">3.3.8.19 Jump</a>
- <a class="reference internal" href="#ibor-jump">3.3.8.20 Ibor Jump</a>
- <a class="reference internal" href="#nominal-bond">3.3.8.21 (Nominal) Bond</a>
- <a class="reference internal" href="#penalty-function-calculation">3.3.8.21.1 Penalty function calculation</a>
- <a class="reference internal" href="#inflation-instruments-lag-and-instrument-interpolation">3.3.8.22 Inflation Instruments Lag and Instrument Interpolation</a>
- <a class="reference internal" href="#inflation-lag">3.3.8.22.1. Inflation lag</a>
- <a class="reference internal" href="#inflation-instrument-interpolation">3.3.8.22.2 Inflation instrument interpolation</a>
- <a class="reference internal" href="#flat">3.3.8.22.2.1 Flat</a>
- <a class="reference internal" href="#linear">3.3.8.22.2.2. Linear</a>
- <a class="reference internal" href="#natural">3.3.8.22.2.3. Natural</a>
- <a class="reference internal" href="#swedish-and-icelandic-inflation-bond-interpolation">3.3.8.22.2.4. Swedish and Icelandic inflation bond interpolation</a>
- <a class="reference internal" href="#australian-inflation-bond-interpolation">3.3.8.22.2.5. Australian inflation bond interpolation</a>
- <a class="reference internal" href="#mexican-inflation-bond-interpolation">3.3.8.22.2.6. Mexican inflation bond interpolation</a>
- <a class="reference internal" href="#unused-interpolation-types">3.3.8.22.2.7. Unused interpolation types</a>
- <a class="reference internal" href="#inflation-zero-coupon-swap">3.3.8.23 Inflation Zero Coupon Swap</a>
- <a class="reference internal" href="#id6">3.3.8.23.1. Payoff</a>
- <a class="reference internal" href="#inflation-future">3.3.8.24. Inflation Future</a>
- <a class="reference internal" href="#inflation-bond">3.3.8.25. Inflation Bond</a>
- <a class="reference internal" href="#id7">3.3.8.25.1. Penalty function calculation</a>
- <a class="reference internal" href="#real-rate-swap">3.3.8.26 Real Rate Swap</a>
- <a class="reference internal" href="#inflation-bond-spread-coupon-spread-ncf-name-inflation-asset-swap-spread">3.3.8.27 Inflation Bond Spread (Coupon Spread) [NCF name: Inflation Asset Swap Spread]</a>
- <a class="reference internal" href="#seasonality">3.3.8.28 Seasonality</a></p>
<ul>
<li><p><a class="reference internal" href="#interpolation">3.3.9 Interpolation</a></p>
<ul>
<li><p><a class="reference internal" href="#geometric-log-linear">3.3.9.1 Geometric/log linear</a></p>
<ul>
<li><p><a class="reference internal" href="#extrapolation">3.3.9.1.1 Extrapolation</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#linear-zero-rate-interpolation-exponential">3.3.9.2 Linear Zero Rate Interpolation (‘Exponential’)</a></p>
<ul>
<li><p><a class="reference internal" href="#id8">3.3.9.2.1. Extrapolation</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#log-cubic">3.3.9.3. Log-cubic</a></p>
<ul>
<li><p><a class="reference internal" href="#id9">3.3.9.3.1. Extrapolation</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#cpi-linear-inflation-curves-only">3.3.9.4. CPI linear (inflation curves only)</a></p></li>
<li><p><a class="reference internal" href="#local-discount-factor-curve-inflation-representation">3.3.9.4.1 Local, Discount Factor Curve (Inflation Representation)</a></p>
<ul>
<li><p><a class="reference internal" href="#id10">3.3.9.4.1. Extrapolation</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#linear-rate">3.3.9.5. Linear Rate</a></p></li>
<li><p><a class="reference internal" href="#local-forward-rate-curve">3.3.9.5.1 Local, Forward Rate Curve</a></p>
<ul>
<li><p><a class="reference internal" href="#id11">3.3.9.5.1. Extrapolation</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#quadratic-rate">3.3.9.6. Quadratic Rate</a></p>
<ul>
<li><p><a class="reference internal" href="#right-gradient">3.3.9.6.1. Right gradient</a></p></li>
<li><p><a class="reference internal" href="#left-gradient">3.3.9.6.2. Left gradient</a></p></li>
<li><p><a class="reference internal" href="#id12">3.3.9.6.3. Extrapolation</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#id14">3.3.10 Seasonality</a></p></li>
<li><p><a class="reference internal" href="#interpolation-choice-and-granularity-of-market-data">3.3.11 Interpolation choice and granularity of market data</a></p>
<ul>
<li><p><a class="reference internal" href="#granular-market-data-granular-node-dates-local-interpolation">3.3.11.1. Granular market data (granular node dates) =&gt; local interpolation</a></p>
<ul>
<li><p><a class="reference internal" href="#linear-interpolation-of-1m-3m-fwds">3.3.11.1.1 Linear interpolation of 1m/3m fwds</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#sparse-market-data-sparse-node-dates-smooth-interpolation">3.3.11.2. Sparse market data (sparse node dates) -&gt; smooth interpolation</a></p></li>
<li><p><a class="reference internal" href="#split-interpolation">3.3.11.3. Split Interpolation</a></p></li>
<li><p><a class="reference internal" href="#single-interpolators">3.3.11.4. Single interpolators</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#implementation-specificities">3.3.12. Implementation specificities</a></p>
<ul>
<li><p><a class="reference internal" href="#discounting">3.3.12.1. Discounting</a></p>
<ul>
<li><p><a class="reference internal" href="#g7-currencies-curve-calibration">3.3.12.1.1 G7 Currencies Curve Calibration</a></p></li>
<li><p><a class="reference internal" href="#other-currencies-curve-calibration">3.3.12.1.2 Other Currencies Curve Calibration</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#ccp-aware-curves">3.3.12.2 CCP-Aware Curves</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#jpy-ccp-basis">JPY CCP basis</a></p></li>
<li><p><a class="reference internal" href="#outputs">3.4 Outputs</a></p>
<ul>
<li><p><a class="reference internal" href="#curve-representation">3.4.1 Curve representation</a></p>
<ul>
<li><p><a class="reference internal" href="#multiple-interpolators">3.4.1.1. Multiple interpolators</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#curve-market-data-object">3.4.2 Curve Market Data object</a></p></li>
<li><p><a class="reference internal" href="#risk-market-data-object">3.4.3 Risk Market Data object</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#payoff-analysis">3.5 Payoff Analysis</a></p></li>
<li><p><a class="reference internal" href="#portfolio-description-and-trends">3.6 Portfolio description and trends</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#model-methodology">4. Model / Methodology</a></p>
<ul>
<li><p><a class="reference internal" href="#id15">4.1 Description</a></p>
<ul>
<li><p><a class="reference internal" href="#model-design-development">4.1.1 Model design &amp; development</a></p>
<ul>
<li><p><a class="reference internal" href="#objective-function">4.1.1.1 Objective function</a></p></li>
<li><p><a class="reference internal" href="#optimisation-1">4.1.1.2 Optimisation (1)</a></p>
<ul>
<li><p><a class="reference internal" href="#nag-parameters">4.1.1.2.1 NAG parameters</a></p></li>
<li><p><a class="reference internal" href="#maxcal">4.1.1.2.1.1 MAXCAL</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#algorithmic-differentiation">4.1.1.3 Algorithmic Differentiation</a></p></li>
<li><p><a class="reference internal" href="#instrument-penalty">4.1.1.4 Instrument penalty</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#instrument-misprice-and-convergence">4.1.1.5. Instrument misprice and convergence</a></p>
<ul>
<li><p><a class="reference internal" href="#negative-discount-factors">4.1.1.6 Negative discount factors</a></p></li>
<li><p><a class="reference internal" href="#node-dates-degrees-of-freedom">4.1.1.7 Node dates (degrees of freedom)</a></p></li>
<li><p><a class="reference internal" href="#smoothing">4.1.1.8. Smoothing</a></p>
<ul>
<li><p><a class="reference internal" href="#41181-smoothing-penalty-weight-w_curve"><span class="xref myst">4.1.1.8.1. Smoothing penalty weight <span class="math notranslate nohighlight">\((W\_{curve})\)</span></span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#optimisation-2">4.1.1.9. Optimisation (2)</a></p></li>
<li><p><a class="reference internal" href="#inverse-jacobian-matrix">4.1.1.10. (Inverse) jacobian matrix</a></p>
<ul>
<li><p><a class="reference internal" href="#id16">4.1.1.10.1. NAG parameters</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#types-of-curve-build">4.1.1.11. Types of curve build</a></p>
<ul>
<li><p><a class="reference internal" href="#complete-build-initial-construction">4.1.1.11.1. Complete build (initial construction)</a></p></li>
<li><p><a class="reference internal" href="#full-rebuild">4.1.1.11.2. Full rebuild</a></p></li>
<li><p><a class="reference internal" href="#fast-jacobian-rebuild">4.1.1.11.3. Fast (jacobian) rebuild</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#jacobian-rebuild-tolerance">4.1.1.12. Jacobian rebuild tolerance</a></p></li>
<li><p><a class="reference internal" href="#engine-parameters-for-rebuilds">4.1.1.13. Engine parameters for rebuilds</a></p></li>
<li><p><a class="reference internal" href="#solve-stages">4.1.1.14. Solve Stages</a></p>
<ul>
<li><p><a class="reference internal" href="#example">4.1.1.14.1. Example</a></p></li>
<li><p><a class="reference internal" href="#jacobian-rebuild-matrix-solve-stages">4.1.1.14.2. Jacobian rebuild matrix – solve stages</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#regulatory-compliance">4.1.2 Regulatory compliance</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#assumptions-limitations-and-outliers">4.2 Assumptions, Limitations and Outliers</a></p>
<ul>
<li><p><a class="reference internal" href="#validation">4.2.1 Validation</a></p>
<ul>
<li><p><a class="reference internal" href="#design">4.2.1.1 Design</a></p></li>
<li><p><a class="reference internal" href="#forward-looking-checks">4.2.1.2 Forward-looking checks</a></p>
<ul>
<li><p><a class="reference internal" href="#test-process">4.2.1.2.1 Test process</a></p></li>
<li><p><a class="reference internal" href="#summary-report">4.2.1.2.2 Summary report</a></p></li>
<li><p><a class="reference internal" href="#error-report">4.2.1.2.3 Error report</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#assumptions-and-limitations">4.2.2 Assumptions and limitations</a></p></li>
<li><p><a class="reference internal" href="#convergence-to-a-global-minimum">4.2.6 Convergence to a global minimum</a></p></li>
<li><p><a class="reference internal" href="#non-convergence-poorly-set-node-dates">4.2.7 Non-convergence – poorly set node dates</a></p></li>
<li><p><a class="reference internal" href="#inappropriate-curve-poorly-set-node-dates">4.2.8 Inappropriate curve – poorly set node dates</a></p></li>
<li><p><a class="reference internal" href="#smoothing-penalty-weight">4.2.9 Smoothing penalty weight</a></p>
<ul>
<li><p><a class="reference internal" href="#too-low">4.2.9.1. Too low</a></p></li>
<li><p><a class="reference internal" href="#too-high">4.2.9.2. Too high</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#smoothing-interpolation-choice">4.2.10 Smoothing &amp; interpolation choice</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#model-parameters-variables">4.3 Model Parameters / Variables</a></p></li>
<li><p><a class="reference internal" href="#model-outputs">4.4 Model Outputs</a></p></li>
<li><p><a class="reference internal" href="#model-uncertainty">4.5 Model Uncertainty</a></p></li>
<li><p><a class="reference internal" href="#risk-factor">4.6 Risk Factor</a></p></li>
<li><p><a class="reference internal" href="#feeder-models">4.7 Feeder Models</a></p></li>
<li><p><a class="reference internal" href="#justification-against-alternative-approaches">4.8 Justification against alternative approaches</a></p></li>
<li><p><a class="reference internal" href="#conditions-of-use">4.9 Conditions of Use</a></p>
<ul>
<li><p><a class="reference internal" href="#stressed-market-conditions">4.9.1 Stressed Market Conditions</a></p></li>
<li><p><a class="reference internal" href="#other">4.9.2 Other</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#implementation-numerical-schema-description">5. Implementation / Numerical Schema Description</a></p>
<ul>
<li><p><a class="reference internal" href="#id17">5.1 Description</a></p></li>
<li><p><a class="reference internal" href="#id18">5.2 Inputs</a></p></li>
<li><p><a class="reference internal" href="#quality-control">5.3 Quality control</a></p></li>
<li><p><a class="reference internal" href="#limitations">5.4 Limitations</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#calibration">6. Calibration</a></p>
<ul>
<li><p><a class="reference internal" href="#id19">6.1 Description</a></p></li>
<li><p><a class="reference internal" href="#id20">6.2 Inputs</a></p>
<ul>
<li><p><a class="reference internal" href="#reference-data-market-data-and-other-data-inputs">6.2.1 Reference Data: Market Data and Other Data Inputs</a></p></li>
<li><p><a class="reference internal" href="#data-sources">6.2.2 Data Sources</a></p></li>
<li><p><a class="reference internal" href="#exchange-price">6.2.3 Exchange price</a></p></li>
<li><p><a class="reference internal" href="#broker-quote">6.2.4 Broker quote</a></p></li>
<li><p><a class="reference internal" href="#manual-input">6.2.5 Manual input</a></p></li>
<li><p><a class="reference internal" href="#data-availability-history">6.2.6 Data availability/history</a></p></li>
<li><p><a class="reference internal" href="#data-quality-and-data-checks">6.2.7 Data quality and data checks</a></p></li>
<li><p><a class="reference internal" href="#calibration-algorithm-inputs">6.2.8 Calibration Algorithm Inputs</a></p></li>
<li><p><a class="reference internal" href="#other-inputs">6.2.9 Other Inputs</a></p></li>
<li><p><a class="reference internal" href="#curves">6.2.10 Curves</a></p>
<ul>
<li><p><a class="reference internal" href="#jacobian-matrix">6.2.10.1. Jacobian matrix</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#63-justification-against-alternative-approaches"><span class="xref myst">6.3 Justification against alternative approaches</span></a></p></li>
<li><p><a class="reference internal" href="#64-quality-control"><span class="xref myst">6.4 Quality control</span></a></p>
<ul>
<li><p><a class="reference internal" href="#641-review-and-testing-before-use"><span class="xref myst">6.4.1 Review and testing before use</span></a></p></li>
<li><p><a class="reference internal" href="#642-forward-testing"><span class="xref myst">6.4.2 Forward testing</span></a></p></li>
<li><p><a class="reference internal" href="#643-eod-engine-build"><span class="xref myst">6.4.3 EOD engine build</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#65-limitations-and-risk-assessment"><span class="xref myst">6.5 Limitations and Risk Assessment</span></a></p>
<ul>
<li><p><a class="reference internal" href="#651-stressed-market-conditions"><span class="xref myst">6.5.1 Stressed Market Conditions</span></a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#7-risk-calculated-by-the-modelpayoff"><span class="xref myst">7. Risk (Calculated by the model/payoff)</span></a></p>
<ul>
<li><p><a class="reference internal" href="#71-description"><span class="xref myst">7.1 Description</span></a></p>
<ul>
<li><p><a class="reference internal" href="#711-ncf-risk"><span class="xref myst">7.1.1 NCF Risk</span></a></p>
<ul>
<li><p><a class="reference internal" href="#7111-forecast-curves"><span class="xref myst">7.1.1.1. Forecast curves</span></a></p></li>
<li><p><a class="reference internal" href="#7112-algorithmic-differentiation"><span class="xref myst">7.1.1.2. Algorithmic Differentiation</span></a></p></li>
<li><p><a class="reference internal" href="#7113-seasonality"><span class="xref myst">7.1.1.3. Seasonality</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#712-graphical-representation"><span class="xref myst">7.1.2 Graphical representation</span></a></p></li>
<li><p><a class="reference internal" href="#713-seasonality"><span class="xref myst">7.1.3 Seasonality</span></a></p></li>
<li><p><a class="reference internal" href="#714-delta"><span class="xref myst">7.1.4 Delta</span></a></p>
<ul>
<li><p><a class="reference internal" href="#7141-jacobian-rebuild"><span class="xref myst">7.1.4.1. Jacobian rebuild</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#715-jacobian-transform"><span class="xref myst">7.1.5 Jacobian transform</span></a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#chain-rule-in-matrix-form"><span class="xref myst">Chain Rule in Matrix Form</span></a></p></li>
<li><p><a class="reference internal" href="#endpmatrixt"><span class="xref myst">\end{pmatrix}^T</span></a></p></li>
<li><p><a class="reference internal" href="#endbmatrix"><span class="xref myst">\end{bmatrix}</span></a>
- <a class="reference internal" href="#application">7.1.5.1. Application</a>
- <a class="reference internal" href="#calculation-of-the-jacobian-transform-matrix">7.1.5.2. Calculation of the Jacobian transform matrix</a>
- <a class="reference internal" href="#numerical-method">7.1.5.2.1. Numerical method</a>
- <a class="reference internal" href="#id21">7.1.5.2.2. Algorithmic Differentiation</a>
- <a class="reference internal" href="#comparison-of-ad-vs-fd">7.1.5.2.3. Comparison of AD vs. FD</a>
- <a class="reference internal" href="#typical-risk-representations">7.1.6 Typical risk representations</a>
- <a class="reference internal" href="#single-outright-curve">7.1.6.1. Single outright curve</a>
- <a class="reference internal" href="#market-instruments">7.1.6.2. Market instruments</a>
- <a class="reference internal" href="#all-outright-curves">7.1.6.3. All outright curves</a></p>
<ul>
<li><p><a class="reference internal" href="#id22">7.2 Inputs</a></p>
<ul>
<li><p><a class="reference internal" href="#shock-size">7.2.1 Shock size</a></p></li>
<li><p><a class="reference internal" href="#id23">7.2.2 AD or FD</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#assumptions-limitations-and-risk-assessment">7.3 Assumptions, Limitations and Risk Assessment</a></p>
<ul>
<li><p><a class="reference internal" href="#jacobian-transform-accuracy">7.3.1 Jacobian transform accuracy</a></p>
<ul>
<li><p><a class="reference internal" href="#suboptimal-transform">7.3.1.1. Suboptimal transform</a></p></li>
<li><p><a class="reference internal" href="#optimal-transform">7.3.1.2. Optimal transform</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#approximation-of-finite-difference">7.3.2    Approximation of finite difference</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#test-and-outcome-analyses-performed-on-payoff-model-portfolio">8. Test and Outcome analyses performed on Payoff/Model/Portfolio</a></p>
<ul>
<li><p><a class="reference internal" href="#back-testing">8.1    Back testing</a></p></li>
<li><p><a class="reference internal" href="#stress-testing">8.2    Stress-testing</a></p>
<ul>
<li><p><a class="reference internal" href="#testing-development-background">8.2.1    Testing/development background</a></p>
<ul>
<li><p><a class="reference internal" href="#currencies">8.2.1.1. Currencies</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#testing-stressed-market-conditions">8.2.2    2008/9 testing – stressed market conditions</a></p>
<ul>
<li><p><a class="reference internal" href="#gbp-16-sep-2008">8.2.2.1. GBP 16-Sep-2008</a></p>
<ul>
<li><p><a class="reference internal" href="#82211----curve-inputs--stress-test"><span class="xref myst">8.2.2.1.1.    Curve inputs – stress test</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#id24">8.2.2.2.    2016/7</a></p>
<ul>
<li><p><a class="reference internal" href="#jpy">8.2.2.2.1.    JPY</a></p></li>
<li><p><a class="reference internal" href="#eur">8.2.2.2.2.    EUR</a></p></li>
<li><p><a class="reference internal" href="#gbp">8.2.2.2.3.    GBP</a></p></li>
<li><p><a class="reference internal" href="#usd">8.2.2.2.4.    USD</a></p></li>
<li><p><a class="reference internal" href="#fd">8.2.2.2.5.    FD</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#shock-sizes">8.2.3    Shock sizes</a></p>
<ul>
<li><p><a class="reference internal" href="#mispricing-of-shocked-curves">8.2.3.1. Mispricing of shocked curves</a></p></li>
<li><p><a class="reference internal" href="#incremental-shocking">8.2.3.2. Incremental shocking</a></p>
<ul>
<li><p><a class="reference internal" href="#id25">8.2.3.2.1.    USD</a></p></li>
<li><p><a class="reference internal" href="#g7">8.2.3.2.2.    G7</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#jacobian-rebuild-accuracy">8.2.4    Jacobian rebuild accuracy</a></p>
<ul>
<li><p><a class="reference internal" href="#finite-difference-in-engine-build">8.2.4.1. Finite difference in engine build</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#extreme-scenario-analysis">8.2.5    Extreme scenario analysis</a></p>
<ul>
<li><p><a class="reference internal" href="#finite-difference">8.2.5.1. Finite difference</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#summary">8.2.6    Summary</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#statistical-testing">8.3    Statistical testing</a></p></li>
<li><p><a class="reference internal" href="#impact-of-assumptions-and-limitations">8.4    Impact of Assumptions and Limitations</a></p>
<ul>
<li><p><a class="reference internal" href="#smoothing-penalty-no-choice-of-nodes">8.4.1    Smoothing penalty - no choice of nodes</a></p>
<ul>
<li><p><a class="reference internal" href="#stepmx">8.5.1.3. STEPMX</a></p></li>
<li><p><a class="reference internal" href="#multiple-parameters">8.5.1.4. Multiple parameters</a></p></li>
<li><p><a class="reference internal" href="#iprint">8.5.1.5. IPRINT</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#fo1blf">8.5.2  FO1BLF</a></p>
<ul>
<li><p><a class="reference internal" href="#t">8.5.2.1. T</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#boundary-cases">8.6  Boundary Cases</a></p>
<ul>
<li><p><a class="reference internal" href="#invalid-price">8.6.1  Invalid price</a></p></li>
<li><p><a class="reference internal" href="#unit-tests">8.6.2  Unit tests</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#comparison-to-other-models">8.7  Comparison to Other Models</a></p></li>
<li><p><a class="reference internal" href="#other-outcome-analysis-testing">8.8  Other Outcome Analysis / Testing</a></p>
<ul>
<li><p><a class="reference internal" href="#development-testing">8.8.1  Development Testing</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#general-limitations">9. General Limitations</a></p>
<ul>
<li><p><a class="reference internal" href="#full-rebuild-time">9.1 Full rebuild time</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#model-monitoring-kpis">10. Model Monitoring – KPIs</a></p>
<ul>
<li><p><a class="reference internal" href="#monitoring-tests-and-key-performance-indicators-kpi">10.1 Monitoring Tests and Key Performance Indicators (KPI)</a></p></li>
<li><p><a class="reference internal" href="#performance-exceptions">10.2 Performance Exceptions</a></p></li>
<li><p><a class="reference internal" href="#exception-mitigation-plan">10.3 Exception Mitigation Plan</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#summary-of-feedback-received-during-development">11. Summary of Feedback Received During Development</a></p></li>
<li><p><a class="reference internal" href="#references">12. References</a></p>
<ul>
<li><p><a class="reference internal" href="#id26">12.1 Literature Review</a></p></li>
<li><p><a class="reference internal" href="#122-internal"><span class="xref myst">12.2 Internal</span></a></p></li>
<li><p><a class="reference internal" href="#nag">12.3 NAG</a></p>
<ul>
<li><p><a class="reference internal" href="#id27">12.4 Algorithmic Differentiation</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</section>
<section id="executive-summary">
<h2>1. Executive Summary<a class="headerlink" href="#executive-summary" title="Link to this heading">#</a></h2>
<p>This document is a technical description of the interest rate and inflation curve construction framework at Xsigma, internally known as the “new curve framework” (NCF). Throughout this document, NCF will be used as this model name.</p>
<p>The purpose of NCF is to provide a complete set of arbitrage-free curves using Rates &amp; FX and inflation instruments (the universe of all possible market data). If further instruments are required, to those described in this document, then the framework provides flexibility to add them. The complete set will encompass all dependencies of fx/sccy market data, i.e., will be accurate, arbitrage-free, and globally consistent.</p>
<p>There are 3 critical parts to ensuring curves constructed have satisfied their purpose:</p>
<ol class="arabic simple">
<li><p>Instruments used in curve construction are correctly implemented, according to the (feder) model documentation, or as documented here.</p></li>
<li><p>All instruments reprice to a tolerance that is immaterial, and not likely to become material under existing, or stressed market conditions. Reprice means that the instrument price calculated from the output curves matches the input price for the instrument used in construction. NCF uses an optimisation to ensure the output curves reprice the instruments. The instrument misprice check thus provides reassurance on the accuracy of this optimisation.</p></li>
<li><p>Curves returned adhere to the interpolation method chosen.</p></li>
</ol>
<p>The test for 2. is performed both before implementation and on a monthly cycle once in production - to check that we have a framework fit for purpose.</p>
<p>These curves will be used for pricing, valuation, and risk.</p>
<p>This same set of instruments available for curve construction can also be used to represent the risk factors for shocking curves and computing risk metrics, but these need not be the same instruments as used to build the curves.</p>
<p>The computation of shocked curves for these risk metrics will employ the rebuilding of a set of curves with the set of shocked market data. Thus, the test of accuracy of applying shocks will require checking of 2. above - that the shock is applied correctly.</p>
<p>It should be noted that this document describes the framework for curve construction and risk - it does not describe any particular implementation, except to provide explanation in sufficient detail.</p>
</section>
<hr class="docutils" />
<section id="scope">
<h2>2. Scope<a class="headerlink" href="#scope" title="Link to this heading">#</a></h2>
<section id="model-purpose-and-intended-usage">
<h3>2.1 Model Purpose and Intended Usage<a class="headerlink" href="#model-purpose-and-intended-usage" title="Link to this heading">#</a></h3>
<section id="model-purpose">
<h4>2.1.1 Model Purpose<a class="headerlink" href="#model-purpose" title="Link to this heading">#</a></h4>
</section>
<section id="curve-construction">
<h4>2.1.2 Curve Construction<a class="headerlink" href="#curve-construction" title="Link to this heading">#</a></h4>
<p>Interest rate and inflation curves are a fundamental building block of pricing, valuation, and risk.</p>
<p>They will be used for linear products - interest rate swaps, FX Forwards, cross-currency swaps, zero-coupon inflation swaps, etc.</p>
<p>They will also be consumed by more complex prices, along with market data (e.g., vol surfaces) and other calibration parameters.</p>
</section>
<section id="risk-generation">
<h4>2.1.3 Risk Generation<a class="headerlink" href="#risk-generation" title="Link to this heading">#</a></h4>
<p>Risk management, and hence risk (in the case of curves, interest rate risk) is always required. This document will cover curve shocking.</p>
<p>The output of NCF for “risk” is not the metrics themselves, but the shocked curves consumed by a price rt or produce those metrics.</p>
<p>For the purposes of testing the Jacobian transform (7.3.1), delta is described in 7.1.4.</p>
</section>
<section id="curve-construction-requirements">
<h4>2.1.4 Curve Construction Requirements<a class="headerlink" href="#curve-construction-requirements" title="Link to this heading">#</a></h4>
<p>The purpose of NCF is to provide a flexible approach to constructing interest rate and inflation curves to satisfy the fundamental requirements above: accurate, arbitrage-free, and globally consistent.</p>
<section id="date-node-structure">
<h5>2.1.4.1 Date/Node Structure<a class="headerlink" href="#date-node-structure" title="Link to this heading">#</a></h5>
<p>To capture the market prices of liquid and tradeable instruments (rich market data), but also the underlying market structure, this can mean:</p>
<ul class="simple">
<li><p>The points used to define the curve (node points) need not lie at the start/end of an instrument.</p></li>
<li><p>There may be more node points (degrees of freedom) than instruments (penalty functions), whereby smoothing is applied to the curve (additional penalty functions to enforce this smoothness).</p></li>
</ul>
</section>
<section id="arbitrage-free-single-set-of-market-data">
<h5>2.1.4.2 Arbitrage-Free (Single Set of Market Data)<a class="headerlink" href="#arbitrage-free-single-set-of-market-data" title="Link to this heading">#</a></h5>
<p>We must build curves with one set of market data (arbitrage-free), by one set of market data we mean a set of market data for all curves captured in a single snap/timestamp. If there are cross-dependencies, e.g., we have three curves that may be inter-dependent then they must be built simultaneously (i.e., in a single process or stage) - 3m (IR Futures), 6m (Swaps) &amp; OIS (discounting). Once these curves are constructed together, other curves that are purely dependent on them (e.g., 1m, 12m) can be constructed using the prices required from the same snap of data.</p>
<p>Typically, we build mid curves - this is the basis on which price inputs are quoted/used. A quoted price that is generated through consumption of the curves would include a bid/offer spread, CVA/FYA adjustment, etc.</p>
<p>Dependent curves - curves that depend on other curves (spread or basis). We build curves in stages e.g., if 1m is dependent on 3m &amp; OIS (but these are not dependent on 1m), then build 1m in a later stage, after the two precedent curves. We retain a single set of market data, to ensure curves are arbitrage-free e.g., if we are using 3s1s basis to derive 1m, then this market data is synchronous with the 3m curve market data. With only two interdependent curves (one for projecting forward rates, one for discounting cashflows) this may be possible in a less sophisticated framework, but not with three interdependent curves.</p>
<p>This could also be expressed as:</p>
<ul class="simple">
<li><p>Single set of market data used. We do not have any conflicts where two instruments define and are priced by the same point(s) on a curve e.g., we use both a 4y outright swap and 3y-4y-5y Fly to define the 4y point.</p></li>
<li><p>All market inputs reprice exactly from the curves. This requires the single set of market data to be the snapshot that produces all curves from that market data (no splitting of market data).</p></li>
</ul>
<p>We can however, show one important counterexample to the “single set of market data”. This is the very short end (&lt;6m) of USD Fed Fund curve. We may have quotes both for Fed Fund Futures and FRAOIS (LIBOR-OIS basis swaps) to define the curve. Neither may be the driver for the curve, so both sets of instruments can be used. This does not break the arbitrage-free principle as the most liquid instrument would be chosen, dependent on market conditions on a particular day.</p>
</section>
<section id="global-consistency">
<h5>2.1.4.3 Global Consistency<a class="headerlink" href="#global-consistency" title="Link to this heading">#</a></h5>
<p>There is a need to use “external” curves - to build a globally consistent set of market data, including fx/xccy inputs, by utilising a single set of USD (&amp; EUR) curves in any currencies that depend on them.</p>
<p>Thus, in terms of the ‘same’ snap of market data, we can ensure the same USD market data is used in the USD curves, and in the curves driven by xccy/fx that use them.</p>
</section>
<section id="correct-cross-currency-basis">
<h5>2.1.4.4 Correct Cross-Currency Basis<a class="headerlink" href="#correct-cross-currency-basis" title="Link to this heading">#</a></h5>
<p>Also called financing bias. This requires the use of three curves to derive a 4th. It is not possible in a simple “yield curve” framework where instruments may only depend on a maximum of two curves.</p>
</section>
<section id="complex-interpolation">
<h5>2.1.4.5 Complex Interpolation<a class="headerlink" href="#complex-interpolation" title="Link to this heading">#</a></h5>
<p>Accurate pricing (a smooth or linear forward curve = no large “steps” in the forward rate, nor discontinuities) and 2.1.4.1 above lead to different interpolation requirements where:</p>
<ul class="simple">
<li><p>Granular market data exists (e.g., a Futures strip informs quarterly granularity on a 3M LIBOR curve), as opposed to</p></li>
<li><p>The longer end of a curve (we may only have 20y, 25y, 30y … swap quotes).</p></li>
</ul>
<p>Thus, a standard developed, where we require two different interpolation schemes for the two regions of the curve.</p>
</section>
</section>
<section id="intended-use">
<h4>2.1.5 Intended Use<a class="headerlink" href="#intended-use" title="Link to this heading">#</a></h4>
<section id="valuation-and-curve-usage">
<h5>2.1.5.1 Valuation and Curve Usage<a class="headerlink" href="#valuation-and-curve-usage" title="Link to this heading">#</a></h5>
<p>The above requirements drive the parameters used to build the curves. Once built, the curves would be queried in the valuation of trades. Types of query (and the types of curve from 3.3.4 below) would be:</p>
<ol class="arabic simple">
<li><p>Forward rates/forecast of fixing (forward rate or discount factor curve), i.e., for any index value required for the floating leg of a trade (swap, FRN, etc.). To give a more specific example, a curve would be built for a forecast of USD LIBOR 3M, this should be used only to project that index (e.g., not 6m LIBOR).</p></li>
<li><p>Discount factor to value a cashflow (discount factor curve), i.e., any valuation of any cashflow would query the correct discount curve built for that purpose. Example - we need to value the EUR leg of a EURUSD FX Forward or xccy swap, if, in our valuation framework, both legs are valued at USD OIS, the curve for the EUR leg is USD OIS “FX’d” into EUR or USDOS-discount curve in EUR. This curve would typically be derived from benchmark EURUSD fx forward and EURUSD xccy basis swap prices.</p></li>
<li><p>Index value (inflation curve). Index values can only be read from inflation curves, and inflation curves only return index values.</p></li>
</ol>
<p>The query used in dependent on the price of any particular trade type.</p>
</section>
<section id="risk">
<h5>2.1.5.2 Risk<a class="headerlink" href="#risk" title="Link to this heading">#</a></h5>
<p>Risk in the NCF is associated somewhat from the flexibility of the curve construction above. There may be spreads between curves and spread/hy instruments that ensure efficient use of inputs, but do not represent a likely trade. Thus, to calculate risk involves:</p>
<ol class="arabic simple">
<li><p>The choice of instruments (the risk factors that will be displayed) – tenors, curve dependencies</p></li>
<li><p>An intermediate step of calculating the shocks to the chosen set of hedge instruments</p></li>
<li><p>Applying the effect of these back onto to the pricing curves.</p></li>
</ol>
<p>This is achieved by the introduction of a risk curve/hedge curve (commonly known as “hedge curve template” - HCT), the instruments of which are bumped instead of those of the pricing curve. Such a HCT in the new framework is more of a collection of hedging instruments rather than an actual curve. In NCF, it is used to generate shocks which will then be applied the curves used for pricing/valuation.</p>
<p>The semi-analytic approach to shedding curves described above will allow us, for example, to apply shocks using a local interpolation method to curves with non-local interpolation (for examples, the shocks can have geometric interpolation, and the underlying curves – log-cubic). It also allows us to generate risk scenarios via linear superposition of the shocks. E.g., apply a parallel shift to all curves (instruments), and then apply individual instrument shocks.</p>
</section>
</section>
</section>
<section id="conceptual-soundness">
<h3>2.2 Conceptual Soundness<a class="headerlink" href="#conceptual-soundness" title="Link to this heading">#</a></h3>
<p>The choice of developing NCF was based on the 5 requirements (2.1.4.1-2.1.4.5) above, and the flexibility required for risk generation (separation of risk factors from the originating curve construction).</p>
<p>This was not done as a comparison to pre-existing approaches (i.e., at the time, 2006, the single-curve Yield Curve approach was in use throughout the bank), but to provide what was needed for business needs.</p>
<p>It was only be deemed fit for purpose once extensively used in pricing (2007-9). This is a robust test – during these years NCF underwent incremental development, and testing in a live production environment. If the curves (the curve construction) are reliable and accurate for pricing intraday, in real-time, they provide an accurate representation of the market data inputs.</p>
<p>We should note 2 things:</p>
<ol class="arabic simple">
<li><p>The soundness of curve construction is simple to determine – do the curves reprice the market data inputs, and follow the desired interpolation. There are tests below.</p></li>
<li><p>The magnitude of using curves daily, during trading hours for pricing – in C4 alone there are over 20000 EOD instances (# currencies * # business days * # regional closes). However, if looking for anomalous behaviour – a problem with optimisation, repricing of instruments or interpolation – one might estimate at least one build of the curves every minute. This is over 4,500,000 instances. If we were to look at each Jacobian rebuild in this time the number would rise to over 200 million.</p></li>
</ol>
<p>Thus, additional justification or testing of conceptual soundness.</p>
<p>Between 2009 and 2011, risk was also tested. The primary test of risk is P&amp;L explain – this was validated in testing for the release of NCF in EOD systems (TQPL) in 2011.</p>
<section id="literature-review">
<h4>2.2.1 Literature Review<a class="headerlink" href="#literature-review" title="Link to this heading">#</a></h4>
<p>The fundamental point of NCF is the use of optimisation to construct the curves. The greater flexibility – choice of instruments, nodes dates, construction of a single market through pre-building dependent curves – are in essence additional features that are the choice of Xsigma for the implementation.</p>
<p>In 2006, and for several years afterwards, (i.e., at the time of creation of NCF) the industry standard was for a traditional, single “bootstrapped” curve construction. Indeed, the problem was seen as one of smoothness &amp; interpolation (Adams &amp; van Deventer (1994), Hagan &amp; West (2006) and Davis &amp; Matiak-Pasier (2009)) and fitting market data accurately with the term structure of the underlying interest rate: Larson &amp; Derry (1994), Brousseau (2002), Knoboldova &amp; Kauermann (2004) and Hagan &amp; West (2008)).</p>
<p>To also quote Adams (2001) “Smoothness is a desirable characteristic of interpolated zero curves not only is it intuitively appealing, but there is some evidence that it provides more accurate pricing of securities.”.</p>
<p>This is largely the opposite of the need for NCF. The development of the framework was to solve the problems with a single curve framework. Notably, the financial crisis of 2008-9 and the widening of Libor-OS basis in particular indicated the need for a different approach (Ito (2010), Bech &amp; Lengwiler (2011)).</p>
<p>At the time of development, NCF was far from the market standard.</p>
<p>Between 2009 and 2013, this changed – the requirement to build multiple curves in a single optimisation became the standard (Mancusopoulos (2009) to Rugengarnana (2013)).</p>
</section>
</section>
</section>
<section id="product-payoff-portfolio">
<h2>3. Product / Payoff / Portfolio<a class="headerlink" href="#product-payoff-portfolio" title="Link to this heading">#</a></h2>
<section id="description">
<h3>3.1 Description<a class="headerlink" href="#description" title="Link to this heading">#</a></h3>
<p>There is no payoff, as such, from a curve construction framework. The output, however, is a set of curves that satisfies the fundamental requirements in 2.1.2 above. We can also note that the curves will be:</p>
<ul class="simple">
<li><p><strong>Accurate</strong>: The curves are defined by the businesses that mark them - FX, Rates Flow, and Inflation trading. Thus, if there is a market-making desk, they mark the curves. If we have no market-maker, then broker quotes (typically a feed from Reuters) would be used. The curves are reviewed by control functions (price tested against external curves - built with broker quotes or consensus data (Totem)).</p></li>
<li><p><strong>Contains all curves required to price and value all products</strong>: Within this, we may have curves implied from another if no market (i.e., no liquid market data) exists - e.g., we may “copy” the 6m curve for use as a 12m curve if we have no quotes for 12m. This allows for a later implementation of that curve once market data becomes available. This allows a clean downstream process. Most importantly, this would allow risk to be shown for instruments against this curve.</p></li>
</ul>
<p>Forecast curves and discount curves: We differentiate curves that are used for valuing cashflows (i.e., provide a discount factor at the payment date) from those that forecast a rate (e.g., a LIBOR curve) or an index (projected index-value). Thus, we may use an OIS curve in both ways.</p>
<section id="curve-engine">
<h4>3.1.1 Curve Engine<a class="headerlink" href="#curve-engine" title="Link to this heading">#</a></h4>
<p>We will use the term “curve engine” in this document. This refers to a single object that builds all the curves required. It will take in the inputs, perform the calibration/optimization, and return curve objects. It will also internally hold a Jacobian matrix.</p>
</section>
</section>
<section id="relationship-to-other-approved-models-payoffs">
<h3>3.2 Relationship to Other Approved Models/Payoffs<a class="headerlink" href="#relationship-to-other-approved-models-payoffs" title="Link to this heading">#</a></h3>
</section>
<section id="inputs">
<h3>3.3 Inputs<a class="headerlink" href="#inputs" title="Link to this heading">#</a></h3>
<section id="ad-or-fd">
<h4>3.3.1 AD or FD<a class="headerlink" href="#ad-or-fd" title="Link to this heading">#</a></h4>
<p>A parameter to govern whether the build of the engine, and hence production of the Jacobian matrix, is performed with AD or FD. See 4.1.1.3.</p>
<p>Before describing the inputs, we will describe three types of curve query (discount factor, forward rate, index value) and three types of curve (discount factor, forward rate, inflation) as seen from the perspective of both internal implementation and external interface. Internally, there are just two representations - discount factors or forward rates.</p>
</section>
<section id="curve-queries">
<h4>3.3.2 Curve Queries<a class="headerlink" href="#curve-queries" title="Link to this heading">#</a></h4>
<p>First, we could describe the types of data that can be validly requested from a curve:</p>
<section id="discount-factor">
<h5>3.3.2.1 Discount Factor<a class="headerlink" href="#discount-factor" title="Link to this heading">#</a></h5>
<p>At time <span class="math notranslate nohighlight">\(T_0\)</span> (curve is built at the evaluation date, ‘today’, <span class="math notranslate nohighlight">\(T_0\)</span>), we can query the curve for a discount factor at time <span class="math notranslate nohighlight">\(t\)</span>:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
df_{T_0,t} \quad \forall \quad t \geq T_0
\]</div>
</div>
</section>
<section id="forward-rate">
<h5>3.3.2.2 Forward Rate<a class="headerlink" href="#forward-rate" title="Link to this heading">#</a></h5>
<p>We can query the curve for a forward rate (simple interest, no compounding) at time <span class="math notranslate nohighlight">\(t\)</span>:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
R_{T_0,t}^{\theta}t, \quad \forall \quad t \geq T_0
\]</div>
</div>
<p>The tenor, or length of the forecast period, is <span class="math notranslate nohighlight">\(\theta\)</span>.</p>
<p><span class="math notranslate nohighlight">\(R_{T_0,t_1,t_2-t_1}\)</span> would indicate the continuously compounded rate between <span class="math notranslate nohighlight">\(t_1\)</span> and <span class="math notranslate nohighlight">\(t_2\)</span>.</p>
<p><span class="math notranslate nohighlight">\(R_{T_0,t_i}\)</span> would indicate the continuously compounded rate at <span class="math notranslate nohighlight">\(t_i\)</span>.</p>
</section>
<section id="index-value">
<h5>3.3.2.3 Index Value<a class="headerlink" href="#index-value" title="Link to this heading">#</a></h5>
<p>This would typically be CPI (inflation); other uses are for the projection of a property index.</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
CPI_{T_0,t}, \quad \forall \quad t \geq t_{\text{index.start}}
\]</div>
</div>
<p><span class="math notranslate nohighlight">\(t_{\text{index.start}}\)</span> is the date of the first inflation index value.</p>
<p>We may query for <span class="math notranslate nohighlight">\(t\)</span> in the past (the curve will contain historic index values as well as a projection of future index values).</p>
</section>
</section>
<section id="notation">
<h4>3.3.3 Notation<a class="headerlink" href="#notation" title="Link to this heading">#</a></h4>
<p>Above, we have used a strict notation, <span class="math notranslate nohighlight">\(R_{T_0,t}^{x}\)</span>, <span class="math notranslate nohighlight">\(df_{T_0,t}\)</span>, and <span class="math notranslate nohighlight">\(CPI_{T_0,t}\)</span>, referencing the evaluation date, <span class="math notranslate nohighlight">\(T_0\)</span>. However, we will, below, drop the <span class="math notranslate nohighlight">\(T_0\)</span> notation, since all curves are built at a single evaluation date, so in all notation, <span class="math notranslate nohighlight">\(T_0\)</span> would be the same.</p>
</section>
<section id="curve-types-internal-representation">
<h4>3.3.4 Curve Types - Internal Representation<a class="headerlink" href="#curve-types-internal-representation" title="Link to this heading">#</a></h4>
<section id="discount-factor-curves">
<h5>3.3.4.1 Discount Factor Curves<a class="headerlink" href="#discount-factor-curves" title="Link to this heading">#</a></h5>
<p>This would be the traditional representation of a “Yield Curve”.</p>
<p>This type of curve is internally represented as discount factors. The curve itself is a table of dates and discount factors, at a set of node points <span class="math notranslate nohighlight">\((t_i)\)</span>. i.e., <span class="math notranslate nohighlight">\((t_i, df_i)\)</span>, <span class="math notranslate nohighlight">\(df_i = 1.0\)</span>. Intermediate discount factors, not on node dates, are interpolated.</p>
<p>Only a discount factor is directly queried from the curve. To query a forward rate from the curve, a start date (<span class="math notranslate nohighlight">\(s\)</span>), end date (<span class="math notranslate nohighlight">\(e\)</span>), and day count fraction (<span class="math notranslate nohighlight">\(\tau_{s,e}\)</span>) are required.</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
R_{s}^{\theta} = \frac{(\frac{df_{s}}{df_{e}} - 1)}{\tau_{s,e}}
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\theta \equiv e - s
\]</div>
</div>
<p>We query for any <span class="math notranslate nohighlight">\(\theta\)</span> - any term/period.</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
R_{s,e} = \frac{\log(\frac{df_{s}}{df_{e}})}{\tau_{s,e}}
\]</div>
</div>
<p>This type of curve can be used as a curve that represents the forecast of an index (e.g., 3M LIBOR) or for discounting.</p>
</section>
<section id="forward-rate-curves">
<h5>3.3.4.2 Forward Rate Curves<a class="headerlink" href="#forward-rate-curves" title="Link to this heading">#</a></h5>
<p>These only validly return a forward rate of tenor <span class="math notranslate nohighlight">\(\theta\)</span>, <span class="math notranslate nohighlight">\(R_{s}^{\theta}\)</span>. This forward rate will be of a single tenor, e.g., <span class="math notranslate nohighlight">\(\theta\)</span> is 3M (LIBOR). In this case, the curve is a table of dates and forward rates, at a set of node points <span class="math notranslate nohighlight">\((t_i)\)</span>. The node points are connected using interpolation (one or more interpolators) in forward rate space.</p>
<p>They are currently not used in end-of-day (EOD) valuation curves, only for intraday pricing.</p>
</section>
</section>
<section id="curve-types-external-usage-taxonomy">
<h4>3.3.5 Curve Types - External Usage (Taxonomy)<a class="headerlink" href="#curve-types-external-usage-taxonomy" title="Link to this heading">#</a></h4>
<section id="discount-curve">
<h5>3.3.5.1 Discount Curve<a class="headerlink" href="#discount-curve" title="Link to this heading">#</a></h5>
<p>This is a curve used to discount cashflows.</p>
<p>A discount curve can only be a discount factor curve.</p>
</section>
<section id="forecast-curve">
<h5>3.3.5.2 Forecast Curve<a class="headerlink" href="#forecast-curve" title="Link to this heading">#</a></h5>
<p>This is a curve used to project the forward rate of a single index (forecast curve).</p>
<p>A forecast curve can be either a discount factor curve or forward rate curve.</p>
</section>
<section id="inflation-index-curves">
<h5>3.3.5.3 Inflation (Index) Curves<a class="headerlink" href="#inflation-index-curves" title="Link to this heading">#</a></h5>
<p>These are internally represented as discount factors, but externally will only return index values.</p>
<p>The curve will also contain the full published inflation (CPI) history.</p>
<p>Typically, the node dates will only be set at the inflation day of month (inflation_day_of_month) for the index. E.g., JPY CPI has inflation_day_of_month = 10, so all node dates in the JPY CPI curve will be on the <span class="math notranslate nohighlight">\(10^{\th}\)</span>. This is enforced for all node dates derived from instrument interpolation (33.8.22.2), except for Natural.</p>
<p><span class="math notranslate nohighlight">\(b\)</span> is the base date for the Index (latest published CPI), so the discount factor representation of the curve will be used for index value queries where <span class="math notranslate nohighlight">\(t &gt; b\)</span>, <span class="math notranslate nohighlight">\(d{f_{b}} = 1.0\)</span>.</p>
<p>Index values can be queried at any date <span class="math notranslate nohighlight">\(t\)</span>, <span class="math notranslate nohighlight">\(t \geq b\)</span>.</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
CPI_{t} = \frac{d{f_{b}}}{d{f_{t}}} CPI_{b} = \frac{CPI_{b}}{d{f_{t}}}
\]</div>
</div>
<p>If <span class="math notranslate nohighlight">\(t &lt; b\)</span>, the inflation curve will return a value with flat interpolation, i.e., if <span class="math notranslate nohighlight">\(t_i \leq t &lt; t_{i+1}\)</span>, <span class="math notranslate nohighlight">\(CPI_{t} = CPI_{t_{i}}\)</span>. <span class="math notranslate nohighlight">\(t_i, t_{i+1}\)</span> are successive published CPIs and therefore fall on <em>inflation</em>,<em>day_of_month</em>.</p>
</section>
</section>
<section id="table">
<h4>3.3.6 Table<a class="headerlink" href="#table" title="Link to this heading">#</a></h4>
<p>We can represent this use of curve types and curve queries as a table:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Curve Type</p></th>
<th class="head"><p>Discount Factor</p></th>
<th class="head"><p>Forward Rate</p></th>
<th class="head"><p>Index Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Discount Factor</p></td>
<td><p>Y</p></td>
<td><p>Y</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>Inflation (Index)</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p>Y</p></td>
</tr>
<tr class="row-even"><td><p>Forward Rate</p></td>
<td><p></p></td>
<td><p>Y</p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="price-rate">
<h4>3.3.7 Price/Rate<a class="headerlink" href="#price-rate" title="Link to this heading">#</a></h4>
<p>The calibration of the engine will be to fit the price <span class="math notranslate nohighlight">\(p\)</span> of each instrument. For the majority of instruments, <span class="math notranslate nohighlight">\(p\)</span> is the rate (swap, deposit, basis swap, …), price (Future, bond), forward points (FX Forward).</p>
<p>For the calibration, a penalty function is provided for each instrument for which an <em>equivalent rate</em> will be used (see 4.1.1 onwards for more detail on the optimization). Thus, a scaling factor may be required.</p>
<ul class="simple">
<li><p>For a Future, the penalty will be scaled by -0.01.</p></li>
<li><p>For bonds, FX forwards, the scaling factor will be calculated (see 33.8.8, 33.8.21, 33.8.25). This is noted below.</p></li>
</ul>
<p>This scaling will also be used when shocking curves for risk, since any instrument shock is also of an equivalent rate (7.1.1).</p>
</section>
<section id="instruments">
<h4>3.3.8 Instruments<a class="headerlink" href="#instruments" title="Link to this heading">#</a></h4>
<p>It is important to note that instruments for curve construction are not necessarily trades; they are chosen for one of two purposes:</p>
<ul class="simple">
<li><p><strong>Pricing</strong>: Accurate curve calibration, generally to allow ease of use, and the correct level of control (enough granularity, as choice of spot or forward space).</p></li>
<li><p><strong>Risk</strong>: A choice of how to view risk in terms of bucketing (e.g., the same buckets across several curves to allow a view in a “grid”) and curve dependencies (e.g., choice of discounting, choice of a single (or multiple) curve(s) with outright instruments).</p></li>
</ul>
<p>Either of these purposes can lead to a situation where a curve calibration instrument is neither a potential trade nor even has financial meaning. Examples:</p>
<ul class="simple">
<li><p><strong>Market Risk</strong>: Consumer risk for V&amp;R in the same buckets across all curves - 1B, 1W, 1M, 3M, … if we have a 3M curve (forecast of 3m rate) that has instruments with no financial meaning and are untraded. Since curves for EOD risk/P&amp;L are all discount factor curves, we can project any forward rate from those curves (3.3.2.2 above).</p></li>
<li><p><strong>Curve Calibration</strong>: The 6M curve (e.g., EURIBOR 6M) may use 3m-tenor instruments at IMM intervals. This is only possible for a discount factor curve. This is to allow accurate marking of the curve (i.e., 6M has the same granularity as the 3M curve marked against, which has Futures on the IMM points), but is marked with instruments of the same tenor. If they were 6m instruments, each instrument would cover 2 IMM periods and would make it less easy to control the rate over a 3m period.</p></li>
</ul>
<p>The following instruments can be used as inputs to curve construction:</p>
<p><strong>Rates:</strong></p>
<p>Swap legs</p>
<p>For greater detail on the formulae and calculation of all swap legs, and all swap types, please see “Linear Interest Rate Swaps” referenced below. MPV and DVD1 calculations would be used.</p>
<section id="convexity">
<h5>3.3.8.1 Convexity<a class="headerlink" href="#convexity" title="Link to this heading">#</a></h5>
<p>Convexity is only an input into the price of an IR Future (3.3.8A) - this will be input or calibrated prior to passing to NCE. In terms of NCE, it is therefore a manual input. In practice, there is no model in place for calculating convexity - it is based on market consensus. There may also be an indication of convexity published on a platform; e.g., Bloomberg.</p>
<p>No other instruments have convexity as an input. The swap formulae are linear, so if there is a swap instrument that would require convexity [misalignment of forecast and accrual periods, arithmetic averaging (Fed Fund), _], the convexity is taken to be removed from the price passed for curve construction. Thus, this could be termed the naive price. In this case, there would be no additional information from providing convexity as an input since “market price-convexity” is equivalent to “naive price” when input into such a linear swap formula.</p>
<p>Convexity is also ignored in Inflation Futures (3.3.8.24) and Fed Fund Futures (Generic Future in 3.3.8.4 below), so “naive price” would have to be input.</p>
<p>A specific example of this is in USD: Fed Fund (arithmetic averaging) vs. 3m LIBOR basis swaps (3.3.8.7) - a convexity adjustment is required, therefore this is calculated externally, and a naive price is the input. Thus, for this example, the output curve will be the underlying rate.</p>
</section>
<section id="daycount-fraction-tau">
<h5>3.3.8.2 Daycount Fraction (<span class="math notranslate nohighlight">\(\tau\)</span>)<a class="headerlink" href="#daycount-fraction-tau" title="Link to this heading">#</a></h5>
<p>Below we make reference to the daycount fraction, <span class="math notranslate nohighlight">\(\tau\)</span>. This will be calculated using the standard rules and conventions for the index/market. The principles, and different daycount bases themselves are described in “Description of Date Bases”.</p>
</section>
<section id="deposit-forward-rate">
<h5>3.3.8.3 Deposit/Forward Rate<a class="headerlink" href="#deposit-forward-rate" title="Link to this heading">#</a></h5>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
p = P_{s} = R_{\theta}^{s} = \frac{\left(\frac{d f_{s}}{d f_{e}} - 1\right)}{\tau_{s,e}}
\]</div>
</div>
<p><span class="math notranslate nohighlight">\(\tau_{s,e}\)</span> is the daycount fraction between start <span class="math notranslate nohighlight">\(s\)</span> and end <span class="math notranslate nohighlight">\(e\)</span> of the forecast period.</p>
</section>
<section id="future">
<h5>3.3.8.4 Future<a class="headerlink" href="#future" title="Link to this heading">#</a></h5>
<p>These are exchange-traded products.</p>
<p><strong>Interest Rate Future:</strong></p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
p = P_{s} = 100[1 - R_{s}^{\theta}] - \text{Convexity}
\]</div>
</div>
<p>The exchange price of the Future, <span class="math notranslate nohighlight">\(p^{\text{exchange}} = 100[1 - R_{s}^{\theta}]\)</span></p>
<p>The above formulae are implemented in NCF, identical to as described in the Model section of “Interest Rate Future’s Pricing”.</p>
<p>The calculation of <span class="math notranslate nohighlight">\(R_{s}^{\theta}\)</span> is purely governed by the convention of the instrument. The typical examples are:</p>
<section id="m-3m-future">
<h6>3.3.8.4.1 1m/3m Future<a class="headerlink" href="#m-3m-future" title="Link to this heading">#</a></h6>
<p>The trivial case, <span class="math notranslate nohighlight">\(\theta = 1\text{m or }3\text{m}\)</span>, so <span class="math notranslate nohighlight">\(R_{t}^{\theta}\)</span> is purely the forward from the forecast curve at time <span class="math notranslate nohighlight">\(t\)</span>.</p>
</section>
<section id="averaging-future">
<h6>3.3.8.4.2 Averaging Future<a class="headerlink" href="#averaging-future" title="Link to this heading">#</a></h6>
<p>Typically, this would be averaging of a daily rate (Fed Fund Future, 1M SONIA Future, or AUD 30 Day Future).</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
R_{s}^{\theta} = \frac{\sum_{i=0}^{d-1} R_{i+s}^{id}}{s - e}
\]</div>
</div>
<p><span class="math notranslate nohighlight">\(d = \#\)</span> days in period</p>
</section>
<section id="compounding-future">
<h6>3.3.8.4.3 Compounding Future<a class="headerlink" href="#compounding-future" title="Link to this heading">#</a></h6>
<p>Typically, this would be compounding of a daily rate (e.g., SOFR and SONIA 3m Future).</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
R_{s}^{\theta} = \prod_{i=0}^{d-1} (1 + R_{i+s}^{id} \tau_{s+i}^{id}) - 1 / \tau_{s}^{\theta}
\]</div>
</div>
</section>
<section id="convexity-and-the-front-future">
<h6>3.3.8.4.4 Convexity and the Front Future<a class="headerlink" href="#convexity-and-the-front-future" title="Link to this heading">#</a></h6>
<p>For Averaging or Compounding Futures the front Future is the one that has already started (s is before evaluation date, e is after evaluation date). In this case convexity (see 3.3.8.1 above) cannot be supplied as an input.</p>
</section>
</section>
</section>
</section>
<section id="payoff">
<h3>3.3.8.4.5. Payoff<a class="headerlink" href="#payoff" title="Link to this heading">#</a></h3>
<p>Futures are bought in a number of contracts. There is a contract size. (e.g. ‘Three-Month EURIBOR Futures’ (EUREX) has a contract size of €1million, ‘30 Day Federal Funds Futures’ (CME) has a contract size of $5million).</p>
<p>Futures are cash-settled, so the payoff is:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\#Contracts \times ContractSize \times p_{expiry}^{exchange}\]</div>
</div>
<p>For an Interest Rate Future <span class="math notranslate nohighlight">\(p_{expiry}^{exchange}\)</span> uses the reference interest rate (fixing) on the final settlement day. E.g. for the EURIBOR Future above, final settlement day is two exchange days prior to the third Wednesday of the respective maturity month e.g. Mon 13-Mar-2017 for the Mar-2017 Future. Payment (final payment) is the following day (Tue 14-Mar-2017).</p>
</section>
<section id="penalty-function-scaling">
<h3>3.3.8.4.6. Penalty function scaling<a class="headerlink" href="#penalty-function-scaling" title="Link to this heading">#</a></h3>
<p>This is scaled by -0.01.</p>
</section>
</section>
<section id="swap">
<h2>3.3.8.5. Swap<a class="headerlink" href="#swap" title="Link to this heading">#</a></h2>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[p = P_s^e = \frac{\sum_{i=1}^{n} R_{t_i}^{\theta} \tau_{t_i,t_{i+1}} df_{t_{i+1}}}{\sum_{j=1}^{m} \tau_{t_j,t_{j+1}} df_{t_{j+1}}}\]</div>
</div>
<p>Where <span class="math notranslate nohighlight">\(s = t_1\)</span> and <span class="math notranslate nohighlight">\(e = t_{n+1} = t_{m+1}\)</span></p>
<p>For greater detail on the formulae and calculation of all swap legs, and all swap types please see “Linear Interest Rate Swaps” referenced below.</p>
</section>
<section id="forward-spread">
<h2>3.3.8.6. Forward Spread<a class="headerlink" href="#forward-spread" title="Link to this heading">#</a></h2>
<p>A spread between two forward rates (Deposits). Typically used to define the <em>Target</em> curve as a spread to a <em>Base</em> curve.</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[p = P_s = R_s^{\theta^{Target}} - R_s^{\theta^{Base}}\]</div>
</div>
</section>
<section id="basis-swap-may-be-referred-to-as-tenor-basis-swap">
<h2>3.3.8.7. Basis Swap (may be referred to as Tenor Basis Swap)<a class="headerlink" href="#basis-swap-may-be-referred-to-as-tenor-basis-swap" title="Link to this heading">#</a></h2>
<p>A basis swap is an agreement to pay cashflows based one index and receive based on another. We term the two legs the “left leg” and the “right leg”. The left and right legs have their own forecast curves but use the same discount curve.</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\sum_{i=0}^{n-1} (R_{t_i}^{\theta_{Left}} \tau_{t_i}^{Left} + P) \tau_{t_i,t_{i+1}}^{Left} df_{t_{i+1}} = \sum_{j=0}^{m-1} R_{t_j}^{\theta_{Right}} \tau_{t_j}^{Right} \tau_{t_j,t_{j+1}}^{Right} df_{t_{j+1}}\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[p = \frac{\sum_{j=0}^{m-1} R_{t_j}^{\theta_{Right}} \tau_{t_j}^{Right} \tau_{t_j,t_{j+1}}^{Right} df_{t_{j+1}} - \sum_{i=0}^{n-1} R_{t_i}^{\theta_{Left}} \tau_{t_i}^{Left} \tau_{t_i,t_{i+1}}^{Left} df_{t_{i+1}}}{\sum_{i=0}^{n-1} \tau_{t_i,t_{i+1}}^{Left} df_{t_{i+1}}}\]</div>
</div>
<p>For greater detail on the formulae and calculation of all swap legs, and all swap types please see “Linear Interest Rate Swaps” referenced below.</p>
</section>
<section id="fx-forward">
<h2>3.3.8.8. FX Forward<a class="headerlink" href="#fx-forward" title="Link to this heading">#</a></h2>
<p>This instrument can only define a discount factor curve (3.3.4.1).
The price of this instrument is for an FX swap with two exchanges of notional, at the instrument start and end dates. The quote would be in forward points (pips), using a point size:</p>
<p><span class="math notranslate nohighlight">\(P\)</span> (<em>Forward Points</em>) <span class="math notranslate nohighlight">\(=(FX_{e}-FX_{s})\cdot PointSize\)</span></p>
<p>PointSize is merely a scaling factor (primarily due to the small size of fx forwards). It is always a power of 10, roughly 10000/<span class="math notranslate nohighlight">\(FX_{spot}\)</span>.</p>
<p>The FX quote is for units of term currency to one unit of base currency. In general this instrument represents a constraint on the discount factors such that:</p>
<p><span class="math notranslate nohighlight">\(FX_{t}=FX_{spot}\left[\frac{df_{t}^{Base}}{df_{spot}^{Base}}\frac{df_{spot}^{Term}} {df_{t}^{Term}}\right]\)</span></p>
<p>For an arbitrary start date:</p>
<p><span class="math notranslate nohighlight">\(p=P_{s,e}=\left(FX_{spot}\left[\frac{df_{e}^{Base}}{df_{spot}^{Base}}\frac{df_{spot}^{Term}} {df_{e}^{Term}}\right]-FX_{spot}\left[\frac{df_{s}^{Base}}{df_{spot}^{Base}}\frac{df_{spot}^{Term}} {df_{s}^{Term}}\right]\right)\cdot PointSize\)</span></p>
<p><span class="math notranslate nohighlight">\(=FX_{spot}\frac{df_{spot}^{Term}}{df_{spot}^{Base}}(\frac{df_{e}^{Base}}{df_{e}^{ Term}}-\frac{df_{s}^{Base}}{df_{s}^{Term}})\cdot PointSize\)</span></p>
<p>For a spot-starting FX forward:</p>
<p><span class="math notranslate nohighlight">\(P_{spot,s}=FX_{spot}\left(\left[\frac{df_{e}^{Base}}{df_{spot}^{Base}}\frac{df_{spot}^{ Term}} {df_{e}^{Term}}\right]-1\right)\cdot PointSize\ (1)\)</span></p>
<section id="id1">
<h3>3.3.8.8.1 Penalty function scaling<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<p>We need an equivalent rate, <span class="math notranslate nohighlight">\(r\)</span>, relating the Term curve and Base curve to <span class="math notranslate nohighlight">\(p\)</span> so construct the equation:</p>
<p><span class="math notranslate nohighlight">\(1+r.\tau_{s,e}=\frac{df_{e}^{Base}}{df_{s}^{Base}}\frac{df_{spot}^{Term}}{df_{e}^{Term}}\)</span>. This will be used for our scaling of the price.</p>
<p>Thus we rearrange (1):
Thus we rearrange (1):</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
1+r.\tau_{s,e}=\frac{df_{e}^{Base}}{df_{s}^{Base}}\frac{df_{spot}^{Term}}{df_{e}^{Term}}=1+\frac{p}{Pointsize+FX_s}=1+\frac{p}{Pointsize+FX_{spot}\left[\left(\frac{df_{e}^{Base}}{df_{spot}^{Base}}\frac{df_{spot}^{ Term}} {df_{e}^{Term}}\right)\right]}
\]</div>
</div>
<p>The scaling factor of price-rate is therefore:
$<span class="math notranslate nohighlight">\(
r=\frac{1+\frac{p}{Pointsize+FX_{spot}\left[\left(\frac{df_{e}^{Base}}{df_{spot}^{Base}}\frac{df_{spot}^{ Term}} {df_{e}^{Term}}\right)\right]}}{\tau_{spot,s}}
\)</span>$</p>
</section>
<section id="cross-currency-basis-swap">
<h3>3.3.8.9. Cross Currency Basis Swap<a class="headerlink" href="#cross-currency-basis-swap" title="Link to this heading">#</a></h3>
<p>This instrument can only define a discount factor curve (3.3.4.1).</p>
<p>A cross-currency basis swap is similar to the basis swap discussed above, except that there is an exchange of notional at start and end for each swap leg.</p>
<p>Both legs are floating and have different currency denomination.</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\sum_{i=0}^{n-1} \left( \left( R^{\theta_{\text{Left}_{t_i}^{\text{Left}}}} + p \right) {\tau_{t_i,t_{i+1}}^{\text{Left}}}{d f_{i+1}^{\text{Left}}}\right) - \left( d f_{t_0}^{\text{Left}} - d f_{t_n}^{\text{Left}} \right) 
= \sum_{j=0}^{m-1} \left(  R^{\theta_{\text{Right}_{t_j}^{\text{Right}}}} {\tau_{t_j,t_{t{j+1}}}^{\text{Right}}}{d f_{j+1}^{\text{Right}}}\right) - \left( d f_{t_0}^{\text{Right}} - d f_{t_m}^{\text{Right}}  \right)
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
p = \frac{\left[ \sum_{i=0}^{m-1} \left(  R^{\theta_{\text{Right}_{t_j}^{\text{Right}}}}  {\tau_{t_j,t_{t{j+1}}}^{\text{Right}}}{d f_{j+1}^{\text{Right}}}\right) - \left( d f_{t_0}^{\text{Right}} - d f_{t_m}^{\text{Right}}  \right) \right] - \left[ \sum_{i=0}^{n-1} \left( \left( R^{\theta_{\text{Left}_{t_i}^{\text{Left}}}} + p \right) {\tau_{t_i,t_{i+1}}^{\text{Left}}}{d f_{i+1}^{\text{Left}}}\right) - \left( d f_{t_0}^{\text{Left}} - d f_{t_n}^{\text{Left}} \right) \right]}{\sum_{i=0}^{n} {\tau_{t_i,t_{i+1}}^{\text{Left}}}{d f_{i+1}^{\text{Left}}}}
\]</div>
</div>
<p><span class="math notranslate nohighlight">\(A = \sum_{i=0}^{m-1} \left(  R^{\theta_{\text{Right}_{t_j}^{\text{Right}}}}  {\tau_{t_j,t_{t{j+1}}}^{\text{Right}}}{d f_{j+1}^{\text{Right}}}\right) - \left( d f_{t_0}^{\text{Right}} - d f_{t_m}^{\text{Right}}  \right)\)</span></p>
<p><span class="math notranslate nohighlight">\(B = \sum_{i=0}^{n-1} \left( \left( R^{\theta_{\text{Left}_{t_i}^{\text{Left}}}} + p \right) {\tau_{t_i,t_{i+1}}^{\text{Left}}}{d f_{i+1}^{\text{Left}}}\right) - \left( d f_{t_0}^{\text{Left}} - d f_{t_n}^{\text{Left}} \right) \)</span></p>
<p><span class="math notranslate nohighlight">\(C = (\sum_{i=0}^{n} {\tau_{t_i,t_{i+1}}^{\text{Left}}}{d f_{i+1}^{\text{Left}}} )\)</span></p>
<p><span class="math notranslate nohighlight">\(p = (\frac{A - B}{C} )\)</span>
For greater detail on the formulae and calculation of all swap legs, and all swap types please see “Linear Interest Rate Swaps” referenced below.</p>
</section>
<section id="i-o-mtm-cross-currency-basis-swap">
<h3>3.3.8.10 I/O MTM Cross Currency Basis Swap<a class="headerlink" href="#i-o-mtm-cross-currency-basis-swap" title="Link to this heading">#</a></h3>
<p>A mark-to-market cross-currency basis swap is similar to the (non-MTM) cross-currency basis swap discussed above, except that the notional on the resetting leg is rescaled at each reset date with the ratio of the FX rate at the reset date to the FX rate at the previous reset date. The difference in the two notionsIs is paid as an interim notional exchange.</p>
<p>The right leg (without the spread) is the resetting or foreign, leg (typically USD).</p>
<p>The final rescaling is at the final reset date of the last cashflow.</p>
<p>The rescaling with the change in FX rate is essentially by the calculation of FX forwards, i.e. the ratio of the change in discount factor of the left leg divided by the change in discount factor of the right leg.</p>
<p>Thus the notional at reset date <span class="math notranslate nohighlight">\(t_{j}\)</span> is scaled by the following (i.e. the ratio of the FX rates from <span class="math notranslate nohighlight">\(t_{o}\)</span>, start date, to <span class="math notranslate nohighlight">\(t_{j}\)</span>, reset date of the <span class="math notranslate nohighlight">\(\mu\)</span>h cashflow.</p>
<p><span class="math notranslate nohighlight">\(\frac{df_{t_j}^{Left}}{df_{t_0}^{Left}}  \cdot \frac{df_{t_0}^{Right}}{df_{t_j}^{Right}}\)</span> (1)</p>
<p>Hence the interim notional exchange at <span class="math notranslate nohighlight">\(t_{j}\)</span>, <span class="math notranslate nohighlight">\(1\leq j&lt;n\)</span> is projected as:</p>
<p><span class="math notranslate nohighlight">\(\frac{df_{t_j-1}^{Left}}{df_{t_0}^{Left}}  \cdot \frac{df_{t_0}^{Right}}{df_{t_j-1}^{Right}}-\frac{df_{t_j}^{Left}}{df_{t_0}^{Left}}  \cdot \frac{df_{t_0}^{Right}}{df_{t_j}^{Right}}
\)</span>
<span class="math notranslate nohighlight">\(=\frac{df_{t_0}^{Right}}{df_{t_0}^{Left}}  \cdot \left[\frac{df_{t_j-1}^{Left}}{df_{t_j-1}^{Right}}-\frac{df_{t_j}^{Left}}{df_{t_j}^{Left}}\right] \)</span></p>
<p>The value of this being:</p>
<p><span class="math notranslate nohighlight">\(\frac{df_{t_0}^{Right}}{df_{t_0}^{Left}}  \cdot \left(df_{t_j-1}^{Left}\frac{df_{t_j}^{Right}}{df_{t_j-1}^{Right}}-df_{t_j}^{Left}\right) \)</span></p>
<p>Thus, applying (1) to the non-MTM case in 3.3.7.8 above, the formula for the PV of the right (resetting) leg alone is:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
 A' = \frac{df_{t_0}^{Right}}{df_{t_0}^{Left}} \left( \sum_{j=1}^{m-1} \left(df_{t_j-1}^{Left}\frac{df_{t_j}^{Right}}{df_{t_j-1}^{Right}}-df_{t_j}^{Left}\right) + \sum_{j=0}^{m-1} \frac{df_{t_j}^{Left}}{df_{t_0}^{Left}}  \cdot \frac{df_{t_0}^{Right}}{df_{t_j}^{Right}} R^{\theta_{\text{Right}_{t_j}^{\text{Right}}}}{\tau_{t_j,t_{t{j+1}}}^{\text{Right}}} df_{t_{j+1}} \right) 
\]</div>
</div>
<p><span class="math notranslate nohighlight">\(- \left( df_{t_0}^{Right} - \frac{df_{t_m-1}^{Left}df_{t_0}^{Right}}{df_{t_0}^{Left}df_{t_m-1}^{Right}} df_{t_m}^{Right} \right) \)</span></p>
<p>Or the price for calibration -B, C can be reused from the (non-MTM) Cross Currency Basis Swap:</p>
<p><span class="math notranslate nohighlight">\(p =\frac{A'-B}{C} \)</span></p>
<p>For greater detail on the formula and calculation of all swap legs, and all swap types please see
“Linear Interest Rate Swaps” referenced below.</p>
</section>
<section id="cross-currency-swap">
<h3>3.3.8.11 Cross Currency Swap<a class="headerlink" href="#cross-currency-swap" title="Link to this heading">#</a></h3>
<p>This instrument can only define a discount factor curve (3.3.4.1).
A cross-currency swap is a fix for float swap involving two currencies, one for each leg. In addition,
there is an exchange of notional at the start and end of each swap leg. One leg (right leg, typically
USD) pays floating rate and the other (left leg, domestic currency) pays fixed rate.</p>
<p><span class="math notranslate nohighlight">\(  p \sum_{i=0}^{n-1} \left( {\tau_{t_i,t_{i+1}}^{\text{Left}}}{d f_{t_{i+1}}^{\text{Left}}}\right) - \left( d f_{t_0}^{\text{Left}} - d f_{t_n}^{\text{Left}} \right) = \sum_{j=0}^{m-1} \left( R^{\theta_{\text{Right}_{t_j}^{\text{Right}}}}{\tau_{t_j,t_{t{j+1}}}^{\text{Right}}} df_{t_{j+1}} \right) - \left( d f_{t_0}^{\text{Right}} - d f_{t_m}^{\text{Right}} \right) \)</span></p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
p = \frac{\left[ \sum_{i=0}^{m-1} \left(  R^{\theta_{\text{Right}_{t_j}^{\text{Right}}}}  {\tau_{t_j,t_{t{j+1}}}^{\text{Right}}}{d f_{t_{j+1}}^{\text{}}}\right) - \left( d f_{t_0}^{\text{Right}} - d f_{t_m}^{\text{Right}}  \right) \right] - \left[ \sum_{i=0}^{n-1} \left( \left( R^{\theta_{\text{Left}_{t_i}^{\text{Left}}}} + p \right) {\tau_{t_i,t_{i+1}}^{\text{Left}}}{d f_{t_{i+1}}^{\text{Left}}}\right) - \left( d f_{t_0}^{\text{Left}} - d f_{t_n}^{\text{Left}} \right) \right]}{\sum_{i=0}^{n-1} {\tau_{t_i,t_{i+1}}^{\text{Left}}}{d f_{t_{i+1}}^{\text{}}}}
\]</div>
</div>
<p>For greater detail on the formula and calculation of all swap legs, and all swap types please see
“Linear Interest Rate Swaps” referenced below.</p>
</section>
<section id="mtm-gross-currency-swap">
<h3>3.3.8.12   MTM Gross Currency Swap<a class="headerlink" href="#mtm-gross-currency-swap" title="Link to this heading">#</a></h3>
<p>This is not implemented in NCF.</p>
</section>
<section id="swap-spread-spread-between-two-swaps">
<h3>3.3.8.13   (Swap) Spread (spread between two swaps)<a class="headerlink" href="#swap-spread-spread-between-two-swaps" title="Link to this heading">#</a></h3>
<p>This might be quoted/traded as, for example, 10s30s spread.</p>
<p><span class="math notranslate nohighlight">\(p = p^{TargetSwap} - p^{BaseSwap}\)</span></p>
<p>The two swaps will be in the same currency, and use the same discount curve.</p>
<p><span class="math notranslate nohighlight">\(p = \frac{ \sum_{i=0}^{n^{Target}} \left(  R^{\theta^{Target}}_{{t_j}\text{Target}}  {\tau_{t_j^\text{Target},t_{{t_j} \text{Target}+1}}}{d f_{{t_j} \text{Target}+1}^{\text{}}}\right)  }{\sum_{j^\text{Target}=i}^{m^\text{Target}} {\tau_{t_j^\text{Target},t_{j^\text{Target}+1}}}{d f_{{t_j} \text{Target}+1}^{\text{}}}}-\frac{ \sum_{i=0}^{n^{Base}} \left(  R^{\theta^{Base}}_{{t_j}\text{Base}}  {\tau_{t_j^\text{Base},t_{t{j\text{Base}+1}}}}{d f_{j^\text{Base}+1}^{\text{}}}\right)  }{\sum_{j^\text{Base}=i}^{m^\text{Base}} {\tau_{t_j \text{Base},t_{j^\text{Base}+1}}}{d f_{t_{j\text{Base}}+1}^{\text{}}}}\)</span></p>
</section>
<section id="spread-constraint">
<h3>3.3.8.14 Spread Constraint<a class="headerlink" href="#spread-constraint" title="Link to this heading">#</a></h3>
<p>This is simply a generic version of the above, a spread between any other two instruments. It could
replace the Spread instrument:</p>
<p><span class="math notranslate nohighlight">\(p = TargetCoefficient  \cdot p^{TargetInstrument} + p^{BaseInstrument}  \cdot BaseCoefficient\)</span></p>
<p>The defaults are TargetCoefficient = 1.0, BaseCoefficient = -1.0.
These coefficients are configurable, i.e. static and decided at the design phase.</p>
<section id="id2">
<h4>3.3.8.14.1 Payoff<a class="headerlink" href="#id2" title="Link to this heading">#</a></h4>
<p>If a Spread instrument represents a tradeable instrument – i.e. both instruments used in the constraint
are tradeable, then the payoff is simply the linear combination of the payoffs of the underlying
instruments:</p>
<p><span class="math notranslate nohighlight">\(Payoff = TargetCoefficient  \cdot \sum_{Legs,i} Payoff^{TargetInstrument} + BaseCoefficient  \cdot \sum_{Legs,j} Payoff^{BaseInstrument}\)</span></p>
</section>
<section id="id3">
<h4>3.3.8.14.2 Penalty function scaling<a class="headerlink" href="#id3" title="Link to this heading">#</a></h4>
<p>The 2 instruments must both return a rate, or have a fixed scalar (could have a spread between a Future and a Deposit, for example, with appropriate scaling of the Future coefficient), or both should be FX Forwards (trading a spread, or both scaled).</p>
<p>Using a spread between 2 bonds would not be recommended. NCF is flexible, so it is not disallowed, but bond prices do not relate to each other via the above formula, in the same way as a rate instrument.</p>
<p>If the Spread Constraint is between 2 FX Forwards the calculation of the score for the penalty function scaling will be:
$<span class="math notranslate nohighlight">\(
penalty = TargetCoefficient * (P^{TargetIncrement} - P^{TargetIncrement}_{Curves} ) * ScalingFactor^{TargetIncrement} + BaseCoefficient * (P^{BaseIncrement} - P^{BaseIncrement}_{Curves} ) * ScalingFactor^{BaseIncrement}
\)</span>$</p>
<p>The scaling for each instrument will be by the same calculation as for the FX Forward itself. Otherwise, the penalty is scaled by the same calculation as for the FX Forward.</p>
</section>
</section>
<section id="fly-butterfly-between-three-swaps">
<h3>3.3.8.15 Fly (butterfly between three swaps)<a class="headerlink" href="#fly-butterfly-between-three-swaps" title="Link to this heading">#</a></h3>
<p>This might be quoted/traded as, for example, 5-7-10 Fly.</p>
<p><span class="math notranslate nohighlight">\(p = p^{LeftSwap} - p^{RightSwap} + 2  \cdot p^{CentreSwap}\)</span></p>
<p>The three swaps will be in the same currency, same tenor <span class="math notranslate nohighlight">\((\theta)\)</span> and use the same discount curve.</p>
<p><span class="math notranslate nohighlight">\(p = \frac{ \sum_{i=0}^{n^{Left}} \left(  R^{\theta^{Left}}_{{t_j}\text{Left}}  {\tau_{t_j^\text{Left},t_{t{j\text{Left}+1}}}}{d f_{j^\text{Left}+1}^{\text{}}}\right)  }{\sum_{j^\text{Left}=i}^{m^\text{Left}} {\tau_{t_j^\text{Left},t_{j^\text{Left}+1}}}{d f_{j^\text{Left}+1}^{\text{}}}}-\frac{ \sum_{i=0}^{n^{Right}} \left(  R^{\theta^{Right}}_{{t_j}\text{Right}}  {\tau_{t_j^\text{Right},t_{t{j\text{Right}+1}}}}{d f_{j^\text{Right}+1}^{\text{}}}\right)  }{\sum_{j^\text{Right}=i}^{m^\text{Right}} {\tau_{t_j^\text{Right},t_{j^\text{Right}+1}}}{d f_{j^\text{Right}+1}^{\text{}}}}+2*-\frac{ \sum_{i=0}^{n^{Centre}} \left(  R^{\theta^{Centre}}_{{t_j}\text{Centre}}  {\tau_{t_j^\text{Centre},t_{t{j\text{Centre}+1}}}}{d f_{j^\text{Centre}+1}^{\text{}}}\right)  }{\sum_{j^\text{Centre}=i}^{m^\text{Centre}} {\tau_{t_j^\text{Centre},t_{j^\text{Centre}+1}}}{d f_{j^\text{Centre}+1}^{\text{}}}}\)</span></p>
</section>
<section id="fly-constraint-butterfly-between-any-other-three-instruments">
<h3>3.3.8.16 Fly Constraint (butterfly between any other three instruments)<a class="headerlink" href="#fly-constraint-butterfly-between-any-other-three-instruments" title="Link to this heading">#</a></h3>
<p>This is simply a generic version of the above, it could replace the Fly instrument:</p>
<p><span class="math notranslate nohighlight">\(p = LeftCoefficient  \cdot p^{LeftInstrument} + CentreCoefficient  \cdot p^{CentreInstrument} + RightCoefficient  \cdot p^{RightInstrument}\)</span></p>
<p>The defaults are CentreCoefficient = 2.0, RightCoefficient = -1.0.</p>
<p>To also generally 3 instruments must be of the same type, 3 instruments of the same type. NCF is flexible, so it is not disallowed, but this is a design principle.</p>
<section id="id4">
<h4>3.3.8.16.1. Payoff<a class="headerlink" href="#id4" title="Link to this heading">#</a></h4>
<p>If a Fly instrument represents a tradeable instrument – i.e. each instrument used in the constraint is tradeable, then the payoff is simply the linear combination of the payoffs of the underlying instruments:</p>
<p><span class="math notranslate nohighlight">\(Payoff = LeftCoefficient  \cdot \sum_{Legs,i} Payoff^{LeftInstrument} + CentreCoefficient  \cdot \sum_{Legs,j} Payoff^{CentreInstrument} + RightCoefficient  \cdot \sum_{Legs,k} Payoff^{RightInstrument}\)</span></p>
</section>
<section id="calculate-coefficients">
<h4>3.3.8.16.2. Calculate Coefficients<a class="headerlink" href="#calculate-coefficients" title="Link to this heading">#</a></h4>
<p>These coefficients are configurable – i.e. static and decided at the design phase, or there is also the option of “Calculate Coefficients”. This sets the coefficients such that a price of 0 enforces the centre instrument price to be the centre of the other 2 prices. Use of this option requires further interpolation.
• All 3 instruments have the same (end) tenor:</p>
<p><span class="math notranslate nohighlight">\(start\_date_{LeftInstrument} &lt; start\_date_{CentreInstrument} &lt; start\_date_{RightInstrument}\)</span></p>
<p><span class="math notranslate nohighlight">\(CentreCoefficient = 1.0\)</span>
<span class="math notranslate nohighlight">\(LeftCoefficient = \frac{start\_date_{CentreInstrument} - start\_date_{RightInstrument}}{start\_date_{RightInstrument} - start\_date_{LeftInstrument}}\)</span>
<span class="math notranslate nohighlight">\(RightCoefficient = \frac{start\_date_{LeftInstrument} - start\_date_{CentreInstrument}}{start\_date_{RightInstrument} - start\_date_{LeftInstrument}}\)</span></p>
<p><span class="math notranslate nohighlight">\(i.e.with p = 0\)</span>:</p>
<p><span class="math notranslate nohighlight">\(0 = (\frac{start\_date_{CentreInstrument} - start\_date_{RightInstrument}}{start\_date_{RightInstrument} - start\_date_{LeftInstrument}})  \cdot p^{LeftInstrument} + (\frac{start\_date_{CentreInstrument} - start\_date_{RightInstrument}}{start\_date_{RightInstrument} - start\_date_{LeftInstrument}})  \cdot p^{RightInstrument}+p^{CentreInstrument}\)</span></p>
<p><span class="math notranslate nohighlight">\(P_{CentreInstrument} = (\frac{start\_date_{CentreInstrument} - start\_date_{RightInstrument}}{start\_date_{RightInstrument} - start\_date_{LeftInstrument}})  \cdot p^{LeftInstrument} + (\frac{start\_date_{CentreInstrument} - start\_date_{RightInstrument}}{start\_date_{RightInstrument} - start\_date_{LeftInstrument}})  \cdot p^{RightInstrument}\)</span></p>
<p>• All 3 instruments have the same start date, <span class="math notranslate nohighlight">\(end\_date_{LeftInstrument} &lt; end\_date_{CentreInstrument} &lt; end\_date_{RightInstrument}\)</span></p>
<p><span class="math notranslate nohighlight">\(CentreCoefficient = 1.0\)</span>
<span class="math notranslate nohighlight">\(LeftCoefficient = \frac{end\_date_{CentreInstrument} - end\_date_{RightInstrument}}{end\_date_{RightInstrument} - end\_date_{LeftInstrument}}\)</span>
<span class="math notranslate nohighlight">\(RightCoefficient = \frac{end\_date_{LeftInstrument} - end\_date_{CentreInstrument}}{end\_date_{RightInstrument} - end\_date_{LeftInstrument}}\)</span></p>
<p><span class="math notranslate nohighlight">\(Hence with p = 0\)</span>:</p>
<p><span class="math notranslate nohighlight">\(P_{CentreInstrument} = (\frac{end\_date_{CentreInstrument} - end\_date_{RightInstrument}}{end\_date_{RightInstrument} - end\_date_{LeftInstrument}})  \cdot p^{LeftInstrument} + (\frac{end\_date_{CentreInstrument} - end\_date_{RightInstrument}}{end\_date_{RightInstrument} - end\_date_{LeftInstrument}})  \cdot p^{RightInstrument}\)</span></p>
</section>
<section id="id5">
<h4>3.3.8.16.3. Penalty function scaling<a class="headerlink" href="#id5" title="Link to this heading">#</a></h4>
<p>All 3 instruments must both return a rate, or have a fixed scalar (could have a Fly Constraint between Futures and a Deposit, for example, with appropriate scaling of the Future coefficient). Therefore, as above, Bonds would not be relatively supported in a Fly Constraint. NCF is flexible, so it is not disallowed, but it is the same way as a rate instrument.</p>
<p>If the Fly Constraint is between 3 FX Forwards the calculation of the score for the penalty function scaling will be:</p>
<p><span class="math notranslate nohighlight">\(
penalty = LeftCoefficient * (P^{LeftIncrement} - P^{LeftIncrement}_{Curves} ) * ScalingFactor^{LeftIncrement} + CentreCoefficient * (P^{CentreIncrement} - P^{CentreIncrement}_{Curves} ) * ScalingFactor^{CentreIncrement} + RightCoefficient * (P^{RightIncrement} - P^{RightIncrement}_{Curves} ) * ScalingFactor^{RightIncrement}
\)</span></p>
<p>i.e. scaling for each instrument will be by the same calculation as for the FX Forward itself. Otherwise, the price is assumed to be a rate and will have no scaling.</p>
</section>
</section>
<section id="term-deposit">
<h3>3.3.8.17. Term Deposit<a class="headerlink" href="#term-deposit" title="Link to this heading">#</a></h3>
<p>This instrument can only define a discount factor curve (3.3.4.1).
A term deposit represents a stream of floating payments (projection of the forward rate-spread) with
an exchange of notional at the start and at the end. The use of a term deposit instrument is used to
define a discount curve in a single currency. The price of the instrument is the spread which makes
the contract PV to zero.</p>
<p><span class="math notranslate nohighlight">\(df_s - df_e = \sum_{i=0}^{n} (R_{t_i}^{\theta} + p)\tau_{t_i,t_i+1} df_{t_i+1}\)</span></p>
<p><span class="math notranslate nohighlight">\(p = \frac{(df_s - df_e) - \sum_{i=0}^{n-1} R_{t_i}^{\theta} \tau_{t_i,t_i+1} df_{t_i+1}}{\sum_{i=0}^{n-1} \tau_{t_i,t_i+1} df_{t_i+1}}\)</span></p>
<p>For greater detail on the formula and calculation of all swap legs, and all swap types please see
‘Linear Interest Rate Swaps’ referenced below.</p>
</section>
<section id="turn">
<h3>3.3.8.18. Turn<a class="headerlink" href="#turn" title="Link to this heading">#</a></h3>
<p>This instrument is non-tradeable, therefore has no payoff.
This instrument defines a discount factor interpolator (3.3.4.1). It is implemented as a separate
interpolator, with Geometric interpolation - 3.3.8.1 below.</p>
<p>Turn instruments can be used to add a spike rate across a short interval. Commonly used in the
business day, regardless of the tenor of the curve (e.g. a 3m curve can be observed daily). Turn will be observed for
three months in a 3m month curve (i.e. whenever the 3m forecast rate contains the Turn). It is
commonly seen at the year-end but the same effect could be a less central observation date such
as month ends (particularly Q1/5, FX curves). NCF places no restrictions on how Turns are used, they
may overlap, extend more than one business day, and be used without imposing performance.</p>
<p>The modelling of a Turn is as two nodes and the corresponding continuously-compounded forward
rate (see 3.3.8.3).</p>
<ul class="simple">
<li><p>one positive Turn at the start of the Turn, <span class="math notranslate nohighlight">\(p = P_s=R_{s,e-s}\)</span></p></li>
<li><p>one negative Turn at the end date of the Turn, <span class="math notranslate nohighlight">\(-p\)</span>.</p></li>
</ul>
<p>In terms of discount factors and node dates the implementation is:</p>
<p><span class="math notranslate nohighlight">\(df_k=df_{s-1d}, R_{s -1d,1d} = 0\)</span></p>
<p>The optimiser will solve for <span class="math notranslate nohighlight">\(df_e\)</span> to return <span class="math notranslate nohighlight">\(p = R_{s,e-s} = \frac{1}{\tau}log\frac{df_s}{df_e}\)</span></p>
<p><span class="math notranslate nohighlight">\(df_{e+1}=df_{e}, or R_{e,1d} = 0\)</span></p>
</section>
<section id="jump">
<h3>3.3.8.19 Jump<a class="headerlink" href="#jump" title="Link to this heading">#</a></h3>
<p>This instrument is non-tradeable, therefore has no payoff.
This instrument can only define a discount factor curve (3.3.4.1). It is implemented as a separate jump
interpolator, with Geometric interpolation - 3.3.8.1 below.</p>
<p>A Jump is very similar to a Turn, but contains one step in the forward rate on a single date.</p>
<p><span class="math notranslate nohighlight">\(df_{s}=df_{s-1}, or R_{s-1} = 0\)</span></p>
<p>The optimiser will solve for <span class="math notranslate nohighlight">\(df_{s+1}\)</span> to return <span class="math notranslate nohighlight">\(p = R_s\)</span></p>
</section>
<section id="ibor-jump">
<h3>3.3.8.20 Ibor Jump<a class="headerlink" href="#ibor-jump" title="Link to this heading">#</a></h3>
<p>This instrument is non-tradeable, therefore has no payoff.</p>
<p>Ibor jumps can be used to add jumps over a business day in the Ibor type curves. An Ibor jump can
have more nodes than the turn. The jump date - 180 are the main node dates. All the
dates that verify: [Jump date - (multiple of the tenor of the curve)] and [Jump date +
(multiple of the tenor of the curve)] Months - 180] are also node dates. Adding a jump to a 3M curve
at a certain date is done in practice by adding a turn jump in the opposite space on the other day fitting the
main jump date. These nodes are added at [Jump date - 3M] and [Jump date + 3M] at the main jump date
-3M]. The addition of node dates at [Jump date - xM] (where x is multiple of 3) with the right value
will remove the unwanted jump. These previous nodes make a propagated jump found in
the main jump date: <span class="math notranslate nohighlight">\(\frac{df_{jumpDate - 1bd}}{df_{jumpDate}}\)</span></p>
<p>The constraint is: <span class="math notranslate nohighlight">\(p = R_{jumpDate - 1bd, 1bd}=\frac{1}{\tau}log\frac{df_{jumpDate - 1bd}}{df_{jumpDate}}\)</span></p>
<p>And all the previous turns will be populated by:</p>
<p><span class="math notranslate nohighlight">\(\frac{df_{jumpDate - 1bd}}{df_{jumpDate}}=\frac{df_{jumpDate - xM- 1d}}{df_{jumpDate-xM}}\)</span> and using <span class="math notranslate nohighlight">\(df_{jumpDate - xM- 1d}=  df_{jumpDate - (x- 1)d}\)</span></p>
<p>We can either set the score of the instrument, or we get from the
interpolator of the jump sole or both the jump interpolator and the DF interpolator of the curve. The
later will lead to see the exact value of the jump node by the jump input by the user. In the curve
many jumps on the same curve but they shouldn’t have the same jump date. During the engine
calibration each instrument’s given a score that will be minimized. It is usually target price - fitted
price. The fitted price of the jump can either be the jump rate from the calibrated curve or the jump
rate solely from the jump interpolator. We can have many jumps in the same curve, but they
shouldn’t have the same jump date. Ibor jumps are only supported on curves with tenors x W and
x M in aggregate.</p>
</section>
<section id="nominal-bond">
<h3>3.3.8.21 (Nominal) Bond<a class="headerlink" href="#nominal-bond" title="Link to this heading">#</a></h3>
<p>This instrument is a non-callable bullet bond. It can only define a discount factor curve (3.3.4.1).
Prices are generated Rates Bond model. See Rates Bond model for the payoff
description.</p>
<p>In a calibration to Price - Yield calculation is used, i.e. Calculate yield y, from dirty price p:</p>
<p><span class="math notranslate nohighlight">\(p = \sum_{i=1}^{n} \frac{C_i}{(1 + y/f)^{{f\tau}_i}} + \frac{R}{(1 + y/f)^{{f\tau}_n}}\)</span></p>
<p>where:</p>
<p><span class="math notranslate nohighlight">\(n\)</span> = cashflows between settlement date and maturity date</p>
<p><span class="math notranslate nohighlight">\(c_i\)</span> = cashflow at time <span class="math notranslate nohighlight">\(i\)</span></p>
<p><span class="math notranslate nohighlight">\(f\)</span> = compounding frequency</p>
<p><span class="math notranslate nohighlight">\(t_i\)</span> = day count fraction between settlement date and coupon payment date <span class="math notranslate nohighlight">\(i\)</span></p>
<p><span class="math notranslate nohighlight">\(R\)</span> = redemption value</p>
<p>when a price is input, <span class="math notranslate nohighlight">\(yield^{price}\)</span> would be calculated for later use.</p>
<p>A bond can be input to the curve is respecified such that the bond (dirty) is returned, discounting
the cashflows from the curve, i.e.:</p>
<p><span class="math notranslate nohighlight">\(p = \sum_{i=1}^{n} (c_i \cdot df_{t_i}) + R \cdot df_{t_n}\)</span></p>
<section id="penalty-function-calculation">
<h4>3.3.8.21.1 Penalty function calculation<a class="headerlink" href="#penalty-function-calculation" title="Link to this heading">#</a></h4>
<p>The bond yield is used in the calculation of the score for the penalty function. Thus,</p>
<p><span class="math notranslate nohighlight">\(penalty = (yield^{curves} - yield^{price})\)</span></p>
<p>Inflation:</p>
<p>These instruments will define an inflation curve only.</p>
<p>We can have instruments for which we require index values for dates in the past, so as mentioned in
3.3.3.3 above we have the concept of a base date, <span class="math notranslate nohighlight">\(b\)</span>, the latest date for which the index has been
published.</p>
<p><span class="math notranslate nohighlight">\(b &lt; T_0, df_{T_0,b} = 1\)</span>, so with positive inflation, <span class="math notranslate nohighlight">\(df_{T_0,T_0} \leq 1\)</span></p>
<p><span class="math notranslate nohighlight">\(b &lt; T_0\)</span> is a point of inflation calculation (that will calculate inflation must be for a historic date.
Some indices contain rules for projection from this date to “today”, thus it would be conceivable to
have <span class="math notranslate nohighlight">\(b =T_0\)</span>. But <span class="math notranslate nohighlight">\(b &gt; T_0\)</span> It is impossible (there are no future inflation values).</p>
<p>Note if <span class="math notranslate nohighlight">\(t &lt; b\)</span>, the curve will not query discount factor, only the published/embedded index value,
<span class="math notranslate nohighlight">\(CPI_t\)</span>.</p>
<p>The published market data for an inflation curve will contain the full index history up to the base date.</p>
<p>An instrument will typically have a start and end.</p>
<p>So if we have:<span class="math notranslate nohighlight">\(\frac{CPI_s}{CPI_e}\)</span></p>
<p><span class="math notranslate nohighlight">\( s \geq b : \frac{CPI_s}{CPI_e}\)</span> (1)</p>
<p><span class="math notranslate nohighlight">\(s &lt;= \frac{df_b}{df_s}\frac{CPI_b}{CPI_s}=\frac{1}{df_s}\frac{CPI_b}{CPI_s}\)</span></p>
<p>For somewhat we will use (1) in the below instruments, when necessary.</p>
</section>
</section>
<section id="inflation-instruments-lag-and-instrument-interpolation">
<h3>3.3.8.22 Inflation Instruments Lag and Instrument Interpolation<a class="headerlink" href="#inflation-instruments-lag-and-instrument-interpolation" title="Link to this heading">#</a></h3>
<section id="inflation-lag">
<h4>3.3.8.22.1. Inflation lag<a class="headerlink" href="#inflation-lag" title="Link to this heading">#</a></h4>
<p>Inflation instruments will, in general, have a lag (a months) to deduct from the reference date to
determine the index/date. This is necessary since the index will always be published with a delay and will always be
based on the collation of historic data, so will, at best, be for the preceding month. Typical lags are 2
or 3 months.</p>
</section>
<section id="inflation-instrument-interpolation">
<h4>3.3.8.22.2 Inflation instrument interpolation<a class="headerlink" href="#inflation-instrument-interpolation" title="Link to this heading">#</a></h4>
<p>See 3.3.3.3 above. The node dates in any inflation curve will be on inflation day of month, the day the
interpolation of the curve will be set (3.3.3.4 to 3.3.3.4 below). However, inflation, inflation instrument interpolation in NCF: Flat interpolation and Linear interpolation.</p>
<p>However, inflation instrument interpolation will typically also define an interpolation. There are 2
examples of inflation instrument interpolation in NCF: Flat interpolation and Linear interpolation.</p>
<p>For both these, the curve will be queried for <span class="math notranslate nohighlight">\(CPI_t\)</span> where <span class="math notranslate nohighlight">\(t\)</span> is inflation day of month.</p>
<p>We define the set <span class="math notranslate nohighlight">\(CPI_t\)</span> where <span class="math notranslate nohighlight">\(t\)</span> is inflation day of month.</p>
</section>
<section id="flat">
<h4>3.3.8.22.2.1 Flat<a class="headerlink" href="#flat" title="Link to this heading">#</a></h4>
<p>There is no interpolation of the inflation index intra-month.</p>
<p>If <span class="math notranslate nohighlight">\(t_1 \leq t \leq t_2\)</span>, the curve will be queried for <span class="math notranslate nohighlight">\(CPI_{t_1}\)</span>.</p>
<p>In practice, if the inflation index has <span class="math notranslate nohighlight">\(inflation\_day\_of\_month = 1\)</span>, then <span class="math notranslate nohighlight">\(CPI_t\)</span> is relevant for the entire
month in which it falls.</p>
</section>
<section id="linear">
<h4>3.3.8.22.2.2. Linear<a class="headerlink" href="#linear" title="Link to this heading">#</a></h4>
<p>This interpolates the change in index between fixing points uniformly over the actual number of days
in the period.</p>
<p><span class="math notranslate nohighlight">\(CPI_t = CPI_{t_i} + (CPI_{t_{i+1}} - CPI_{t_i}) \frac{(t - t_i)}{(t_{i+1} - t_i)}, t_i \leq t \leq t_{i+1}\)</span></p>
<p>This is identical to CPILinear for the curve.</p>
<p>For bonds it is also known as the Canadian Model with <span class="math notranslate nohighlight">\(inflation\_day\_of\_month = 1\)</span>. It is also the
case for some inflation bond interpolation, with a lag of 3, and <span class="math notranslate nohighlight">\(inflation\_day\_of\_month = 8\)</span>.</p>
</section>
<section id="natural">
<h4>3.3.8.22.2.3. Natural<a class="headerlink" href="#natural" title="Link to this heading">#</a></h4>
<p>The above does not apply, interpolation of the curve will be used when querying for <span class="math notranslate nohighlight">\(CPI_t\)</span>. This
interpolation method has never been required in NCF.</p>
</section>
<section id="swedish-and-icelandic-inflation-bond-interpolation">
<h4>3.3.8.22.2.4. Swedish and Icelandic inflation bond interpolation<a class="headerlink" href="#swedish-and-icelandic-inflation-bond-interpolation" title="Link to this heading">#</a></h4>
<p>This is identical to Linear except the ratio applied to <span class="math notranslate nohighlight">\((CPI_{t_2} - CPI_{t_1})\)</span> is different:</p>
<p><span class="math notranslate nohighlight">\(CPI_t = CPI_{t_i} + (CPI_{t_{i+1}} - CPI_{t_i}) \frac{\min(t - t_i, 29)}{30}, t_i \leq t \leq t_{i+1}\)</span></p>
</section>
<section id="australian-inflation-bond-interpolation">
<h4>3.3.8.22.2.5. Australian inflation bond interpolation<a class="headerlink" href="#australian-inflation-bond-interpolation" title="Link to this heading">#</a></h4>
<p>The CPI values for Australian linkers are published every 3 months and are applicable to the entire
quarter, they are associated with the mid-point of the quarter. We associate the CPI values with
1 Jan, 1 Apr, 1 Jul and 1 Oct. The inflation multipliers for the cashflows are much more closely linked
to the bond’s actual coupon payment dates. They are defined by:</p>
<p><span class="math notranslate nohighlight">\(K_{t_i} = \left[K_{t_{i-1}} \left(1 +  \left [\frac{1}{2} \left(\frac{CPI_{t_i-6M} }{CPI_{t_i-12M}}\right)\right]_4\right)\right]_4\)</span></p>
<p><span class="math notranslate nohighlight">\(t_i\)</span> is the date of a coupon payment. If <span class="math notranslate nohighlight">\(t_i\)</span> is the first coupon payment then <span class="math notranslate nohighlight">\(K_n\)</span> is defined
(usually 1). The formula expresses that the rate of inflation from one quarter to the next
average percentage change in CPI over two quarters prior to that in which the next interest payment falls. The square brackets with subscript indicate
indexing of decimals.</p>
<p>Index ratios for dates between coupon payment dates are defined by:</p>
<p><span class="math notranslate nohighlight">\(K_{t} = K_{t_i} \left(1 +  \left [\frac{1}{2} \left(\frac{CPI_{t_i-6M} }{CPI_{t_i-12M}}\right)\right]_4\right)^{-(t_i - t)/(t_i - t_{i-1})}, t_i \leq t \leq t_{i+1}\)</span></p>
<p>The entire definition assumes that Australian inflation-linked bonds has a coupon frequency of 3
months.</p>
</section>
<section id="mexican-inflation-bond-interpolation">
<h4>3.3.8.22.2.6. Mexican inflation bond interpolation<a class="headerlink" href="#mexican-inflation-bond-interpolation" title="Link to this heading">#</a></h4>
<p>De linkers values. Daily UDI (Unidades) values are derived from the twice-monthly published CPI values. We
associate the CPI values with the mid-point of the month, one starting on the 1st of a month and ending on the 25th of the same
month, another starting on the 26th of the previous month and ending on the 10th of the next month.</p>
<p>We can define the UDI value:</p>
<p><span class="math notranslate nohighlight">\(UDI_t =UDI_{startofPeriod}  \left(\frac{CPI_{startofPeriod}}{CPI_{t-1M}}\right)^{(t-startofPeriod)/lengthofPeriod} \)</span></p>
<p>The base value is 1.1676/48 on 25 Jan 1995.</p>
</section>
<section id="unused-interpolation-types">
<h4>3.3.8.22.2.7. Unused interpolation types<a class="headerlink" href="#unused-interpolation-types" title="Link to this heading">#</a></h4>
<p>I.e. these are implemented for the inflation bonds, but these bonds are not used in NCF:</p>
<ol class="arabic simple">
<li><p>Colombian inflation bond interpolation</p></li>
<li><p>Chilean inflation bond interpolation</p></li>
<li><p>Argentine inflation bond interpolation</p></li>
<li><p>Uruguayan inflation bond interpolation</p></li>
<li><p>Brazilian inflation bond interpolation</p></li>
</ol>
</section>
</section>
<section id="inflation-zero-coupon-swap">
<h3>3.3.8.23 Inflation Zero Coupon Swap<a class="headerlink" href="#inflation-zero-coupon-swap" title="Link to this heading">#</a></h3>
<p>The price of the zero coupon swap is defined through the inflation rate between start and end date.
This defines the index at a future date.</p>
<p><span class="math notranslate nohighlight">\(e &gt; b\)</span></p>
<p>With compounding (frequency <span class="math notranslate nohighlight">\(f\)</span>), <span class="math notranslate nohighlight">\(\tau_{s,e}f &gt; 1.0\)</span>:</p>
<p><span class="math notranslate nohighlight">\(p = \left[ \left(\frac{CPI_{e-lag}}{CPI_{s-lag} } \right)^{\frac{1}{\tau_{s,e}f}} - 1\right]f\)</span></p>
<p>If <span class="math notranslate nohighlight">\(\tau_{s,e}f \leq 1.0\)</span></p>
<p><span class="math notranslate nohighlight">\(p = P_{b,s,e} = \left(\frac{CPI_{e-lag}}{CPI_{s-lag} } \right){\frac{1}{\tau_{s,e}}}\)</span></p>
<p>In NCF production, only compounding, annual frequency are used:</p>
<p><span class="math notranslate nohighlight">\(\tau_{s,e} \leq 1.0\)</span></p>
<p><span class="math notranslate nohighlight">\(p = \left(\frac{CPI_{e-lag}}{CPI_{s-lag} } \right){\frac{1}{\tau_{s,e}}}\)</span></p>
<p><span class="math notranslate nohighlight">\(\tau_{s,e} &gt; 1.0\)</span></p>
<p><span class="math notranslate nohighlight">\(p = \left(\frac{CPI_{e-lag}}{CPI_{s-lag} } \right)^{\frac{1}{\tau_{s,e}}} - 1\)</span></p>
<p>Also it can be noted that for those instruments used in NCF <span class="math notranslate nohighlight">\(\tau\)</span> is always a whole number of years, <span class="math notranslate nohighlight">\(y\)</span>, in the instruments used (using a daycount basis of 30/360), so we can simplify to a single formula:</p>
<p><span class="math notranslate nohighlight">\(p = \left( \frac{CPI_{e-lag}}{CPI_{s-lag} } \right)^{\frac{1}{y}} - 1\)</span></p>
<section id="id6">
<h4>3.3.8.23.1. Payoff<a class="headerlink" href="#id6" title="Link to this heading">#</a></h4>
<p>The payoff for an inflation zero coupon swap, using the simplified case from (1):</p>
<p>Notional = <span class="math notranslate nohighlight">\(N\)</span> (we notional is receiving fixed)</p>
<p>Payment are:</p>
<p>Fixed leg: <span class="math notranslate nohighlight">\(N((1 + p)^{y} - 1)\)</span></p>
<p>Floating leg = <span class="math notranslate nohighlight">\(   -N\left[ \left(\frac{CPI_{e-lag}}{CPI_{s-lag} } \right)- 1\right]\)</span></p>
<p><span class="math notranslate nohighlight">\(df_e\)</span> = Discount factor at end (payment date)</p>
<p>PV = <span class="math notranslate nohighlight">\(N\left[(1 + p)^{y} - 1\right]df_e-N\left[ \frac{CPI_{e-lag}}{CPI_{s-lag} }- 1\right]df_e= N\left[(1 + p)^{y} - \frac{CPI_{e-lag}}{CPI_{s-lag} }\right]df_e\)</span></p>
</section>
</section>
<section id="inflation-future">
<h3>3.3.8.24. Inflation Future<a class="headerlink" href="#inflation-future" title="Link to this heading">#</a></h3>
<p>[Pending production use]</p>
<p>The price of the inflation futures is defined through the inflation rate between start and end date.</p>
<p><span class="math notranslate nohighlight">\(p = P_{b,s,e}=100  \cdot \left[1 - \left(\frac{CPI_e}{CPI_s} - 1\right)\frac{1}{\tau_{s,e}}\right]\)</span></p>
</section>
<section id="inflation-bond">
<h3>3.3.8.25. Inflation Bond<a class="headerlink" href="#inflation-bond" title="Link to this heading">#</a></h3>
<p>This instrument defines an inflation curve (3.3.3.5). Prices are generated by the Rates bond model. For details on inflation-linked bond model.</p>
<p>The simple general case is a calculation of inflation-linked bond price/yield.</p>
<p>In calibration to Price - Yield calculation is used, i.e. Calculate yield <span class="math notranslate nohighlight">\(y\)</span>, from dirty price <span class="math notranslate nohighlight">\(p\)</span>:</p>
<p><span class="math notranslate nohighlight">\(p = \sum \frac{c_i}{(1+y)^{t_i}} + \frac{R}{(1+y)^{n}}\)</span></p>
<p>where:
<span class="math notranslate nohighlight">\(n\)</span> = cashflows between settlement date and maturity date
<span class="math notranslate nohighlight">\(c_i\)</span> = cashflow at time <span class="math notranslate nohighlight">\(i\)</span>
<span class="math notranslate nohighlight">\(f\)</span> = compounding frequency
<span class="math notranslate nohighlight">\(t_i\)</span> = day count fraction between settlement date and coupon payment date <span class="math notranslate nohighlight">\(i\)</span>
<span class="math notranslate nohighlight">\(R\)</span> = redemption value</p>
<p>The inflation-linked bonds generate inflation coupons defined as below and require the inflation curve:</p>
<p><span class="math notranslate nohighlight">\(c_i = c  \cdot \frac{CPI_{{t_i}-lag}}{CPI_{base}}\)</span></p>
<p><span class="math notranslate nohighlight">\(c\)</span> = fixed coupon at issue (base date)</p>
<p><span class="math notranslate nohighlight">\(CPI_{{t_i}-lag}\)</span> = inflation index at time <span class="math notranslate nohighlight">\(t_i\)</span>, adjusted for lag</p>
<p><span class="math notranslate nohighlight">\(CPI_{base}\)</span> = base inflation index of the bond (issue date)</p>
<p>The similar implementation sees a computation as follows. For details on other inflation bond price/yield model implementation see “Inflation-linked bond model”.</p>
<p><span class="math notranslate nohighlight">\(p = \sum \frac{c  \cdot \frac{CPI_{{t_i}-lag}}{CPI_{base}}}{(1+\frac{y}{f})^{f\tau_i}} + \frac{R  \cdot \frac{CPI_{{t_n}-lag}}{CPI_{base}}}{(1+\frac{y}{f})^{f\tau_n}}\)</span></p>
<p><span class="math notranslate nohighlight">\(n\)</span> = # cashflows between settlement date and maturity date</p>
<p><span class="math notranslate nohighlight">\(c_{i}\)</span> = cashflow at time <span class="math notranslate nohighlight">\(t_i\)</span></p>
<p><span class="math notranslate nohighlight">\(f\)</span> = compounding frequency</p>
<p><span class="math notranslate nohighlight">\(\tau_{i}\)</span> = day count fraction between settlement date and coupon payment date <span class="math notranslate nohighlight">\(i\)</span></p>
<p><span class="math notranslate nohighlight">\(R\)</span> = redemption value</p>
<p>When a price is input, <span class="math notranslate nohighlight">\(yield^{dirty}\)</span> would be calculated for later use.</p>
<p>A bond as an input to the curve is respecified such that the bond (dirty) is returned, discounting the cashflows from the curve, i.e.:</p>
<p><span class="math notranslate nohighlight">\(p = \sum (c  \cdot \frac{CPI_{{t_i}-lag}}{CPI_{base}} \cdot df_{t_i}^{Nominal}) + R  \cdot \frac{CPI_{{t_n}-lag}}{CPI_{base}} \cdot df_{t_n}^{Nominal}\)</span></p>
<section id="id7">
<h4>3.3.8.25.1. Penalty function calculation<a class="headerlink" href="#id7" title="Link to this heading">#</a></h4>
<p>The bond yield (real yield) is used in the calculation of the score for the penalty function. Thus,</p>
<p><span class="math notranslate nohighlight">\(penalty = (real\_yield^{curves} - real\_yield^{price,discountcurve})\)</span></p>
</section>
</section>
<section id="real-rate-swap">
<h3>3.3.8.26 Real Rate Swap<a class="headerlink" href="#real-rate-swap" title="Link to this heading">#</a></h3>
<p>A real rate swap is analogous to a cross-currency swap. One leg pays a fixed rate inflation, the other a floating rate:</p>
<p><span class="math notranslate nohighlight">\(p\sum_{i=1}^{n-1}(\frac{CPI_{{t_{i+1}}-lag}}{CPI_{s-lag}}) \cdot \tau_{t_i,t_{i+1}}df_{t_{i+1}}^{Nominal} +(\frac{CPI_{e-lag}}{CPI_{s-lag}}) \cdot df_{e}^{Nominal}=\sum_{j=1}^{m-1} R_{t_j}^{\theta}\cdot \tau_{t_j,t_{j+1}}df_{t_{j+1}}^{Nominal} + df_{e}^{Nominal}\)</span></p>
<p><span class="math notranslate nohighlight">\(p=\frac{\sum_{j=1}^{m-1} R_{t_j}^{\theta}\cdot \tau_{t_j,t_{j+1}}df_{t_{j+1}}^{Nominal} + df_{e}^{Nominal}(1-(\frac{CPI_{e-lag}}{CPI_{s-lag}}))}{\sum_{i=1}^{n-1}(\frac{CPI_{{t_{i+1}}-lag}}{CPI_{s-lag}}) \cdot \tau_{t_i,t_{i+1}}df_{t_{i+1}}^{Nominal}}\)</span></p>
</section>
<section id="inflation-bond-spread-coupon-spread-ncf-name-inflation-asset-swap-spread">
<h3>3.3.8.27 Inflation Bond Spread (Coupon Spread) [NCF name: Inflation Asset Swap Spread]<a class="headerlink" href="#inflation-bond-spread-coupon-spread-ncf-name-inflation-asset-swap-spread" title="Link to this heading">#</a></h3>
<p>The price of this instrument is the spread added to the inflation-adjusted coupon payments (the coupons of an inflation-linked bond), that when discounted with the nominal (bond) discount curve will reprice the inflation bond.</p>
<p>The simple/general cases is a computation as follows. For details on other inflation bond price/yield implementations see “inflation-linked bond model”.</p>
<p><em>base</em> is the base date for the CPI of the bond.</p>
<p><span class="math notranslate nohighlight">\(\sum_{i=1}^{n}(c+p\tau_{i})\left(\frac{(CPI_{t_i-lag})}{CPI_{base}}\right)df_{t_i}^{Nominal}+\left(\frac{(CPI_{t_n-lag})}{CPI_{base}}\right)df_{t_n}^{Nominal}=P_{\textrm{InflationBond}}\)</span></p>
<p>It should be noted that the instrument has 2 ‘price’ inputs (somewhat analogous to price and convexity for an IR Future, 3.3.8.4).
)</p>
<ol class="arabic simple">
<li><p>1.<span class="math notranslate nohighlight">\(p\)</span> (spread)</p></li>
<li><p>2.<span class="math notranslate nohighlight">\(P_{\textrm{InflationBond}}\)</span></p></li>
</ol>
<p><span class="math notranslate nohighlight">\(p=\frac{P_{\textrm{InflationBond}}-C\sum_{i=1}^{n}\left(\frac{(CPI_{t_i-lag})}{CPI_{base}}\right)df_{t_i}^{Nominal}-\left(\frac{(CPI_{t_n-lag})}{CPI_{base}}\right)df_{t_n}^{Nominal}}{\sum_{i=1}^{n}\tau_{t_i}\left(\frac{(CPI_{t_i-lag})}{CPI_{base}}\right)df_{t_i}^{Nominal}}\)</span></p>
</section>
<section id="seasonality">
<h3>3.3.8.28 Seasonality<a class="headerlink" href="#seasonality" title="Link to this heading">#</a></h3>
<p>Seasonality may not be seen as an instrument but it does define an interpolator, so we include it here.</p>
<p>Inflation seasonality is the tendency of inflation indices to exhibit different rates of growth at certain times of the year. The inflation curve deals with seasonality by allowing the definition of a series of seasonal terms. These define a set of monthly factors which are applied to the inflation indices.</p>
<p>They should be viewed as an instrument because risk can be returned against them. This risk is consumed from EOD systems by both trading and control functions.</p>
<p>To implement seasonality an interpolator is created with the 12 monthly terms repeated each year. This is then used in the building and repricing of the other inflation instruments for the construction of the final curve.</p>
<p>Seasonality is defined as 12 values (Jan-Dec), that can be rescaled such their product is 1.0. These factors form the 12 repeating discount factors of the seasonality curve/interpolator.</p>
<p>Thus a set of seasonality factors:
jar=0.987702, Feb=0.990201, Mar=0.999500, Apr=1.000000, May=1.000000, Jun=0.995959, Jul=0.993081, Aug=0.994461, Sep=0.997300, Oct=0.998000, Nov=0.996381, Dec=0.998300</p>
<p><span class="math notranslate nohighlight">\(d_{10} = 0.991353, d_{11} = 0.993061, d_{12} = 1.003194, d_{13} = 1.004499, d_{14} = 1.003696, d_{15} =
1.003290, d_{16} = 0.996772, d_{17} = 0.998297, d_{18} = 1.000896, d_{19} = 1.001689\)</span></p>
<p>This normalization is made internally in NCF.
These discount factors would be for the whole of the month in question, there is no interpolation.
They then repeat every year.</p>
</section>
<section id="interpolation">
<h3>3.3.9 Interpolation<a class="headerlink" href="#interpolation" title="Link to this heading">#</a></h3>
<p>A curve will consist of one or more interpolators (e.g. if seasonality is used this introduces a second interpolator to a curve). Each of these interpolators has two facets:</p>
<ol class="arabic simple">
<li><p>the types of interpolation available</p></li>
<li><p>the potential split of interpolation into two sections: interpolation of one type to a split date, interpolation of another type after the split date.</p></li>
</ol>
<p>Types of interpolation</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(t_1\)</span> is the set of node dates defined for a curve.
For a discount factor curve this would be a set of <span class="math notranslate nohighlight">\(\{t_0, d_1\}\)</span>, <span class="math notranslate nohighlight">\((d_1 = 1.0)\)</span>.</p></li>
</ol>
<p>For a forward rate curve this would be a set of <span class="math notranslate nohighlight">\(\{t_0, d_1\}\)</span>.</p>
<p>Interpolation is often a choice between:
a) Local interpolation - <span class="math notranslate nohighlight">\(d_0\)</span>(will only depend on <span class="math notranslate nohighlight">\(\{t_0, d_1\}\)</span>, where <span class="math notranslate nohighlight">\(t_1 &lt; t &lt; t_1\)</span>).
b) Smooth, non-local. Above condition does not hold.</p>
<section id="geometric-log-linear">
<h4>3.3.9.1 Geometric/log linear<a class="headerlink" href="#geometric-log-linear" title="Link to this heading">#</a></h4>
<p>Local discount factor curve
This is linear interpolation of the natural logarithm of the discount factors.</p>
<p><span class="math notranslate nohighlight">\(\ln(df_t) = \frac{t-t_i}{t_{i+1}-t_i} \ln(df_{t_{i+1}}) + \frac{t_{i+1}-t}{t_{i+1}-t_i}\ln(df_{t_i})\)</span></p>
<p><span class="math notranslate nohighlight">\(\ln(df_t) = (t-t_i)\frac{\ln(df_{t_{i+1}}) - \ln(df_{t_i})}{t_{i+1}-t_i} + \ln(df_{t_i})\)</span></p>
<p>We can note that <span class="math notranslate nohighlight">\(\frac{\partial}{\partial_t} \ln(df_{t_{i}}) = \frac{\ln(df_{t_{i+1}}) - \ln(df_{t_{i}})}{t_{i+1} - t_{i}}\)</span>.</p>
<section id="extrapolation">
<h5>3.3.9.1.1 Extrapolation<a class="headerlink" href="#extrapolation" title="Link to this heading">#</a></h5>
<p><span class="math notranslate nohighlight">\(
\frac{\partial}{\partial_t} \ln(df_{t_{n}}) = \frac{\ln(df_{t_{n}}) - \ln(df_{t_{n-1}})}{t_{n} - t_{n-1}}
\)</span></p>
<p><span class="math notranslate nohighlight">\(
\ln(df_{t_{n}}) = (t_{n} - t_{0}) \left( \frac{\ln(df_{t_{n}}) - \ln(df_{t_{n-1}})}{t_{n} - t_{n-1}} \right) + \ln(df_{t_{n}}), \, t &gt; t_{n}\)</span></p>
</section>
</section>
<section id="linear-zero-rate-interpolation-exponential">
<h4>3.3.9.2 Linear Zero Rate Interpolation (‘Exponential’)<a class="headerlink" href="#linear-zero-rate-interpolation-exponential" title="Link to this heading">#</a></h4>
<p>Currently implemented interpolation type ‘Exponential’ is equivalent to linearly interpolating the continuously compounded zero rates from the interpolation.</p>
<p><span class="math notranslate nohighlight">\(
\frac{\ln(df_t)}{t - t_r} = \left( \frac{t - t_i}{t_{i+1} - t_i} \right) \frac{\ln(df_{t_{i+1}})}{t_{i+1} - t_r} + \left( \frac{t_{i+1} - t}{t_{i+1} - t_i} \right) \frac{\ln(df_{t_i})}{t_i - t_r}
\)</span></p>
<p><span class="math notranslate nohighlight">\(
t_i \leq t \leq t_{i+1}
\)</span></p>
<p><span class="math notranslate nohighlight">\(
\ln(df_t) = \left( \frac{t - t_r}{t_{i+1} - t_i} \right) \left( \frac{t - t_i}{t_{i+1} - t_r} \right) \ln(df_{t_{i+1}}) + \left( \frac{t_{i+1} - t}{t_i - t_r} \right) \ln(df_{t_i})
\)</span></p>
<p><span class="math notranslate nohighlight">\(
\ln(df_t) = \frac{1}{t_{i+1} - t_i} \left( \left( \frac{t^2 - (t_i + t_r)t + t_i t_r}{t_{i+1} - t_r} \right) \ln(df_{t_{i+1}}) + \left( \frac{-t^2 + (t_{i+1} - t_r)t - t_{i+1}t_r}{t_i - t_r} \right) \ln(df_{t_i}) \right)
\)</span></p>
<p><span class="math notranslate nohighlight">\(
\frac{\partial}{\partial t} \ln(df_t) = \frac{1}{t_{i+1} - t_i} \left( \left( \frac{2t - (t_i + t_r)}{t_{i+1} - t_r} \right) \ln(df_{t_{i+1}}) + \left( \frac{-2t + (t_{i+1} - t_r)}{t_i - t_r} \right) \ln(df_{t_i}) \right)
\)</span></p>
<section id="id8">
<h5>3.3.9.2.1. Extrapolation<a class="headerlink" href="#id8" title="Link to this heading">#</a></h5>
<p>Extrapolation is geometric:</p>
<p><span class="math notranslate nohighlight">\(
\frac{\partial}{\partial t} \ln(df_{t_n}) = \frac{1}{t_n - t_{n-1}} \left( \left( \frac{2t_n - (t_{n-1} + t_r)}{t_n - t_r} \right) \ln(df_{t_n}) + \left( \frac{-2t_n + (t_n - t_r)}{t_{n-1} - t_r} \right) \ln(df_{t_{n-1}}) \right)
\)</span></p>
<p><span class="math notranslate nohighlight">\(
\frac{\partial}{\partial t} \ln(df_{t_n}) = \frac{1}{t_n - t_{n-1}} \left( \left( \frac{2t_n - t_{n-1} - t_r}{t_n - t_r} \right) \ln(df_{t_n}) - \left( \frac{t_n + t_r}{t_{n-1} - t_r} \right) \ln(df_{t_{n-1}}) \right)
\)</span></p>
<p><span class="math notranslate nohighlight">\(
\ln(df_t) = (t - t_n) \left( \frac{1}{t_n - t_{n-1}} \left( \left( \frac{2t_n - t_{n-1} - t_r}{t_n - t_r} \right) \ln(df_{t_n}) - \left( \frac{t_n + t_r}{t_{n-1} - t_r} \right) \ln(df_{t_{n-1}}) \right) \right) + \ln(df_{t_n}), t &gt; t_n
\)</span></p>
</section>
</section>
<section id="log-cubic">
<h4>3.3.9.3. Log-cubic<a class="headerlink" href="#log-cubic" title="Link to this heading">#</a></h4>
<p>Smooth, discount factor curve</p>
<p>The log cubic interpolation algorithm uses cubic spline interpolation on the natural log of the discount factors. This creates a smooth forward curve. While Geometric and Exponential interpolation are only continuous in the function itself (i.e. the first derivative is discontinuous at the node points); Cubic interpolation is continuous up to the second derivative.</p>
<p>This technique involves fitting a cubic polynomial to each pair of known points in the curve. The curve is built from a series of cubic segments. Boundary conditions are imposed to ensure the curve is smooth at the points where two segments are joined together.</p>
<p>With cubic splines for each segment (between successive node dates) of the form:</p>
<p><span class="math notranslate nohighlight">\(
\ln df_t = f_i(t) = p_t(t - t_i)^3 + q_t(t - t_i)^2 + r_t(t - t_i) + \ln df_{t_i}
\)</span></p>
<p>and the conditions for continuous first and second derivative at <span class="math notranslate nohighlight">\( t_{i+1} \)</span>:</p>
<p><span class="math notranslate nohighlight">\(
f_i(t_{i+1}) = \ln df_{t_{i+1}}, 0 \leq i \leq n - 1
\)</span></p>
<p><span class="math notranslate nohighlight">\(
\partial_t f_i(t_{i+1}) = \partial_t f_{t_{i+1}}(t_{i+1}), 0 \leq i \leq n - 2
\)</span></p>
<p><span class="math notranslate nohighlight">\(
\partial_t^2 f_i(t_{i+1}) = \partial_t^2 f_{t_{i+1}}(t_{i+1}), 0 \leq i \leq n - 2
\)</span></p>
<p>we have 3n unknowns and 3n-2 equations. two further conditions can be obtained by setting either the first or second derivative at the end points to a specific number, i.e. there are 4 possible combinations of end point specifications:</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(\partial_t f_0(t_0), \partial_t f_{n-1}(t_n)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\partial_t f_0(t_0), \partial_t^2 f_{n-1}(t_n)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\partial_t^2 f_0(t_0), \partial_t f_{n-1}(t_n)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\partial_t^2 f_0(t_0), \partial_t^2 f_{n-1}(t_n)\)</span></p></li>
</ol>
<p>In NCF 4) is employed, with <span class="math notranslate nohighlight">\(\partial_{t}^{2}f_{0}(t_{0}) = \partial_{t}^{2}f_{n-1}(t_{n}) = 0\)</span>.</p>
<p>Setting <span class="math notranslate nohighlight">\(h_{i} = t_{i+1} - t_{i}\)</span> we can reduce the three continuity conditions to one equation:</p>
<p><span class="math notranslate nohighlight">\(
h_{i-1}q_{i-1} + 2(h_{i-1} + h_{i})q_{i} + h_{i}q_{i+1} = 3\left(\frac{\ln df_{t_{i+1}} - \ln df_{t_{i}}}{h_{i}} - \frac{\ln df_{t_i} - \ln df_{t_{i+1}}}{h_{i-1}}\right), 1 \leq i \leq n-1
\)</span></p>
<p>This is a tridiagonal system of equations. If the first derivative at the left most end point is specified the additional equation</p>
<p><span class="math notranslate nohighlight">\(
3h_{0}q_{0} + 2(3h_{0} + 2h_{1})q_{1} + h_{1}q_{2} = 3\left(\frac{\ln df_{t_{2}} - \ln df_{t_{1}}}{h_{1}} - \partial_{t}f_{0}(t_{0})\right)
\)</span></p>
<p>is required. If the first derivative at the right most end point is specified the additional equation</p>
<p><span class="math notranslate nohighlight">\(
h_{n-1}q_{n-1} + 2h_{n-1}q_{n} = 3\left(\partial_{t}f_{t_{n-1}}(t_{n}) - \frac{\ln df_{t_{n-1}} - \ln df_{t_{n}}}{h_{n-1}}\right)
\)</span></p>
<p>is required. The tridiagonal system can be solved with the Thomas algorithm.</p>
<p>Once the <span class="math notranslate nohighlight">\(q_{i}\)</span>’s have been calculated the other parameters can be determined as</p>
<p><span class="math notranslate nohighlight">\(
r_{i} = \ln df_{t_{i}} - \frac{h_{i}}{3}(2q_{i} + q_{i+1})
\)</span></p>
<p><span class="math notranslate nohighlight">\(
p_{i} = \frac{1}{3h_{i}}(q_{i+1} - q_{i})
\)</span></p>
<section id="id9">
<h5>3.3.9.3.1. Extrapolation<a class="headerlink" href="#id9" title="Link to this heading">#</a></h5>
<p>Extrapolation is geometric. I.e. since condition 4) is met, <span class="math notranslate nohighlight">\(\partial_{t}^{2}f_{n-1}(t_{n}) = 0\)</span>, the interpolation is C2 continuous.</p>
<p><span class="math notranslate nohighlight">\(
t &gt; t_{n-1}: f_{i}(t) = \ln df_{t} = p_{n-1}(t - t_{n-1})^{3} + q_{n-1}(t - t_{n-1})^{2} + r_{n-1}(t - t_{n-1}) + \ln df_{t_{n-1}}
\)</span></p>
<p><span class="math notranslate nohighlight">\(
\frac{\partial}{\partial t}\ln(df_{t_{}}) = p_{n-1}(3t^{2} - 6t_{n-1} + 3t_{n-1}^{2}) + q_{n-1}(2t - 2t_{n-1}) + r_{n-1}
\)</span></p>
<p>Thus <span class="math notranslate nohighlight">\(\frac{\partial}{\partial t}\ln(df_{t_{n}}) = 3p_{n-1}(t_{n} - t_{n-1})^{2} + 2q_{n-1}(t_{n} - t_{n-1}) + r_{n-1}\)</span></p>
<p><span class="math notranslate nohighlight">\(
\ln(df_{t_{}}) = (t - t_{n})(3p_{n-1}(t_{n} - t_{n-1})^{2} + 2q_{n-1}(t_{n} - t_{n-1}) + r_{n-1}) + \ln(df_{t_{n}}), t &gt; t_{n}
\)</span></p>
</section>
</section>
<section id="cpi-linear-inflation-curves-only">
<h4>3.3.9.4. CPI linear (inflation curves only)<a class="headerlink" href="#cpi-linear-inflation-curves-only" title="Link to this heading">#</a></h4>
</section>
<section id="local-discount-factor-curve-inflation-representation">
<h4>3.3.9.4.1 Local, Discount Factor Curve (Inflation Representation)<a class="headerlink" href="#local-discount-factor-curve-inflation-representation" title="Link to this heading">#</a></h4>
<p>Inverse linear interpolation interpolates linearly between the inverse of the discount factors.</p>
<p><span class="math notranslate nohighlight">\(
\frac{1}{df_{t_{}}} = \left(\frac{t - t_{i}}{t_{i+1} - t_{i}}\right)\frac{1}{df_{t_{i+1}}} + \left(\frac{t_{i+1} - t}{t_{i+1} - t_{i}}\right)\frac{1}{df_{t_{i}}}
\)</span></p>
<section id="id10">
<h5>3.3.9.4.1. Extrapolation<a class="headerlink" href="#id10" title="Link to this heading">#</a></h5>
<p>Extrapolation is CPI Linear:</p>
<p><span class="math notranslate nohighlight">\(
\frac{1}{df_{t_{}}} = \left(\frac{t - t_{n-1}}{t_{n} - t_{n-1}}\right)\frac{1}{df_{t_{i}}} - \left(\frac{t - t_{n}}{t_{n} - t_{n-1}}\right)\frac{1}{df_{t_{i+1}}}, t &gt; t_{n}
\)</span></p>
</section>
</section>
<section id="linear-rate">
<h4>3.3.9.5. Linear Rate<a class="headerlink" href="#linear-rate" title="Link to this heading">#</a></h4>
</section>
<section id="local-forward-rate-curve">
<h4>3.3.9.5.1 Local, Forward Rate Curve<a class="headerlink" href="#local-forward-rate-curve" title="Link to this heading">#</a></h4>
<p>Linear interpolation of the forward rate</p>
<p><span class="math notranslate nohighlight">\(
R_{t}^{\theta} = \left(\frac{t - t_{i}}{t_{i+1} - t_{i}}\right)R_{t_{i+1}}^{\theta} + \left(\frac{t_{i+1} - t}{t_{i+1} - t_{i}}\right)R_{t_i}^{\theta}
\)</span></p>
<section id="id11">
<h5>3.3.9.5.1. Extrapolation<a class="headerlink" href="#id11" title="Link to this heading">#</a></h5>
<p>Extrapolation is flat:<br />
<span class="math notranslate nohighlight">\( R_t^\theta = R_{t_n}^\theta, \quad t &gt; t_n \)</span></p>
</section>
</section>
<section id="quadratic-rate">
<h4>3.3.9.6. Quadratic Rate<a class="headerlink" href="#quadratic-rate" title="Link to this heading">#</a></h4>
<p>Smooth, forward rate curve<br />
This method is very similar to cubic spline. It fits a series of points using quadratic splines.</p>
<p>The quadratic is of the form:<br />
<span class="math notranslate nohighlight">\( f_i(t) = p_i(t - t_i)^2 + q_i(t - t_i) + r_i \)</span>
<span class="math notranslate nohighlight">\( f_i'(t) = 2p_i(t - t_i) + q_i \quad (1) \)</span>
<span class="math notranslate nohighlight">\( f_i'(t_i) = q_i \quad (2) \)</span></p>
<p>Each portion is fitted according to the constraint:<br />
<span class="math notranslate nohighlight">\( f_i'(t_{i+1}) = f_{i+1}'(t_{i+1}) \)</span>
From (1):<br />
<span class="math notranslate nohighlight">\( f_i'(t_{i+1}) = f_{i+1}'(t_{i+1}) = q_{i+1} = 2p_i(t_{i+1} - t_i) + q_i \quad (3) \)</span></p>
<p>We have a boundary condition, with two options available:</p>
<ul class="simple">
<li><p>An initial gradient (left gradient) supplied <span class="math notranslate nohighlight">\( f_i'(t_i) \)</span>.</p></li>
<li><p>A final gradient (right gradient) supplied, <span class="math notranslate nohighlight">\( f_x'(t_x) \)</span>. If this were the boundary condition, the interpolation is effectively run backwards such that the same algorithm applies.</p></li>
</ul>
<p>This is the one implemented in NCF – the curve is flat after the last node. Hence:<br />
<span class="math notranslate nohighlight">\( f_x'(t_x) = 0 \)</span></p>
<p>We also have:<br />
<span class="math notranslate nohighlight">\( f_i(t_i) = r_i \quad (4) \)</span></p>
<section id="right-gradient">
<h5>3.3.9.6.1. Right gradient<a class="headerlink" href="#right-gradient" title="Link to this heading">#</a></h5>
<p>We also have continuity in the derivative:<br />
<span class="math notranslate nohighlight">\( f_x'(t_x) = f_{x-1}'(t_x) = 0 \)</span></p>
<p>This can be used to project “backwards” the coefficients of the interpolator:<br />
<span class="math notranslate nohighlight">\( r_{i+1} = p_i(t_{i+1} - t_i)^2 + q_i(t_{i+1} - t_i) + r_i \)</span></p>
<p><span class="math notranslate nohighlight">\( q_{i+1} = 2p_i(t_{i+1} - t_i) + q_i \)</span></p>
<p><span class="math notranslate nohighlight">\( r_{i+1} = p_i(t_{i+1} - t_i)^2 + (q_{i+1} - 2p_i(t_{i+1} - t_i))(t_{i+1} - t_i) + r_i \)</span></p>
<p><span class="math notranslate nohighlight">\( p_i(t_{i+1} - t_i)^2 = q_{i+1}(t_{i+1} - t_i) - (r_{i+1} - r_i) \)</span></p>
<p><span class="math notranslate nohighlight">\( p_i = \frac{q_{i+1}(t_{i+1} - t_i) - (r_{i+1} - r_i)}{(t_{i+1} - t_i)^2} \)</span></p>
<p><span class="math notranslate nohighlight">\( q_i = q_{i+1} - 2\left(\frac{q_{i+1}(t_{i+1} - t_i) - (r_{i+1} - r_i)}{(t_{i+1} - t_i)}\right) \)</span></p>
<p><span class="math notranslate nohighlight">\( q_i = 2\frac{r_{i+1} - r_i}{(t_{i+1} - t_i)} - q_{i+1} \)</span></p>
<p>A right gradient of 0 implies <span class="math notranslate nohighlight">\( p_n = q_n = 0 \)</span>, thus:<br />
<span class="math notranslate nohighlight">\( p_{n-1} = \frac{r_{n-1} - r_n}{(t_n - t_{n-1})^2} \)</span></p>
<p><span class="math notranslate nohighlight">\( q_{n-1} = \frac{2(r_n - r_{n-1})}{(t_n - t_{n-1})} \)</span></p>
</section>
<section id="left-gradient">
<h5>3.3.9.6.2. Left gradient<a class="headerlink" href="#left-gradient" title="Link to this heading">#</a></h5>
<p>If we return to the condition of the left gradient, <span class="math notranslate nohighlight">\( f_1'(t_1) \)</span></p>
<p><span class="math notranslate nohighlight">\( f_1'(t_2) = f_2'(t_2) \)</span></p>
<p>Substituting (2) &amp; (4) into (3):</p>
<p><span class="math notranslate nohighlight">\( f_1(t) = p_1(t - t_1)^2 + q_1(t - t_1) + r_1 \)</span></p>
<p><span class="math notranslate nohighlight">\( r_2 = p_1(t_2 - t_1)^2 + q_1(t_2 - t_1) + r_1 \)</span></p>
<p><span class="math notranslate nohighlight">\( q_1 = f_1'(t_1) \text{ as above} \)</span></p>
<p><span class="math notranslate nohighlight">\( p_1 = \frac{(r_2 - r_1) - f_1'(t_1)(t_2 - t_1)}{(t_2 - t_1)^2} \)</span></p>
<p>Or – along with (3) - to enable the coefficients <span class="math notranslate nohighlight">\( p_i \)</span> and <span class="math notranslate nohighlight">\( q_i \)</span> to be “bootstrapped” from <span class="math notranslate nohighlight">\( q_1 \)</span> and <span class="math notranslate nohighlight">\( r_i \)</span>‘s:</p>
<p><span class="math notranslate nohighlight">\( p_i = \frac{(f_i(t_{i+1}) - f_1(t_i)) - f_i'(t_i)(t_{i+1} - t_i)}{(t_{i+1} - t_i)^2} \)</span></p>
<p><span class="math notranslate nohighlight">\( q_{i+1} = 2p_i(t_{i+1} - t_i) + q_i \)</span></p>
</section>
<section id="id12">
<h5>3.3.9.6.3. Extrapolation<a class="headerlink" href="#id12" title="Link to this heading">#</a></h5>
<p>Extrapolation is flat:</p>
<p><span class="math notranslate nohighlight">\( R_t^\theta = R_{t_n}^\theta, \, t &gt; t_n \)</span></p>
</section>
<section id="id13">
<h5>3.3.9.7. Extrapolation<a class="headerlink" href="#id13" title="Link to this heading">#</a></h5>
<p>It is not recommended to query a curve beyond the last node date (of all interpolators). For this reason a simple method is employed to extrapolate. Extrapolation is at the level of interpolator, not curve (since a curve may contain several interpolators).</p>
</section>
</section>
</section>
<section id="id14">
<h3>3.3.10 Seasonality<a class="headerlink" href="#id14" title="Link to this heading">#</a></h3>
<p>It is worth noting how seasonality is applied to an inflation curve. The curve will have two interpolators – one with what we might term the “underlying” interpolation. This interpolator will have node dates as required to reprice the input instruments. Seasonality will be a second interpolator with 12 monthly points, repeating each year.</p>
<p>We can note that <span class="math notranslate nohighlight">\( CPI_t = CPI_t^{NS} \cdot Seas_{mont} \)</span> (t)</p>
<p>Note that for the seasonality interpolator <span class="math notranslate nohighlight">\( df_m^{seas} = \frac{1}{Sea_{r_m}} \)</span>, so we can state:</p>
<p><span class="math notranslate nohighlight">\( df_t = df_t^{NS}df_{mont}^{seas} \)</span> (t)</p>
<p>Thus the seasonality interpolator can be seen as an input into the optimisation to then fit the second interpolator to retrieve the prices of the inflation instruments, i.e. the optimisation will fit <span class="math notranslate nohighlight">\( df_t^{NS} \)</span> at the node dates <span class="math notranslate nohighlight">\( [t_i] \)</span>.</p>
</section>
<section id="interpolation-choice-and-granularity-of-market-data">
<h3>3.3.11 Interpolation choice and granularity of market data<a class="headerlink" href="#interpolation-choice-and-granularity-of-market-data" title="Link to this heading">#</a></h3>
<p>We refer primarily to discount factor curves, but the same principles apply to forward rate curves.</p>
<p>The primary question considered is “Is smooth interpolation required?”. If the answer is no, local interpolation will be employed.</p>
<section id="granular-market-data-granular-node-dates-local-interpolation">
<h4>3.3.11.1. Granular market data (granular node dates) =&gt; local interpolation<a class="headerlink" href="#granular-market-data-granular-node-dates-local-interpolation" title="Link to this heading">#</a></h4>
<p>Where market data exists at either:</p>
<ol class="arabic simple">
<li><p>The tenor of the curve (quarterly data for a 3m curve, semi-annual data for a 6m curve), or</p></li>
<li><p>The frequency of market observation of rate changes, or discrete data points (e.g. central bank meeting dates for an OIS curve), or</p></li>
<li><p>Monthly, or more granular (e.g. FX Forwards for the short end of a cross-currency discount curve)</p></li>
</ol>
<p>Local interpolation would be favoured.</p>
<p>There may be stronger considerations:
A. market observation may be of linear interpolation of the forward rate (LIBOR curve) (see 3.3.11.1 below)
B. rate changes are only observed on central bank meeting dates (i.e. when base rate decisions are made)</p>
<p>Both these considerations imply the use of Geometric interpolation if node dates (market data) satisfies condition 1 or 2 above.</p>
<p>We can see this by observing 2 graphs for the GBP market. These observations are general so are globally applicable.</p>
<p>Requirements for GBP LIBOR 3M satisfy 1 &amp; A
Requirements for SONIA satisfy 2 &amp; B</p>
<p>Geometric interpolation:</p>
<p><img alt="Comparison of LIBOR Interpolation Methods" src="../../_images/libor_ois_interpolation_1.jpg" /></p>
<p>Notes:</p>
<ul class="simple">
<li><p>Top graph: Geometric Interpolation</p></li>
<li><p>Bottom graph: Log-cubic Interpolation</p></li>
</ul>
<p><img alt="LIBOR and OIS Interpolation Graphs" src="../../_images/libor_ois_interpolation_2.jpg" /></p>
<p>The first graph (geometric) demonstrates that since 1 is true, B is not met for LIBOR, so we have no requirement for smooth interpolation and this is rejected in favour of local interpolation.</p>
<p><img alt="Comparison of LIBOR Interpolation Methods" src="../../_images/libor_ois_interpolation_3.jpg" /></p>
<p>The second graph (log-cubic) demonstrates that since 2 is true, B is not met for SONIA, so we have no requirement for smooth interpolation and this is rejected in favour of local interpolation.</p>
<p>The third graph demonstrates that there is no reason for selecting smooth interpolation.</p>
<p>We will select Geometric or Exponential, so can now consider a graph of OIS:</p>
<p><img alt="Comparison of LIBOR Interpolation Methods" src="../../_images/libor_ois_interpolation_4.jpg" /></p>
<p>This curve breaks the principle B above, so we choose Geometric.</p>
<p>We would also now introduce another criteria for interpolation choice - in the absence of other factors we choose the same interpolation method for all curves in a market.</p>
<p>Thus we would choose Geometric for the GBP LIBOR and other GBP curves that satisfy the above criteria.</p>
<p>We can use exactly the same decision tree to determine the use of Linear Rate interpolation in a forward rate curve.</p>
<p>Source: [Insert specific source details here - e.g., Internal Research, Date, Report Name]</p>
<section id="linear-interpolation-of-1m-3m-fwds">
<h5>3.3.11.1.1 Linear interpolation of 1m/3m fwds<a class="headerlink" href="#linear-interpolation-of-1m-3m-fwds" title="Link to this heading">#</a></h5>
<p>In building a 3m curve the (enforced) choice of IMM-dated instruments can lead to more than 3m between node dates (which are placed on the IMM dates). E.g. Wed 15-Mar-17 to Wed 21-Jun-17 is 98 days. Thus with the standard geometric interpolation the 3m forwards would have a “flat spot” between 15-Mar and 20-Mar. The desire is for linear forwards as far as possible.</p>
<p>In this situation above an additional node (and “smoothing”) is applied at 15-Jun-17. This results in forward rates as follows:</p>
<p><img alt="Comparison of LIBOR Interpolation Methods" src="../../_images/libor_ois_interpolation_5.jpg" /></p>
<p>Overnight space:</p>
<ul class="simple">
<li><p>Top graph shows stepped rate changes in the overnight space</p></li>
</ul>
<p>3m Forward space:</p>
<ul class="simple">
<li><p>Bottom graph shows linear interpolation between forward rates</p></li>
</ul>
<p><img alt="Comparison of LIBOR Interpolation Methods" src="../../_images/libor_ois_interpolation_6.jpg" /></p>
<p>A similar technique is used for the 1m curve - adding nodes, and smoothing, at IMM-1m, IMM+1m, and IMM-3m when instruments are IMM-dated 1s3.</p>
</section>
</section>
<section id="sparse-market-data-sparse-node-dates-smooth-interpolation">
<h4>3.3.11.2. Sparse market data (sparse node dates) -&gt; smooth interpolation<a class="headerlink" href="#sparse-market-data-sparse-node-dates-smooth-interpolation" title="Link to this heading">#</a></h4>
<p>We can now consider the situation where the above criteria do not hold. We have annual market data after the 12th IMM period (4 years onwards).</p>
<p>Source: [Insert specific source details here - e.g., Internal Research, Date, Report Name]</p>
<p><img alt="Comparison of LIBOR Interpolation Methods" src="../../_images/libor_ois_interpolation_7.jpg" /></p>
<p>We build the same 2 curves only using Geometric interpolation:</p>
<p>Top graph:</p>
<ul class="simple">
<li><p>Shows stepped rate changes with geometric interpolation</p></li>
<li><p>Red and blue lines representing different curve representations</p></li>
</ul>
<p>Bottom graph:</p>
<ul class="simple">
<li><p>Smooth forward curve using log-cubic interpolation</p></li>
<li><p>Red and blue lines showing different interpolation approaches</p></li>
</ul>
<p><img alt="Comparison of LIBOR Interpolation Methods" src="../../_images/libor_ois_interpolation_8.jpg" /></p>
<p>The observation is simply that a smooth forward curve is desired if there is such a lack of market data (i.e. above A: above B does not necessarily hold or is not market enough) for the OIS curve. For the LIBOR curve, Geometric interpolation is a long way from satisfying A.</p>
<p>Thus we would choose our smooth interpolation to be log-cubic, for this curve.</p>
<p>We can use exactly the same decision tree to determine the use of Quadratic Rate interpolation in a forward rate curve.</p>
<p>Source: [Insert specific source details here - e.g., Internal Research, Date, Report Name]</p>
</section>
<section id="split-interpolation">
<h4>3.3.11.3. Split Interpolation<a class="headerlink" href="#split-interpolation" title="Link to this heading">#</a></h4>
<p>Above, in 3.3.3.9, split interpolation is mentioned. The curve plots above introduce this requirement.</p>
<p>The requirement that drives local, geometric, interpolation is satisfied until the end of the 12th IMM period (13th IMM date). From this date smooth interpolation is desirable.</p>
<p>This has been adopted in NCF. It is used as a standard for both forecast of a fixing (e.g. LIBOR, OIS) &amp; discount curves (discounting fx/xccy instruments) and inflation curves.</p>
<p>To considerate the decisions above:</p>
<ul class="simple">
<li><p>Where there is granular market data (quarterly or greater frequency) geometric is used (discount factor/inflation curve) or linear rate curve.</p>
<ul>
<li><p>In can be noted that if we have a curve to project a 3m fixing (e.g. 3M USD LIBOR) and quarterly data, with geometric interpolation, the 3m forward rate projected from the curve will be very close to linear. Thus the purpose of the interpolation is both type of curve is not to build a “smooth” curve.</p></li>
</ul>
</li>
<li><p>Where there is sparse market data (annual or lower frequency) log-cubic is used (discount factor/inflation curve) or quadratic rate (forward rate curve).</p>
<ul>
<li><p>This will produce a smooth curve (whether measured with the instantaneous forward rate, or the forward rate of the natural term of the curve), but this desire for smoothness is a result of the lack of market data.</p></li>
</ul>
</li>
</ul>
<p>In practice what this means is:
In a major currency, prices for market data (instruments used to build curves) are observable over IMM dates (quarterly) for 8-12 periods. This is the region over which IR futures are liquid. Thus the interpolation is geometric until 9th IMM or 13th IMM. In other currencies with no trading of IR futures, or in fx/cross-currency curve construction, this “crossover date” from granular market data may be 1-2y.</p>
<p>After this date (what might be termed “the end of the Futures strip”) annual swaps will be observable. Depending on the liquidity of the market the annual observability will be until 5-20y, and 5 yearly thereafter.</p>
</section>
<section id="single-interpolators">
<h4>3.3.11.4. Single interpolators<a class="headerlink" href="#single-interpolators" title="Link to this heading">#</a></h4>
<p>In the above case is made strongly for the appropriateness of split interpolation, however this is not universal. There can be curves that do not require split interpolation. If we build a bond curve with only the most liquid, on-the-run (most recently issued) bonds, at sparse maturities (2y, 3y, 5y, 10y, 30y) we’d not have any region of the curve with granular market data. A curve with this number/sparsity of instruments would use a single, log-cubic interpolator.</p>
<p>The above criteria may also not apply to inflation curves. So there here is a choice of interpolation, depending on the market. In practical terms a split interpolation of Geometric-Log-cubic may be chosen, or CPI linear interpolation is an implementation choice.</p>
</section>
</section>
<section id="implementation-specificities">
<h3>3.3.12. Implementation specificities<a class="headerlink" href="#implementation-specificities" title="Link to this heading">#</a></h3>
<section id="discounting">
<h4>3.3.12.1. Discounting<a class="headerlink" href="#discounting" title="Link to this heading">#</a></h4>
<p>An overarching parameter relevant to the use of the NCF is the choice of discounting. All instruments in curve construction that contain swap, leg, and hence reference a discount curve will use the discounting (valuation) appropriate for a benchmark quote from market (e.g. cleared swap, price on a broker page).</p>
<p>This discounting is reflected as USDOIS (Fed Funds) as the appropriate benchmarking as the base of a collateralised price quote. The only 6 exceptions (USD, i.e. trivially, not an exception) are for currencies in those developed markets that have:</p>
<ol class="arabic simple">
<li><p>liquid domestic OIS – i.e. outright or basis trades are available for OIS to the same tenor as swap quotes.</p></li>
<li><p>swaps typically trade through a clearing house that will pay the OIS rate.</p></li>
</ol>
<p>To refer back to the use of forecast and discount curves (Eror Reference source not found) – this will mean that an OIS curve will often have 2 instantiations, as essentially separate objects, identical curves, both constructed of discount factors, but one used explicitly for forecasting the index, the other only for discounting.</p>
<section id="g7-currencies-curve-calibration">
<h5>3.3.12.1.1 G7 Currencies Curve Calibration<a class="headerlink" href="#g7-currencies-curve-calibration" title="Link to this heading">#</a></h5>
<p>Namely, USD, EUR, GBP, JPY, AUD, CHF, SEK. For these 7 currencies the domestic forecast curves will be calibrated using domestic swap quotes only, no FX cross-currency instruments. In practice this means, as a minimum, the initial set of curves built (i.e. initial stage of curve calibration for a multi-stage engine) will be: 2:OS &amp; 3m (i.e. the most widely traded floating index), or 3:OIS, 3m &amp; 6m.</p>
</section>
<section id="other-currencies-curve-calibration">
<h5>3.3.12.1.2 Other Currencies Curve Calibration<a class="headerlink" href="#other-currencies-curve-calibration" title="Link to this heading">#</a></h5>
<p>For all other currencies curve will be calibrated using cross-currency instruments – FX forwards and cross-currency swaps quoted to deliver a USDOIS discounting curve in the domestic currency.</p>
<p>The instruments used – FX Forward (3.3.8.8) and cross-currency swaps (3.3.8.9-3.3.8.11) are defining a discounting curve in domestic currency (Term currency (FX Forward) or 1st leg currency (cross-currency basis) swap)) for a cashflow in that currency, but implying that collateral payments, or funding, is in the foreign (Base/Right leg) currency. Thus the statement is also being made that we do not have instruments/trades and hence also hedges, to calibrate a discount curve for collateralisation/funding in the domestic currency.</p>
<p>In practice all these cross-currency instruments are used in curve construction with USD as the Base/Right leg and USDOIS as the discounting of that leg.</p>
<p>In practice this means the initial set of curves built (i.e. initial stage of curve calibration for a multi-stage engine) will be:</p>
<ul class="simple">
<li><p>“main” forecast curve (typically 3m, some exceptions, e.g. SGD has 6m as the main curve).</p></li>
<li><p>Thereof also 1 (FX Forward or 2 (cross-currency swap) external dependencies on USD curves</p></li>
<li><p>USDOIS itself</p></li>
<li><p>USD LIBOR for the forecast of the leg.</p></li>
</ul>
</section>
</section>
<section id="ccp-aware-curves">
<h4>3.3.12.2 CCP-Aware Curves<a class="headerlink" href="#ccp-aware-curves" title="Link to this heading">#</a></h4>
<p>For cleared trades, where a one-way position is built up (greater prevalence of paying or receiving on OIS) there will be a cost due to the initial Margin (IM) payment accruing on new trades. If the primary dealers (market-makers) in the market build up similar one-way positions with the same Central Counterparty Clearing House (CCP) the entire market will exhibit a basis, i.e. trades with one CCP will trade at a basis (different price for a swap trade). This basis, represented in NCF as a swap spread, will have a term structure since the IM cost increases with the term of the trade.</p>
<p>To mark curves in this way one CCP will be the benchmark, all other CCPs trading as a basis to that. In USD, EUR &amp; GBP the benchmarks are LCH (LCHClearnet) and in JPY it is JSCC (Japan Securities Clearing Corporation) (correct as of Jan 2017).</p>
<p>Discussion of the IM cost itself is outside the scope of this document – the important point for curve construction is that the market spreads for difference CCPs are different, hence different curves will be constructed for each of them.</p>
<p>At the time of writing (Jan 2017) the term structure for this basis visible, and marked as follows:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Tenor</p></th>
<th class="head"><p>USD LCH-CME</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1y</p></td>
<td><p>0.10</p></td>
</tr>
<tr class="row-odd"><td><p>2y</p></td>
<td><p>0.20</p></td>
</tr>
<tr class="row-even"><td><p>3y</p></td>
<td><p>0.45</p></td>
</tr>
<tr class="row-odd"><td><p>4y</p></td>
<td><p>0.85</p></td>
</tr>
<tr class="row-even"><td><p>5y</p></td>
<td><p>1.40</p></td>
</tr>
<tr class="row-odd"><td><p>7y</p></td>
<td><p>1.70</p></td>
</tr>
<tr class="row-even"><td><p>7y</p></td>
<td><p>2.20</p></td>
</tr>
<tr class="row-odd"><td><p>8y</p></td>
<td><p>2.55</p></td>
</tr>
<tr class="row-even"><td><p>9y</p></td>
<td><p>2.95</p></td>
</tr>
<tr class="row-odd"><td><p>10y</p></td>
<td><p>3.35</p></td>
</tr>
<tr class="row-even"><td><p>12y</p></td>
<td><p>3.80</p></td>
</tr>
<tr class="row-odd"><td><p>15y</p></td>
<td><p>4.00</p></td>
</tr>
<tr class="row-even"><td><p>20y</p></td>
<td><p>4.70</p></td>
</tr>
<tr class="row-odd"><td><p>25y</p></td>
<td><p>5.05</p></td>
</tr>
<tr class="row-even"><td><p>30y</p></td>
<td><p>5.05</p></td>
</tr>
<tr class="row-odd"><td><p>50y</p></td>
<td><p>5.05</p></td>
</tr>
</tbody>
</table>
</div>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Tenor</p></th>
<th class="head"><p>EUR LCH-CME</p></th>
<th class="head"><p>EUR LCH-EUREX</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1y</p></td>
<td><p>-0.05</p></td>
<td><p>0.10</p></td>
</tr>
<tr class="row-odd"><td><p>2y</p></td>
<td><p>-0.10</p></td>
<td><p>0.30</p></td>
</tr>
<tr class="row-even"><td><p>3y</p></td>
<td><p>-0.30</p></td>
<td><p>0.45</p></td>
</tr>
<tr class="row-odd"><td><p>5y</p></td>
<td><p>-0.60</p></td>
<td><p>0.95</p></td>
</tr>
<tr class="row-even"><td><p>10y</p></td>
<td><p>-0.90</p></td>
<td><p>1.50</p></td>
</tr>
<tr class="row-odd"><td><p>20y</p></td>
<td><p>-0.95</p></td>
<td><p>2.40</p></td>
</tr>
<tr class="row-even"><td><p>30y</p></td>
<td><p>-1.05</p></td>
<td><p>2.80</p></td>
</tr>
<tr class="row-odd"><td><p>50y</p></td>
<td><p>-1.15</p></td>
<td><p>3.00</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="jpy-ccp-basis">
<h3>JPY CCP basis<a class="headerlink" href="#jpy-ccp-basis" title="Link to this heading">#</a></h3>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Tenor</p></th>
<th class="head"><p>JSCC-CME</p></th>
<th class="head"><p>JSCC-LCH</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1y</p></td>
<td><p>0.00</p></td>
<td><p>0.00</p></td>
</tr>
<tr class="row-odd"><td><p>18M</p></td>
<td><p>0.00</p></td>
<td><p>0.00</p></td>
</tr>
<tr class="row-even"><td><p>2y</p></td>
<td><p>-0.06</p></td>
<td><p>0.00</p></td>
</tr>
<tr class="row-odd"><td><p>3y</p></td>
<td><p>-0.06</p></td>
<td><p>-0.06</p></td>
</tr>
<tr class="row-even"><td><p>4y</p></td>
<td><p>-0.06</p></td>
<td><p>-0.06</p></td>
</tr>
<tr class="row-odd"><td><p>5y</p></td>
<td><p>-0.06</p></td>
<td><p>-0.06</p></td>
</tr>
<tr class="row-even"><td><p>6y</p></td>
<td><p>0.00</p></td>
<td><p>0.00</p></td>
</tr>
<tr class="row-odd"><td><p>7y</p></td>
<td><p>0.00</p></td>
<td><p>0.00</p></td>
</tr>
<tr class="row-even"><td><p>8y</p></td>
<td><p>0.13</p></td>
<td><p>0.13</p></td>
</tr>
<tr class="row-odd"><td><p>9y</p></td>
<td><p>0.25</p></td>
<td><p>0.25</p></td>
</tr>
<tr class="row-even"><td><p>10y</p></td>
<td><p>0.38</p></td>
<td><p>0.38</p></td>
</tr>
<tr class="row-odd"><td><p>12y</p></td>
<td><p>0.63</p></td>
<td><p>0.50</p></td>
</tr>
<tr class="row-even"><td><p>15y</p></td>
<td><p>1.00</p></td>
<td><p>0.81</p></td>
</tr>
<tr class="row-odd"><td><p>20y</p></td>
<td><p>1.50</p></td>
<td><p>1.31</p></td>
</tr>
<tr class="row-even"><td><p>25y</p></td>
<td><p>2.06</p></td>
<td><p>1.75</p></td>
</tr>
<tr class="row-odd"><td><p>30y</p></td>
<td><p>2.56</p></td>
<td><p>2.50</p></td>
</tr>
<tr class="row-even"><td><p>35y</p></td>
<td><p>2.81</p></td>
<td><p>2.50</p></td>
</tr>
<tr class="row-odd"><td><p>40y</p></td>
<td><p>3.06</p></td>
<td><p>2.75</p></td>
</tr>
<tr class="row-even"><td><p>50y</p></td>
<td><p>3.19</p></td>
<td><p>2.88</p></td>
</tr>
</tbody>
</table>
</div>
<p>GBP LCH-CME</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Tenor</p></th>
<th class="head"><p>GBP LCH-CME</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1y</p></td>
<td><p>0.00</p></td>
</tr>
<tr class="row-odd"><td><p>2y</p></td>
<td><p>0.20</p></td>
</tr>
<tr class="row-even"><td><p>3y</p></td>
<td><p>0.35</p></td>
</tr>
<tr class="row-odd"><td><p>5y</p></td>
<td><p>0.60</p></td>
</tr>
<tr class="row-even"><td><p>7y</p></td>
<td><p>1.60</p></td>
</tr>
<tr class="row-odd"><td><p>10y</p></td>
<td><p>1.82</p></td>
</tr>
<tr class="row-even"><td><p>20y</p></td>
<td><p>1.90</p></td>
</tr>
<tr class="row-odd"><td><p>30y</p></td>
<td><p>1.90</p></td>
</tr>
<tr class="row-even"><td><p>50y</p></td>
<td><p>1.90</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="outputs">
<h3>3.4 Outputs<a class="headerlink" href="#outputs" title="Link to this heading">#</a></h3>
<p>Curves
The primary, necessary, output of a curve construction framework is curves. These can be queried by a price as appropriate (forward, rate of projection of Libor, CPIR or an inflation index etc.). See 3.3.2 above.</p>
<p>Jacobian rebuild matrix
Within the engine that produced curves is the Jacobian rebuild matrix - the inverse of the Jacobian matrix can be accessed by supplying a revised set of instruments prices (all of which are within the 5bp tolerance required to this original engine.</p>
<p>Shocked curves
Bumped curves for risk - 7.1 - are the output from NCF.</p>
<p>Jacobian transform matrix
As described in 7.1.5.</p>
<section id="curve-representation">
<h4>3.4.1 Curve representation<a class="headerlink" href="#curve-representation" title="Link to this heading">#</a></h4>
<p>This is the output – the curve object stored in the market environment - is then consumed by all users/systems for pricing and valuation.</p>
<p>A curve object is simply a collection <span class="math notranslate nohighlight">\(\{t_i, df_{t_i}\}\)</span> of <span class="math notranslate nohighlight">\(\{t_i, R_{t_i}^\theta\}\)</span> and the interpolation rule(s).</p>
<section id="multiple-interpolators">
<h5>3.4.1.1. Multiple interpolators<a class="headerlink" href="#multiple-interpolators" title="Link to this heading">#</a></h5>
<p>A curve can contain multiple interpolators – 3.3.8.18(Turns) and 3.3.8.28 (Seasonality) are examples where a particular set of instruments/constraints define an interpolator that may be separate to the others.</p>
<p>Thus if a curve contains a set of interpolators <span class="math notranslate nohighlight">\(\{I_j\}\)</span> we can write <span class="math notranslate nohighlight">\(df_t^{curve} = \prod_j df_t^j\)</span>.</p>
<p>For a forward rate curve we can write <span class="math notranslate nohighlight">\(R_t^{\theta,curve} = \sum_{j} R_t^{\theta,j}\)</span>.</p>
<p>More rigorously we can therefore rewrite the above:</p>
<p>A curve object is a collection <span class="math notranslate nohighlight">\(\left\{ \left\{ t_{i_j}, df_{t_{i_j}}^j\right\}_j\right\}\)</span> or <span class="math notranslate nohighlight">\(\left\{ \left\{ t_{i_j}, R_{t_{i_j}}^{\theta,j}\right\}_j\right\}\)</span> and the interpolation rule(s).</p>
</section>
</section>
<section id="curve-market-data-object">
<h4>3.4.2 Curve Market Data object<a class="headerlink" href="#curve-market-data-object" title="Link to this heading">#</a></h4>
<p>These are published to the Xsigma Market Environment (ME). Here they persist (EOD market data) or third with changes in the market data (live, current). The EOD market data is saved for all regions that require a separate set of close prices (and curves) and all currencies required.</p>
<p>Similarly the live curves in ME will be ticking (i.e. updating in inputs to the NCF engine change, and new curves published). A call for which typically will be for a semi-annual data, weekdays, except holidays, but may also not be ticking outside the core trading hours - e.g. EUR will be ticking as approximately 7:30am-5:30pm London hours.</p>
<p>It is up to the calling system that they retrieve the correct curves required for their purpose. This is obviously a high level, e.g. to save a semi-annual EUR IRS requires the 6M EURIBOR curve, and an appropriate discount curve, and ME.</p>
</section>
<section id="risk-market-data-object">
<h4>3.4.3 Risk Market Data object<a class="headerlink" href="#risk-market-data-object" title="Link to this heading">#</a></h4>
<p>For use these are then retrieved by the downstream consumer/system along with the curves, trades, and any other data/objects to calculate, then store, the risk output.</p>
<p>It is up to each user that they retrieve the coret risk template for their purpose.</p>
</section>
</section>
<section id="payoff-analysis">
<h3>3.5 Payoff Analysis<a class="headerlink" href="#payoff-analysis" title="Link to this heading">#</a></h3>
<p>n/a</p>
</section>
<section id="portfolio-description-and-trends">
<h3>3.6 Portfolio description and trends<a class="headerlink" href="#portfolio-description-and-trends" title="Link to this heading">#</a></h3>
<p>n/a</p>
</section>
</section>
<section id="model-methodology">
<h2>4. Model / Methodology<a class="headerlink" href="#model-methodology" title="Link to this heading">#</a></h2>
<p>The simplest description is that in curve construction instruments are chosen to reflect market liquidity and to produce accurate curves (e.g. use of the most liquid instruments to drive the curves).</p>
<p>The flexibility of instrument choice described above allows this.</p>
<section id="id15">
<h3>4.1 Description<a class="headerlink" href="#id15" title="Link to this heading">#</a></h3>
<section id="model-design-development">
<h4>4.1.1 Model design &amp; development<a class="headerlink" href="#model-design-development" title="Link to this heading">#</a></h4>
<p>As stated above, a curve is specified in terms of a table of discount factors (or forward rates) and data. These points on the curve are known as nodes.</p>
<p>The full implementation of the curve building process is a curve engine. This has the following steps:
• Instruments (described above)
• Node dates (defined at instrument level, or separately)
• Interpolation for the curves.
• Smoothing penalty weight (see 4.1.1.8.1 below)
• Conventions (to build the instruments as a par instrument traded on the market), and
• Subsidy data
• Inflation history (for inflation curves)
• Swap fixings (includes fixings for Fed Fund Futures)
• Configure parameters
• Use of Algorithmic Differentiation, In Xsigma Adjoint Algorithmic is used (AAD).
• Full rebuild tolerance - full rebuild only (see below)
• Use an automatic solve stage generator (see below)</p>
<p>For bumped curves (risk) we would have, in addition, to the risk template/HCT:
• Shock (bump) sizes - an array of instrument names and shocks.</p>
<section id="objective-function">
<h5>4.1.1.1 Objective function<a class="headerlink" href="#objective-function" title="Link to this heading">#</a></h5>
<p>We will fit our curves by minimising an objective function.</p>
<p><span class="math notranslate nohighlight">\(
\text{Obj. Func.} = \sum_{i} W_i \cdot \text{penalty}_i^2
\)</span></p>
<p>The parameters and implementation in NCF:</p>
<p><span class="math notranslate nohighlight">\(
\text{Obj. Func.} = \sum_{\text{trst (i), df\_curve}} W_i [R_i(Z_j) - R_i^{o}]^2 + \sum_{\text{trst (k), fc\_curve}} W_k [R_k(R_i^{\theta}) - R_k^o]^2+\sum_{\text{nodes(m)}}W_{\text{curve}}[R_m^{id} - R_{m-i}^{id}]^2
\)</span></p>
<p>is described below.</p>
<p>This method is flexible and powerful - it allows multiple curves to be solved at once (the objective function will be a sum of curves), with an approach of curve construction described above. There is also great flexibility since it allows us to incorporate any instrument provided it can be calibrated.</p>
</section>
<section id="optimisation-1">
<h5>4.1.1.2 Optimisation (1)<a class="headerlink" href="#optimisation-1" title="Link to this heading">#</a></h5>
<p>We can use a multivariate optimizer for the above objective function. Current implementation uses the multi-variate tool provided as part of the NAG library, nag_opt_sqP_kx_deriv. The documentation for the library can be found here:
<a class="reference external" href="http://www.nag.com/numeric/fl/nagdoc_fl/pdf/E04/e04pdf#">http://www.nag.com/numeric/fl/nagdoc_fl/pdf/E04/e04pdf#</a></p>
<p>From the NAG terminology:</p>
<p>Minimize <span class="math notranslate nohighlight">\(F(x) = \sum_i^m f_i(x)^2\)</span></p>
<p>where <span class="math notranslate nohighlight">\(x = (x_1,...,x_n)\)</span> and <span class="math notranslate nohighlight">\(m \geq n\)</span></p>
<section id="nag-parameters">
<h6>4.1.1.2.1 NAG parameters<a class="headerlink" href="#nag-parameters" title="Link to this heading">#</a></h6>
<p>With reference to parameters in the NAG documentation above (p2 onwards):</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SQLIN</p></td>
<td><p>No derivative, evaluation of <span class="math notranslate nohighlight">\(f_t(x)\)</span> only</p></td>
</tr>
<tr class="row-odd"><td><p>IPRINT</p></td>
<td><p>the frequency with which the minimisation of the penalty is measured. If IPRINT &gt; 0, called once every iteration and just before exit from the function. If 0, called only at 1st, or if F-new &lt; F-old.</p></td>
</tr>
<tr class="row-even"><td><p>MAXCAL</p></td>
<td><p>100 (NAG recommendation): Number of iterations of the optimisation.</p></td>
</tr>
<tr class="row-odd"><td><p>ETA</p></td>
<td><p>0.9 NAG recommendation): Accuracy of linear minimisation.</p></td>
</tr>
<tr class="row-even"><td><p>XTOL</p></td>
<td><p>The tolerance for a solution, such that NAG will return without error. NAG recommendation: <span class="math notranslate nohighlight">\(\epsilon\)</span>. Machine precision, <span class="math notranslate nohighlight">\(\epsilon\)</span> is small such that 1+<span class="math notranslate nohighlight">\(\epsilon\)</span> &gt; 1.</p></td>
</tr>
<tr class="row-odd"><td><p>STEPMX</p></td>
<td><p>1 (A low value - more likely to lead to the global minimum on a difficult problem)</p></td>
</tr>
</tbody>
</table>
</div>
<p>Please see 4.2 below for the description of assumptions and limitations (problems) with the use of such an optimisation for curve construction.</p>
</section>
<section id="maxcal">
<h6>4.1.1.2.1.1 MAXCAL<a class="headerlink" href="#maxcal" title="Link to this heading">#</a></h6>
<p>We describe this then, since it is a configurable parameter. The figure of 100 for this has never been changed, it is extremely conservative. There has never been an observation of a successful solving of a successful curve build taking more than 15 iterations. This is a value of 25 may still be conservative, but the only benefit of using 100 is found quickly.</p>
<p>If we take the problematic GBP engine example from 8.2.2.1 below. This took 4 iterations to return a solution.</p>
</section>
</section>
<section id="algorithmic-differentiation">
<h5>4.1.1.3 Algorithmic Differentiation<a class="headerlink" href="#algorithmic-differentiation" title="Link to this heading">#</a></h5>
<p>Algorithmic Differentiation can be used in engine construction. The use is not to gain a more accurate solution (see also 8.2.4), but to speed up the process - the calculation of <span class="math notranslate nohighlight">\(\nabla f\)</span> for LSQFUN.</p>
<p>(<a class="reference external" href="http://manual.nag.com/fl/manual/pdf/E04/e04pdf#">http://manual.nag.com/fl/manual/pdf/E04/e04pdf#</a>). The convergent point is that more memory is used, which may be problematic. Hence the choice of AD is neither recommended nor discouraged - it is more likely to be dependent on the improvement in memory usage and calculation speed for the full build.</p>
<p>See 8.2.2.2.5 for the negligible differences between FD and AD in curve construction, and 8.2.4 for the differences in the Jacobian.</p>
</section>
<section id="instrument-penalty">
<h5>4.1.1.4 Instrument penalty<a class="headerlink" href="#instrument-penalty" title="Link to this heading">#</a></h5>
<p>The following describes the mapping of <span class="math notranslate nohighlight">\( f_i(x) \)</span> to our problem:</p>
<p><span class="math notranslate nohighlight">\(
f_i(curves) = \sqrt{W_i}[R_i(curves) - R_i^{o}]
\)</span></p>
<p>Which has 2 instantiations:</p>
<p><strong>Discount factor curve:</strong></p>
<p><span class="math notranslate nohighlight">\(
f_i([Z_j]) = \sqrt{W_i}[R_i(Z_j) - R_i^{o}]
\)</span></p>
<p><span class="math notranslate nohighlight">\(
\text{Obj. Func.} = \sum_{inst} W_i[R_i(Z_j) - R_i^{o}]^2
\)</span></p>
<p><strong>Forward rate curve:</strong></p>
<p><span class="math notranslate nohighlight">\(
f_k([R_i^{\theta}]) = \sqrt{W_k}[R_k(R_i^{\theta}) - R_k^o]
\)</span></p>
<p><span class="math notranslate nohighlight">\(
\text{Obj. Func.} = \sum_{i \neq j} W_k[R_k(R_i^{\theta}) - R_k^o]^2
\)</span></p>
<p>Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\{W_i\}, \{W_k\}\)</span>: instrument mispricing penalty. 1 is default. Configurable at instrument level. Recommendation is to use 1 to prevent mispricing of instrument. 1 used in all EOD engines.</p></li>
<li><p><span class="math notranslate nohighlight">\(\{R_i(curves)\}\)</span>, <span class="math notranslate nohighlight">\(R_i(Z_j)\)</span>, <span class="math notranslate nohighlight">\({R_k(R_i^{\theta})}\)</span>: rate functions corresponding to the market constraints (instruments). These should be scaled appropriately for non-rate prices such as for IR Futures, FX Forwards, Bonds. These rate functions are evaluated for the set of the curves for a given set of parameters – zero rates in discount factor curves <span class="math notranslate nohighlight">\(\{Z_j\}\)</span>, and forward rates in forward rate curves <span class="math notranslate nohighlight">\(\{R_i^{\theta}\}\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\{R_i^{o}\}\)</span>: target rates (market data – scaled to rate).</p></li>
<li><p><span class="math notranslate nohighlight">\(\{Z_j\}\)</span>: zero rates at the set of node dates <span class="math notranslate nohighlight">\(\{t_j\}\)</span>, <span class="math notranslate nohighlight">\(Z_j = \frac{1}{r_j} \log \frac{1}{df(t_j)}\)</span>.</p></li>
</ul>
<p><span class="math notranslate nohighlight">\(m = n\)</span> ensures there are at least as many instruments (penalty functions) as node dates (degrees of freedom).</p>
<p>An initial “guess” is made for the node date-discount factor table for each curve, with 1 entered for all of the discount factors (or 0 for all forward rates/zero rates). We define this to be the state of the system <span class="math notranslate nohighlight">\(\mathcal{Z} = (Z_1, ..., Z_n)\)</span>.</p>
</section>
</section>
</section>
<section id="instrument-misprice-and-convergence">
<h3>4.1.1.5. Instrument misprice and convergence<a class="headerlink" href="#instrument-misprice-and-convergence" title="Link to this heading">#</a></h3>
<p>If we look at the instrument penalty objective function:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\text{Obj. Func.} = \sum_{inst} W_i[R_i(curves) - R_i^{\theta}]^2
\]</div>
</div>
<p>We can take the step to use instrument misprice, measured as a rate <span class="math notranslate nohighlight">\([R_i(curve) - R_i^{\theta}]\)</span> to give insight into the penalty.</p>
<p>With unadjusted instrument penalties, <span class="math notranslate nohighlight">\(w_i = 1.0 \cdot L_i\)</span> the penalty is then simply:</p>
<p><span class="math notranslate nohighlight">\(\sum_{inst} [instrument\_rate\_misprice_i]^2  \)</span></p>
<p>Thus by measuring and checking misprice we are, in fact, checking convergence. We can see that on 32-bit windows, <span class="math notranslate nohighlight">\( \epsilon = 1.5e - 8 \)</span>. If we have an engine with 100 instruments, with equal misprice, convergence would be when <span class="math notranslate nohighlight">\(instrument\_rate\_misprice_i= \frac{\sqrt{1.5e-8}}{100} = 1.2e - 6 \)</span>. We take a conservative approach. However, when checking the mispricing of instruments in engines since we take a approach that bears relation to the fact that we are mispricing a rate 1e-6 of a 1% rate is 1e-8. Thus we choose 1e-8 as a conservative measure of mispricing of instruments. 1e-6 would, in fact, be a more practical boundary for mispricing to be an issue – i.e. an issue that is noticeable in a price quote, and hence the curve constructed and valuation.</p>
<p>Thus misprices between 1e-6 and 1e-8 warrant investigation, but are not necessarily a warning of a more fundamental problem.</p>
<section id="negative-discount-factors">
<h4>4.1.1.6 Negative discount factors<a class="headerlink" href="#negative-discount-factors" title="Link to this heading">#</a></h4>
<p>Since the optimisation problem for a discount factor curve uses zero rates <span class="math notranslate nohighlight">\([R_i(Z_i)]\)</span> there is no possibility of NAG returning negative discount factors. Even if this were the case, NCF throws an error.</p>
<p>Note though, that NCF is agnostic to discount factors that increase (including <span class="math notranslate nohighlight">\(f(x+1)\)</span>) or negative forward rates.</p>
</section>
<section id="node-dates-degrees-of-freedom">
<h4>4.1.1.7 Node dates (degrees of freedom)<a class="headerlink" href="#node-dates-degrees-of-freedom" title="Link to this heading">#</a></h4>
<p>The default node date is the end date of an instrument. This traditional design is such that a node date is added for which the discount factor is to be derived. In NCF this is optional, however, node dates can be switched off from any instrument, individually, and defined separately.</p>
<p>They are configurable in several ways (example below):</p>
<ol class="arabic simple">
<li><p>A different node date associated with an instrument (the field NodeDates is set for an individual instrument). This optimisation is performed, potentially, all instruments are sensitive to node dates.</p></li>
<li><p>Instruments are constrained to no node dates.</p></li>
<li><p>Additional node dates are specified separately. This is normally used along with 2) above, particularly for more node dates along a smoothing section.</p></li>
</ol>
<p>An example where this might be employed is when building a curve with IFR Futures - the instruments at start on IMM dates, but the end dates are 3m hence, not the following IMM date. Thus the decision date for interpolation is made at the IMM date.</p>
<table>
  <tr>
    <th>Start Date (IMM)</th>
    <th>End Date (IMM+3m)</th>
    <th>Node Date (IMM)</th>
  </tr>
  <tr>
    <td>Wed 15 Mar 17</td>
    <td>Thu 15 Jun 17</td>
    <td>Wed 21 Jun 17</td>
  </tr>
  <tr>
    <td>Wed 21 Jun 17</td>
    <td>Thu 21 Sep 17</td>
    <td>Wed 20 Sep 17</td>
  </tr>
  <tr>
    <td>Wed 20 Sep 17</td>
    <td>Tue 20 Dec 17</td>
    <td>Wed 20 Dec 17</td>
  </tr>
  <tr>
    <td>Wed 20 Dec 17</td>
    <td>Tue 20 Mar 18</td>
    <td>Wed 21 Mar 18</td>
  </tr>
  <tr>
    <td>Wed 21 Mar 18</td>
    <td>Thu 21 Jun 18</td>
    <td>Wed 20 Jun 18</td>
  </tr>
    <tr>
    <td>Wed 20 Jun 18</td>
    <td>Wed 19 Sep 18</td>
    <td>Wed 19 Dec 18</td>
  </tr>
</table>
</section>
<section id="smoothing">
<h4>4.1.1.8. Smoothing<a class="headerlink" href="#smoothing" title="Link to this heading">#</a></h4>
<p>An additional parameter that can be applied to a discount factor curve is smoothing. It can only be used in discount factor curves.</p>
<p>Smoothing is not a direct choice for curve calibration, it is a choice informed by the decision to select a node date structure that produces more node dates (degrees of freedom) than instruments (constraints). Without an additional constraint the problem presented to the optimiser would lead to failure.</p>
<p>This is typically employed when a curve is constructed with a mismatch between the node dates at which discount factors are defined and the dates of the instruments used in construction (2.1.4.1 &amp; 3.3.11.1 above). The normal situation in which this occurs is when considering an OIS curve - the observation in the market is that rate changes on central bank meeting dates, but the curve is constructed with IMM-dated instruments. So to compare the GBP SONIA curve, nodes are placed at the BOE meeting dates for IMM instruments (2.1.4.1-17 example):</p>
<table>
  <tr>
    <th>Start Date</th>
    <th>End Date</th>
    <th>Node Date</th>
  </tr>
  <tr>
    <td>Wed 15 Mar 17</td>
    <td>Wed 21 Jun 17</td>
    <td>16 Mar 17, 11 May 17, 15 Jun 17</td>
  </tr>
  <tr>
    <td>Wed 21 Jun 17</td>
    <td>Wed 20 Sep 17</td>
    <td>15 Jun 17, 03 Aug 17</td>
  </tr>
  <tr>
    <td>Wed 20 Sep 17</td>
    <td>Wed 20 Dec 17</td>
    <td>02 Nov 17, 14 Dec 17</td>
  </tr>
  <tr>
    <td>Wed 20 Dec 17</td>
    <td>Wed 21 Mar 18</td>
    <td>08 Feb 18</td>
  </tr>
</table>
<p>We can use the same data as in 3.3.11.1, and if we compare the curve with node dates at the end of the instruments (IMM dates) rather than a curve with steps on the BOE meeting dates we have the following comparison:</p>
<p>The black dotted line does not match the market structure (green line), any individual meeting-meeting period will return an incorrect rate (although IMM-IMM periods are exact).</p>
<p>To construct the curve with steps on meeting dates we require a constraint on the BOE dates, not instrument end dates.</p>
<p>The method implemented is known as “first derivative smoothing”. This introduces a penalty function at each node date of the curve on the 1-day forward rate either side of the node.</p>
<p>With this additional constraint we have:</p>
<p><img alt="Comparison of LIBOR Interpolation Methods" src="../../_images/libor_ois_interpolation_9.jpg" /></p>
<p>Obj. Func. = <span class="math notranslate nohighlight">\(\sum_{nodes} W_{curve}[R_{i+1}^{d} - R_{i-1}^{d}]^{2}\)</span></p>
<p><span class="math notranslate nohighlight">\(W_{curve}\)</span> is a scalar, specified for each curve for which smoothing is selected</p>
<p><span class="math notranslate nohighlight">\(f_{m}({m})^2 = W_{curve}[R_{m}^{1d} - R_{m-1}^{1d}]^{2}\)</span></p>
<p><span class="math notranslate nohighlight">\([R_{m}^{1d}]\)</span> 1-day forward rates either side of the node points.</p>
<p>It can be noted that if a curve uses first derivative smoothing we can now have fewer instruments <span class="math notranslate nohighlight">\((a)\)</span> than nodes <span class="math notranslate nohighlight">\((b)\)</span>, but more penalty functions <span class="math notranslate nohighlight">\((c = a + b)\)</span> than degrees of freedom <span class="math notranslate nohighlight">\((b)\)</span>.</p>
<section id="smoothing-penalty-weight-w-curve">
<h5>4.1.1.8.1. Smoothing penalty weight <span class="math notranslate nohighlight">\((W_{curve})\)</span><a class="headerlink" href="#smoothing-penalty-weight-w-curve" title="Link to this heading">#</a></h5>
<p>With careful setting of the weight of the smoothing penalty (i.e., we set the weight low enough), the optimisation will still produce curves that reprice all the instruments accurately. Accuracy is within <span class="math notranslate nohighlight">\(1e-8\)</span> (measured as a rate).</p>
<p>A low weight is, in fact, extremely low - to ensure instruments reprice, <span class="math notranslate nohighlight">\(0.001\)</span> is chosen. With this, the relative weight of the smoothing penalty function is <span class="math notranslate nohighlight">\(1e-6\)</span> the instrument penalty function (weight=1). See 4.2.9 below.</p>
</section>
</section>
<section id="optimisation-2">
<h4>4.1.1.9. Optimisation (2)<a class="headerlink" href="#optimisation-2" title="Link to this heading">#</a></h4>
<p>Thus in the general case, the objective function used to fit the curve contains two groups of terms.</p>
<p>Obj. Func. = <span class="math notranslate nohighlight">\(\sum_{inst,i} W_{i}[R_{i}(curves) - R_{i}^{0}]^{2} + \sum_{nodes,m} W_{m}[R_{m}^{1d}(curves) - R_{m-1}^{1d}(curves)]^{2}\)</span></p>
<p>Or</p>
<p>Obj. Func. = <span class="math notranslate nohighlight">\(\sum_{inst,df,curves} W_{i}[R_{i}(Z_{i}) - R_{i}^{0}]^{2} + \sum_{inst,df,curves} W_{k}[R_{k}(R_{i}^{\theta}) - R_{k}^{0}]^{2} + \sum_{nodes,m} W_{m}[R_{m}^{1d}(curves) - R_{m-1}^{1d}(curves)]^{2}\)</span></p>
<p>The role of the optimiser is to find <span class="math notranslate nohighlight">\(x\)</span> such that we minimize the sum of the squares of the penalty vector,</p>
<p>min <span class="math notranslate nohighlight">\(\sum_{i} (f_i(x))^{2}\)</span></p>
</section>
<section id="inverse-jacobian-matrix">
<h4>4.1.1.10. (Inverse) jacobian matrix<a class="headerlink" href="#inverse-jacobian-matrix" title="Link to this heading">#</a></h4>
<p>An output of the optimisation, directly from NAG, is the jacobian matrix. This is an <span class="math notranslate nohighlight">\(m  \cdot n\)</span>-dimensional matrix with elements (sensitivity of the penalty functions with respect to the changes in the curve parameters (forward rates if a forward rate curve)).</p>
<p>We denote <span class="math notranslate nohighlight">\(Z_j\)</span> below. [In a forward rate curve this would be <span class="math notranslate nohighlight">\(R_j^\theta\)</span>].</p>
<p><span class="math notranslate nohighlight">\(
\{ \Delta R_i^\theta \} = \left( \frac{\partial f_i}{\partial x_j} \right) \{ \Delta x_j \} = \left( \frac{\partial f_i}{\partial Z_j} \right) \{ \Delta Z_j \} = \{ f \}_{i,j} \{ \Delta Z_j \}\)</span></p>
<p><span class="math notranslate nohighlight">\(\Delta Z_{j}\)</span> (discount factor curve). [In a forward rate curve this would be <span class="math notranslate nohighlight">\(\Delta R_{i}^{\theta}\)</span>].</p>
<p>We note, from 4.1.1.4 above: <span class="math notranslate nohighlight">\(f_{i}([Z_{j}])=\sqrt{W_{i}}[R_{i}(Z_{j})-R_{i}^{\theta}]=\sqrt{W_{i}}ScalingFactor_{i}[p_{i}(Z_{j})-p_{i}^{\theta}]\)</span></p>
<p><span class="math notranslate nohighlight">\(\{p_{i}^{\theta}\}\)</span> target rates (market data – target price);</p>
<p><span class="math notranslate nohighlight">\(\frac{\partial f_{i}}{\partial Z_{j}}=\sqrt{W_{i}}ScalingFactor_{i}\frac{\partial p _{i}}{\partial Z_{j}}\)</span></p>
<p><span class="math notranslate nohighlight">\(\frac{\partial p_{i}}{\partial Z_{j}}=\frac{1}{\sqrt{W_{i}} \cdot ScalingFactor_{i}}\left(\frac{\partial f_{i}}{\partial Z_{j}}\right)\)</span>
We use the NAG function to find the pseudo-inverse to this jacobian:</p>
<p><a class="reference external" href="http://www.nag.com/numeric/fl/manual/pdf/F01/f01bif.pdf">http://www.nag.com/numeric/fl/manual/pdf/F01/f01bif.pdf</a></p>
<p>This inverse jacobian will provide sensitivity of the curve discount factors (forward rates if a forward rate curve) with respect to the changes in the instrument prices) and can be used for efficient rebuilding of the curves under small price changes.</p>
<p><span class="math notranslate nohighlight">\(\{\Delta Z_{j}\}=\left(\frac{\partial Z_{j}}{\partial f_{i}}\right)[\Delta R_{i}^{\theta}]=\left(\frac{\partial Z_{j}}{\partial p_{i}}\right)[\Delta p_{i}^{\theta}]=[J^{-1}]_{ji}[\Delta p_{i}^{\theta}]\)</span>
where <span class="math notranslate nohighlight">\([J^{-1}]_{ji}\)</span> denotes the inverse jacobian.</p>
<section id="id16">
<h5>4.1.1.10.1. NAG parameters<a class="headerlink" href="#id16" title="Link to this heading">#</a></h5>
<p>The relevant parameter passed to this function:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>T</p></td>
<td><p>1e-8 - the tolerance used to decide when elements can be regarded as zero</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="types-of-curve-build">
<h4>4.1.1.11. Types of curve build<a class="headerlink" href="#types-of-curve-build" title="Link to this heading">#</a></h4>
<p>There are three ways to build a set of curves.</p>
<section id="complete-build-initial-construction">
<h5>4.1.1.11.1. Complete build (initial construction)<a class="headerlink" href="#complete-build-initial-construction" title="Link to this heading">#</a></h5>
<p>A full set of parameters – including instruments - are created. These form the “engine”. The penalty functions derived from this initial engine creation along with an initial guess (<span class="math notranslate nohighlight">\(\{t_{i},1.0\}\)</span> for all discount factor interpolators, <span class="math notranslate nohighlight">\(\{t_{j},0.0\}\)</span> for all forward rate curve interpolators), is the input to the NAG optimiser. The output is the curves and the (inverse) jacobian matrix.</p>
<p>In a production framework, typically a complete build only needs to be done at start of day, after that the supply of new price data will result in either a full or fast rebuild.</p>
</section>
<section id="full-rebuild">
<h5>4.1.1.11.2. Full rebuild<a class="headerlink" href="#full-rebuild" title="Link to this heading">#</a></h5>
<p>Updated instrument prices only are supplied. Pre-built instruments and interpolators are used to perform a complete recalibration of the curves with a new set of market data. The jacobian and inverse jacobian are recalculated.</p>
</section>
<section id="fast-jacobian-rebuild">
<h5>4.1.1.11.3. Fast (jacobian) rebuild<a class="headerlink" href="#fast-jacobian-rebuild" title="Link to this heading">#</a></h5>
<p>Updated instrument prices (market data) only are supplied.</p>
<p>The inverse jacobian is used to recalibrate the curves (i.e. apply a change to the discount factors or forward rates) from the change in instrument price, i.e.</p>
<p><span class="math notranslate nohighlight">\(\{\Delta Z_{j}\}=[J^{-1}]_{ji}[\Delta R_{i}^{\theta}]\)</span></p>
<p>The use of a jacobian rebuild is on small changes in instrument prices. The price change against the original, complete build, or full rebuild build is measured in terms of rate (i.e. the price change is scaled for non-rate instruments).</p>
</section>
</section>
<section id="jacobian-rebuild-tolerance">
<h4>4.1.1.12. Jacobian rebuild tolerance<a class="headerlink" href="#jacobian-rebuild-tolerance" title="Link to this heading">#</a></h4>
<p>The maximum change across all of the updated market data is measured against a fast rebuild tolerance (e.g. 2bp, 0.0002). This is consistent with the curve calibration process described in 9.1 given both fast, and accurate pricing. It is a more complex IT setup, but underlines the reason for using an optimiser. See 8.2.4 for testing of jacobian rebuild accuracy.</p>
</section>
<section id="engine-parameters-for-rebuilds">
<h4>4.1.1.13. Engine parameters for rebuilds<a class="headerlink" href="#engine-parameters-for-rebuilds" title="Link to this heading">#</a></h4>
<p>Engines can be parametrised in two ways:</p>
<ul class="simple">
<li><p>Full rebuild only – never perform a fast rebuild</p></li>
<li><p>Fast rebuild tolerance – set a tolerance (5bp is the default).</p></li>
</ul>
</section>
<section id="solve-stages">
<h4>4.1.1.14. Solve Stages<a class="headerlink" href="#solve-stages" title="Link to this heading">#</a></h4>
<p>Despite the power of using a flexible non-linear optimiser to build curves it is not necessary, or desirable, to solve for all constraints (instrument prices which pull curves (node points)) simultaneously. Thus we reject “bootstrapping” of curves in favour of breaking the overall optimisation into problems that are as small as possible. We refer to these as solve stages (the decomposition of the problem into these stages can be performed automatically).</p>
<p>This can be overridden and the entire engine solved in one stage (the main drawback would be the time spent to build the engine with a single optimisation).</p>
<p>Minimal groups of curves are solved in the same solve stage. Splitting into solve stages is by the following criteria:</p>
<ol class="arabic simple">
<li><p>Instruments define curves. If instrument group <span class="math notranslate nohighlight">\(A_j^X \)</span> (a group of instruments with the same curves/conventions that define them) is in the definition of curve <span class="math notranslate nohighlight">\(X \)</span> and instrument <span class="math notranslate nohighlight">\(A_j^X \)</span> is priced from curves <span class="math notranslate nohighlight">\(\{x_i^{A_1}\}\)</span>, then <span class="math notranslate nohighlight">\(X \in \{x_i^{A_1}\}\)</span>. If we have <span class="math notranslate nohighlight">\(m \)</span> instrument groups in <span class="math notranslate nohighlight">\(X \)</span>, the complete set of curves used to price the instruments in <span class="math notranslate nohighlight">\(X \)</span> is <span class="math notranslate nohighlight">\(\{x_i\} = \{(x_i^{A_1}), ..., (x_i^{A_m})\}\)</span>.</p></li>
<li><p>SolveStage<span class="math notranslate nohighlight">\((X) \geq\)</span> SolveStage<span class="math notranslate nohighlight">\((x_i) \forall i \in \{x_i\}, x_i \neq X \)</span></p></li>
<li><p>If we have two curves <span class="math notranslate nohighlight">\(X \)</span> and <span class="math notranslate nohighlight">\(Y \)</span>, and neither <span class="math notranslate nohighlight">\(X \in \{y_i\}, Y \in \{x_i\}. X \)</span> and <span class="math notranslate nohighlight">\(Y \)</span> are in different solve stages.</p></li>
<li><p>Leading from 3. If curve <span class="math notranslate nohighlight">\(X \)</span> has no instruments dependent on it (and hence curves) apart from the instruments used to define the curve itself, then it is in its own solve stage.</p></li>
</ol>
<p>If <span class="math notranslate nohighlight">\(\forall x_i^a s.t. a = A =&gt; x_i = X \)</span> then SolveStage <span class="math notranslate nohighlight">\((X) &gt;\)</span> SolveStage <span class="math notranslate nohighlight">\((x_i) \forall i \in \{x_i\}, x_i \neq X \)</span></p>
<p>By using these rules we have multiple optimisations, one per solve stage. Each solve stage only contains curves that are interdependent (i.e. criteria two above when applied to all curves in the solve stage returns the same value). Any “standalone” curves (4.) above are in later solve stages.</p>
<section id="example">
<h5>4.1.1.14.1. Example<a class="headerlink" href="#example" title="Link to this heading">#</a></h5>
<p>If we have a market with the following instruments/dependencies/curves:OIS: Deposits/Swaps (OIS), Basis Swaps (3m vs. OIS)</p>
<p>1m: Deposits (1m), Basis Swaps (3m vs. 1m)</p>
<p>3m: Deposits (3m), Futures (3m), Basis Swaps (3m vs. 6m)</p>
<p>6m: Deposits (6m), Basis Swaps (3m vs. 6m), Swaps (6m)</p>
<p>12m: Deposits (12m), Basis Swaps (6m vs. 12m)</p>
<p>All swaps discounted with OIS. Hence:</p>
<p>All curves contain instruments that depend on OIS ⇒ OIS must be in Solve Stage 1.</p>
<p>Instruments in OIS curve depend on 3m ⇒ 3m must be in Solve Stage 1.</p>
<p>Instruments in 3m curve depend on OIS and 6m ⇒ 6m must be in Solve Stage 1.</p>
<p>Instruments in 6m curve depend on OIS and 3m ⇒ we have all curves for Solve Stage 1.</p>
<p>Solve Stages for 1m &amp; 12m are 2 and 3 or 3 and 2 respectively it makes no difference. (rule 4).</p>
</section>
<section id="jacobian-rebuild-matrix-solve-stages">
<h5>4.1.1.14.2. Jacobian rebuild matrix – solve stages<a class="headerlink" href="#jacobian-rebuild-matrix-solve-stages" title="Link to this heading">#</a></h5>
<p>When solving in stages the jacobian will look as follows:</p>
<p><span class="math notranslate nohighlight">\(J = \begin{bmatrix} J_{11} &amp; 0 &amp; 0 \\ J_{21} &amp; J_{22} &amp; 0 \\ J_{13} &amp; J_{23} &amp; J_{33} \end{bmatrix}\)</span></p>
<p><span class="math notranslate nohighlight">\(J_{11} = J_{1} = U_{11}\)</span> is the output of Solve Stage 1</p>
<p><span class="math notranslate nohighlight">\(J_{22} = U_{12} J_{22}\)</span> is the output of Solve Stage 2 <span class="math notranslate nohighlight">\((J = \begin{bmatrix} J_{11} &amp; 0\\ J_{12} &amp;J_{22} \end{bmatrix})\)</span>, etc.</p>
<p>Without remediation, when this matrix is inverted, the matrix <span class="math notranslate nohighlight">\(J^{-1}\)</span> obtained is no longer obviously partitioned and the upper triangular elements can be non-zero. This would result in parameters (curve changes) from earlier solve stages being affected by residuals (instrument price changes) from later stages. This is a slight approximation mathematically, but not for the use in NCF - the critical point is the accuracy of the jacobian rebuild reflected in the non-zero elements.</p>
<p>To get around this problem the relationship <span class="math notranslate nohighlight">\(\Delta Z = J^{-1}\Delta f\)</span> is solved at each stage, and at each stage manually prevents parameters in early stages being affected by later stage residuals. This approach is equivalent to taking the matrix <span class="math notranslate nohighlight">\(J_{11}^{-1}\)</span> and zeroing out the relevant upper triangular elements before calculating <span class="math notranslate nohighlight">\(\Delta Z = J^{-1}\Delta f\)</span> in a single matrix multiply.</p>
</section>
</section>
<section id="regulatory-compliance">
<h4>4.1.2 Regulatory compliance<a class="headerlink" href="#regulatory-compliance" title="Link to this heading">#</a></h4>
<p>n/a</p>
</section>
</section>
<section id="assumptions-limitations-and-outliers">
<h3>4.2 Assumptions, Limitations and Outliers<a class="headerlink" href="#assumptions-limitations-and-outliers" title="Link to this heading">#</a></h3>
<p>We note here the assumptions of NCF curve construction/optimisation. Where more detail or test evidence is required this is referenced in section 8.4.</p>
<section id="validation">
<h4>4.2.1 Validation<a class="headerlink" href="#validation" title="Link to this heading">#</a></h4>
<p>We can start with a description of where necessary validation or requirements for input or output checking are present in NCF:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Validation/requirement</p></th>
<th class="head"><p>Limitation/description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1. Instrument conflicts can lead to build failure</p></td>
<td><p>The problem may fail to solve. Parameters, and the entire configuration, will be checked at entry for validity. This will include: - instrument end date &gt; start date - no two instruments in the same curve define the same node date Not an assumption or limitation – we could state an assumption that when instruments are chosen, but these are checks necessary to ensure that we supply a valid problem for optimisation.</p></td>
</tr>
<tr class="row-odd"><td><p>2. Instrument misprice if there are fewer nodes than instruments</p></td>
<td><p>This will typically happen if we have fewer degrees of freedom (constraints are only on node dates, no smoothing) than penalty functions (instruments), especially for specific fewer node dates than instruments in a particular region of the curve. Not an assumption or limitation – node dates should be chosen to be appropriate for the curve construction problem in question. The checking of instrument mispricing is critical to identify potentially bad design. See 4.2.4.3.</p></td>
</tr>
<tr class="row-even"><td><p>3. Penalty function will always converge below epsilon</p></td>
<td><p>There are 2 distinct cases to consider: A curve engine where we have# instruments (penalty functions) = # nodes (constraints), and we have set those node dates appropriately (we are not in the situation caused by 1 &amp; 2 above). A standard use case – see 4.2.4 below. A curve engine where we employ smoothing will almost certainly not converge below epsilon. Not an assumption or limitation – it is the convergence to a global minimum in instrument penalty space that is important (smoothing is a second order effect). See 4.2.5 below.</p></td>
</tr>
<tr class="row-odd"><td><p>4. Optimisation need not find a global minimum</p></td>
<td><p>Convergence in instrument penalty space to be close to the global minimum is sufficient. Not an assumption or limitation – see 4.2.6 below.</p></td>
</tr>
</tbody>
</table>
</div>
<section id="design">
<h5>4.2.1.1 Design<a class="headerlink" href="#design" title="Link to this heading">#</a></h5>
<p>Items 1-3 above and 1-2 below are not noted as limitations in the model, the prevention of them is through good design (see 4.2.1.2 below).</p>
<p>Two steps are taken:</p>
<ol class="arabic simple">
<li><p>Forward design (see 4.2.1.2 below) – curves are rolled forward through time and the inputs shocked to detect build failures and mispricing. The check for mispricing is critical. A build failure, however, is not. Mispricing is less transparent, but more important, as the reasons for mispricing – it would imply the curves may not be arbitrage free.</p></li>
<li><p>Design &amp; testing – engines are tested before any deployment that they behave as planned. This includes testing by the end users (trading desks) prior to any release and adhering to the rules on interpolation selection. This is relevant for #8 below – see 8.4.1.</p></li>
</ol>
</section>
<section id="forward-looking-checks">
<h5>4.2.1.2 Forward-looking checks<a class="headerlink" href="#forward-looking-checks" title="Link to this heading">#</a></h5>
<p>During development of NCF a testing process developed within QA. Engines needed to be tested for:</p>
<ol class="arabic simple">
<li><p>Robustness – do they build at all dates in the future?</p></li>
<li><p>Accuracy – given that they build – do all instruments reprice?</p></li>
<li><p>Stability – when shocking the instruments one-by-one do they still reprice accurately (no deterioration in misprice)?</p></li>
</ol>
<p>This testing process developed to a command-line tool that IT can run for the 542 now in production. “542 in production” is those marked by FX and Rates in any pricing or EOD system (Jun-2015). It is QA that has driven the development of this process. Even though IT run the command line tool on all the above engines, it is QA that interrogates the results and documents them, along with a remediation path.</p>
<section id="test-process">
<h6>4.2.1.2.1 Test process<a class="headerlink" href="#test-process" title="Link to this heading">#</a></h6>
<p>These are tested on a monthly basis. Testing is for 100 days to allow approximately 70 days to fix any problems (i.e. each month the ‘new’ test dates will be the additional 28-31 days at the end of the 100 day period not covered by the preceding month’s test). QA has developed tools that do the following:</p>
<ol class="arabic simple">
<li><p>1.Take the latest version of the engine (last good business day close). E.g. on 01-Mar, take the engines from 28-Feb close.</p></li>
<li><p>2.Build this engine, check the mispricing of the instruments</p></li>
<li><p>3.Shock the instruments in the engine, one by one, by 1bp. Rebuild the engine after each shock, check the mispricing of the instruments</p></li>
<li><p>4.Roll the curves internally (decay the curves - i.e. node dates remain the same, but scale all discount factors at all nodes in each curve by the t+1 discount factor from the close curve) by one day (including weekends)</p></li>
<li><p>5.Rebuild the instruments at the new valuation date</p></li>
<li><p>6.Repeat 2-5 for 100 days of tests.</p></li>
</ol>
<p>Thus if running the tests on 01-Mar as at a date of 28-Feb, the 100 days of results (tests to 08-Jun) will be available that day, or the next - 02-Mar. The next set of tests will come a month later, with results up to 09-Jul.</p>
<p>Note the above tests <em>do</em> include testing on weekends. Although not strictly necessary it is a very good test for the build failures/problems in 4.2 and hence will indicate poor design.</p>
<p>A recent (at the time of the original document) sample of results of these forward tests would be:</p>
</section>
<section id="summary-report">
<h6>4.2.1.2.2 Summary report<a class="headerlink" href="#summary-report" title="Link to this heading">#</a></h6>
<p>This is a text file with n rows for n tests - plus header/footer</p>
<p><code class="docutils literal notranslate"><span class="pre">Resultstraries&#64;09:15:31,Tue30-Jun-2015</span></code></p>
<p>[1/278]: AED MUREX FX OC, HCT, Witch Repricing, tested for 100 days, from Mon29-Jun-2015 to Tue06-Oct-2015.Maximum Mispricing = 3.828-11</p>
<p>[2/278]: BKP MUREX FX OC, HCT, Witch Repricing, tested for 100 days, from Mon29-Jun-2015 to Tue06-Oct-2015.Maximum Mispricing = 4.596-09</p>
<p>[3/278]: CEX MUREX FX OC, HCT, Witch Repricing, tested for 100 days, from Mon29-Jun-2015 to Tue06-Oct-2015.Maximum Mispricing = 2.628-12</p>
<p>[27/278]: AED_FINBIAS_FX_OC, HCT, With Repricing, tested for 100 days, from Mon 29-Jun-2015 to Tue 06-Oct-2015. Maximum Mispricing = 5.68E-12</p>
<p>#…days have failures, see details</p>
<p>#…\Engineering\PwCreatingCmdTool\TestFailures\AED_FINBIAS_FX_OC_failureReport.xml</p>
</section>
<section id="error-report">
<h6>4.2.1.2.3 Error report<a class="headerlink" href="#error-report" title="Link to this heading">#</a></h6>
<p>For each of the failures above an xml file is produced. This has n NCForwardTestElementPP nodes, one for each test day (so typically 100):</p>
<p>EngineBuilt node includes 99/100 days passed without error:</p>
<p>&lt;QAXML_V2Terms QAVersion=”231100”&gt;</p>
<NCForwardTestResultSPP>
<p>&lt;TorwardTestResultCount=”101”&gt;</p>
<NCForwardTestElementPP>
<p><code class="docutils literal notranslate"><span class="pre">&lt;TrestDate&gt;</span></code>0<code class="docutils literal notranslate"><span class="pre">&lt;/restDate&gt;</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">&lt;EngineBuilt&gt;</span></code>99<code class="docutils literal notranslate"><span class="pre">&lt;/EngineBuilt&gt;</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">&lt;MaximumMisprico&gt;</span></code>5.682416343022467e-12<code class="docutils literal notranslate"><span class="pre">&lt;/MaximumMisprico&gt;</span></code></p>
</NCForwardTestElementPP>
<NCForwardTestElementPP>
<p><code class="docutils literal notranslate"><span class="pre">&lt;TestDate&gt;</span></code>42184<code class="docutils literal notranslate"><span class="pre">&lt;/TestDate&gt;</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">&lt;EngineBuilt&gt;</span></code>1<code class="docutils literal notranslate"><span class="pre">&lt;/EngineBuilt&gt;</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">&lt;MaximumMisprico&gt;</span></code>3.8344986907912216e-12<code class="docutils literal notranslate"><span class="pre">&lt;/MaximumMisprico&gt;</span></code></p>
</NCForwardTestElementPP>
<p>…[60 more days of passing tests]</p>
<NCForwardTestElementPP>
<p><code class="docutils literal notranslate"><span class="pre">&lt;TestDate&gt;</span></code>42245<code class="docutils literal notranslate"><span class="pre">&lt;/TestDate&gt;</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">&lt;EngineBuilt&gt;</span></code>0<code class="docutils literal notranslate"><span class="pre">&lt;/EngineBuilt&gt;</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">&lt;ErrorMessage&gt;</span></code>Unable to provide discount factor for 2015-08-28</p>
<p>{42244} as this is before the evaluation date of the curve 2015-08-28</p>
<p>{42245}. Unable to reprice the instrument ‘FINBIASIM’.<code class="docutils literal notranslate"><span class="pre">&lt;/ErrorMessage&gt;</span></code></p>
</NCForwardTestElementPP>
<p>…[37 more days of passing tests]</p>
<NCForwardTestElementPP>
<p><code class="docutils literal notranslate"><span class="pre">&lt;TestDate&gt;</span></code>42285<code class="docutils literal notranslate"><span class="pre">&lt;/TestDate&gt;</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">&lt;EngineBuilt&gt;</span></code>1<code class="docutils literal notranslate"><span class="pre">&lt;/EngineBuilt&gt;</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">&lt;MaximumMisprico&gt;</span></code>2.953012834261415e-12<code class="docutils literal notranslate"><span class="pre">&lt;/MaximumMisprico&gt;</span></code></p>
</NCForwardTestElementPP>
</NCForwardTestResultSPP>
<p>&lt;/QAXML_V2Terms&gt;</p>
<p>42245 is Sat 29-Aug-15, a non-critical day of trading for Xsigma, but a business day in AED (United Arab Emirates Division). The problem was in a xcv instrument that starts at a Monday (two days from 29th - Mon 31st), the last day of a 31-day month. Remediation was applied such that “today” is treated as the next good business day in the two currencies of the xcv instrument: i.e. instruments will start from Monday, not Saturday, the next good business day in both AED &amp; USD. A similar fix was applied to other middle eastern currencies.</p>
<p>The above is one example, all problems in the 278 tests in the 30-June EMEA (forward) stress test would be similarly treated, to provide a fix, before they occur.</p>
<p>If mispricing occurs the testing window of 100 days is designed to provide at least 70 days of time for remediation for a monthly testing cycle.</p>
</section>
</section>
</section>
<section id="assumptions-and-limitations">
<h4>4.2.2 Assumptions and limitations<a class="headerlink" href="#assumptions-and-limitations" title="Link to this heading">#</a></h4>
<p>We can move on to the assumptions and limitations themselves.</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p><strong>Assumption</strong></p></th>
<th class="head text-center"><p><strong>Limitation/description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>Insufficient constraints can lead to build failure</p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">&lt;p&gt;</span></code>If we supply fewer instruments (constraints) than node dates (degrees of freedom) this will not be checked directly, but NAC will return an error (IFAIL=1).<code class="docutils literal notranslate"><span class="pre">&lt;/p&gt;&lt;p&gt;</span></code><strong>Limitation:</strong> a poorly defined engine will fail, and the error message may be opaque to the designer.<code class="docutils literal notranslate"><span class="pre">&lt;/p&gt;&lt;p&gt;</span></code>The engine should not build in this case - an error is appropriate to identify to the designer that too many node dates have been selected. This problem would be identified by forward-testing (4.2.1.2).<code class="docutils literal notranslate"><span class="pre">&lt;/p&gt;</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>Poorly set node dates can lead to non-convergence</p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">&lt;p&gt;</span></code>If we supply node dates that do not allow convergence – e.g. the problem is insensitive to one of the node dates, then an error will be returned.<code class="docutils literal notranslate"><span class="pre">&lt;/p&gt;&lt;p&gt;</span></code>”Failed to solve - problem is insensitive to one of the entered variables”.<code class="docutils literal notranslate"><span class="pre">&lt;/p&gt;&lt;p&gt;</span></code><strong>Limitation:</strong> a poorly defined engine will fail – the engine should not build in this case. An error is appropriate, node dates should be chosen to be appropriate for the curve construction problem in question. Thus the build failure will force the designer to review. This will be identified by forward-testing (4.2.1.2).<code class="docutils literal notranslate"><span class="pre">&lt;/p&gt;&lt;p&gt;</span></code>See 4.2.7.<code class="docutils literal notranslate"><span class="pre">&lt;/p&gt;</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>Poorly set node dates and poorly set interpolation can lead to inappropriate output curves</p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">&lt;p&gt;</span></code>If we supply node dates that are poorly set for the instruments, but also include a non-local interpolation, the problem may solve but the curves may not have an appropriate shape.<code class="docutils literal notranslate"><span class="pre">&lt;/p&gt;&lt;p&gt;</span></code><strong>Limitation:</strong> without examination of the curves this problem may not be identified.<code class="docutils literal notranslate"><span class="pre">&lt;/p&gt;&lt;p&gt;</span></code>Interpolation and node dates should be chosen to be appropriate for the curve construction problem in question. If further problems were revealed – 1 or 2 above – this is again appropriate.<code class="docutils literal notranslate"><span class="pre">&lt;/p&gt;&lt;p&gt;</span></code>See 4.2.8.<code class="docutils literal notranslate"><span class="pre">&lt;/p&gt;</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>Optimiser chosen is appropriate</p></td>
<td class="text-center"><p>The choice of NAC E04CBF is an assumption – the assumption that it is appropriate for the type of problem presented for curve construction. This least-squares optimisation is a standard and comprehensive quasi-Newton algorithm for the problem required.<code class="docutils literal notranslate"><span class="pre">&lt;br&gt;</span></code>No limitation is noted.</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>Jacobian inversion will not fail</p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">&lt;p&gt;</span></code>There is an assumption that the inversion of the Jacobian using NAC P01BLF will not fail.<code class="docutils literal notranslate"><span class="pre">&lt;/p&gt;&lt;p&gt;</span></code><strong>Limitation:</strong> a failure will prevent a full or complete build of an engine. Leading to no curves and/or no risk (shocked curves).<code class="docutils literal notranslate"><span class="pre">&lt;/p&gt;&lt;p&gt;</span></code>No failures of this type have been reported in any production curve build (or risk generation).<code class="docutils literal notranslate"><span class="pre">&lt;/p&gt;&lt;p&gt;</span></code>In event of a failure there are 2 main courses of action:<code class="docutils literal notranslate"><span class="pre">&lt;/p&gt;&lt;p&gt;</span></code>1. Vary the input prices to achieve a successful build, including inversion of the jacobian.<code class="docutils literal notranslate"><span class="pre">&lt;/p&gt;</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<ol class="arabic simple" start="2">
<li><p>A poorly defined problem (bad data or insufficient/badly spaced node dates to allow convergence).</p></li>
</ol>
<p>2 is described above in 4.2.3.</p>
<p>The outcome – i.e. curves are suitable for use, or not, is determined by the mispricing of the input instruments (as noted in, for example, 4.2.8, 4.2.10) – mispricing of all instruments below 1e-8 (i.e. 0.001bp) is the only globally acceptable outcome. Correct use of a smoothing penalty produces this result, a poorly defined problem does not. It is only by careful design, and the testing detailed above (particularly the forward testing) that this is prevented.</p>
<p>We can examine a very simple example in 4.2.4, with the same number of instruments but smoothing applied.</p>
<p>We construct a set of OIS, 3M &amp; 6M LIBOR curves. We have 112 instruments and 143 nodes. All 3 curves have a smoothing penalty, so we have 255 penalty functions.</p>
<p>It is important, we do not examine <span class="math notranslate nohighlight">\(\epsilon\)</span> directly, but examine the total instrument penalty. This is the determination of whether the minimum discovered through the optimisation is close to the global minimum in the dimension of the instrument penalty space (we can only state ‘close to the global minimum in instrument penalty space’ since unless all instrument misprices were zero we cannot say whether the optimisation has halted at the global minimum. But this is not relevant – a local minimum within <span class="math notranslate nohighlight">\(\epsilon\)</span> of the global minimum is always sufficient.</p>
<p>So running the same analysis over the same dates above we find:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Average</p></td>
<td><p>1.6-16 (1e-17)</p></td>
</tr>
<tr class="row-odd"><td><p>Maximum</p></td>
<td><p>8.16 (80e-17)</p></td>
</tr>
</tbody>
</table>
</div>
<p>Thus our convergence close to the global minimum is only better value for the non-smoothed engine case.</p>
</section>
<section id="convergence-to-a-global-minimum">
<h4>4.2.6 Convergence to a global minimum<a class="headerlink" href="#convergence-to-a-global-minimum" title="Link to this heading">#</a></h4>
<p>See 4.2.1 #4.</p>
<p>We can refer to the text above, and repeat it here:</p>
<p>We examine the total instrument penalty. This is the determination of whether the minimum discovered through the optimisation is close to the global minimum in the dimension of the instrument penalty space.</p>
<p>We can only state ‘close to the global minimum in instrument penalty space’ since unless all instrument misprices were zero we cannot say whether the optimisation has halted at the global minimum. But this is not relevant – a local minimum within <span class="math notranslate nohighlight">\(\epsilon\)</span> of the global minimum is always sufficient.</p>
</section>
<section id="non-convergence-poorly-set-node-dates">
<h4>4.2.7 Non-convergence – poorly set node dates<a class="headerlink" href="#non-convergence-poorly-set-node-dates" title="Link to this heading">#</a></h4>
<p>See 4.2.2 #2.</p>
<p>A simple example would be as follows – a single curve constructed from three forward rates:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Start Date</p></th>
<th class="head"><p>End Date</p></th>
<th class="head"><p>Price</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Tue 11-Aug-15</p></td>
<td><p>Mon 12-Oct-15</p></td>
<td><p>1.10%</p></td>
</tr>
<tr class="row-odd"><td><p>Wed 12-Aug-15</p></td>
<td><p>Mon 12-Oct-15</p></td>
<td><p>1.20%</p></td>
</tr>
<tr class="row-even"><td><p>Fri 11-Sep-15</p></td>
<td><p>Mon 12-Oct-15</p></td>
<td><p>1.30%</p></td>
</tr>
</tbody>
</table>
</div>
<p>We have three instruments, but would only set two node dates in the instrument end dates were used. This would fail the check above in 4.2.1 #1.</p>
<p>However, if we set the nodes dates separately at Fri 11-Sep-15, Fri 09-Oct-15 and Mon 12-Oct-15. With Geometric interpolation the problem does not converge – the forward rates are all insensitive to the discount factor at Fri 09-Oct-15 (due to use of local interpolation, discount factors prior to 11-Sep are insensitive to the node date at 09-Oct).</p>
<p>Assumption – supply of node dates appropriate for the problem. We may call this “well spaced” node dates – in this example we could not assign a node date appropriate for each instrument.</p>
<p>Limitation – poorly set node dates can lead to a build failure. Although a limitation this build failure would be deemed appropriate behaviour.</p>
</section>
<section id="inappropriate-curve-poorly-set-node-dates">
<h4>4.2.8 Inappropriate curve – poorly set node dates<a class="headerlink" href="#inappropriate-curve-poorly-set-node-dates" title="Link to this heading">#</a></h4>
<p>See 4.2.2 #3.</p>
<p>If we repeat the test above with logistic interpolation the problem will solve. Now, due to the use of a smooth, non-local interpolator, discount factor at 12-Aug is sensitive to the node date at 09-Oct.</p>
<p>It may be noted that the curve returned may not be appropriate – the forward rates are well outside the range of the instrument prices i.e. instrument prices &lt;= 1.3% forward rates &gt; 2.5%</p>
<p><img alt="Comparison of LIBOR Interpolation Methods" src="../../_images/libor_ois_interpolation_10.jpg" /></p>
<p>[Graph showing forward rates vs time with rates ranging from 0.8% to 2.4%]</p>
<p>Here we would have a slightly different assumption – supply of node dates appropriate to the problem and interpolation appropriate for the curve. We can refer to 3.3.11 above for more discussion on the appropriate interpolation.</p>
<p>The limitation would be – without adhering to the selection of appropriate interpolation the interpolation may result in a curve with a poor shape. It may only be visual inspection that determines this. Adherence to the selection rules would have demonstrated the build failure, and a more immediate need for remediation.</p>
</section>
<section id="smoothing-penalty-weight">
<h4>4.2.9 Smoothing penalty weight<a class="headerlink" href="#smoothing-penalty-weight" title="Link to this heading">#</a></h4>
<p>See 4.2.2 #7.</p>
<p>Thus we have an assumption that we can use smoothing for all nodes with an appropriate weight to achieve this balance between smoothness and to reprice the input prices.</p>
<p>We can investigate the production EOD USD engine – weight is set at 0.001. If we vary this we see the following:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Weight</p></th>
<th class="head"><p>Misprice (bp)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>2.44E-02</p></td>
</tr>
<tr class="row-odd"><td><p>0.1</p></td>
<td><p>2.55E-04</p></td>
</tr>
<tr class="row-even"><td><p>0.01</p></td>
<td><p>2.55E-06</p></td>
</tr>
<tr class="row-odd"><td><p>0.001</p></td>
<td><p>2.33E-08</p></td>
</tr>
<tr class="row-even"><td><p>0.0001</p></td>
<td><p>3.22E-09</p></td>
</tr>
</tbody>
</table>
</div>
<p>Thus our chosen weight is extremely conservative in repricing the instrument – 0.01 would leave a large “safety margin”.</p>
<p>Limitations would include:</p>
<section id="too-low">
<h5>4.2.9.1. Too low<a class="headerlink" href="#too-low" title="Link to this heading">#</a></h5>
<p>The weight of the penalty is too low (curve shape does not fit the market, due to large and unequal steps in the curve).</p>
<p>This is ‘difficult’ to achieve, if we examine the plot of USDOIS with the 5 weights above we see:</p>
<p><img alt="Graph showing curves with different weights" src="../../_images/libor_ois_interpolation_11.jpg" /></p>
</section>
<section id="too-high">
<h5>4.2.9.2. Too high<a class="headerlink" href="#too-high" title="Link to this heading">#</a></h5>
<p>The weight of the penalty is too high (instrument mispricing). Ad-hoc tests can obviously be undertaken if there is market volatility. See table above.</p>
</section>
</section>
<section id="smoothing-interpolation-choice">
<h4>4.2.10 Smoothing &amp; interpolation choice<a class="headerlink" href="#smoothing-interpolation-choice" title="Link to this heading">#</a></h4>
<p>See 4.2.2 #9.</p>
<p>Inappropriate choice of interpolation – if a smooth interpolator is chosen the penalty at each node would be very small, and probably pointless. In our USDOIS example from 4.2.5, the entire curve has smoothing applied (a penalties for the logistic region are much smaller (0.001 weight used)):</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>Max penalty</p></th>
<th class="head"><p>Average penalty</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Geometric</p></td>
<td><p>9.41E-12</p></td>
<td><p>3.10E-12</p></td>
</tr>
<tr class="row-odd"><td><p>Logistic</p></td>
<td><p>3.09E-15</p></td>
<td><p>1.46E-16</p></td>
</tr>
</tbody>
</table>
</div>
<p>Or with 0.1 weight (Logistic penalties still comparable to Geometric):</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>Max penalty</p></th>
<th class="head"><p>Average penalty</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Geometric</p></td>
<td><p>9.41E-10</p></td>
<td><p>3.10E-10</p></td>
</tr>
<tr class="row-odd"><td><p>Logistic</p></td>
<td><p>3.09E-13</p></td>
<td><p>1.46E-14</p></td>
</tr>
</tbody>
</table>
</div>
<p>This we can see negligible effect of smoothing applied to a logistic curve. It might be deemed better to “catch” poor design such as this, but this would be a negligible limitation.</p>
</section>
</section>
<section id="model-parameters-variables">
<h3>4.3 Model Parameters / Variables<a class="headerlink" href="#model-parameters-variables" title="Link to this heading">#</a></h3>
<p>Parameters are described in Inputs (3.3).</p>
</section>
<section id="model-outputs">
<h3>4.4 Model Outputs<a class="headerlink" href="#model-outputs" title="Link to this heading">#</a></h3>
<p>These are described in 3.4.</p>
<p>Accuracy (repricing inputs) is in the above, and in the backtesting results below.</p>
</section>
<section id="model-uncertainty">
<h3>4.5 Model Uncertainty<a class="headerlink" href="#model-uncertainty" title="Link to this heading">#</a></h3>
<p>There is no uncertainty as such in curve construction - the input parameters (instrument prices) should be transparent, they should be repriced and the curves produced have the correct interpolation.</p>
</section>
<section id="risk-factor">
<h3>4.6 Risk Factor<a class="headerlink" href="#risk-factor" title="Link to this heading">#</a></h3>
<p>See 6 for a description of risk generation.</p>
</section>
<section id="feeder-models">
<h3>4.7 Feeder Models<a class="headerlink" href="#feeder-models" title="Link to this heading">#</a></h3>
<p>Interest Rate Futures Pricing.</p>
<p>Rates bond model/inflation linked bond model.</p>
<p>FX forwards: FX swaps and FX outrights.</p>
</section>
<section id="justification-against-alternative-approaches">
<h3>4.8 Justification against alternative approaches<a class="headerlink" href="#justification-against-alternative-approaches" title="Link to this heading">#</a></h3>
<p>See 6.3 below.</p>
</section>
<section id="conditions-of-use">
<h3>4.9 Conditions of Use<a class="headerlink" href="#conditions-of-use" title="Link to this heading">#</a></h3>
<section id="stressed-market-conditions">
<h4>4.9.1 Stressed Market Conditions<a class="headerlink" href="#stressed-market-conditions" title="Link to this heading">#</a></h4>
<p>See 8.2.2 below.</p>
</section>
<section id="other">
<h4>4.9.2 Other<a class="headerlink" href="#other" title="Link to this heading">#</a></h4>
<p>n/a</p>
</section>
</section>
</section>
<section id="implementation-numerical-schema-description">
<h2>5. Implementation / Numerical Schema Description<a class="headerlink" href="#implementation-numerical-schema-description" title="Link to this heading">#</a></h2>
<section id="id17">
<h3>5.1 Description<a class="headerlink" href="#id17" title="Link to this heading">#</a></h3>
<p>n/a</p>
</section>
<section id="id18">
<h3>5.2 Inputs<a class="headerlink" href="#id18" title="Link to this heading">#</a></h3>
<p>n/a</p>
</section>
<section id="quality-control">
<h3>5.3 Quality control<a class="headerlink" href="#quality-control" title="Link to this heading">#</a></h3>
<p>n/a</p>
</section>
<section id="limitations">
<h3>5.4 Limitations<a class="headerlink" href="#limitations" title="Link to this heading">#</a></h3>
<p>n/a</p>
</section>
</section>
<section id="calibration">
<h2>6. Calibration<a class="headerlink" href="#calibration" title="Link to this heading">#</a></h2>
<section id="id19">
<h3>6.1 Description<a class="headerlink" href="#id19" title="Link to this heading">#</a></h3>
<p>There is no separate calibration to that in the curve construction itself. The optimisation using the NAG solver for the objective function is the calibration, described in section 4.</p>
</section>
<section id="id20">
<h3>6.2 Inputs<a class="headerlink" href="#id20" title="Link to this heading">#</a></h3>
<p>The inputs are described in 3.3.</p>
<section id="reference-data-market-data-and-other-data-inputs">
<h4>6.2.1 Reference Data: Market Data and Other Data Inputs<a class="headerlink" href="#reference-data-market-data-and-other-data-inputs" title="Link to this heading">#</a></h4>
<p>The market data inputs are the instruments, and prices described in 3.3.8 above.</p>
</section>
<section id="data-sources">
<h4>6.2.2 Data Sources<a class="headerlink" href="#data-sources" title="Link to this heading">#</a></h4>
<p>The source of the inputs can be in one of 3 categories:</p>
</section>
<section id="exchange-price">
<h4>6.2.3 Exchange price<a class="headerlink" href="#exchange-price" title="Link to this heading">#</a></h4>
<p>The most liquid input – at time of writing available for IR Futures and Bond Futures. This is used if available, so typically they will be “hard wired” as inputs without a manual override, or a manual override only outside of exchange trading hours.</p>
</section>
<section id="broker-quote">
<h4>6.2.4 Broker quote<a class="headerlink" href="#broker-quote" title="Link to this heading">#</a></h4>
<p>These would be used as a reliable indication of where the market is trading. They would be provided by a third party, e.g. Reuters. If they are “stale”, maybe if the market is not liquid this reduces their usefulness.</p>
</section>
<section id="manual-input">
<h4>6.2.5 Manual input<a class="headerlink" href="#manual-input" title="Link to this heading">#</a></h4>
<p>Often these will be used optionally with a broker quote (for the reason above – the quote may not be liquid). They may also be used for example, in a quote that is of relative value e.g. a butterfly (i.e. define the price of one instrument relative to the price of two others rather than as an outright).</p>
<p>It will be up to the owner of the implementation (typically the trading desk that is a market-maker) to appropriately select in the design both the type of input and the source.</p>
</section>
<section id="data-availability-history">
<h4>6.2.6 Data availability/history<a class="headerlink" href="#data-availability-history" title="Link to this heading">#</a></h4>
<p>For testing data availability is primarily in the major currencies – G4 – USD, EUR, GBP, and JPY.</p>
<p>Below table shows the history for the highest quality data, used for EOD valuation and subject to price testing:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Currency</p></th>
<th class="head"><p></p></th>
<th class="head"><p>XCV/FX</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>USD</p></td>
<td><p>Tue 10-Oct-00</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>EUR</p></td>
<td><p>Mon 17-Jan-00</p></td>
<td><p>Fri 22-Aug-08</p></td>
</tr>
<tr class="row-even"><td><p>GBP</p></td>
<td><p>Fri 15-Dec-00</p></td>
<td><p>Fri 22-Aug-08</p></td>
</tr>
<tr class="row-odd"><td><p>JPY</p></td>
<td><p>Mon 06-Jan-03</p></td>
<td><p>Fri 22-Aug-08</p></td>
</tr>
</tbody>
</table>
</div>
<p>No other data has been used for historical analysis prior to 2015.</p>
</section>
<section id="data-quality-and-data-checks">
<h4>6.2.7 Data quality and data checks<a class="headerlink" href="#data-quality-and-data-checks" title="Link to this heading">#</a></h4>
<p>Data for all NCF implementations is checked via price testing of the curves used for EOD valuation.</p>
</section>
<section id="calibration-algorithm-inputs">
<h4>6.2.8 Calibration Algorithm Inputs<a class="headerlink" href="#calibration-algorithm-inputs" title="Link to this heading">#</a></h4>
<p>Interpolation and smoothing is described in 3.3.9 &amp; 3.3.11 above.</p>
</section>
<section id="other-inputs">
<h4>6.2.9 Other Inputs<a class="headerlink" href="#other-inputs" title="Link to this heading">#</a></h4>
</section>
<section id="curves">
<h4>6.2.10 Curves<a class="headerlink" href="#curves" title="Link to this heading">#</a></h4>
<p>As well as instruments curves can be an input to a curve build. This is analogous to the use of solve stages. Rather than rebuilding USD curves in all sets of curves dependent on USD, we build a single USD engine and provide the pre-built curves to the dependent (domestic) currency curve engine. The USD curves used in construction are still an output of the curves from the dependent engine.</p>
<p>This approach achieves two things that might otherwise be contradictory:</p>
<ul class="simple">
<li><p>Efficiency</p></li>
<li><p>All input instruments can still be repriced from the curves from any single engine</p></li>
</ul>
<section id="jacobian-matrix">
<h5>6.2.10.1. Jacobian matrix<a class="headerlink" href="#jacobian-matrix" title="Link to this heading">#</a></h5>
<p>To ensure Jacobian, or fast rebuilds are performed correctly, we create <span class="math notranslate nohighlight">\(\{Z_j\}\)</span>, a set of zero rates (created as Forward Rate instruments with continuous compounding) at the set of node dates <span class="math notranslate nohighlight">\(\{t_i\}\)</span> in all the externally supplied curves.</p>
<p>We can now use these instruments in a “solve stage 0”, and create a Jacobian matrix in the normal way:</p>
<p>$
J = \left[</p>
<div class="math-wrapper amsmath docutils container" id="equation-0051f6fa-2c5e-4ee8-a1ff-2c7e8c1252bc">
<div class="amsmath math notranslate nohighlight" id="equation-0051f6fa-2c5e-4ee8-a1ff-2c7e8c1252bc">
<span class="eqno">(1)<a class="headerlink" href="#equation-0051f6fa-2c5e-4ee8-a1ff-2c7e8c1252bc" title="Permalink to this equation">#</a></span>\[\begin{pmatrix}
J_{01} \\
J_{02} \\
J_{03}
\end{pmatrix}\]</div>
</div>
<div class="math-wrapper amsmath docutils container" id="equation-b64f6db3-d0d8-4bfa-bd7e-321f5694ca8e">
<div class="amsmath math notranslate nohighlight" id="equation-b64f6db3-d0d8-4bfa-bd7e-321f5694ca8e">
<span class="eqno">(2)<a class="headerlink" href="#equation-b64f6db3-d0d8-4bfa-bd7e-321f5694ca8e" title="Permalink to this equation">#</a></span>\[\begin{pmatrix}
J_{11} \\
J_{12} \\
J_{13}
\end{pmatrix}\]</div>
</div>
<div class="math-wrapper amsmath docutils container" id="equation-6fc12306-94ec-4f2d-b81c-9929ccbc3ef5">
<div class="amsmath math notranslate nohighlight" id="equation-6fc12306-94ec-4f2d-b81c-9929ccbc3ef5">
<span class="eqno">(3)<a class="headerlink" href="#equation-6fc12306-94ec-4f2d-b81c-9929ccbc3ef5" title="Permalink to this equation">#</a></span>\[\begin{pmatrix}
0 \\
J_{22} \\
J_{23}
\end{pmatrix}\]</div>
</div>
<div class="math-wrapper amsmath docutils container" id="equation-010d68bc-5fe3-4e7a-8062-a490c76f528f">
<div class="amsmath math notranslate nohighlight" id="equation-010d68bc-5fe3-4e7a-8062-a490c76f528f">
<span class="eqno">(4)<a class="headerlink" href="#equation-010d68bc-5fe3-4e7a-8062-a490c76f528f" title="Permalink to this equation">#</a></span>\[\begin{pmatrix}
0 \\
0 \\
J_{33}
\end{pmatrix}\right]
$

Note we do not have $J_{00}$, since the external curves' zero rate instrument (prices) are not recomputed by a Jacobian rebuild.

The Jacobian rebuild tolerance calculation is unchanged – changes in external curves' zero rate instrument prices can be checked against the rebuild tolerance. If a Jacobian rebuild is triggered, this will then use these updated prices in the Jacobian rebuild.

### 6.3 Justification against alternative approaches

n/a

### 6.4 Quality control

In 4.2 above some limitations and dangers of an approach using an optimiser were noted. Best practice has lead to the following:

#### 6.4.1 Review and testing before use

Any engine to be used in a production process is reviewed within QA, and tested by the owner (typically the trading desk). The testing and signoff will be recorded (email).

The implementation of the engines will be by IT. This will also be reviewed by QA to ensure it matches the version signed off.

#### 6.4.2 Forward testing

There are, at the time of writing (March 2017), 542 engines in use in EOD processes.

They are tested with the process described in 4.2.1.2.

#### 6.4.3 EOD engine build

It is worth noting – all EOD curves are built as a separate process – i.e. only a complete, new build is ever used for EOD curves.

### 6.5 Limitations and Risk Assessment

With the testing in 4.2.1.2 we guard against failure in normal circumstances. Exceptional circumstances would be:

- A user changing the configuration of an engine to cause a build failure. This would be the exclusion, or inclusion of an instrument.
- Exceptional market conditions, never previously experienced. This might not be complete failure, but mispricing. See 4.2.1.2 for behaviour under stressed market conditions.

The calibration may break temporarily if an input causes misconfiguration of the engine e.g. an instrument is switched on or off in the engine causing one of the problems described in 4.2.

The process to stop this is either:

- Reject the change that causes the failure at source (i.e. reverse the user-driven change)
- Investigate. This may not be instantaneous (up to 1hr) but once found the curve construction behaves normally i.e. this user-driven error is adjusted. If this were to occur exactly before an EOD process, the closing snap of curves would be delayed. This may in turn delay overnight batches but not cause a complete failure (i.e. curves are late but will be present).

#### 6.5.1 Stressed Market Conditions

This is outlined below in the Error Reference source not found.

## 7. Risk (Calculated by the model/payoff)

Risk in this context will be generation of shocked curves.

### 7.1 Description

#### 7.1.1 NCF Risk

Risk in the new curve framework is based around the concept of a Risk Template that builds a &quot;hedge engine&quot;. Such a &quot;hedge engine&quot; (HCT) is a collection of hedging instruments, with the curves to be shocked. It may be possible to trade an engine that had a set of curves in the risk engine that is not necessary. The term Hedge Curve Template (HCT) is used to describe this risk template used to generate a hedge engine. Once the HCT contains real instruments calibrated from the market data (and hence the equivalent market price for each) it would then represent the hedge engine.

Thus an HCT is a time agnostic and market data agnostic template that can contain any number of curves, and instruments within those curves. An HCT with a single curve would, by definition, shock only a single curve. The HCT is effectively an engine that contains all the risk engine curves, namely the instruments, convention, interpolation methods will be built. The only difference is, it does not contain any market data or instrument prices. The HCT effectively defines the bucketing (instruments and their granularity) and how the risk is viewed.

As mentioned in 3.3.7 the interpolation method chosen allows us, for example to apply shocks using a local interpolation method to curves with non-local interpolation (i.e. curves can have geometric interpolation and the underlying curves - unshocked).

In NCF the HCT is used to generate shocks which can then be applied to pre-built curves. In other words, in NCF Risk the pricing/valuation has been split from the risk(ing) (shocking) mechanism to make it faster (for more flexibility) and consistent results.

The process of shocking the curves is as follows:

1. **Creating the hedge engine** - Reprice the instruments in the HCT using the pricing curves. Build this engine, which now contains prices and an evaluation date.

2. **Shock instruments in the HCT** (i.e. apply a price change)

   a) **One-by-one**  
   b) **Sequentially, adding shocks** – Cumulative bumping  
   c) **As a group of instruments/shocks** – A scenario  

   Shocks are applied as an equivalent rate, typically 1bp. So if an instrument has a scaling factor (see also 3.3.7 and 3.3.8.8, 3.3.8.21, 3.3.8.25 above), this must be used to calculate the equivalent shock to the price.

3. **Rebuild the hedge engine** with the shocked instruments.

4. **Calculate the (set of) shocked interpolators** – This is a collection of all curves affected by a shock, but purely the shock itself. So referring to the notation in 3.4.1.1 above:

$
\left\{ \begin{array}{l}
\left( t_{ij}, df^{shock} / t_{ij} \right)
\end{array} \right\}
$

where $ df^{shock} / t_{ij} = \frac{df^{shock} d'}{d' \sigma t_{0} t_{0,1}} $

5. **Apply the shock shape only** (multiply these interpolators of only the shock shape) from each hedge curve to the equivalent pricing curve.
Figure 1: Risk Template and Shock Generation Framework

![Risk Template and Shock Generation Framework](./Fig/libor_ois_interpolation_12.jpg)
One very important feature of NCF Risk is that once the HCT is shocked, the shock shape only (i.e. an interpolator containing only the shock shape) is applied to the original pricing curve. This is achieved by adding this interpolator (equivalent to multiplying the corresponding discount factors) it is these final shocked curves that are then passed to a pricer to calculate risk metrics. For a full &quot;risk step&quot; there will be as many shocks as there are hedge instruments for each curve in the HCT.

To return to the matrix above (4.1.1.10), when the HCT is built the inverse Jacobian $\frac{\partial z_i}{\partial r_i}$ can be used for the instrument shocks $\frac{\partial d_r}{\partial p_{q_k}}$.

This shocking mechanism is identical in inflation curves since the internal representation is as discount factors.

##### 7.1.1.1. Forecast curves

NCF risk for forward rate curves has not been tested or used – neither in production systems, but also not in any test application.

##### 7.1.1.2. Algorithmic Differentiation

Curve engines can also be constructed, and hence shocks applied, by Algorithmic Differentiation. In the case of risk generation, the sensitivity of the curve $(\{t_i, df_i\}_{curves})$ will be recorded against the instrument prices $(\{p_j\})$ as a first derivative (i.e. an infinitesimal bump) $\frac{\partial df_i}{\partial p_j}$.

So although intuitively the application of a 1bp shock, say, can still be thought of as a shock of that size to the instrument, it is not – it is simply $0.0001 \cdot \frac{\partial df_i}{\partial p_j}$.

##### 7.1.1.3. Seasonality

The above describes how risk is applied to a standard instrument and interpolator.

For Seasonality, it is different. We can note two things:

- Seasonality is always shocked as a single point.
- A single seasonality point (month) is shocked, but the product of the seasonality is 1.0.

If the shock is 1bp on month $ j $, then we have:

$
Seas_j = Seas_j \cdot 1.0001^{\left(\frac{11}{12}\right)} \text{ or } df_j = df_j \cdot 1.0001^{\left(-\frac{11}{12}\right)}
$

$
Seas_m = Seas_m \cdot 1.0001^{\left(-\frac{1}{12}\right)} \text{ for } m \neq j \text{ or } df_m = df_m \cdot 1.0001^{\left(\frac{1}{12}\right)}
$

**Note:** To shock seasonality **Up**, this will, if not on a node date, shock the CPI **Up** on month $ j $ (so the seasonality factor, which is applied to the discount factor, is shocked **Down**). See the next section for more information.

- When seasonality is shocked, we expect CPI values at the node dates defined by all other instruments to be unchanged, i.e. the interpolation in the 'no seasonality' interpolator (which is calibrated to reprice the instruments) will rebalance such that:

$
CPI_{t_i} = CPI_{t_i}^{NS} \cdot Seas'_{\text{month}}(t_i)
$

$
CPI_{t_i}^{NS} = CPI_{t_i}^{NS} \cdot Seas'_{\text{month}}(t_i)$

#### 7.1.2 Graphical representation

We can view the effect of an instrument shock, and in particular the dissociation of the risk from the pricing curves as follows.

We look at the EURIBOR 6M curve as at 30-Oct-2015, and the effect of shocking the 5Y swap rate. The risk factors on the curve are ... 3Y, 4Y, 5Y, 6Y, 7Y, 8Y... The curve has a split interpolation – Geometric to 19-Dec-18 (3Y IMM date), Logistic thereafter.

We can look at two scenarios – non local shocks, and local shocks.

![EURIBOR 6M curve showing effect of 5Y swap rate shock](./Fig/libor_ois_interpolation_13.jpg)

First, a shock where the HCT matches the interpolation of the curve (and the curve has smooth, non-local, interpolation). Shocking the 5y point (1bp) only produces an oscillatory effect due to logistic interpolation, but only after the split date. The geometric region is unaffected. Plot is of forward rate.

![EURIBOR 6M curve demonstrating local shock between 4y and 6y risk factors](./Fig/libor_ois_interpolation_14.jpg)

Second, a shock where the HCT has Geometric interpolation. Here the shock is completely local – between 4y and 6y (the two adjacent risk factors in the HCT).

#### 7.1.3 Seasonality

When examining the effect of shocking seasonality two items need to be considered:

1. The frequency of the instruments for risk (and their associated Node Dates).
2. How the seasonality month aligns with the Node Dates.

We take the example of the EUR HICP inflation curve at 30-Oct-2015. Base date (latest CPI) is 01-Sep-2015. It has the following instrument dates and node dates – all annual ZC inflation swaps of an exact yearly term. Lag for the instruments is 3 months:

| Instrument End Date | Node Date (for each instrument) | Frequency of instrument/node dates |
| ------------------- | ------------------------------- | ---------------------------------- |
| 30-Jan-2016-&gt;       | 01-Oct-2015-&gt;                   |                                    |
| 30-Nov-2016         | 01-Aug-2016                     | Mthly                              |
| 30-Oct-2017-&gt;       | 01-Jul-2017-&gt;                   |                                    |
| 30-Oct-2020-&gt;       | 01-Jul-2020-&gt;                   | Annual                             |
| 30-Oct-2025-&gt;       | 01-Jul-2025-&gt;                   | LTY                                |

If we shock a seasonality coefficient, only CPI values beyond Aug-2016 can change (the end of monthly instrument frequency). If we shock a seasonality coefficient other than Jul (i.e. Mar) then only the Mar CPI values beyond Aug-2016 will be shocked - i.e. Mar seasonality will be shocked (CPI up seasonality down) but the 11 other seasonalities will each be shocked up by the same amount, and the CPI at the Jul node dates remains unchanged. $df_j$ will compensate.

The shock size is 1bp equivalent, which means: $Seas^{shocked} = Seas_{Mar} * (1.0001)^{\frac{12}{11}}$ whereas the 11 other seasonalities $Seas^{shocked}_m = Seas_m * (1.0001)^{-\frac{1}{11}}$

On the below graphs LH axis (solid line) is CPI, RH (dotted line) is CPI shock.

First graph shows the positive shock in March only.

![Graph showing effect of March seasonality shock on CPI values](./Fig/libor_ois_interpolation_14.jpg)

Alternatively, since the instruments beyond Nov-2016 all specify node dates of Jul, if the Jul seasonality is shocked all other months are shocked (since to reprice the risk instruments by definition the Jul CPIs will not be shocked).

Thus the second graph shows the negative shock in all months other than July.

![Graph showing negative shock effect across all months except July](./Fig/libor_ois_interpolation_15.jpg)

#### 7.1.4 Delta

Delta is change in PV of a trade for a change in the price of a risk (hedge) instrument, $\frac{dPV}{dP_k}$

A &quot;delta strip&quot; will be a vector of the change in PV for a change in each hedge instrument:

$
\begin{pmatrix}
\frac{\partial PV}{\partial P_1} \\
\vdots \\
\frac{\partial PV}{\partial P_n}
\end{pmatrix}\]</div>
</div>
<p>$</p>
<p>In terms of curves, the change in PV is calculated from the curves with the effect of the change in instrument price. So “delta” with respect to curves themselves is a shock (change in discount factor/forward rate) in a curve from a change in instrument price:</p>
<p>For a single instrument, <span class="math notranslate nohighlight">\( t \)</span>, this is a vector,</p>
<p>$</p>
<div class="math-wrapper amsmath docutils container" id="equation-07eaf816-a683-4fe7-9ce2-355867c25f3d">
<div class="amsmath math notranslate nohighlight" id="equation-07eaf816-a683-4fe7-9ce2-355867c25f3d">
<span class="eqno">(5)<a class="headerlink" href="#equation-07eaf816-a683-4fe7-9ce2-355867c25f3d" title="Permalink to this equation">#</a></span>\[\begin{pmatrix}
\frac{\partial df_{t_i}^{a_1}}{\partial p_1} \\
\vdots \\
\frac{\partial df_{t_i}^{a_f}}{\partial p_1}
\end{pmatrix},
$

curves $\{a_j\}$, node dates $\{t_i'\}$. This vector could be for multiple curves (or just one curve, even a single discount factor).

For multiple instruments, $\{q_k\}, k = 1, \ldots, n$, this is a matrix,

$$
\begin{pmatrix}
\frac{\partial df_{t_i}^{a_1}}{\partial p_1} &amp; \frac{\partial df_{t_i}^{a_2}}{\partial p_2} &amp; \frac{\partial df_{t_i}^{a_3}}{\partial p_3} \\
\vdots &amp; \vdots &amp; \vdots \\
\frac{\partial df_{t_i}^{a_f}}{\partial p_1} &amp; \frac{\partial df_{t_i}^{a_f}}{\partial p_2} &amp; \frac{\partial df_{t_i}^{a_f}}{\partial p_3}
\end{pmatrix},
$$

curves $\{a_j\}$, node dates $\{t_i'\}$.

##### 7.1.4.1. Jacobian rebuild

In a production system, the shocked curves produced for delta are always generated using a Jacobian rebuild. The shock size is always 1bp or less (e.g., it may be 0.1bp, but the result is scaled by 10).

#### 7.1.5 Jacobian transform

The Jacobian transform is normally used to convert risk from a more complex form to a simpler form. It is used to ensure efficiency in generating risk – only the more complex or granular risk need actually be generated. In general, the transform is from source risk (structure defined by Source Risk Template) to target risk (structure defined by Target Risk Template).

All risk being transformed from the source must be represented (i.e., curves present) in the target.

A way of describing a transform is that the target risk represents how those instruments/buckets affect instruments/buckets in the source. Alternatively, the transform represents the portfolio of instruments in the target HCT that give risk to the instruments in the source HCT.

Jacobian transformation is often used along with the chain rule to compute derivatives of a composite function.

The chain rule states that:

If $$ y = h(x) $$

and $$ f(x) = g(x) = g(h(x)) $$

then $$ f'(x) = g'(x) * h'(x) $$

In more general cases, $ x $ and $ y $ are vectors, and the above equation is written as:


# Chain Rule in Matrix Form

The chain rule for multivariate functions can be expressed elegantly in matrix form. When we have a composite function $f(x) = g(y(x))$, the gradient of $f$ with respect to $x$ can be calculated as follows:

$$
\begin{pmatrix}
\frac{\partial f}{\partial x_1} \\
\vdots \\
\frac{\partial f}{\partial x_n}
\end{pmatrix}^T
=
\begin{pmatrix}
\frac{\partial g}{\partial y_1} \\
\vdots \\
\frac{\partial g}{\partial y_n}
\end{pmatrix}^T
\begin{pmatrix}
\frac{\partial y_1}{\partial x_1} &amp; \cdots &amp; \frac{\partial y_1}{\partial x_n} \\
\vdots &amp; \ddots &amp; \vdots \\
\frac{\partial y_n}{\partial x_1} &amp; \cdots &amp; \frac{\partial y_n}{\partial x_n}
\end{pmatrix}\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}This equation demonstrates how the gradient of the composite function is equal to the product of the gradient of the outer function and the Jacobian matrix of the inner function.\\In more compact notation, this can be written as:\\$$\nabla_x f = \nabla_y g \cdot J_{y,x}\end{aligned}\end{align} \]</div>
</div>
<p>Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\nabla_x f\)</span> is the gradient of <span class="math notranslate nohighlight">\(f\)</span> with respect to <span class="math notranslate nohighlight">\(x\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\nabla_y g\)</span> is the gradient of <span class="math notranslate nohighlight">\(g\)</span> with respect to <span class="math notranslate nohighlight">\(y\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(J_{y,x}\)</span> is the Jacobian matrix of <span class="math notranslate nohighlight">\(y\)</span> with respect to <span class="math notranslate nohighlight">\(x\)</span></p></li>
</ul>
<p>A Jacobian transform allows us to obtain the risk strip to a Target Risk Template from the risk strip to a Source Risk Template.</p>
<p><span class="math notranslate nohighlight">\(
\text{Delta target} = \text{Delta source} \times J \text{ matrix}
\)</span></p>
<p>In mathematical form:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{bmatrix}
\frac{\partial P}{\partial \tau_1} \\
\vdots \\
\frac{\partial P}{\partial \tau_n}
\end{bmatrix}
=
\begin{bmatrix}
\frac{\partial P}{\partial R_1} &amp; \cdots &amp; \frac{\partial P}{\partial R_m}
\end{bmatrix}
\begin{bmatrix}
\frac{\partial R_1}{\partial \tau_1} &amp; \cdots &amp; \frac{\partial R_1}{\partial \tau_n} \\
\vdots &amp; \ddots &amp; \vdots \\
\frac{\partial R_m}{\partial \tau_1} &amp; \cdots &amp; \frac{\partial R_m}{\partial \tau_n}
\end{bmatrix}
\end{split}\]</div>
</div>
<p>Where:</p>
<ul class="simple">
<li><p><strong>Delta target</strong> is the risk strip to the target Risk Template, and <span class="math notranslate nohighlight">\(\frac{\partial P}{\partial \tau_i} (i = 1, ..., n)\)</span> represents the sensitivity of the trade price to the rate of instrument <span class="math notranslate nohighlight">\(i\)</span> in the target Risk Template.</p></li>
<li><p><strong>Delta source</strong> is the risk strip to the source Risk Template, and <span class="math notranslate nohighlight">\(\frac{\partial P}{\partial R_j} (j = 1, ..., m)\)</span> represents the sensitivity of the trade price to the rate of instrument <span class="math notranslate nohighlight">\(j\)</span> in the source Risk Template.</p></li>
<li><p><span class="math notranslate nohighlight">\(\frac{\partial R_j}{\partial \tau_i}\)</span> indicates the sensitivity of the instrument <span class="math notranslate nohighlight">\(j\)</span>’s rate in the source Risk Template to the instrument <span class="math notranslate nohighlight">\(i\)</span>’s rate in the target Risk Template via pricing curves.</p></li>
</ul>
</section>
<section id="application">
<h5>7.1.5.1. Application<a class="headerlink" href="#application" title="Link to this heading">#</a></h5>
<p>Note that the Jacobian transform matrix is just that – a matrix. It can only be used together with the delta (change in PV) produced for a trade, or set of trades, using the source, to transform to a different set of buckets defined by the target.</p>
</section>
<section id="calculation-of-the-jacobian-transform-matrix">
<h5>7.1.5.2. Calculation of the Jacobian transform matrix<a class="headerlink" href="#calculation-of-the-jacobian-transform-matrix" title="Link to this heading">#</a></h5>
<p>There are two methods for this:</p>
<section id="numerical-method">
<h6>7.1.5.2.1. Numerical method<a class="headerlink" href="#numerical-method" title="Link to this heading">#</a></h6>
<p>Use the numerical method to calculate the Jacobian transform matrix. The matrix is calculated column by column. The <span class="math notranslate nohighlight">\(i\)</span>-th instrument in the target Risk Template is shocked to get the <span class="math notranslate nohighlight">\(i\)</span>-th column of the matrix. The curve shock shapes of the bumping (one single bump may affect several curves in the curve set) are added to the original curve set. The source Risk Template is repriced by this bumped curve set. The rate differences of each instrument in the source Risk Template correspond to the entries of the <span class="math notranslate nohighlight">\(i\)</span>-th column of the Jacobian transform matrix.</p>
</section>
<section id="id21">
<h6>7.1.5.2.2. Algorithmic Differentiation<a class="headerlink" href="#id21" title="Link to this heading">#</a></h6>
<p>The Jacobian transform is calculated analytically – the sensitivity of the Source Template instruments to the curves <span class="math notranslate nohighlight">\(\frac{\partial q_i}{\partial z_j}\)</span>, is computed directly by registering against the sensitivity of the curves to the Target Template instruments <span class="math notranslate nohighlight">\(\frac{\partial z_j}{\partial f_i}\)</span>.</p>
</section>
<section id="comparison-of-ad-vs-fd">
<h6>7.1.5.2.3. Comparison of AD vs. FD<a class="headerlink" href="#comparison-of-ad-vs-fd" title="Link to this heading">#</a></h6>
<p>We do not make the statement that finite differencing is more or less accurate in practical use than AD for calculation of the Jacobian transform. If we apply a shock of 1bp to the instruments in the source risk template, then, by definition, if actual shocks of 1bp were experienced and applied, this would be more accurate than AD.
However, AD has greater numerical accuracy, since it is the derivative.</p>
<p>We can examine a portion of a jacobian transform from a granular source (4Y-50Y swaps, annual to 20Y, forward-starting) in the columns of the matrix, to less granular (spot-starting, only annual to 10Y), in the rows of the matrix. The portion we look at is 10y-20y.</p>
<p>Below we show the jacobian transform matrix 10y-20y with AD, and also the absolute difference from these values to the same portion of the matrix with FD i.e. the format is:</p>
<p>| AD value |
| ADs difference |</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>SWAP31Y1Y</p></th>
<th class="head"><p>SWAP4Y1Y</p></th>
<th class="head"><p>SWAP5Y1Y</p></th>
<th class="head"><p>SWAP6Y1Y</p></th>
<th class="head"><p>SWAP7Y1Y</p></th>
<th class="head"><p>SWAP8Y1Y</p></th>
<th class="head"><p>SWAP9Y1Y</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SWAP4Y</p></td>
<td><p>-0.071541; 0.000004</p></td>
<td><p>-0.048130; 0.000013</p></td>
<td><p>-0.115615; 0.000002</p></td>
<td><p>-0.116115; 0.000001</p></td>
<td><p>&lt;1E-6</p></td>
<td><p>&lt;1E-6</p></td>
<td><p>&lt;1E-6</p></td>
</tr>
<tr class="row-odd"><td><p>SWAP5Y</p></td>
<td><p>-0.134905; 0.000001</p></td>
<td><p>-0.481512; 0.000006</p></td>
<td><p>-0.138188; 0.000021</p></td>
<td><p>-2.782942; 0.000004</p></td>
<td><p>-1.401523; 0.000002</p></td>
<td><p>1.156048; 0.000001</p></td>
<td><p>&lt;1E-6</p></td>
</tr>
<tr class="row-even"><td><p>SWAP6Y</p></td>
<td><p>&lt;1E-6</p></td>
<td><p>-0.653604; 0.000001</p></td>
<td><p>-1.381188; 0.000009</p></td>
<td><p>-7.801604; 0.000030</p></td>
<td><p>-3.414199; 0.000006</p></td>
<td><p>-2.338936; 0.000002</p></td>
<td><p>-1.528099; 0.000002</p></td>
</tr>
<tr class="row-odd"><td><p>SWAP7Y</p></td>
<td><p>&lt;1E-6; &lt;1E-6</p></td>
<td><p>-0.023998; &lt;1E-6</p></td>
<td><p>1.391404; 0.000002</p></td>
<td><p>4.884839; 0.000012</p></td>
<td><p>-9.268649; 0.000043</p></td>
<td><p>3.850912; 0.000008</p></td>
<td><p>-2.22124; 0.000005</p></td>
</tr>
<tr class="row-even"><td><p>SWAP8Y</p></td>
<td><p>&lt;1E-6</p></td>
<td><p>&lt;1E-6</p></td>
<td><p>&lt;1E-6</p></td>
<td><p>2.254336; 0.000002</p></td>
<td><p>2.683889; 0.000016</p></td>
<td><p>10.564319; 0.000056</p></td>
<td><p>2.917127; 0.000016</p></td>
</tr>
<tr class="row-odd"><td><p>SWAP9Y</p></td>
<td><p>-0.010458; &lt;1E-6</p></td>
<td><p>0.067212; &lt;1E-6</p></td>
<td><p>-0.013744; &lt;1E-6</p></td>
<td><p>-0.038604; &lt;1E-6</p></td>
<td><p>2.532620; 0.000003</p></td>
<td><p>6.357527; 0.000020</p></td>
<td><p>14.334334; 0.000101</p></td>
</tr>
<tr class="row-even"><td><p>SWAP10Y</p></td>
<td><p>-0.018963; &lt;1E-6</p></td>
<td><p>0.012125; &lt;1E-6</p></td>
<td><p>-0.007883; &lt;1E-6</p></td>
<td><p>0.005737; &lt;1E-6</p></td>
<td><p>-0.047817; &lt;1E-6</p></td>
<td><p>2.835028; 0.000004</p></td>
<td><p>0.056311; &lt;1E-6</p></td>
</tr>
<tr class="row-odd"><td><p>SWAP12Y</p></td>
<td><p>-0.010921; &lt;1E-6</p></td>
<td><p>0.066860; &lt;1E-6</p></td>
<td><p>-0.004421; &lt;1E-6</p></td>
<td><p>0.002834; &lt;1E-6</p></td>
<td><p>-0.001595; &lt;1E-6</p></td>
<td><p>-0.019306; &lt;1E-6</p></td>
<td><p>1.340997; 0.000002</p></td>
</tr>
<tr class="row-even"><td><p>SWAP15Y</p></td>
<td><p>-0.009468; &lt;1E-6</p></td>
<td><p>0.006086; &lt;1E-6</p></td>
<td><p>-0.003962; &lt;1E-6</p></td>
<td><p>0.002538; &lt;1E-6</p></td>
<td><p>-0.001704; &lt;1E-6</p></td>
<td><p>0.002986; &lt;1E-6</p></td>
<td><p>-0.125285; &lt;1E-6</p></td>
</tr>
<tr class="row-odd"><td><p>SWAP20Y</p></td>
<td><p>-0.006269; &lt;1E-6</p></td>
<td><p>0.004030; &lt;1E-6</p></td>
<td><p>-0.002617; &lt;1E-6</p></td>
<td><p>0.001681; &lt;1E-6</p></td>
<td><p>-0.001109; &lt;1E-6</p></td>
<td><p>0.000454; &lt;1E-6</p></td>
<td><p>0.015272; &lt;1E-6</p></td>
</tr>
<tr class="row-even"><td><p>Sum (rel. diff)</p></td>
<td><p>0.0001%</p></td>
<td><p>0.003%</p></td>
<td><p>0.003%</p></td>
<td><p>0.004%</p></td>
<td><p>0.006%</p></td>
<td><p>0.005%</p></td>
<td><p>0.007%</p></td>
</tr>
</tbody>
</table>
</div>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>SWAP10Y1Y</p></th>
<th class="head"><p>SWAP11Y1Y</p></th>
<th class="head"><p>SWAP12Y1Y</p></th>
<th class="head"><p>SWAP13Y1Y</p></th>
<th class="head"><p>SWAP14Y1Y</p></th>
<th class="head"><p>SWAP15Y1Y</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SWAP4Y</p></td>
<td><p>-0.008617; &lt;1E-6</p></td>
<td><p>-0.012431; &lt;1E-6</p></td>
<td><p>-0.135876; &lt;1E-6</p></td>
<td><p>0.134480; &lt;1E-6</p></td>
<td><p>-0.02004; &lt;1E-6</p></td>
<td><p>0.06313; &lt;1E-6</p></td>
</tr>
<tr class="row-odd"><td><p>SWAP5Y</p></td>
<td><p>-0.055843; &lt;1E-6</p></td>
<td><p>0.827272; &lt;1E-6</p></td>
<td><p>-0.365609; &lt;1E-6</p></td>
<td><p>-0.276176; &lt;1E-6</p></td>
<td><p>-0.808165; &lt;1E-6</p></td>
<td><p>-1.277778; &lt;1E-6</p></td>
</tr>
<tr class="row-even"><td><p>SWAP6Y</p></td>
<td><p>0.086446; &lt;1E-6</p></td>
<td><p>-1.550988; 0.000001</p></td>
<td><p>-0.492884; &lt;1E-6</p></td>
<td><p>-0.502664; &lt;1E-6</p></td>
<td><p>-1.702608; &lt;1E-6</p></td>
<td><p>-1.839010; &lt;1E-6</p></td>
</tr>
<tr class="row-odd"><td><p>SWAP7Y</p></td>
<td><p>-1.178817; &lt;1E-6</p></td>
<td><p>2.811799; 0.000004</p></td>
<td><p>1.882677; &lt;1E-6</p></td>
<td><p>-1.332305; &lt;1E-6</p></td>
<td><p>-1.382832; 0.000001</p></td>
<td><p>-1.755565; &lt;1E-6</p></td>
</tr>
<tr class="row-even"><td><p>SWAP8Y</p></td>
<td><p>2.294821; 0.000002</p></td>
<td><p>-5.024804; 0.000012</p></td>
<td><p>-1.943225; 0.000001</p></td>
<td><p>1.644842; 0.000001</p></td>
<td><p>4.320368; 0.000003</p></td>
<td><p>1.298631; 0.000001</p></td>
</tr>
<tr class="row-odd"><td><p>SWAP9Y</p></td>
<td><p>0.506020; &lt;1E-6</p></td>
<td><p>8.92459; 0.000039</p></td>
<td><p>2.611004; 0.000004</p></td>
<td><p>-2.943242; 0.000004</p></td>
<td><p>-4.373051; 0.000009</p></td>
<td><p>-2.322808; 0.000003</p></td>
</tr>
</tbody>
</table>
</div>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>SWAP10Y</p></th>
<th class="head"><p>SWAP11Y</p></th>
<th class="head"><p>SWAP12Y</p></th>
<th class="head"><p>SWAP13Y</p></th>
<th class="head"><p>SWAP14Y</p></th>
<th class="head"><p>SWAP15Y</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SWAP10Y</p></td>
<td><p>-5.188981; 0.000023</p></td>
<td><p>-12.141531; 0.000073</p></td>
<td><p>-3.571393; 0.000006</p></td>
<td><p>3.097882; 0.000002</p></td>
<td><p>5.505738; 0.000015</p></td>
<td><p>2.919282; 0.000004</p></td>
</tr>
<tr class="row-odd"><td><p>SWAP12Y</p></td>
<td><p>6.960389; 0.000018</p></td>
<td><p>6.094631; 0.000018</p></td>
<td><p>-1.988015; 0.000002</p></td>
<td><p>-7.390181; 0.000029</p></td>
<td><p>-7.605747; 0.000029</p></td>
<td><p>-3.889202; 0.000007</p></td>
</tr>
<tr class="row-even"><td><p>SWAP15Y</p></td>
<td><p>-0.023506; &lt;1E-6</p></td>
<td><p>1.642156; 0.000001</p></td>
<td><p>5.944082; 0.000014</p></td>
<td><p>6.702195; 0.000016</p></td>
<td><p>4.682505; 0.000011</p></td>
<td><p>0.132726; &lt;1E-6</p></td>
</tr>
<tr class="row-odd"><td><p>SWAP20Y</p></td>
<td><p>0.041742; &lt;1E-6</p></td>
<td><p>-0.212176; &lt;1E-6</p></td>
<td><p>-0.567085; &lt;1E-6</p></td>
<td><p>0.007316; &lt;1E-6</p></td>
<td><p>1.777684; 0.000002</p></td>
<td><p>1.304193; 0.000009</p></td>
</tr>
<tr class="row-even"><td><p>Sum (rel. diff)</p></td>
<td><p>0.003%</p></td>
<td><p>0.008%</p></td>
<td><p>0.003%</p></td>
<td><p>0.005%</p></td>
<td><p>0.004%</p></td>
<td><p>0.002%</p></td>
</tr>
</tbody>
</table>
</div>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>SWAP16Y1Y</p></th>
<th class="head"><p>SWAP17Y1Y</p></th>
<th class="head"><p>SWAP18Y1Y</p></th>
<th class="head"><p>SWAP19Y1Y</p></th>
<th class="head"><p>Sum (rel. diff)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SWAP4Y</p></td>
<td><p>-0.006612; &lt;1E-6</p></td>
<td><p>-0.056698; &lt;1E-6</p></td>
<td><p>-0.083783; &lt;1E-6</p></td>
<td><p>-0.074787; &lt;1E-6</p></td>
<td><p>0.007%</p></td>
</tr>
<tr class="row-odd"><td><p>SWAP5Y</p></td>
<td><p>-0.090614; &lt;1E-6</p></td>
<td><p>-0.184628; &lt;1E-6</p></td>
<td><p>-0.161100; &lt;1E-6</p></td>
<td><p>-0.141116; &lt;1E-6</p></td>
<td><p>0.002%</p></td>
</tr>
<tr class="row-even"><td><p>SWAP6Y</p></td>
<td><p>-0.268816; &lt;1E-6</p></td>
<td><p>-0.503396; &lt;1E-6</p></td>
<td><p>-0.305882; &lt;1E-6</p></td>
<td><p>-0.272257; &lt;1E-6</p></td>
<td><p>0.002%</p></td>
</tr>
<tr class="row-odd"><td><p>SWAP7Y</p></td>
<td><p>-0.061776; &lt;1E-6</p></td>
<td><p>-0.357247; &lt;1E-6</p></td>
<td><p>-0.051995; &lt;1E-6</p></td>
<td><p>-0.043345; &lt;1E-6</p></td>
<td><p>0.002%</p></td>
</tr>
<tr class="row-even"><td><p>SWAP8Y</p></td>
<td><p>0.095476; &lt;1E-6</p></td>
<td><p>-0.603579; &lt;1E-6</p></td>
<td><p>-0.991383; &lt;1E-6</p></td>
<td><p>-0.888864; &lt;1E-6</p></td>
<td><p>0.002%</p></td>
</tr>
<tr class="row-odd"><td><p>SWAP9Y</p></td>
<td><p>-0.188394; &lt;1E-6</p></td>
<td><p>1.170058; 0.000001</p></td>
<td><p>1.754596; 0.000002</p></td>
<td><p>1.568437; 0.000001</p></td>
<td><p>0.001%</p></td>
</tr>
<tr class="row-even"><td><p>SWAP10Y</p></td>
<td><p>-0.266408; &lt;1E-6</p></td>
<td><p>-1.487284; 0.000001</p></td>
<td><p>-2.223701; 0.000002</p></td>
<td><p>-1.987175; 0.000001</p></td>
<td><p>0.005%</p></td>
</tr>
<tr class="row-odd"><td><p>SWAP12Y</p></td>
<td><p>-0.324497; &lt;1E-6</p></td>
<td><p>1.945159; 0.000002</p></td>
<td><p>2.922357; 0.000004</p></td>
<td><p>2.612792; 0.000003</p></td>
<td><p>0.003%</p></td>
</tr>
<tr class="row-even"><td><p>SWAP15Y</p></td>
<td><p>-3.585143; 0.000006</p></td>
<td><p>-5.652232; 0.000016</p></td>
<td><p>-6.069899; 0.000018</p></td>
<td><p>-4.837666; 0.000012</p></td>
<td><p>0.005%</p></td>
</tr>
<tr class="row-odd"><td><p>SWAP20Y</p></td>
<td><p>5.787593; 0.000017</p></td>
<td><p>5.834125; 0.000017</p></td>
<td><p>4.429896; 0.000010</p></td>
<td><p>1.567071; 0.000003</p></td>
<td><p>0.007%</p></td>
</tr>
<tr class="row-even"><td><p>Sum (rel. diff)</p></td>
<td><p>0.003%</p></td>
<td><p>0.003%</p></td>
<td><p>0.003%</p></td>
<td><p>0.002%</p></td>
<td><p>0.002%</p></td>
</tr>
</tbody>
</table>
</div>
<p>We highlight red the largest difference = 0.000101 in absolute difference, 0.0007% in relative difference.</p>
<p>A largest difference on 7E-6 in relative terms is not material – 0.07c in $1000.</p>
<p>In production EOD AAD is used.</p>
</section>
</section>
</section>
<section id="typical-risk-representations">
<h4>7.1.6 Typical risk representations<a class="headerlink" href="#typical-risk-representations" title="Link to this heading">#</a></h4>
<p>In 7.1.1 the flexibility of NCF Risk is described, but it is worth describing the typical types of risk view – there are a relatively small number used in practice.</p>
<p>It should be emphasised, this is a choice, the discretion of the consumer or the risk.</p>
<section id="single-outright-curve">
<h5>7.1.6.1. Single outright curve<a class="headerlink" href="#single-outright-curve" title="Link to this heading">#</a></h5>
<p>This is the most common choice. A single, main, curve is chosen to represent risk to the absolute change in interest rates – i.e. this is the outright curve – represented as Deposits, Futures and Swaps.
All other curves are defined in the risk representation as a spread, or basis (e.g. use basis swaps, 3.3.8.7 above). E.g. EUR has the following risk representation for EOD:</p>
<p>[Diagram showing risk representation with three columns]</p>
<p><img alt="Diagram showing risk representation with three columns" src="../../_images/libor_ois_interpolation_17.jpg" /></p>
<p>Outright curve:</p>
<ul class="simple">
<li><p>EUR.EONIA.1B</p></li>
</ul>
<p>Spread to OIS:</p>
<ul class="simple">
<li><p>EUR.EURIBOR.3M</p></li>
<li><p>EUR.EURIBOR.1M</p></li>
<li><p>EUR.LIBOR.1M</p></li>
<li><p>EUR.BASE.1B</p></li>
<li><p>EUR.DISC [EUR.EONIA.1B]</p></li>
</ul>
<p>Spread to 3M:</p>
<ul class="simple">
<li><p>EUR.EURIBOR.6M</p></li>
<li><p>EUR.EURIBOR.12M</p></li>
<li><p>EUR.LIBOR.3M</p></li>
<li><p>EUR.LIBOR.6M</p></li>
<li><p>EUR.LIBOR.12M</p></li>
</ul>
</section>
<section id="market-instruments">
<h5>7.1.6.2. Market instruments<a class="headerlink" href="#market-instruments" title="Link to this heading">#</a></h5>
<p>Here the risk representation is exactly as the instruments used to construct the curve. This may be used for price testing against market data.</p>
</section>
<section id="all-outright-curves">
<h5>7.1.6.3. All outright curves<a class="headerlink" href="#all-outright-curves" title="Link to this heading">#</a></h5>
<p>This risk representation simplifies the approach, and treats all curves as outright, with no interdependency.</p>
</section>
</section>
</section>
<section id="id22">
<h3>7.2 Inputs<a class="headerlink" href="#id22" title="Link to this heading">#</a></h3>
<section id="shock-size">
<h4>7.2.1 Shock size<a class="headerlink" href="#shock-size" title="Link to this heading">#</a></h4>
<p>This will typically be 1bp or 0.01bp (0.0001 or 0.000001 as a rate).</p>
</section>
<section id="id23">
<h4>7.2.2 AD or FD<a class="headerlink" href="#id23" title="Link to this heading">#</a></h4>
<p>Whether to produce shocked curves with AD or FD – i.e. whether the full build, and hence production of the jacobian matrix is performed with AD or FD. See 4.1.1.3.</p>
</section>
</section>
<section id="assumptions-limitations-and-risk-assessment">
<h3>7.3 Assumptions, Limitations and Risk Assessment<a class="headerlink" href="#assumptions-limitations-and-risk-assessment" title="Link to this heading">#</a></h3>
<p>We note here the assumptions of NCF shocked curve/jacobian transform. Where more detail or test evidence is required this is referenced in section 8.4.</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Assumption</p></th>
<th class="head"><p>Limitation/description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>Curve shocking applied using finite difference under a</p></td>
</tr>
<tr class="row-odd"><td><p>jacobian rebuild is accurate</p></td>
<td><p>rebuild (given that curve shocks are applied either via AAD or for 1bp rate change) is accurate for use in risk calculations. Limitation: This may not be accurate under all shock sizes.</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>Jacobian transform is accurate for a target risk template if nodes and associated instruments in a subset of those in the source risk template</p></td>
</tr>
</tbody>
</table>
</div>
<section id="jacobian-transform-accuracy">
<h4>7.3.1 Jacobian transform accuracy<a class="headerlink" href="#jacobian-transform-accuracy" title="Link to this heading">#</a></h4>
<p>A jacobian transform is not completely accurate (i.e. will not produce the same risk as native calculation) if the bucketing of the target risk does not satisfy 3 criteria:</p>
<ul class="simple">
<li><p>For each curve the instruments (node dates) in the target are a strict subset of the nodes in the source.</p></li>
<li><p>For each curve that contains outright instruments (an instrument that is not defining a spread between 2 curves), and is not a cross-currency instrument in the target that is defined by spread instrument (an instrument that define the spread between 2 curves) in the source must also contain instruments (node dates) in the target that are a strict subset of the nodes of each of the curves to each of the curves used in the spread instrument, as defined in the source.</p></li>
<li><p>The interpolation of each curve in source and target is identical.</p></li>
</ul>
<p>This inaccuracy is identified and noted by users of the risk – for example Market Risk consume risk in buckets that do not satisfy these criteria, but have done so since the implementation of NCF for EOD and are aware of this limitation. The therefore the choice made by the consumer of the risk – not NCF itself – they test and sign off on the inaccuracy, or a native risk run (no transform) would be enabled at the implementation of the EOD system.</p>
<section id="suboptimal-transform">
<h5>7.3.1.1. Suboptimal transform<a class="headerlink" href="#suboptimal-transform" title="Link to this heading">#</a></h5>
<p>We can show two examples – computed as of 24-Jun-16. We show IR Delta (outright delta). This is a typical example of realistic risk views seen in production:</p>
<p>Fixed-float swap – maturity 01-Jan-2035 (18.5 years) €100mio notional</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>Source</p></th>
<th class="head"><p>Native</p></th>
<th class="head"><p>Transformed</p></th>
<th class="head"><p>% error</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>IR Delta</p></td>
<td><p>157,609</p></td>
<td><p></p></td>
<td><p>161,738</p></td>
<td><p>0%</p></td>
</tr>
<tr class="row-odd"><td><p>DEPOSITS_3M</p></td>
<td><p>-2.469</p></td>
<td><p>DEPOSITS_EON_1B</p></td>
<td><p>-14</p></td>
<td><p>-13</p></td>
</tr>
<tr class="row-even"><td><p>DEPOSITS_1MM_3M</p></td>
<td><p>2.331</p></td>
<td><p>DEPOSITS_1W</p></td>
<td><p>-69</p></td>
<td><p>-70</p></td>
</tr>
<tr class="row-odd"><td><p>DEPOSITS_2MM_3M</p></td>
<td><p>-2.575</p></td>
<td><p>DEPOSITS_1M</p></td>
<td><p>2</p></td>
<td><p>-280</p></td>
</tr>
<tr class="row-even"><td><p>DEPOSITS_3MM_3M</p></td>
<td><p>-2.570</p></td>
<td><p>DEPOSITS_3M</p></td>
<td><p>16</p></td>
<td><p>285</p></td>
</tr>
<tr class="row-odd"><td><p>DEPOSITS_4MM_3M</p></td>
<td><p>-2.152</p></td>
<td><p>DEPOSITS_6M</p></td>
<td><p>-60</p></td>
<td><p>-302</p></td>
</tr>
<tr class="row-even"><td><p>DEPOSITS_5MM_3M</p></td>
<td><p>-2.124</p></td>
<td><p>SWAPS_1Y</p></td>
<td><p>-37</p></td>
<td><p>18</p></td>
</tr>
<tr class="row-odd"><td><p>DEPOSITS_6MM_3M</p></td>
<td><p>-2.088</p></td>
<td><p>SWAPS_2Y</p></td>
<td><p>-211</p></td>
<td><p>-245</p></td>
</tr>
<tr class="row-even"><td><p>DEPOSITS_7MM_3M</p></td>
<td><p>2.177</p></td>
<td><p>SWAPS_3Y</p></td>
<td><p>-250</p></td>
<td><p>-458</p></td>
</tr>
<tr class="row-odd"><td><p>DEPOSITS_8MM_3M</p></td>
<td><p>-2.124</p></td>
<td><p>SWAPS_4Y</p></td>
<td><p>-518</p></td>
<td><p>-85</p></td>
</tr>
<tr class="row-even"><td><p>DEPOSITS_9MM_3M</p></td>
<td><p>2.127</p></td>
<td><p>SWAPS_5Y</p></td>
<td><p>-557</p></td>
<td><p>-604</p></td>
</tr>
<tr class="row-odd"><td><p>DEPOSITS_10MM_3M</p></td>
<td><p>-2.104</p></td>
<td><p>SWAPS_6Y</p></td>
<td><p>-691</p></td>
<td><p>-478</p></td>
</tr>
<tr class="row-even"><td><p>DEPOSITS_11MM_3M</p></td>
<td><p>2.180</p></td>
<td><p>SWAPS_7Y</p></td>
<td><p>-818</p></td>
<td><p>-821</p></td>
</tr>
<tr class="row-odd"><td><p>DEPOSITS_12MM_3M</p></td>
<td><p>-2.088</p></td>
<td><p>SWAPS_8Y</p></td>
<td><p>249</p></td>
<td><p>251</p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_3Y_1Y</p></td>
<td><p>8.472</p></td>
<td><p>SWAPS_9Y</p></td>
<td><p>-4,980</p></td>
<td><p>-4,981</p></td>
</tr>
<tr class="row-odd"><td><p>SWAPS_4Y_1Y</p></td>
<td><p>8.393</p></td>
<td><p>SWAPS_10Y</p></td>
<td><p>8,817</p></td>
<td><p>8,817</p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_5Y_1Y</p></td>
<td><p>8.429</p></td>
<td><p>SWAPS_12Y</p></td>
<td><p>-25,334</p></td>
<td><p>-25,334</p></td>
</tr>
<tr class="row-odd"><td><p>SWAPS_6Y_1Y</p></td>
<td><p>8.419</p></td>
<td><p>SWAPS_15Y</p></td>
<td><p>-54,051</p></td>
<td><p>-54,051</p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_7Y_1Y</p></td>
<td><p>8.402</p></td>
<td><p>SWAPS_20Y</p></td>
<td><p>154,327</p></td>
<td><p>154,327</p></td>
</tr>
<tr class="row-odd"><td><p>SWAPS_8Y_1Y</p></td>
<td><p>8.451</p></td>
<td><p>SWAPS_25Y</p></td>
<td><p>-29,451</p></td>
<td><p>-29,451</p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_9Y_1Y</p></td>
<td><p>8.397</p></td>
<td><p>SWAPS_30Y</p></td>
<td><p>7,708</p></td>
<td><p>7,708</p></td>
</tr>
<tr class="row-odd"><td><p>SWAPS_10Y_1Y</p></td>
<td><p>8.362</p></td>
<td><p>SWAPS_50Y</p></td>
<td><p>-1,099</p></td>
<td><p>-1,099</p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_11Y_1Y</p></td>
<td><p>8.396</p></td>
<td><p></p></td>
<td><p>227</p></td>
<td><p>227</p></td>
</tr>
<tr class="row-odd"><td><p>SWAPS_12Y_1Y</p></td>
<td><p>8.396</p></td>
<td><p>Sum of absolute error</p></td>
<td><p>1,187</p></td>
<td><p>0.7%</p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_13Y_1Y</p></td>
<td><p>8.415</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>SWAPS_14Y_1Y</p></td>
<td><p>8.455</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_15Y_1Y</p></td>
<td><p>8.431</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>SWAPS_16Y_1Y</p></td>
<td><p>8.194</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_17Y_1Y</p></td>
<td><p>9.302</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>SWAPS_18Y_1Y</p></td>
<td><p>4.339</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_19Y_1Y</p></td>
<td><p>-706</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>SWAPS_20Y_5Y</p></td>
<td><p>-8</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_25Y_5Y</p></td>
<td><p>-71</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>SWAPS_30Y_5Y</p></td>
<td><p>5</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_35Y_5Y</p></td>
<td><p>1</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>SWAPS_40Y_5Y</p></td>
<td><p>0</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_45Y_5Y</p></td>
<td><p>0</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</div>
<p>Note on instrument terminology:</p>
<table>
  <tr>
    <th>Instrument</th>
    <th>Description</th>
  </tr>
  <tr>
    <td>DEPOSITS_11MM_3M</td>
    <td>Deposit starting on the next (1st) IMM date, term 3 months</td>
  </tr>
  <tr>
    <td>SWAPS_3Y_1Y</td>
    <td>Swap start in 3y (from spot), term 1y</td>
  </tr>
  <tr>
    <td>DEPOSITS_E-OB_1B</td>
    <td>Deposit starting from evaluation day ('today' of the curve), term 1 business day</td>
  </tr>
  <tr>
    <td>DEPOSITS_1W</td>
    <td>Spot-starting Deposit, term 1 week</td>
  </tr>
  <tr>
    <td>DEPOSITS_1M</td>
    <td>Spot-starting Deposit, term 1 month</td>
  </tr>
  <tr>
    <td>SWAPS_1Y</td>
    <td>Spot-starting Swap, term 1 year</td>
  </tr>
</table>
<p>Here the error in the transform - tiny as a measure of parallel shift (overall IRDelta €1) or the sum of all errors (0.7%).</p>
<p>FRA 01-Jul-16, 3M, €1bn notional</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>Source</p></th>
<th class="head"><p>Native</p></th>
<th class="head"><p>Transformed</p></th>
<th class="head"><p>% error</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>IR Delta</p></td>
<td><p>26,150</p></td>
<td><p>IR Delta</p></td>
<td><p>26,153</p></td>
<td><p>26,152</p></td>
</tr>
<tr class="row-odd"><td><p>DEPOSITS_3M</p></td>
<td><p>-2,422</p></td>
<td><p>DEPOSITS_EON_1B</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>DEPOSITS_1MM_3M</p></td>
<td><p>1,718</p></td>
<td><p>DEPOSITS_1W</p></td>
<td><p>-815</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>DEPOSITS_2MM_3M</p></td>
<td><p>0</p></td>
<td><p>DEPOSITS_1M</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>DEPOSITS_3MM_3M</p></td>
<td><p>0</p></td>
<td><p>DEPOSITS_3M</p></td>
<td><p>23,645</p></td>
<td><p>23,025</p></td>
</tr>
<tr class="row-odd"><td><p>DEPOSITS_4MM_3M</p></td>
<td><p>0</p></td>
<td><p>DEPOSITS_6M</p></td>
<td><p>3,323</p></td>
<td><p>3,131</p></td>
</tr>
<tr class="row-even"><td><p>DEPOSITS_5MM_3M</p></td>
<td><p>0</p></td>
<td><p>SWAPS_1Y</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>DEPOSITS_6MM_3M</p></td>
<td><p>0</p></td>
<td><p>SWAPS_2Y</p></td>
<td><p>-0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>DEPOSITS_7MM_3M</p></td>
<td><p>0</p></td>
<td><p>SWAPS_3Y</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>DEPOSITS_8MM_3M</p></td>
<td><p>0</p></td>
<td><p>SWAPS_4Y</p></td>
<td><p>0</p></td>
<td><p>-0</p></td>
</tr>
<tr class="row-even"><td><p>DEPOSITS_9MM_3M</p></td>
<td><p>0</p></td>
<td><p>SWAPS_5Y</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>DEPOSITS_10MM_3M</p></td>
<td><p>0</p></td>
<td><p>SWAPS_6Y</p></td>
<td><p>-0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>DEPOSITS_11MM_3M</p></td>
<td><p>0</p></td>
<td><p>SWAPS_7Y</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>DEPOSITS_12MM_3M</p></td>
<td><p>0</p></td>
<td><p>SWAPS_8Y</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_3Y_1Y</p></td>
<td><p>-0</p></td>
<td><p>SWAPS_9Y</p></td>
<td><p>0</p></td>
<td><p>-0</p></td>
</tr>
<tr class="row-odd"><td><p>SWAPS_4Y_1Y</p></td>
<td><p>0</p></td>
<td><p>SWAPS_10Y</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_5Y_1Y</p></td>
<td><p>0</p></td>
<td><p>SWAPS_12Y</p></td>
<td><p>0</p></td>
<td><p>-0</p></td>
</tr>
<tr class="row-odd"><td><p>SWAPS_6Y_1Y</p></td>
<td><p>0</p></td>
<td><p>SWAPS_15Y</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_7Y_1Y</p></td>
<td><p>0</p></td>
<td><p>SWAPS_20Y</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>SWAPS_8Y_1Y</p></td>
<td><p>0</p></td>
<td><p>SWAPS_25Y</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_9Y_1Y</p></td>
<td><p>0</p></td>
<td><p>SWAPS_30Y</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>SWAPS_10Y_1Y</p></td>
<td><p>0</p></td>
<td><p>SWAPS_40Y</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_11Y_1Y</p></td>
<td><p>0</p></td>
<td><p>SWAPS_50Y</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>SWAPS_12Y_1Y</p></td>
<td><p>-0</p></td>
<td><p></p></td>
<td><p>Sum of absolute error</p></td>
<td><p>1,631</p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_13Y_1Y</p></td>
<td><p>0</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>SWAPS_14Y_1Y</p></td>
<td><p>-0</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_15Y_1Y</p></td>
<td><p>0</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>SWAPS_16Y_1Y</p></td>
<td><p>0</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_17Y_1Y</p></td>
<td><p>-0</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>SWAPS_18Y_1Y</p></td>
<td><p>-0</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_19Y_1Y</p></td>
<td><p>0</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>SWAPS_20Y_5Y</p></td>
<td><p>-0</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_25Y_5Y</p></td>
<td><p>-0</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>SWAPS_30Y_5Y</p></td>
<td><p>0</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_35Y_5Y</p></td>
<td><p>0</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>SWAPS_40Y_5Y</p></td>
<td><p>0</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_45Y_5Y</p></td>
<td><p>0</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</div>
<p>So here the I start of the FRA (01-Jul) is between 24-Jun and 1w (05-Jul). Hence we see risk in the first 2 buckets in the native risk. In the transformed risk, however, the next IMM date (21-Sep) is between 1M and 3M, hence risk is transformed into 1M and 3M buckets. So the measure on a “sum of absolute error” is quite large – 6.2%.</p>
<p>What is important however, is that overall IR Delta – parallel shift – is correct in the transformed case (±1, 0.0% error).</p>
</section>
<section id="optimal-transform">
<h5>7.3.1.2. Optimal transform<a class="headerlink" href="#optimal-transform" title="Link to this heading">#</a></h5>
<p>We can also perform the above comparisons, but using a target risk view where the 3 conditions are satisfied:</p>
<p>Swap example:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>Source</p></th>
<th class="head"><p>Native</p></th>
<th class="head"><p>Transformed</p></th>
<th class="head"><p>% error</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>IR Delta</p></td>
<td><p>157,430</p></td>
<td><p>IR Delta</p></td>
<td><p>157,418</p></td>
<td><p>157,418</p></td>
</tr>
<tr class="row-odd"><td><p>DEPOSITS_3M</p></td>
<td><p>2,475</p></td>
<td><p>SWAPS_1Y</p></td>
<td><p>9,967</p></td>
<td><p>9,967</p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_3M_3M</p></td>
<td><p>2,675</p></td>
<td><p>SWAPS_11_1Y</p></td>
<td><p>8,406</p></td>
<td><p>8,406</p></td>
</tr>
<tr class="row-odd"><td><p>SWAPS_6M_3M</p></td>
<td><p>2,532</p></td>
<td><p>SWAPS_2Y_1Y</p></td>
<td><p>8,452</p></td>
<td><p>8,452</p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_9M_3M</p></td>
<td><p>2,512</p></td>
<td><p>SWAPS_3Y_1Y</p></td>
<td><p>8,505</p></td>
<td><p>8,505</p></td>
</tr>
<tr class="row-odd"><td><p>SWAPS_1Y_1Y</p></td>
<td><p>8,403</p></td>
<td><p>SWAPS_4Y_1Y</p></td>
<td><p>8,253</p></td>
<td><p>8,253</p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_2Y_1Y</p></td>
<td><p>8,462</p></td>
<td><p>SWAPS_5Y_2Y</p></td>
<td><p>17,246</p></td>
<td><p>17,246</p></td>
</tr>
<tr class="row-odd"><td><p>SWAPS_3Y_1Y</p></td>
<td><p>8,468</p></td>
<td><p>SWAPS_7Y_3Y</p></td>
<td><p>29,910</p></td>
<td><p>29,910</p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_4Y_1Y</p></td>
<td><p>8,385</p></td>
<td><p>SWAPS_10Y_5Y</p></td>
<td><p>48,314</p></td>
<td><p>48,314</p></td>
</tr>
<tr class="row-odd"><td><p>SWAPS_5Y_1Y</p></td>
<td><p>8,429</p></td>
<td><p>SWAPS_15Y_5Y</p></td>
<td><p>29,651</p></td>
<td><p>29,651</p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_6Y_1Y</p></td>
<td><p>8,419</p></td>
<td><p>SWAPS_20Y_10Y</p></td>
<td><p>-2,969</p></td>
<td><p>-2,969</p></td>
</tr>
<tr class="row-odd"><td><p>SWAPS_7Y_1Y</p></td>
<td><p>8,402</p></td>
<td><p>SWAPS_30Y_10Y</p></td>
<td><p>736</p></td>
<td><p>736</p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_8Y_1Y</p></td>
<td><p>8,451</p></td>
<td><p>SWAPS_40Y_10Y</p></td>
<td><p>-165</p></td>
<td><p>-165</p></td>
</tr>
<tr class="row-odd"><td><p>SWAPS_9Y_1Y</p></td>
<td><p>8,397</p></td>
<td><p></p></td>
<td><p>Sum of absolute error</p></td>
<td><p>0.17</p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_10Y_1Y</p></td>
<td><p>8,362</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>SWAPS_11Y_1Y</p></td>
<td><p>8,392</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_12Y_1Y</p></td>
<td><p>8,396</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>SWAPS_13Y_1Y</p></td>
<td><p>8,415</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_14Y_1Y</p></td>
<td><p>8,455</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>SWAPS_15Y_1Y</p></td>
<td><p>8,431</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_16Y_1Y</p></td>
<td><p>8,194</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>SWAPS_17Y_1Y</p></td>
<td><p>9,303</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_18Y_1Y</p></td>
<td><p>4,339</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>SWAPS_19Y_1Y</p></td>
<td><p>-706</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_20Y_5Y</p></td>
<td><p>78</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>SWAPS_25Y_5Y</p></td>
<td><p>-21</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_30Y_5Y</p></td>
<td><p>5</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>SWAPS_35Y_5Y</p></td>
<td><p>1</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_40Y_5Y</p></td>
<td><p>0</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>SWAPS_45Y_5Y</p></td>
<td><p>0</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</div>
<p>This some inaccuracy can be introduced – e.g. a misprice in the transformed shock of 2e-11 on a shock of 1e-4 is an approximate error in the transform of 2e-11/1e-4 = 2e-7.
FRA example – for a meaningful bucketing of risk we change the start date of the FRA to 24-May-17:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>Source</p></th>
<th class="head"><p>Native</p></th>
<th class="head"><p>Transformed</p></th>
<th class="head"><p>% error</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>IR Delta</p></td>
<td><p>25,354</p></td>
<td><p>IR Delta</p></td>
<td><p>25,457</p></td>
<td><p>25,457</p></td>
</tr>
<tr class="row-odd"><td><p>DEPOSITS_3M</p></td>
<td><p>21</p></td>
<td><p>SWAPS_1Y</p></td>
<td><p>9,728</p></td>
<td><p>9,728</p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_3M_3M</p></td>
<td><p>20</p></td>
<td><p>SWAPS_1Y_1Y</p></td>
<td><p>13,729</p></td>
<td><p>13,729</p></td>
</tr>
<tr class="row-odd"><td><p>SWAPS_6M_3M</p></td>
<td><p>20</p></td>
<td><p>SWAPS_2Y_1Y</p></td>
<td><p>-0</p></td>
<td><p>-0</p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_9M_3M</p></td>
<td><p>9,564</p></td>
<td><p>SWAPS_3Y_1Y</p></td>
<td><p>0</p></td>
<td><p>-0</p></td>
</tr>
<tr class="row-odd"><td><p>SWAPS_1Y_1Y</p></td>
<td><p>15,729</p></td>
<td><p>SWAPS_4Y_1Y</p></td>
<td><p>0</p></td>
<td><p>-0</p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_2Y_1Y</p></td>
<td><p>-0</p></td>
<td><p>SWAPS_5Y_2Y</p></td>
<td><p>0</p></td>
<td><p>-0</p></td>
</tr>
<tr class="row-odd"><td><p>SWAPS_3Y_1Y</p></td>
<td><p>-0</p></td>
<td><p>SWAPS_7Y_3Y</p></td>
<td><p>0</p></td>
<td><p>-0</p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_4Y_1Y</p></td>
<td><p>-0</p></td>
<td><p>SWAPS_10Y_5Y</p></td>
<td><p>-0</p></td>
<td><p>-0</p></td>
</tr>
<tr class="row-odd"><td><p>SWAPS_5Y_1Y</p></td>
<td><p>-0</p></td>
<td><p>SWAPS_15Y_5Y</p></td>
<td><p>0</p></td>
<td><p>-0</p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_6Y_1Y</p></td>
<td><p>-0</p></td>
<td><p>SWAPS_20Y_10Y</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>SWAPS_7Y_1Y</p></td>
<td><p>-0</p></td>
<td><p>SWAPS_30Y_10Y</p></td>
<td><p>-0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_8Y_1Y</p></td>
<td><p>-0</p></td>
<td><p>SWAPS_40Y_10Y</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>SWAPS_9Y_1Y</p></td>
<td><p>-0</p></td>
<td><p></p></td>
<td><p>Sum of absolute error</p></td>
<td><p>0.09</p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_10Y_1Y</p></td>
<td><p>-0</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>SWAPS_11Y_1Y</p></td>
<td><p>-0</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_12Y_1Y</p></td>
<td><p>-0</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>SWAPS_13Y_1Y</p></td>
<td><p>0</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_14Y_1Y</p></td>
<td><p>0</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>SWAPS_15Y_1Y</p></td>
<td><p>0</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_16Y_1Y</p></td>
<td><p>0</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>SWAPS_17Y_1Y</p></td>
<td><p>0</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_18Y_1Y</p></td>
<td><p>-0</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>SWAPS_19Y_1Y</p></td>
<td><p>0</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_20Y_5Y</p></td>
<td><p>0</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>SWAPS_25Y_5Y</p></td>
<td><p>0</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_30Y_5Y</p></td>
<td><p>0</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>SWAPS_35Y_5Y</p></td>
<td><p>0</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>SWAPS_40Y_5Y</p></td>
<td><p>0</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>SWAPS_45Y_5Y</p></td>
<td><p>-0</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="approximation-of-finite-difference">
<h4>7.3.2    Approximation of finite difference<a class="headerlink" href="#approximation-of-finite-difference" title="Link to this heading">#</a></h4>
<p>We can show in terms of the curve shocks themselves that a finite difference approach is accurate for much larger shocks that may occur (i.e. the market move on a day of a dramatic market event). Please see Error! Reference source not found. below.</p>
</section>
</section>
</section>
<section id="test-and-outcome-analyses-performed-on-payoff-model-portfolio">
<h2>8. Test and Outcome analyses performed on Payoff/Model/Portfolio<a class="headerlink" href="#test-and-outcome-analyses-performed-on-payoff-model-portfolio" title="Link to this heading">#</a></h2>
<p>All testing/analysis of NCF is carried out on a stress-testing and, as far as possible, a forward-looking basis – to check mispricing as the fundamental check of curve quality, and to provide confidence from the way the tests are carried out for future use of NCF in production.</p>
<section id="back-testing">
<h3>8.1    Back testing<a class="headerlink" href="#back-testing" title="Link to this heading">#</a></h3>
<p>n/a</p>
</section>
<section id="stress-testing">
<h3>8.2    Stress-testing<a class="headerlink" href="#stress-testing" title="Link to this heading">#</a></h3>
<section id="testing-development-background">
<h4>8.2.1    Testing/development background<a class="headerlink" href="#testing-development-background" title="Link to this heading">#</a></h4>
<p>NCF was built as a pricing framework. The most complex curve builds used in Xsigma remain those developed first for EUR &amp; GBP, complexity has not increased dramatically since 2009. Thus during testing and development, before use in EOD the curves were used in 2007 and 2008 under stressed market conditions. Hence NCF has entered EOD systems only after extensive use and verification (i.e. pricing accuracy) outside of valuation.</p>
<p>In valuation all curves undergo the necessary controls of price testing, and risk-based P&amp;L explain (the fundamental test of risk).</p>
<p>There was a long period of parallel (i.e. parallel to existing curve framework) testing by EUR, GBP swaps trading from 2007. Thus from 2007 to present there has been testing. The fundamental part of the curve construction – use of penalty functions with the NAG optimiser – has not changed in this time.</p>
<p>The NCF entered EOD systems in 2010, it was fully enabled (OIS discounting) in 2012/3 for Rates Flow desk (OIS discounting was in use for pricing since 2008).</p>
<p>All development and roll-out was pricing first, then PV/risk testing and signoff (FO &amp; control functions) before implementation in EOD.</p>
<p>For these reasons – a number of years of incremental development, and testing in a live production environment, we will focus our tests on areas where it is relevant – the forward-looking nature of the ongoing test process, stressed market conditions, and a framework for analysing mispricing and shocks.</p>
<section id="currencies">
<h5>8.2.1.1. Currencies<a class="headerlink" href="#currencies" title="Link to this heading">#</a></h5>
<p>We will generally select G4 as our choice of curves/models because they are:</p>
<ol class="arabic simple">
<li><p>The most complex engines – due to the requirements to price and value accurately in real time (i.e. curves being cut, 1 sec from a change in market input). Thus the design flaws are more likely.</p></li>
<li><p>The most substantial risk/P&amp;L for the bank.</p></li>
</ol>
</section>
</section>
<section id="testing-stressed-market-conditions">
<h4>8.2.2    2008/9 testing – stressed market conditions<a class="headerlink" href="#testing-stressed-market-conditions" title="Link to this heading">#</a></h4>
<p>This period is chosen due to the extreme market stress during this year. The period is 01-Sep-2008-01-Sep-2009. This test operates alongside the forward testing. Again, the misprice is most relevant – this is a measure of how well the curves coped with the stressed market over these 263 weekdays:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>USD</p></th>
<th class="head"><p>EUR</p></th>
<th class="head"><p>GBP</p></th>
<th class="head"><p>JPY</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Max (bp)</p></td>
<td><p>0.002021</p></td>
<td><p>0.002343</p></td>
<td><p>0.027620</p></td>
<td><p>0.000039</p></td>
</tr>
<tr class="row-odd"><td><p>Average (bp)</p></td>
<td><p>0.000193</p></td>
<td><p>0.000073</p></td>
<td><p>0.000157</p></td>
<td><p>0.000005</p></td>
</tr>
<tr class="row-even"><td><p>#days &gt;0.0001</p></td>
<td><p>127</p></td>
<td><p>26</p></td>
<td><p>14</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>#days &gt;0.0005</p></td>
<td><p>22</p></td>
<td><p>6</p></td>
<td><p>5</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>#days &gt;0.001</p></td>
<td><p>7</p></td>
<td><p>5</p></td>
<td><p>3</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>Date (max)</p></td>
<td><p>Thu 09-Oct-08</p></td>
<td><p>Wed 08-Apr-09</p></td>
<td><p>Tue 16-Sep-08</p></td>
<td><p>Mon 02-Feb-09</p></td>
</tr>
</tbody>
</table>
</div>
<p>It can clearly be seen that these misprices are higher than the threshold of 0.0001bp on 15 days, but there’s just one date – 16-Sep-08 in GBP that is greater than 0.01bp.</p>
<p>We have explained the importance of mispricing, and indicated the tolerance of 1e-8 for acceptance of the curves.</p>
<section id="gbp-16-sep-2008">
<h5>8.2.2.1. GBP 16-Sep-2008<a class="headerlink" href="#gbp-16-sep-2008" title="Link to this heading">#</a></h5>
<p>If we investigate the problem of GBP on 16-Sep-08 we can see the problem in the input data:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>TargetPrice</p></th>
<th class="head"><p>FittedPrice</p></th>
<th class="head"><p>Misprice</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>GBP LIBOR 1M-BASISSWAPS_2IMM_3M</p></td>
<td><p>-0.4807%</p></td>
<td><p>-0.4810%</p></td>
<td><p>0.027620</p></td>
</tr>
<tr class="row-odd"><td><p>GBP LIBOR 1M-BASISSWAPS_3IMM_3M</p></td>
<td><p>-0.3523%</p></td>
<td><p>-0.3523%</p></td>
<td><p>0.000003</p></td>
</tr>
<tr class="row-even"><td><p>GBP LIBOR 1M-BASISSWAPS_4IMM_3M</p></td>
<td><p>-0.3115%</p></td>
<td><p>-0.3115%</p></td>
<td><p>0.000000</p></td>
</tr>
<tr class="row-odd"><td><p>GBP LIBOR 1M-BASISSWAPS_5IMM_3M</p></td>
<td><p>-0.2715%</p></td>
<td><p>-0.2715%</p></td>
<td><p>0.000000</p></td>
</tr>
<tr class="row-even"><td><p>GBP LIBOR 1M-BASISSWAPS_6IMM_3M</p></td>
<td><p>-0.2511%</p></td>
<td><p>-0.2511%</p></td>
<td><p>0.000000</p></td>
</tr>
<tr class="row-odd"><td><p>GBP LIBOR 1M-BASISSWAPS_7IMM_3M</p></td>
<td><p>-0.2110%</p></td>
<td><p>-0.2110%</p></td>
<td><p>0.000000</p></td>
</tr>
<tr class="row-even"><td><p>GBP LIBOR 1M-BASISSWAPS_8IMM_3M</p></td>
<td><p>-0.1867%</p></td>
<td><p>-0.1867%</p></td>
<td><p>0.000000</p></td>
</tr>
<tr class="row-odd"><td><p>GBP LIBOR 1M-BASISSWAPS_9IMM_3M</p></td>
<td><p>-0.1568%</p></td>
<td><p>-0.1568%</p></td>
<td><p>0.000000</p></td>
</tr>
<tr class="row-even"><td><p>GBP LIBOR 1M-BASISSWAPS_10IMM_3M</p></td>
<td><p>-0.1213%</p></td>
<td><p>-0.1213%</p></td>
<td><p>0.000000</p></td>
</tr>
<tr class="row-odd"><td><p>GBP LIBOR 1M-BASISSWAPS_11MM_3M</p></td>
<td><p>-0.1214%</p></td>
<td><p>-0.1214%</p></td>
<td><p>0.000000</p></td>
</tr>
<tr class="row-even"><td><p>GBP LIBOR 1M-BASISSWAPS_12MM_3M</p></td>
<td><p>-0.1116%</p></td>
<td><p>-0.1116%</p></td>
<td><p>0.000000</p></td>
</tr>
</tbody>
</table>
</div>
<p>The first instrument price is out of line with the following ones- by approximately 8bp. The curve has smoothing applied, so in this case the smoothing function penalty is actually causing the first instrument to misprice i.e. there is a tension between the instrument penalty and the smoothing penalty.</p>
<p>We can see both the divergent nature of the instrument price and the smoothing penalty together contribute to the misprice.</p>
<p>See also the example in 8.4.1 below. Such extreme market data can cause this. It would also indicate that on this date the 1M LIBOR curve may not have been liquid in the region with the misprice – i.e. 0.03bp is not significant under such conditions. The proof is driven somewhat by the negative statement – if the output rate of -0.481% presented a problem the curve would have been corrected intraday and not have been present in the close.</p>
<section id="curve-inputs-stress-test">
<h6>8.2.2.1.    Curve inputs – stress test<a class="headerlink" href="#curve-inputs-stress-test" title="Link to this heading">#</a></h6>
<p><img alt="Figure 8.1: Instrument misprice during stressed market conditions (2008-2009) showing different scales for currencies" src="../../_images/libor_ois_interpolation_18.jpg" /></p>
<p>We can clearly see in this graph, the stresses in the market data that lead to this result. JPY is the outlier – rates in this currency did not produce curves exhibiting such a stressed market state, hence the misprice was lower. GBP is on the RH scale. Thus it can also be seen only 3 of the misprices above 1e-8 come after Jan 2009.</p>
<p><img alt="Figure 8.2: Detailed view of instrument misprice showing finer granularity of variations" src="../../_images/libor_ois_interpolation_19.jpg" /></p>
</section>
</section>
<section id="id24">
<h5>8.2.2.2.    2016/7<a class="headerlink" href="#id24" title="Link to this heading">#</a></h5>
<p>For a comparison, and an indication of how the model behaves under normal market conditions, we consider the period 01-Apr-16 to 31-Mar-17 (261 weekdays):
<img alt="Figure 8.3: Instrument misprice during normal market conditions (2016/7) with currency comparison" src="../../_images/libor_ois_interpolation_20.jpg" /></p>
<p>We can see some misprices higher than 0.0001bp:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>JPY</p></th>
<th class="head"><p>EUR</p></th>
<th class="head"><p>GBP</p></th>
<th class="head"><p>USD</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Max (max misprice), bp</p></td>
<td><p>0.143239</p></td>
<td><p>0.000194</p></td>
<td><p>0.000906</p></td>
<td><p>0.000723</p></td>
</tr>
<tr class="row-odd"><td><p>Average (max misprice), bp</p></td>
<td><p>0.000277</p></td>
<td><p>0.000051</p></td>
<td><p>0.000040</p></td>
<td><p>0.000087</p></td>
</tr>
<tr class="row-even"><td><p>#days max misprice &gt;0.0001bp</p></td>
<td><p>29</p></td>
<td><p>16</p></td>
<td><p>14</p></td>
<td><p>71</p></td>
</tr>
<tr class="row-odd"><td><p>#instruments misprice &gt;0.0001bp</p></td>
<td><p>56</p></td>
<td><p>38</p></td>
<td><p>35</p></td>
<td><p>94</p></td>
</tr>
<tr class="row-even"><td><p>Total instruments (261 days)</p></td>
<td><p>56/128/11</p></td>
<td><p>38/151/91</p></td>
<td><p>35/107/111</p></td>
<td><p>94/69/193</p></td>
</tr>
<tr class="row-odd"><td><p>Ratio</p></td>
<td><p>0.0437%</p></td>
<td><p>0.0251%</p></td>
<td><p>0.0327%</p></td>
<td><p>0.1359%</p></td>
</tr>
</tbody>
</table>
</div>
<p>We will examine the misprice in JPY, and the significant instances in the other 3 currencies.</p>
<section id="jpy">
<h6>8.2.2.2.1.    JPY<a class="headerlink" href="#jpy" title="Link to this heading">#</a></h6>
<p>The large misprice in JPY is 28-Jul-16 to 04-Aug-16 (also 31-Oct to 04-Nov, 30-Jan-17 to 03-Feb-17), of a single instrument:</p>
<table>
  <tr>
    <th>Instrument</th>
    <th>Start Date</th>
    <th>End Date</th>
    <th>Misprice, bp</th>
  </tr>
  <tr>
    <td>JPY ZTIBOR 1M-BASISSWAPS_5B-1G_1M</td>
    <td>Wed 17-Aug-16</td>
    <td>Tue 20-Sep-16</td>
    <td>0.1432</td>
  </tr>
</table>
<p>This problem thus occurs approximately every 3 months, just before Bank of Japan meeting date. At this time the curve has fewer nodes than instruments at the front of the curve.</p>
<p>The remediation is the release of an updated engine, with an additional node at the short end, which is planned, but not yet released. This release would update the production instance.</p>
<p>Backtesting this engine shows the following behaviour over the same 261 weekdays:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>JPY</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Max (max misprice), bp</p></td>
<td><p>0.000592</p></td>
</tr>
<tr class="row-odd"><td><p>Average (max misprice), bp</p></td>
<td><p>0.000043</p></td>
</tr>
<tr class="row-even"><td><p>#days max misprice &gt;0.0001bp</p></td>
<td><p>13</p></td>
</tr>
<tr class="row-odd"><td><p>#instruments misprice &gt;0.0001bp</p></td>
<td><p>27</p></td>
</tr>
<tr class="row-even"><td><p>Total instruments (261 days)</p></td>
<td><p>27/99/409</p></td>
</tr>
<tr class="row-odd"><td><p>Ratio</p></td>
<td><p>0.0272%</p></td>
</tr>
</tbody>
</table>
</div>
<p>Thus this behaviour is better than GBP, EUR or USD.</p>
</section>
<section id="eur">
<h6>8.2.2.2.2.    EUR<a class="headerlink" href="#eur" title="Link to this heading">#</a></h6>
<p>The small misprice in EUR is around times of stress in the FX market. The mispricing instruments on 28-Jun-16 are:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>EUR Tue 28-Jun-16</p></th>
<th class="head"><p>Start</p></th>
<th class="head"><p>End</p></th>
<th class="head"><p>Input price</p></th>
<th class="head"><p>Output - reprice fixed (bls)</p></th>
<th class="head"><p>Misprice (bp)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>FXFORWARDS_E+1B_1B</p></td>
<td><p>Wed 29-Jun-16</p></td>
<td><p>Thu 30-Jun-16</p></td>
<td><p>0.330000</p></td>
<td><p>0.330001</p></td>
<td><p>0.00015</p></td>
</tr>
<tr class="row-odd"><td><p>FXFORWARDS_1B</p></td>
<td><p>Thu 30-Jun-16</p></td>
<td><p>Fri 01-Jul-16</p></td>
<td><p>1.400000</p></td>
<td><p>1.399999</p></td>
<td><p>0.00047</p></td>
</tr>
<tr class="row-even"><td><p>FXFORWARDS_1W</p></td>
<td><p>Thu 30-Jun-16</p></td>
<td><p>Thu 07-Jul-16</p></td>
<td><p>3.400000</p></td>
<td><p>3.400000</p></td>
<td><p>0.00011</p></td>
</tr>
</tbody>
</table>
</div>
<p>This is clear indication of the stringency of the 1e-8 misprice test – the error in the price is not noticeable (quoting a FX fwd would not expose the misprice – quoting it to 2 digits error is in 5th). Thus the mispricing when there is a degree of market stress is not problematic.</p>
</section>
<section id="gbp">
<h6>8.2.2.2.3.    GBP<a class="headerlink" href="#gbp" title="Link to this heading">#</a></h6>
<p>The small mispricing in GBP is for exactly the same reason as for EUR. Using 28-Sep-16 as an example:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>GBP Wed 28-Sep-16</p></th>
<th class="head"><p>Start</p></th>
<th class="head"><p>End</p></th>
<th class="head"><p>Input price fixed (bls)</p></th>
<th class="head"><p>Output - reprice fixed (bls)</p></th>
<th class="head"><p>Misprice (bp)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>FXFORWARDS_E+1B_1B</p></td>
<td><p>Thu 29-Sep-16</p></td>
<td><p>Fri 30-Sep-16</p></td>
<td><p>0.190000</p></td>
<td><p>0.190000</p></td>
<td><p>0.00013</p></td>
</tr>
<tr class="row-odd"><td><p>FXFORWARDS_1B</p></td>
<td><p>Fri 30-Sep-16</p></td>
<td><p>Mon 03-Oct-16</p></td>
<td><p>3.650000</p></td>
<td><p>3.649997</p></td>
<td><p>0.00028</p></td>
</tr>
<tr class="row-even"><td><p>FXFORWARDS_1W</p></td>
<td><p>Fri 30-Sep-16</p></td>
<td><p>Fri 07-Oct-16</p></td>
<td><p>4.550000</p></td>
<td><p>4.550004</p></td>
<td><p>0.00014</p></td>
</tr>
</tbody>
</table>
</div>
<p>The error in the price is, again, not noticeable.</p>
</section>
<section id="usd">
<h6>8.2.2.2.4.    USD<a class="headerlink" href="#usd" title="Link to this heading">#</a></h6>
<p>This is a little difference. The misprice is in 3 instruments:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>USD Fri 25-Nov-16</p></th>
<th class="head"><p>Start</p></th>
<th class="head"><p>End</p></th>
<th class="head"><p>Input price</p></th>
<th class="head"><p>Output - reprice</p></th>
<th class="head"><p>Misprice (bp)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>USD LIBOR 3M-TURNS_1T_1B</p></td>
<td><p>Fri 30-Dec-16</p></td>
<td><p>Tue 03-Jan-17</p></td>
<td><p>0.000000%</p></td>
<td><p>0.000002%</p></td>
<td><p>0.00023</p></td>
</tr>
<tr class="row-odd"><td><p>USD OIS 1B-TURNS_1U_1B</p></td>
<td><p>Wed 30-Nov-16</p></td>
<td><p>Thu 01-Dec-16</p></td>
<td><p>0.000000%</p></td>
<td><p>-0.000001%</p></td>
<td><p>0.00013</p></td>
</tr>
<tr class="row-even"><td><p>USD OIS 1B-TURNS_1U_1B</p></td>
<td><p>Fri 30-Dec-16</p></td>
<td><p>Tue 03-Jan-17</p></td>
<td><p>0.000000%</p></td>
<td><p>0.000002%</p></td>
<td><p>0.00012</p></td>
</tr>
</tbody>
</table>
</div>
<p>The error in the price is not noticeable.</p>
</section>
<section id="fd">
<h6>8.2.2.2.5.    FD<a class="headerlink" href="#fd" title="Link to this heading">#</a></h6>
<p>Above results are all generated with AD, if we repeat with FD results are as follows (remediated engine for JPY). These results are almost indistinguishable from AD:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>JPY</p></th>
<th class="head"><p>EUR</p></th>
<th class="head"><p>GBP</p></th>
<th class="head"><p>USD</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Max (max misprice), bp</p></td>
<td><p>0.000696</p></td>
<td><p>0.000994</p></td>
<td><p>0.000661</p></td>
<td><p>0.000711</p></td>
</tr>
<tr class="row-odd"><td><p>Average (max misprice), bp</p></td>
<td><p>0.000043</p></td>
<td><p>0.000047</p></td>
<td><p>0.000025</p></td>
<td><p>0.000077</p></td>
</tr>
<tr class="row-even"><td><p>#days max misprice &gt;0.0001bp</p></td>
<td><p>13</p></td>
<td><p>16</p></td>
<td><p>10</p></td>
<td><p>65</p></td>
</tr>
<tr class="row-odd"><td><p>#instruments misprice &gt;0.0001bp</p></td>
<td><p>27</p></td>
<td><p>38</p></td>
<td><p>22</p></td>
<td><p>78</p></td>
</tr>
<tr class="row-even"><td><p>Total instruments (261 days)</p></td>
<td><p>27/100/88</p></td>
<td><p>38/127/432</p></td>
<td><p>22/85/23</p></td>
<td><p>78/48/935</p></td>
</tr>
<tr class="row-odd"><td><p>Ratio</p></td>
<td><p>0.0298%</p></td>
<td><p>0.0299%</p></td>
<td><p>0.0299%</p></td>
<td><p>0.1594%</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
</section>
<section id="shock-sizes">
<h4>8.2.3    Shock sizes<a class="headerlink" href="#shock-sizes" title="Link to this heading">#</a></h4>
<p>See 4.1.2.1 and 7.1 above.</p>
<p>In testing we will apply shocks consistently across curves. Shocks are applied in the following tenors: 1M,3M,6M,9M,1Y,2Y,3Y,5Y,7Y,10Y,15Y,20Y,30Y. The 3M LIBOR curve is the outright curve – the Swaps/Discounting curve. The interpolation chosen for the shock is Geometric to 1Y/Log+cubic thereafter. The risk factors for all other curves are built as a basis from OIS itself, i.e. the same curve.</p>
<p>Therefore a shock applied to the 3M curve will propagate to all other curves.</p>
<p>The shocks are applied as described in 7.1 #1-5.</p>
<p>Shocks are applied to all instruments according to an adverse &amp; severely adverse scenario.</p>
<p>Shocks applied are – 2016 data – used in 2017 (G4) – Severely Adverse scenario:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>1M</p></th>
<th class="head"><p>3M</p></th>
<th class="head"><p>6M</p></th>
<th class="head"><p>9M</p></th>
<th class="head"><p>1Y</p></th>
<th class="head"><p>2Y</p></th>
<th class="head"><p>3Y</p></th>
<th class="head"><p>5Y</p></th>
<th class="head"><p>7Y</p></th>
<th class="head"><p>10Y</p></th>
<th class="head"><p>15Y</p></th>
<th class="head"><p>20Y</p></th>
<th class="head"><p>30Y</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>USD OIS</p></td>
<td><p>-0.25</p></td>
<td><p>-0.25</p></td>
<td><p>-0.23</p></td>
<td><p>-0.22</p></td>
<td><p>-0.21</p></td>
<td><p>-0.19</p></td>
<td><p>-0.18</p></td>
<td><p>-0.16</p></td>
<td><p>-0.14</p></td>
<td><p>-0.12</p></td>
<td><p>-0.09</p></td>
<td><p>-0.07</p></td>
<td><p>-0.05</p></td>
</tr>
<tr class="row-odd"><td><p>USD OIS LR</p></td>
<td><p>-0.0031</p></td>
<td><p>-0.0038</p></td>
<td><p>-0.0033</p></td>
<td><p>-0.0024</p></td>
<td><p>-0.0021</p></td>
<td><p>-0.0014</p></td>
<td><p>-0.0010</p></td>
<td><p>-0.05</p></td>
<td><p>-0.04</p></td>
<td><p>-0.031</p></td>
<td><p>-0.031</p></td>
<td><p>-0.031</p></td>
<td><p>-0.031</p></td>
</tr>
<tr class="row-even"><td><p>USD XCCY</p></td>
<td><p>-0.25</p></td>
<td><p>-0.25</p></td>
<td><p>-0.23</p></td>
<td><p>-0.22</p></td>
<td><p>-0.21</p></td>
<td><p>-0.19</p></td>
<td><p>-0.18</p></td>
<td><p>-0.16</p></td>
<td><p>-0.14</p></td>
<td><p>-0.12</p></td>
<td><p>-0.09</p></td>
<td><p>-0.07</p></td>
<td><p>-0.05</p></td>
</tr>
<tr class="row-odd"><td><p>USD XCCY LR</p></td>
<td><p>-0.0031</p></td>
<td><p>-0.0038</p></td>
<td><p>-0.0033</p></td>
<td><p>-0.0024</p></td>
<td><p>-0.0021</p></td>
<td><p>-0.0014</p></td>
<td><p>-0.0010</p></td>
<td><p>-0.05</p></td>
<td><p>-0.04</p></td>
<td><p>-0.031</p></td>
<td><p>-0.031</p></td>
<td><p>-0.031</p></td>
<td><p>-0.031</p></td>
</tr>
<tr class="row-even"><td><p>EUR</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>EUR BASIS OIS 3M</p></td>
<td><p>1.14</p></td>
<td><p>1.14</p></td>
<td><p>1.14</p></td>
<td><p>25.1</p></td>
<td><p>1.72</p></td>
<td><p>27.6</p></td>
<td><p>1.28</p></td>
<td><p>-21.48</p></td>
<td><p>-48.9</p></td>
<td><p>-87.71</p></td>
<td><p>-95.21</p></td>
<td><p>-95.21</p></td>
<td><p>-91.46</p></td>
</tr>
<tr class="row-even"><td><p>EUR BASIS 6M</p></td>
<td><p>-1.23</p></td>
<td><p>-8.41</p></td>
<td><p>-8.21</p></td>
<td><p>-8.41</p></td>
<td><p>-8.32</p></td>
<td><p>-8.17</p></td>
<td><p>-8.1</p></td>
<td><p>-6.5</p></td>
<td><p>-6.2</p></td>
<td><p>-6.8</p></td>
<td><p>-6.8</p></td>
<td><p>-6.8</p></td>
<td><p>-6.8</p></td>
</tr>
<tr class="row-odd"><td><p>EUR BASIS 12M</p></td>
<td><p>-2.93</p></td>
<td><p>-1.66</p></td>
<td><p>-8.31</p></td>
<td><p>-1.88</p></td>
<td><p>-8.73</p></td>
<td><p>-8.39</p></td>
<td><p>-8.2</p></td>
<td><p>-1.86</p></td>
<td><p>-1.9</p></td>
<td><p>-1.8</p></td>
<td><p>-1.8</p></td>
<td><p>-1.8</p></td>
<td><p>-1.9</p></td>
</tr>
<tr class="row-even"><td><p>EUR BASIS 1M</p></td>
<td><p>-10.51</p></td>
<td><p>-11.51</p></td>
<td><p>-11.54</p></td>
<td><p>-11.54</p></td>
<td><p>-11.54</p></td>
<td><p>-11.53</p></td>
<td><p>-11.53</p></td>
<td><p>-11.69</p></td>
<td><p>-11.69</p></td>
<td><p>-10.81</p></td>
<td><p>-10.81</p></td>
<td><p>-10.81</p></td>
<td><p>-10.81</p></td>
</tr>
<tr class="row-odd"><td><p>GBP</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>GBP BASIS 3M</p></td>
<td><p>-23.5</p></td>
<td><p>-27.5</p></td>
<td><p>-4.55</p></td>
<td><p>-43.5</p></td>
<td><p>-1.18</p></td>
<td><p>-5.19</p></td>
<td><p>-115.74</p></td>
<td><p>-151.81</p></td>
<td><p>-273.61</p></td>
<td><p>-386.71</p></td>
<td><p>-392.51</p></td>
<td><p>-392.51</p></td>
<td><p>-391.51</p></td>
</tr>
<tr class="row-odd"><td><p>GBP BASIS 6M</p></td>
<td><p>-96</p></td>
<td><p>-1.8</p></td>
<td><p>-39</p></td>
<td><p>-4.1</p></td>
<td><p>-51</p></td>
<td><p>-3.9</p></td>
<td><p>-4.3</p></td>
<td><p>-3.2</p></td>
<td><p>-3.1</p></td>
<td><p>-3.0</p></td>
<td><p>-3.0</p></td>
<td><p>-3.0</p></td>
<td><p>-3.1</p></td>
</tr>
<tr class="row-even"><td><p>GBP BASIS 12M</p></td>
<td><p>-7.8</p></td>
<td><p>-8.7</p></td>
<td><p>-8.6</p></td>
<td><p>-9.0</p></td>
<td><p>-11.1</p></td>
<td><p>-10.7</p></td>
<td><p>-10.3</p></td>
<td><p>-9.7</p></td>
<td><p>-8.4</p></td>
<td><p>-7.8</p></td>
<td><p>-7.6</p></td>
<td><p>-6.7</p></td>
<td><p>-6.7</p></td>
</tr>
<tr class="row-odd"><td><p>GBP BASIS 1M</p></td>
<td><p>-10.51</p></td>
<td><p>-11.51</p></td>
<td><p>-11.54</p></td>
<td><p>-11.54</p></td>
<td><p>-11.54</p></td>
<td><p>-11.53</p></td>
<td><p>-11.53</p></td>
<td><p>-11.69</p></td>
<td><p>-11.69</p></td>
<td><p>-10.81</p></td>
<td><p>-10.81</p></td>
<td><p>-10.81</p></td>
<td><p>-10.81</p></td>
</tr>
<tr class="row-even"><td><p>JPY</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>JPY BASIS 3M</p></td>
<td><p>-69</p></td>
<td><p>-0.9</p></td>
<td><p>-69</p></td>
<td><p>-0.9</p></td>
<td><p>-69</p></td>
<td><p>-0.9</p></td>
<td><p>-0.9</p></td>
<td><p>-0.9</p></td>
<td><p>-0.6</p></td>
<td><p>-0.6</p></td>
<td><p>-0.6</p></td>
<td><p>-0.6</p></td>
<td><p>-0.6</p></td>
</tr>
<tr class="row-even"><td><p>JPY BASIS 6M</p></td>
<td><p>-66</p></td>
<td><p>-0.8</p></td>
<td><p>-66</p></td>
<td><p>-0.8</p></td>
<td><p>-66</p></td>
<td><p>-0.8</p></td>
<td><p>-0.8</p></td>
<td><p>-0.8</p></td>
<td><p>-0.6</p></td>
<td><p>-0.6</p></td>
<td><p>-0.6</p></td>
<td><p>-0.6</p></td>
<td><p>-0.6</p></td>
</tr>
<tr class="row-odd"><td><p>JPY BASIS 12M</p></td>
<td><p>-66</p></td>
<td><p>-0.8</p></td>
<td><p>-1.6</p></td>
<td><p>-0.8</p></td>
<td><p>-1.6</p></td>
<td><p>-0.8</p></td>
<td><p>-0.6</p></td>
<td><p>-0.6</p></td>
<td><p>-0.6</p></td>
<td><p>-0.7</p></td>
<td><p>-1.1</p></td>
<td><p>-1.1</p></td>
<td><p>-1.0</p></td>
</tr>
<tr class="row-even"><td><p>JPY BASIS 1M</p></td>
<td><p>-66</p></td>
<td><p>-0.8</p></td>
<td><p>-66</p></td>
<td><p>-0.8</p></td>
<td><p>-66</p></td>
<td><p>-0.8</p></td>
<td><p>-0.8</p></td>
<td><p>-0.8</p></td>
<td><p>-0.6</p></td>
<td><p>-0.6</p></td>
<td><p>-0.6</p></td>
<td><p>-0.6</p></td>
<td><p>-0.6</p></td>
</tr>
<tr class="row-odd"><td><p>JPY TIBOR 6M</p></td>
<td><p>-67</p></td>
<td><p>-0.8</p></td>
<td><p>-1.1</p></td>
<td><p>-0.9</p></td>
<td><p>-1.6</p></td>
<td><p>-0.9</p></td>
<td><p>-0.3</p></td>
<td><p>-0.3</p></td>
<td><p>-0.4</p></td>
<td><p>-0.5</p></td>
<td><p>-0.5</p></td>
<td><p>-0.5</p></td>
<td><p>-0.5</p></td>
</tr>
<tr class="row-even"><td><p>JPY TIBOR 3M</p></td>
<td><p>-67</p></td>
<td><p>-0.8</p></td>
<td><p>-1.1</p></td>
<td><p>-0.9</p></td>
<td><p>-1.6</p></td>
<td><p>-0.9</p></td>
<td><p>-0.3</p></td>
<td><p>-0.3</p></td>
<td><p>-0.4</p></td>
<td><p>-0.5</p></td>
<td><p>-0.5</p></td>
<td><p>-0.5</p></td>
<td><p>-0.5</p></td>
</tr>
<tr class="row-odd"><td><p>JPY XCCY LR</p></td>
<td><p>-69</p></td>
<td><p>-0.9</p></td>
<td><p>-69</p></td>
<td><p>-0.9</p></td>
<td><p>-69</p></td>
<td><p>-0.9</p></td>
<td><p>-0.9</p></td>
<td><p>-0.9</p></td>
<td><p>-0.6</p></td>
<td><p>-0.6</p></td>
<td><p>-0.6</p></td>
<td><p>-0.6</p></td>
<td><p>-0.6</p></td>
</tr>
</tbody>
</table>
</div>
<p>All curves are as at 05-Jan-2017.</p>
<p>Accuracy (mispricing)</p>
<p>We can focus on the main currencies: USD, EUR, GBP, JPY, AUD, CHF, SEK, CAD, DKK, NOK, NZD, CZK, HKD, HUF, MXN, PLN, SGD, ZAR. We can examine the mispricing of the instruments in the shocked curves to determine their accuracy.</p>
<section id="mispricing-of-shocked-curves">
<h5>8.2.3.1. Mispricing of shocked curves<a class="headerlink" href="#mispricing-of-shocked-curves" title="Link to this heading">#</a></h5>
<p>We can first measure the mispricing of the risk template for the buckets defined above (i.e. with both adverse and severely adverse shocks). Misprices – maximum misprice across all instruments – in bp (values same for adverse and severely adverse):</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Currency</p></th>
<th class="head"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>USD</p></td>
<td><p>0.000002</p></td>
</tr>
<tr class="row-odd"><td><p>EUR</p></td>
<td><p>0.000002</p></td>
</tr>
<tr class="row-even"><td><p>GBP</p></td>
<td><p>0.000002</p></td>
</tr>
<tr class="row-odd"><td><p>JPY</p></td>
<td><p>0.000002</p></td>
</tr>
<tr class="row-even"><td><p>AUD</p></td>
<td><p>0.000002</p></td>
</tr>
<tr class="row-odd"><td><p>CHF</p></td>
<td><p>0.000002</p></td>
</tr>
<tr class="row-even"><td><p>SEK</p></td>
<td><p>0.000002</p></td>
</tr>
<tr class="row-odd"><td><p>CAD</p></td>
<td><p>0.000002</p></td>
</tr>
<tr class="row-even"><td><p>DKK</p></td>
<td><p>0.00000006</p></td>
</tr>
<tr class="row-odd"><td><p>NOK</p></td>
<td><p>0.000002</p></td>
</tr>
<tr class="row-even"><td><p>NZD</p></td>
<td><p>0.00000006</p></td>
</tr>
<tr class="row-odd"><td><p>CZK</p></td>
<td><p>0.000007</p></td>
</tr>
<tr class="row-even"><td><p>HKD</p></td>
<td><p>0.000007</p></td>
</tr>
<tr class="row-odd"><td><p>HUF</p></td>
<td><p>0.000007</p></td>
</tr>
<tr class="row-even"><td><p>MXN</p></td>
<td><p>0.00000003</p></td>
</tr>
<tr class="row-odd"><td><p>PLN</p></td>
<td><p>0.000007</p></td>
</tr>
<tr class="row-even"><td><p>SGD</p></td>
<td><p>0.000007</p></td>
</tr>
<tr class="row-odd"><td><p>ZAR</p></td>
<td><p>0.00000003</p></td>
</tr>
</tbody>
</table>
</div>
<p>2 points can be noted:</p>
<ul class="simple">
<li><p>All are extremely low.</p></li>
<li><p>They are of similar magnitude (apart from the 4, low value, outliers).</p></li>
</ul>
<p>This is, in turn, due to 2 factors:</p>
<ul class="simple">
<li><p>The large size of the shocks. This leads to a full rebuild of the engine when applying the shocks in both scenarios, hence the most accurate application of them.</p></li>
<li><p>The simple bucketing of the shocks (1M, 3M, 6M, 9M, 1Y, 2Y, 3Y, 5Y, 7Y, 10Y, 15Y, 20Y, 30Y), which is the same across all curves.</p></li>
</ul>
</section>
<section id="incremental-shocking">
<h5>8.2.3.2. Incremental shocking<a class="headerlink" href="#incremental-shocking" title="Link to this heading">#</a></h5>
<p>Again, all scenarios run as at 05-Jan-2017.</p>
<p>We can also examine the incremental effect of applying these scenario shocks in 5 steps – 1%, +9%, +10%, +10%, (+20%, +30%, +50%, +50%, +100% - the full shock). We perform this for G7 under severely adverse scenario.</p>
<p>The test here is to see if there is any increase in mispricing of instruments as we apply the shocks, and whether there are significant differences between smaller shock sizes (which may all be below 5bp, and hence employ a jacobian rebuild) and larger ones (which will require a full rebuild).</p>
<p>All below results use AD unless stated.</p>
<section id="id25">
<h6>8.2.3.2.1.    USD<a class="headerlink" href="#id25" title="Link to this heading">#</a></h6>
<p>Results are as follows:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>USD</p></th>
<th class="head"><p></p></th>
<th class="head"><p></p></th>
<th class="head"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Shock (%) - incrementing</p></td>
<td><p>Jacobian?</p></td>
<td><p>Misprice (bp)</p></td>
<td><p>Max bump error</p></td>
</tr>
<tr class="row-odd"><td><p>[unbumped]</p></td>
<td><p></p></td>
<td><p>0.00000141</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>1%</p></td>
<td><p>TRUE (max shock 1.88bp)</p></td>
<td><p>0.00000327</p></td>
<td><p>0.006296%</p></td>
</tr>
<tr class="row-odd"><td><p>10%</p></td>
<td><p>FALSE</p></td>
<td><p>0.00003119</p></td>
<td><p>0.005999%</p></td>
</tr>
<tr class="row-even"><td><p>20%</p></td>
<td><p>FALSE</p></td>
<td><p>0.00004724</p></td>
<td><p>0.000000%</p></td>
</tr>
<tr class="row-odd"><td><p>50%</p></td>
<td><p>FALSE</p></td>
<td><p>0.00001796</p></td>
<td><p>0.000000%</p></td>
</tr>
<tr class="row-even"><td><p>100%</p></td>
<td><p>FALSE</p></td>
<td><p>0.00001530</p></td>
<td><p>0.000000%</p></td>
</tr>
</tbody>
</table>
</div>
<p>Shocks are always applied to the original, unbumped, curves.</p>
<p><strong>Misprice</strong> represents the largest misprice measured on a single instrument.</p>
<p><strong>“Max bump error”</strong> is the maximum error across all shocks, of the shocks themselves:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\text{Max}_{\text{instruments}, l} \left[ \text{abs} \left( \frac{\text{misprice}^{shocked} - \text{misprice}^{original}}{\text{input\_shock}_l} \right) \right]
\]</div>
</div>
<p>This could also be represented as:</p>
<p><span class="math notranslate nohighlight">\(\text{Max}_{\text{instruments}, l} \left[ \text{abs} \left( \frac{\text{realised\_shock}_l}{\text{input\_shock}_l} - 1 \right) \right]\)</span></p>
<p>We could also plot:</p>
<p><span class="math notranslate nohighlight">\(\text{Max}_{\text{instruments}, l} \left[ \text{abs} \left( \frac{\text{realised\_shock}_l}{\text{input\_shock}_l} \right) \right]\)</span></p>
<p><img alt="Figure 8.5: Realised shock vs input shock ratio" src="../../_images/libor_ois_interpolation_21.jpg" /></p>
<p>We can also see this graphically, 3m forward rate of USD LIBOR 3M:</p>
<p><img alt="Figure 8.6: 3M LIBOR forward rates comparison" src="../../_images/libor_ois_interpolation_22.jpg" /></p>
<p><img alt="Figure 8.7: 3M LIBOR shock size comparison" src="../../_images/libor_ois_interpolation_23.jpg" /></p>
<p>Shock size (bp) – i.e. difference between shocked curve and original (3m forward rate).</p>
<p>Notes:</p>
<p>The only notable point above is that the gradient of the shock (100% line) is almost exactly the -ve of the gradient (positive) of the LIBOR curve itself. Hence there is a “flat” spot in the shocked curve from Oct 17-Jun 18.</p>
<p>This can be seen more clearly in 2 detailed graphs:
<img alt="Figure 8.8: 3M LIBOR forward rates detail showing gradient comparison" src="../../_images/libor_ois_interpolation_24.jpg" /></p>
<p>This second graph shows that the gradient of the shock applied is almost identical to the gradient of the 3m libor curve in this region:</p>
<p><img alt="Figure 8.9: 3M LIBOR shock detail demonstrating shock shape characteristics" src="../../_images/libor_ois_interpolation_25.jpg" /></p>
<p>The slight “waviness” and lack of monotonicity of the shock shape more generally (in forward space) is due to 2 factors:</p>
<ol class="arabic simple">
<li><p>The scenario is defined in spot space and monotonically increasing spot shocks do not necessarily imply monotonically increasing forward shocks.</p></li>
<li><p>Log+cubic interpolation.</p></li>
</ol>
</section>
<section id="g7">
<h6>8.2.3.2.2.    G7<a class="headerlink" href="#g7" title="Link to this heading">#</a></h6>
<p>Further currencies are as follows:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>EUR</p></th>
<th class="head"><p></p></th>
<th class="head"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Shock (%) - incrementing</p></td>
<td><p>Jacobian?</p></td>
<td><p>Misprice (bp)</p></td>
</tr>
<tr class="row-odd"><td><p>[unbumped]</p></td>
<td><p></p></td>
<td><p>0.00004828</p></td>
</tr>
<tr class="row-even"><td><p>1%</p></td>
<td><p>TRUE (max shock 2.17bp)</p></td>
<td><p>0.00004655</p></td>
</tr>
<tr class="row-odd"><td><p>10%</p></td>
<td><p>FALSE</p></td>
<td><p>0.00005409</p></td>
</tr>
<tr class="row-even"><td><p>20%</p></td>
<td><p>FALSE</p></td>
<td><p>0.00003754</p></td>
</tr>
<tr class="row-odd"><td><p>90%</p></td>
<td><p>FALSE</p></td>
<td><p>0.00001043</p></td>
</tr>
<tr class="row-even"><td><p>100%</p></td>
<td><p>FALSE</p></td>
<td><p>0.00005234</p></td>
</tr>
</tbody>
</table>
</div>
<p>We will also show the equivalent graphs, as above for USD, for EUR:</p>
<p><img alt="Figure 8.10: 3M EURIBOR forward rates showing shock impact" src="../../_images/libor_ois_interpolation_26.jpg" /></p>
<p>[Table showing shock values:]</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>1M</p></th>
<th class="head"><p>3M</p></th>
<th class="head"><p>6M</p></th>
<th class="head"><p>9M</p></th>
<th class="head"><p>1Y</p></th>
<th class="head"><p>2Y</p></th>
<th class="head"><p>3Y</p></th>
<th class="head"><p>5Y</p></th>
<th class="head"><p>7Y</p></th>
<th class="head"><p>10Y</p></th>
<th class="head"><p>15Y</p></th>
<th class="head"><p>20Y</p></th>
<th class="head"><p>30Y</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>EUR EURIBOR 3M</p></td>
<td><p>15.4</p></td>
<td><p>15.4</p></td>
<td><p>-10.3</p></td>
<td><p>-74.7</p></td>
<td><p>-52.3</p></td>
<td><p>-27.6</p></td>
<td><p>-1.22</p></td>
<td><p>-21.48</p></td>
<td><p>-48.9</p></td>
<td><p>-87.71</p></td>
<td><p>-95.21</p></td>
<td><p>-95.21</p></td>
<td><p>-91.46</p></td>
</tr>
<tr class="row-odd"><td><p>EUR</p></td>
<td><p>3M</p></td>
<td><p>3M</p></td>
<td><p>3M/6M</p></td>
<td><p>6M/6M</p></td>
<td><p>9M/6M</p></td>
<td><p>2Y/1Y</p></td>
<td><p>3Y/2Y</p></td>
<td><p>5Y/2Y</p></td>
<td><p>7Y/2Y</p></td>
<td><p>10Y/5Y</p></td>
<td><p>15Y/5Y</p></td>
<td><p>20Y/5Y</p></td>
<td><p>30Y/5Y</p></td>
</tr>
<tr class="row-even"><td><p>EUR EURIBOR 3M</p></td>
<td><p>15.4</p></td>
<td><p>15.4</p></td>
<td><p>-71.2</p></td>
<td><p>-66.6</p></td>
<td><p>-64.3</p></td>
<td><p>-31.6</p></td>
<td><p>-26.3</p></td>
<td><p>-26.0</p></td>
<td><p>-23.4</p></td>
<td><p>-17.68</p></td>
<td><p>-22.18</p></td>
<td><p>-23.54</p></td>
<td><p>-17.67</p></td>
</tr>
<tr class="row-odd"><td><p>The variability in the forward shocks creates a strange shape – for the same 2 reasons as above:</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</div>
<p><img alt="Figure 8.11: 3M EURIBOR shock analysis" src="../../_images/libor_ois_interpolation_27.jpg" /></p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>GBP</p></th>
<th class="head"><p></p></th>
<th class="head"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Shock (%) - incrementing</p></td>
<td><p>Jacobian?</p></td>
<td><p>Misprice (bp)</p></td>
</tr>
<tr class="row-odd"><td><p>[unbumped]</p></td>
<td><p></p></td>
<td><p>0.00005676</p></td>
</tr>
<tr class="row-even"><td><p>1%</p></td>
<td><p>TRUE (max shock 2.24bp)</p></td>
<td><p>0.00005993</p></td>
</tr>
<tr class="row-odd"><td><p>10%</p></td>
<td><p>FALSE</p></td>
<td><p>0.00005356</p></td>
</tr>
<tr class="row-even"><td><p>20%</p></td>
<td><p>FALSE</p></td>
<td><p>0.00003989</p></td>
</tr>
<tr class="row-odd"><td><p>50%</p></td>
<td><p>FALSE</p></td>
<td><p>0.00003067</p></td>
</tr>
<tr class="row-even"><td><p>100%</p></td>
<td><p>FALSE</p></td>
<td><p>0.00003650</p></td>
</tr>
</tbody>
</table>
</div>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>JPY</p></th>
<th class="head"><p></p></th>
<th class="head"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Shock (%) - incrementing</p></td>
<td><p>Jacobian?</p></td>
<td><p>Misprice (bp)</p></td>
</tr>
<tr class="row-odd"><td><p>[unbumped]</p></td>
<td><p></p></td>
<td><p>0.00002520</p></td>
</tr>
<tr class="row-even"><td><p>1%</p></td>
<td><p>TRUE (max shock 1.88bp)</p></td>
<td><p>0.00002520</p></td>
</tr>
<tr class="row-odd"><td><p>10%</p></td>
<td><p>FALSE</p></td>
<td><p>0.00002520</p></td>
</tr>
<tr class="row-even"><td><p>20%</p></td>
<td><p>FALSE</p></td>
<td><p>0.00002520</p></td>
</tr>
<tr class="row-odd"><td><p>50%</p></td>
<td><p>FALSE</p></td>
<td><p>0.00002520</p></td>
</tr>
<tr class="row-even"><td><p>100%</p></td>
<td><p>FALSE</p></td>
<td><p>0.00002520</p></td>
</tr>
</tbody>
</table>
</div>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>AUD</p></th>
<th class="head"><p></p></th>
<th class="head"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Shock (%) - incrementing</p></td>
<td><p>Jacobian?</p></td>
<td><p>Misprice (bp)</p></td>
</tr>
<tr class="row-odd"><td><p>[unbumped]</p></td>
<td><p></p></td>
<td><p>0.00000868</p></td>
</tr>
<tr class="row-even"><td><p>1%</p></td>
<td><p>TRUE (max shock 2.49bp)</p></td>
<td><p>0.00000883</p></td>
</tr>
<tr class="row-odd"><td><p>10%</p></td>
<td><p>FALSE</p></td>
<td><p>0.00001049</p></td>
</tr>
<tr class="row-even"><td><p>20%</p></td>
<td><p>FALSE</p></td>
<td><p>0.00001087</p></td>
</tr>
<tr class="row-odd"><td><p>50%</p></td>
<td><p>FALSE</p></td>
<td><p>0.00000621</p></td>
</tr>
<tr class="row-even"><td><p>100%</p></td>
<td><p>FALSE</p></td>
<td><p>0.00002395</p></td>
</tr>
</tbody>
</table>
</div>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>CHF</p></th>
<th class="head"><p></p></th>
<th class="head"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Shock (%) - incrementing</p></td>
<td><p>Jacobian?</p></td>
<td><p>Misprice (bp)</p></td>
</tr>
<tr class="row-odd"><td><p>[unbumped]</p></td>
<td><p></p></td>
<td><p>0.00000700</p></td>
</tr>
<tr class="row-even"><td><p>1%</p></td>
<td><p>TRUE (max shock 1.88bp)</p></td>
<td><p>0.00000668</p></td>
</tr>
<tr class="row-odd"><td><p>10%</p></td>
<td><p>FALSE</p></td>
<td><p>0.00000426</p></td>
</tr>
<tr class="row-even"><td><p>20%</p></td>
<td><p>FALSE</p></td>
<td><p>0.00000247</p></td>
</tr>
<tr class="row-odd"><td><p>50%</p></td>
<td><p>FALSE</p></td>
<td><p>0.00002324</p></td>
</tr>
<tr class="row-even"><td><p>100%</p></td>
<td><p>FALSE</p></td>
<td><p>0.00001590</p></td>
</tr>
</tbody>
</table>
</div>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>SEK</p></th>
<th class="head"><p></p></th>
<th class="head"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Shock (%) - incrementing</p></td>
<td><p>Jacobian?</p></td>
<td><p>Misprice (bp)</p></td>
</tr>
<tr class="row-odd"><td><p>[unbumped]</p></td>
<td><p></p></td>
<td><p>0.00004915</p></td>
</tr>
<tr class="row-even"><td><p>1%</p></td>
<td><p>TRUE (max shock 2.52bp)</p></td>
<td><p>0.00004835</p></td>
</tr>
<tr class="row-odd"><td><p>10%</p></td>
<td><p>FALSE</p></td>
<td><p>0.00004153</p></td>
</tr>
<tr class="row-even"><td><p>20%</p></td>
<td><p>FALSE</p></td>
<td><p>0.00003485</p></td>
</tr>
<tr class="row-odd"><td><p>50%</p></td>
<td><p>FALSE</p></td>
<td><p>0.00001968</p></td>
</tr>
<tr class="row-even"><td><p>100%</p></td>
<td><p>FALSE</p></td>
<td><p>0.00001590</p></td>
</tr>
</tbody>
</table>
</div>
<p>Thus the above confirms the accuracy of the shocks – no misprice rises above 1e-8 (0.0001bp), when applying the ladder.</p>
</section>
</section>
</section>
<section id="jacobian-rebuild-accuracy">
<h4>8.2.4    Jacobian rebuild accuracy<a class="headerlink" href="#jacobian-rebuild-accuracy" title="Link to this heading">#</a></h4>
<p>The above incremental scenario generation is also a test of Jacobian rebuild accuracy. The 1% Shock in all 7 examples above create a maximum instrument price change equivalent to &lt;5bp (i.e. 50bp as a rate).</p>
<p>We can also look at a ladder of shocks up to 5bp – all instruments in the scenario are shocked by an identical amount. Results with AD:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>USD</p></th>
<th class="head"><p></p></th>
<th class="head"><p></p></th>
<th class="head"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Shock (%) - incrementing</p></td>
<td><p>Shock (bp)</p></td>
<td><p>Misprice (bp)</p></td>
<td><p>Max bump error</p></td>
</tr>
<tr class="row-odd"><td><p>[unbumped]</p></td>
<td><p></p></td>
<td><p>0.00000141</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>1%</p></td>
<td><p>0.05</p></td>
<td><p>0.00000122</p></td>
<td><p>2.92E-10</p></td>
</tr>
<tr class="row-odd"><td><p>10%</p></td>
<td><p>0.50</p></td>
<td><p>0.00000027</p></td>
<td><p>5.20E-11</p></td>
</tr>
<tr class="row-even"><td><p>20%</p></td>
<td><p>1.00</p></td>
<td><p>0.00000027</p></td>
<td><p>5.15E-11</p></td>
</tr>
<tr class="row-odd"><td><p>50%</p></td>
<td><p>2.50</p></td>
<td><p>0.00000028</p></td>
<td><p>5.29E-11</p></td>
</tr>
<tr class="row-even"><td><p>100%</p></td>
<td><p>5.00</p></td>
<td><p>0.00000031</p></td>
<td><p>5.41E-11</p></td>
</tr>
</tbody>
</table>
</div>
<p>Max bump error is again the maximum error across all shocks of the shocks themselves:
<span class="math notranslate nohighlight">\(Max_{incremental}\)</span> <span class="math notranslate nohighlight">\(abs(misprice^{shock}_i-misprice^{ref}_{shock})\)</span></p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>EUR</p></th>
<th class="head"><p></p></th>
<th class="head"><p></p></th>
<th class="head"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Shock (%) - incrementing</p></td>
<td><p>Shock (bp)</p></td>
<td><p>Misprice (bp)</p></td>
<td><p>Max bump error</p></td>
</tr>
<tr class="row-odd"><td><p>[unbumped]</p></td>
<td><p></p></td>
<td><p>0.00004828</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>1%</p></td>
<td><p>0.05</p></td>
<td><p>0.00004841</p></td>
<td><p>0.00000000</p></td>
</tr>
<tr class="row-odd"><td><p>10%</p></td>
<td><p>0.50</p></td>
<td><p>0.00004956</p></td>
<td><p>0.00000256</p></td>
</tr>
<tr class="row-even"><td><p>20%</p></td>
<td><p>1.00</p></td>
<td><p>0.00005087</p></td>
<td><p>0.00000059</p></td>
</tr>
<tr class="row-odd"><td><p>50%</p></td>
<td><p>2.50</p></td>
<td><p>0.00004494</p></td>
<td><p>0.00000266</p></td>
</tr>
<tr class="row-even"><td><p>100%</p></td>
<td><p>5.00</p></td>
<td><p>0.00006188</p></td>
<td><p>0.00002203</p></td>
</tr>
</tbody>
</table>
</div>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>GBP</p></th>
<th class="head"><p></p></th>
<th class="head"><p></p></th>
<th class="head"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Shock (%) - incrementing</p></td>
<td><p>Shock (bp)</p></td>
<td><p>Misprice (bp)</p></td>
<td><p>Max bump error</p></td>
</tr>
<tr class="row-odd"><td><p>[unbumped]</p></td>
<td><p></p></td>
<td><p>0.00005676</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>1%</p></td>
<td><p>0.05</p></td>
<td><p>0.00005648</p></td>
<td><p>0.00000000</p></td>
</tr>
<tr class="row-odd"><td><p>10%</p></td>
<td><p>0.50</p></td>
<td><p>0.00005391</p></td>
<td><p>0.00000057</p></td>
</tr>
<tr class="row-even"><td><p>20%</p></td>
<td><p>1.00</p></td>
<td><p>0.00004424</p></td>
<td><p>0.00000059</p></td>
</tr>
<tr class="row-odd"><td><p>50%</p></td>
<td><p>2.50</p></td>
<td><p>0.00002698</p></td>
<td><p>0.00000061</p></td>
</tr>
</tbody>
</table>
</div>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>JPY</p></th>
<th class="head"><p></p></th>
<th class="head"><p></p></th>
<th class="head"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Shock (%) - incrementing</p></td>
<td><p>Shock (bp)</p></td>
<td><p>Misprice (bp)</p></td>
<td><p>Max bump error</p></td>
</tr>
<tr class="row-odd"><td><p>[unbumped]</p></td>
<td><p></p></td>
<td><p>0.00002520</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>1%</p></td>
<td><p>0.05</p></td>
<td><p>0.00002528</p></td>
<td><p>0.00000000</p></td>
</tr>
<tr class="row-odd"><td><p>10%</p></td>
<td><p>0.50</p></td>
<td><p>0.00002600</p></td>
<td><p>0.00000059</p></td>
</tr>
<tr class="row-even"><td><p>20%</p></td>
<td><p>1.00</p></td>
<td><p>0.00002681</p></td>
<td><p>0.00000161</p></td>
</tr>
<tr class="row-odd"><td><p>50%</p></td>
<td><p>2.50</p></td>
<td><p>0.00002938</p></td>
<td><p>0.00000067</p></td>
</tr>
<tr class="row-even"><td><p>100%</p></td>
<td><p>5.00</p></td>
<td><p>0.00003408</p></td>
<td><p>0.00000177</p></td>
</tr>
</tbody>
</table>
</div>
<p>Thus the maximum error is 0.00002203, as highlighted, this means a shock of 5.0001 bp was realised for a 5bp input.</p>
<p>It is only in EUR, 5bp shock that 3 values above 1e-5 are seen.</p>
<p>Thus we conclude that a 5bp tolerance for shocking produces an accurate result.</p>
<section id="finite-difference-in-engine-build">
<h5>8.2.4.1. Finite difference in engine build<a class="headerlink" href="#finite-difference-in-engine-build" title="Link to this heading">#</a></h5>
<p>If we repeat with FD – i.e. the engine is built, and jacobian generated without AD:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>USD</p></th>
<th class="head"><p></p></th>
<th class="head"><p></p></th>
<th class="head"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Shock (%) - incrementing</p></td>
<td><p>Shock (bp)</p></td>
<td><p>Misprice (bp)</p></td>
<td><p>Max bump error</p></td>
</tr>
<tr class="row-odd"><td><p>[unbumped]</p></td>
<td><p></p></td>
<td><p>0.00000090</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>1%</p></td>
<td><p>0.05</p></td>
<td><p>0.00000063</p></td>
<td><p>0.00001157</p></td>
</tr>
<tr class="row-odd"><td><p>10%</p></td>
<td><p>0.50</p></td>
<td><p>0.00000003</p></td>
<td><p>0.00000009</p></td>
</tr>
<tr class="row-even"><td><p>20%</p></td>
<td><p>1.00</p></td>
<td><p>0.00000022</p></td>
<td><p>0.00000024</p></td>
</tr>
<tr class="row-odd"><td><p>50%</p></td>
<td><p>2.50</p></td>
<td><p>0.00000027</p></td>
<td><p>0.00000006</p></td>
</tr>
<tr class="row-even"><td><p>100%</p></td>
<td><p>5.00</p></td>
<td><p>0.00000027</p></td>
<td><p>0.00000001</p></td>
</tr>
</tbody>
</table>
</div>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>EUR</p></th>
<th class="head"><p></p></th>
<th class="head"><p></p></th>
<th class="head"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Shock (%) - incrementing</p></td>
<td><p>Shock (bp)</p></td>
<td><p>Misprice (bp)</p></td>
<td><p>Max bump error</p></td>
</tr>
<tr class="row-odd"><td><p>[unbumped]</p></td>
<td><p></p></td>
<td><p>0.00002952</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>1%</p></td>
<td><p>0.05</p></td>
<td><p>0.00002960</p></td>
<td><p>0.00000000</p></td>
</tr>
<tr class="row-odd"><td><p>10%</p></td>
<td><p>0.50</p></td>
<td><p>0.00003006</p></td>
<td><p>0.00000312</p></td>
</tr>
<tr class="row-even"><td><p>20%</p></td>
<td><p>1.00</p></td>
<td><p>0.00002930</p></td>
<td><p>0.00000265</p></td>
</tr>
<tr class="row-odd"><td><p>50%</p></td>
<td><p>2.50</p></td>
<td><p>0.00002930</p></td>
<td><p>0.00000105</p></td>
</tr>
<tr class="row-even"><td><p>100%</p></td>
<td><p>5.00</p></td>
<td><p>0.00003035</p></td>
<td><p>0.00000032</p></td>
</tr>
</tbody>
</table>
</div>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>GBP</p></th>
<th class="head"><p></p></th>
<th class="head"><p></p></th>
<th class="head"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Shock (%) - incrementing</p></td>
<td><p>Shock (bp)</p></td>
<td><p>Misprice (bp)</p></td>
<td><p>Max bump error</p></td>
</tr>
<tr class="row-odd"><td><p>[unbumped]</p></td>
<td><p></p></td>
<td><p>0.00001001</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>1%</p></td>
<td><p>0.05</p></td>
<td><p>0.00001007</p></td>
<td><p>0.00000000</p></td>
</tr>
<tr class="row-odd"><td><p>10%</p></td>
<td><p>0.50</p></td>
<td><p>0.00000971</p></td>
<td><p>0.00000044</p></td>
</tr>
<tr class="row-even"><td><p>20%</p></td>
<td><p>1.00</p></td>
<td><p>0.00000976</p></td>
<td><p>0.00000075</p></td>
</tr>
<tr class="row-odd"><td><p>50%</p></td>
<td><p>2.50</p></td>
<td><p>0.00000968</p></td>
<td><p>0.00000023</p></td>
</tr>
<tr class="row-even"><td><p>100%</p></td>
<td><p>5.00</p></td>
<td><p>0.00000955</p></td>
<td><p>0.00000012</p></td>
</tr>
</tbody>
</table>
</div>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>JPY</p></th>
<th class="head"><p></p></th>
<th class="head"><p></p></th>
<th class="head"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Shock (%) - incrementing</p></td>
<td><p>Shock (bp)</p></td>
<td><p>Misprice (bp)</p></td>
<td><p>Max bump error</p></td>
</tr>
<tr class="row-odd"><td><p>[unbumped]</p></td>
<td><p></p></td>
<td><p>0.00000884</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>1%</p></td>
<td><p>0.05</p></td>
<td><p>0.00000908</p></td>
<td><p>0.00000000</p></td>
</tr>
<tr class="row-odd"><td><p>10%</p></td>
<td><p>0.50</p></td>
<td><p>0.00000882</p></td>
<td><p>0.00000043</p></td>
</tr>
<tr class="row-even"><td><p>20%</p></td>
<td><p>1.00</p></td>
<td><p>0.00000872</p></td>
<td><p>0.00000030</p></td>
</tr>
<tr class="row-odd"><td><p>50%</p></td>
<td><p>2.50</p></td>
<td><p>0.00000882</p></td>
<td><p>0.00000009</p></td>
</tr>
<tr class="row-even"><td><p>100%</p></td>
<td><p>5.00</p></td>
<td><p>0.00000884</p></td>
<td><p>0.00000005</p></td>
</tr>
</tbody>
</table>
</div>
<p>We would conclude that both FD and AD show, in general, a very small misprice, well within a rigorous misprice tolerance.</p>
<p>We do not state that there is a systematic difference, since we note that the jacobian resulting from the engine build is produced from a different input to LSQFM (4.1.1.3), thus the result – final output of curves and (inverse) jacobian will be different regardless of the infinitesimal bump size in AD, versus the finite size in FD, they come from different end points to the optimisation. This is why we do not expect to, nor do observe a systematic relation of AD vs. FD for the bump sizes (GBP, JPY above).</p>
</section>
</section>
<section id="extreme-scenario-analysis">
<h4>8.2.5    Extreme scenario analysis<a class="headerlink" href="#extreme-scenario-analysis" title="Link to this heading">#</a></h4>
<p>This is not designed as a realistic test, but the opposite - to apply a scenario to a set of curves with a drastically disparate set of shocks. The test is then that this does not create mispricing, or a build failure.</p>
<p>To create such an extreme scenario we can reuse our shocks but alternate the sign of the shocks, thus:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>USD</p></th>
<th class="head"><p>1M</p></th>
<th class="head"><p>3M</p></th>
<th class="head"><p>6M</p></th>
<th class="head"><p>9M</p></th>
<th class="head"><p>1Y</p></th>
<th class="head"><p>2Y</p></th>
<th class="head"><p>3Y</p></th>
<th class="head"><p>5Y</p></th>
<th class="head"><p>7Y</p></th>
<th class="head"><p>10Y</p></th>
<th class="head"><p>15Y</p></th>
<th class="head"><p>20Y</p></th>
<th class="head"><p>30Y</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>USD LIBOR 3M</p></td>
<td><p>8.1</p></td>
<td><p>8.1</p></td>
<td><p>8.2</p></td>
<td><p>8.0</p></td>
<td><p>8.0</p></td>
<td><p>-8.0</p></td>
<td><p>-8.0</p></td>
<td><p>-8.0</p></td>
<td><p>-8.0</p></td>
<td><p>-8.0</p></td>
<td><p>-8.0</p></td>
<td><p>-8.0</p></td>
<td><p>-8.0</p></td>
</tr>
<tr class="row-odd"><td><p>USD/GS&#64;18</p></td>
<td><p>48.9</p></td>
<td><p>48.9</p></td>
<td><p>-32.5</p></td>
<td><p>24.4</p></td>
<td><p>-29.6</p></td>
<td><p>15.4</p></td>
<td><p>-8.0</p></td>
<td><p>6.0</p></td>
<td><p>-3.8</p></td>
<td><p>3.5</p></td>
<td><p>-3.5</p></td>
<td><p>3.5</p></td>
<td><p>-3.5</p></td>
</tr>
<tr class="row-even"><td><p>USD/LIBOR/6M</p></td>
<td><p>4.4</p></td>
<td><p>-3.7</p></td>
<td><p>6.2</p></td>
<td><p>-2.5</p></td>
<td><p>7.1</p></td>
<td><p>-4.1</p></td>
<td><p>5.7</p></td>
<td><p>-4.9</p></td>
<td><p>4.6</p></td>
<td><p>-3.8</p></td>
<td><p>5.1</p></td>
<td><p>-4.1</p></td>
<td><p>5.4</p></td>
</tr>
</tbody>
</table>
</div>
<p>These shocks produce a misprice of 0.0007bp. This is outside a normal tolerance, however, with a graphical representation we can clearly see how unrealistic this scenario is, but that it has been successfully applied. We can also state that the misprice of this magnitude would not be visible in pricing or valuation (2/E in $1m).</p>
<p><img alt="Figure 8.12: USD 3m LIBOR extreme scenario analysis" src="../../_images/libor_ois_interpolation_200.jpg" /></p>
<p>This extreme scenario is a clear demonstration of the robustness of NCF. The wild oscillations, but retaining smoothness, are due to the use of log+cubic interpolation.</p>
<p>However, it is important to note that this test is not a criticism of the NCF – the fact that a set of curves – where the flexibility of the NCF allows what is an intuitively invalid input if the correct marking of input prices is not monitored. Governance of this is outside the scope of this document.</p>
<section id="finite-difference">
<h5>8.2.5.1. Finite difference<a class="headerlink" href="#finite-difference" title="Link to this heading">#</a></h5>
<p>If we repeat the same test as above but with finite difference there is only a minute difference – the misprice is 0.00265583bp vs. 0.00265590bp with AD.</p>
</section>
</section>
<section id="summary">
<h4>8.2.6    Summary<a class="headerlink" href="#summary" title="Link to this heading">#</a></h4>
<p>We can summarise what the above tests and analysis have shown:</p>
<ol class="arabic simple">
<li><p>8.2.2 has shown the robustness of the forward-looking tests on production engines, both pre-release and in production. The 100 day window provides enough time for remediation.</p></li>
<li><p>8.2.3 shows the robustness of the framework under stressed market conditions.</p></li>
<li><p>8.2.4 shows the accuracy of applying curve shocks – that all works correctly.</p></li>
<li><p>8.2.7 is an extreme version of 2 – the robustness of the framework, under an unrealistic scenario.</p></li>
</ol>
</section>
</section>
<section id="statistical-testing">
<h3>8.3    Statistical testing<a class="headerlink" href="#statistical-testing" title="Link to this heading">#</a></h3>
<p>n/a</p>
</section>
<section id="impact-of-assumptions-and-limitations">
<h3>8.4    Impact of Assumptions and Limitations<a class="headerlink" href="#impact-of-assumptions-and-limitations" title="Link to this heading">#</a></h3>
<p>We can review the assumptions and limitations described in 4.2 and 7.3 in light of the above testing.</p>
<section id="smoothing-penalty-no-choice-of-nodes">
<h4>8.4.1    Smoothing penalty - no choice of nodes<a class="headerlink" href="#smoothing-penalty-no-choice-of-nodes" title="Link to this heading">#</a></h4>
<p>See 4.2.2 #8.</p>
<p>Applying smoothing at all nodes on a curve may produce an inappropriate curve shape.
We can plot a test version of the 6M CHF LIBOR curve at 10-Mar-2017. This date, and testing, were under scrutiny as part of the roll-out of a revised (simplified) design for EOD curves. They were not in production use.</p>
<p>The 6m forward rate is plotted. The blue line is the weight for smoothing in the engine under test (0.001), red with a weight of 0.1:</p>
<p><img alt="Figure 8.13: Impact of smoothing penalty on 6M CHF LIBOR curve" src="../../_images/libor_ois_interpolation_29.jpg" /></p>
<p>However, by “smoothing” the curve with the increase in instrument penalty we create a misprice in the instruments:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Weight</p></th>
<th class="head"><p>Misprice (bp)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0.001</p></td>
<td><p>0.000821</p></td>
</tr>
<tr class="row-odd"><td><p>(ms)</p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</div>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>sqrt(ε) (~1.5E-8)</p></th>
<th class="head"><p>1</p></th>
<th class="head"><p>0.02762</p></th>
<th class="head"><p>436</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0.9</p></td>
<td><p>1E-10</p></td>
<td><p>0.02762</p></td>
<td><p>427</p></td>
</tr>
<tr class="row-odd"><td><p>0.9</p></td>
<td><p>1E-12</p></td>
<td><p>0.02762</p></td>
<td><p>426</p></td>
</tr>
<tr class="row-even"><td><p>0.9</p></td>
<td><p>1E-14</p></td>
<td><p>0.02762</p></td>
<td><p>428</p></td>
</tr>
<tr class="row-odd"><td><p>0.9</p></td>
<td><p>1E-16</p></td>
<td><p>0.02762</p></td>
<td><p>428</p></td>
</tr>
<tr class="row-even"><td><p>0.9</p></td>
<td><p>0.0000001</p></td>
<td><p>0.02762</p></td>
<td><p>432</p></td>
</tr>
<tr class="row-odd"><td><p>0.9</p></td>
<td><p>0.000001</p></td>
<td><p>0.02762</p></td>
<td><p>432</p></td>
</tr>
<tr class="row-even"><td><p>0.9</p></td>
<td><p>0.0001</p></td>
<td><p>0.02762</p></td>
<td><p>428</p></td>
</tr>
<tr class="row-odd"><td><p>0.9</p></td>
<td><p>0.001</p></td>
<td><p>0.02762</p></td>
<td><p>424</p></td>
</tr>
<tr class="row-even"><td><p>0.9</p></td>
<td><p>0.01</p></td>
<td><p>0.02762</p></td>
<td><p>394</p></td>
</tr>
<tr class="row-odd"><td><p>0.9</p></td>
<td><p>0.1</p></td>
<td><p>0.02762</p></td>
<td><p>370</p></td>
</tr>
</tbody>
</table>
</div>
<section id="stepmx">
<h5>8.5.1.3. STEPMX<a class="headerlink" href="#stepmx" title="Link to this heading">#</a></h5>
<p>We have selected a low value, thus, as expected, increasing STEPMX does not alter the solution. At lower values either an error code is returned (IFAIL=3), or a failure.</p>
<p>Thus the selection of 1.0 is conservative.</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Inputs</p></th>
<th class="head"><p>Outputs (test results)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ETA</p></td>
<td><p>XTOL</p></td>
</tr>
<tr class="row-odd"><td><p>0.9</p></td>
<td><p>sqrt(ε) (~1.5E-8)</p></td>
</tr>
<tr class="row-even"><td><p>0.9</p></td>
<td><p>sqrt(ε) (~1.5E-8)</p></td>
</tr>
<tr class="row-odd"><td><p>0.9</p></td>
<td><p>sqrt(ε) (~1.5E-8)</p></td>
</tr>
<tr class="row-even"><td><p>0.9</p></td>
<td><p>sqrt(ε) (~1.5E-8)</p></td>
</tr>
<tr class="row-odd"><td><p>0.9</p></td>
<td><p>sqrt(ε) (~1.5E-8)</p></td>
</tr>
<tr class="row-even"><td><p>0.9</p></td>
<td><p>sqrt(ε) (~1.5E-8)</p></td>
</tr>
<tr class="row-odd"><td><p>0.9</p></td>
<td><p>sqrt(ε) (~1.5E-8)</p></td>
</tr>
<tr class="row-even"><td><p>0.9</p></td>
<td><p>sqrt(ε) (~1.5E-8)</p></td>
</tr>
<tr class="row-odd"><td><p>—–</p></td>
<td><p>——————-</p></td>
</tr>
<tr class="row-even"><td><p>0.9</p></td>
<td><p>sqrt(ε) (~1.5E-8)</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="multiple-parameters">
<h5>8.5.1.4. Multiple parameters<a class="headerlink" href="#multiple-parameters" title="Link to this heading">#</a></h5>
<p>The above single-parameter tests are further validated by multiple parameters – low values of STEPMX lead to failures.</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Inputs</p></th>
<th class="head"><p>Outputs (test results)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ETA</p></td>
<td><p>XTOL</p></td>
</tr>
<tr class="row-odd"><td><p>0.001</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>0.001</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>0.001</p></td>
<td><p>sqrt(ε) (~1.5E-8)</p></td>
</tr>
<tr class="row-even"><td><p>0.001</p></td>
<td><p>sqrt(ε) (~1.5E-8)</p></td>
</tr>
<tr class="row-odd"><td><p>0.9</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>0.9</p></td>
<td><p>1</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="iprint">
<h5>8.5.1.5. IPRINT<a class="headerlink" href="#iprint" title="Link to this heading">#</a></h5>
<p>The chosen value has little effect on the outcome, so using the conservative parameter, 1, is justified.</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Outputs (test results)</p></th>
<th class="head"><p></p></th>
<th class="head"><p></p></th>
<th class="head"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>IPRINT</p></td>
<td><p>Misprice (bp)</p></td>
<td><p>Build time (ms)</p></td>
<td><p>IFAIL</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>0.02762</p></td>
<td><p>436</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>0</p></td>
<td><p>0.02762</p></td>
<td><p>428</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>0.9</p></td>
<td><p>sqrt(ε) (~1.5E-8)</p></td>
<td><p>0.01</p></td>
<td><p>0.02762</p></td>
</tr>
<tr class="row-even"><td><p>—–</p></td>
<td><p>——————-</p></td>
<td><p>——</p></td>
<td><p>———</p></td>
</tr>
<tr class="row-odd"><td><p>0.9</p></td>
<td><p>sqrt(ε) (~1.5E-8)</p></td>
<td><p>0.001</p></td>
<td><p>0.02762</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="fo1blf">
<h4>8.5.2  FO1BLF<a class="headerlink" href="#fo1blf" title="Link to this heading">#</a></h4>
<section id="t">
<h5>8.5.2.1. T<a class="headerlink" href="#t" title="Link to this heading">#</a></h5>
<p>We had set a value of 1E-8 for T in initial use of FO1BLF for matrix inversion.</p>
<p>This was tested with same problematic engine for the above parameters, for the same reason – inaccuracies in the build (mispricing above 1E-4bp) would lead to at least some inaccuracy in the jacobian – the jacobian rebuild. This, in itself might not be of importance, but it should allow a reliable test for the discovery of zeros in the (inverse) jacobian. The (inverse) jacobian has 33856 elements.</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>T</p></th>
<th class="head"><p>Matrix inversion time (ms)</p></th>
<th class="head"><p>Build time (ms)</p></th>
<th class="head"><p>AD Misprice - bp (4bp shock on jacobian rebuild)</p></th>
<th class="head"><p>Jacobian zeros</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Full rebuild</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p>0.00008292</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>1.00E-02</p></td>
<td><p>97</p></td>
<td><p>343</p></td>
<td><p>0.00565859</p></td>
<td><p>11959</p></td>
</tr>
<tr class="row-even"><td><p>1.00E-03</p></td>
<td><p>45</p></td>
<td><p>310</p></td>
<td><p>0.00565859</p></td>
<td><p>11959</p></td>
</tr>
<tr class="row-odd"><td><p>1.00E-04</p></td>
<td><p>45</p></td>
<td><p>343</p></td>
<td><p>0.00565859</p></td>
<td><p>11959</p></td>
</tr>
<tr class="row-even"><td><p>1.00E-05</p></td>
<td><p>47</p></td>
<td><p>343</p></td>
<td><p>0.00565859</p></td>
<td><p>11959</p></td>
</tr>
<tr class="row-odd"><td><p>1.00E-06</p></td>
<td><p>45</p></td>
<td><p>310</p></td>
<td><p>0.00565859</p></td>
<td><p>11959</p></td>
</tr>
</tbody>
</table>
</div>
<p>For a comparison of FD and AD in jacobian rebuild see section 8.2.4.</p>
<p>The results indicate a value of T within the range 1E-8 to 1E-11 might be preferable. There is lower accuracy (fewer zeros) as T is reduced and a slight increase in build time as T is increased. No difference is seen in the accuracy of the jacobian rebuild.</p>
<p>Thus, we should not use these results as a reason to change the default value. We would refer to 2.2 above – there are many million instances of jacobian rebuilds, and none have been reported as inaccurate.</p>
</section>
</section>
</section>
<section id="boundary-cases">
<h3>8.6  Boundary Cases<a class="headerlink" href="#boundary-cases" title="Link to this heading">#</a></h3>
<p>There are, in addition to 6.4.2 tests unit tests of individual parameters for the engine in the QA regression testing system. These tests are run, and the results signed off, for every release of QA.</p>
<section id="invalid-price">
<h4>8.6.1  Invalid price<a class="headerlink" href="#invalid-price" title="Link to this heading">#</a></h4>
<p>There is one important test outside of those checking for build failures such as 4.2.1 &amp; 4.2.2. An invalid price input. E.g. a rate for an outright instrument (deposit, asset) with a price &lt; -100%. The tests of this type do not necessarily lead to build failure they will often (in fact it is usual) to produce an engine (but with IF AIL=3, non-convergence at a minimum). This is not incorrect behaviour, but should be the type of bad input data that should be captured before passing to the engine for construction. Testing of this type is important therefore that behaviour as expected, and that the tests of NCF for all types of instrument do this. These tests run as part of regression testing on the QA Library.</p>
</section>
<section id="unit-tests">
<h4>8.6.2  Unit tests<a class="headerlink" href="#unit-tests" title="Link to this heading">#</a></h4>
<p>Unit tests are implemented for coverage of the major areas. As for above tests they run as regression tests on every release of the QA Library. A unit test is one that focuses on one, very specific area of code, or input.</p>
<p>There are also the additional set of tests that fill the gap not covered by forward testing and backtesting over a stressed period. The tests need not be designed to be realistic, they are often designed to be unrealistic, but check the model behaves sensibly under unlikely situations. This is important for a model framework as flexible as NCF, since there is no possibility to test all “realistic” scenarios.</p>
<p>Tests include:</p>
<ul class="simple">
<li><p>Conventions/parameters for input instruments (e.g. frequency, node date, start date/end date (e.g. spot or forward-starting), etc.).</p></li>
<li><p>Interpolation types.</p></li>
<li><p>Extreme data (e.g. 2008/9) – valid, but very sharply changing curves, inverted mkt data, negative rates.</p></li>
<li><p>Curve shocking – individually by instrument (normal calculation of a risk strip), all instruments (parallel shift).</p></li>
<li><p>Full and fast rebuilds (both for accuracy, and that the correct path is chosen for different size of instrument shocks).</p></li>
</ul>
<p>Accuracy of these tests was set at a stringent level - 1e-10 in the rate or discount factor (i.e. much smaller than forward testing misprice tolerance) – such that rebasing needs to be examined for even tiny changes (i.e. a very robust safety net), and that upgrades e.g. change to NAG version would not go unnoticed.</p>
<p>There are also many system tests – calls to QA that include curve construction, and risk, for real trades. When bugs are fixed – since generally found against a real-world example – the corrected trade and output is used as a new test baseline.</p>
</section>
</section>
<section id="comparison-to-other-models">
<h3>8.7  Comparison to Other Models<a class="headerlink" href="#comparison-to-other-models" title="Link to this heading">#</a></h3>
<p>n/a</p>
</section>
<section id="other-outcome-analysis-testing">
<h3>8.8  Other Outcome Analysis / Testing<a class="headerlink" href="#other-outcome-analysis-testing" title="Link to this heading">#</a></h3>
<section id="development-testing">
<h4>8.8.1  Development Testing<a class="headerlink" href="#development-testing" title="Link to this heading">#</a></h4>
<p>A fundamental part of the checks for robustness of NCF, and the suitability of the individual implementations is to check that all input prices of instruments are reverted to a very low tolerance (mispricing below a value noticeable in pricing or PV calculation), and to give a degree of confidence this will continue into the future and under different market conditions.</p>
<p>To ensure this is a valid test and to provide an external check to the engine calculations separate tests were developed to check the internal return of input prices to instrument accuracy – and for the external test, that the test the internal call through NCF to the QA Library is identical to the priding of that same instrument through an external call to the QA Library. The test result is therefore a comparison between the fitted price returned by NCF against the externally calculated price.</p>
<p>These tests are also presented in such a way to provide a test that the instrument is implemented in line with its description in 3.3.8.</p>
<p>Results are:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Instrument</p></th>
<th class="head"><p>Tenors tested</p></th>
<th class="head"><p>Rate difference</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Deposit/Forward Rate</p></td>
<td><p>1M, 3M, 6M, 9M, 1Y</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>Future</p></td>
<td><p>1F, 2F, 3F, 4F, 5F</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>Swaps</p></td>
<td><p>2Y, 3Y, 5Y, 7Y, 10Y</p></td>
<td><p>1.06581E-18</p></td>
</tr>
<tr class="row-odd"><td><p>Forward Spread</p></td>
<td><p>8.88178E-16</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>(Tenor) Basis Swap</p></td>
<td><p>1Y, 2Y, 3Y, 5Y, 7Y, 10Y</p></td>
<td><p>7.10543E-19</p></td>
</tr>
<tr class="row-odd"><td><p>FX Forward</p></td>
<td><p>1M, 3M, 6M, 9M, 1Y</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>Cross Currency Basis Swap</p></td>
<td><p>1Y, 2Y, 3Y, 5Y, 7Y, 10Y</p></td>
<td><p>1.10845E-16</p></td>
</tr>
<tr class="row-odd"><td><p>MTM Cross Currency Basis Swap</p></td>
<td><p>1Y, 2Y, 3Y, 5Y, 7Y, 10Y</p></td>
<td><p>1.05781E-16</p></td>
</tr>
<tr class="row-even"><td><p>Cross Currency Swap</p></td>
<td><p>1Y, 2Y, 3Y, 5Y, 7Y, 10Y</p></td>
<td><p>1.10845E-16</p></td>
</tr>
<tr class="row-odd"><td><p>Spread Constraint</p></td>
<td><p>2Y3Y, 3Y5Y, 5Y7Y, 7Y10Y</p></td>
<td><p>9.23706E-18</p></td>
</tr>
<tr class="row-even"><td><p>Fly Constraint</p></td>
<td><p>2Y3Y5Y, 3Y5Y7Y, 5Y7Y10Y</p></td>
<td><p>1.33272E-18</p></td>
</tr>
<tr class="row-odd"><td><p>Term Deposit</p></td>
<td><p>1Y, 2Y, 3Y, 5Y, 7Y, 10Y</p></td>
<td><p>6.4837E-17</p></td>
</tr>
<tr class="row-even"><td><p>Turn</p></td>
<td><p>1YE, 2YE, 4YE, 5YE**</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>Bond</p></td>
<td><p>Jul-12, Jul-18, Jul-19, Jul-20, Jul-22, Jan-24, Jan-31, Jul-40***</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>Inflation Zero Coupon Swap</p></td>
<td><p>1Y, 2Y, 3Y, 5Y, 7Y, 10Y</p></td>
<td><p>2.435166-12****</p></td>
</tr>
</tbody>
</table>
</div>
<ul class="simple">
<li><p>‘f’ indicates an IMM date</p></li>
</ul>
<p>** YE = year end</p>
<p>*** Maturity dates of the bonds tested</p>
<p>**** CPI values are returned to 12dp, hence this is the maximum tolerance that can be achieved.</p>
<p>Above results – negligible difference – to machine tolerance – throughout (i.e. the highest is 2.4e-12 as an absolute rate) – show the correct implementation of instruments within NCF.</p>
</section>
</section>
</section>
<section id="general-limitations">
<h2>9. General Limitations<a class="headerlink" href="#general-limitations" title="Link to this heading">#</a></h2>
<p>Due to the original design principles, for EOD there are essentially no limitations for PV/risk, i.e. any of the instrument types can be used to view risk with a set of chosen curve and instrument dependencies as desired by the designer or consumer. There are of course the assumptions and limitations noted above, but a more general limitation is for pricing:</p>
<section id="full-rebuild-time">
<h3>9.1 Full rebuild time<a class="headerlink" href="#full-rebuild-time" title="Link to this heading">#</a></h3>
<p>For pricing intraday the full rebuild time (i.e. the time curves could be “offline” during a full rebuild) of complex engines e.g. EUR, GBP - needed remediation. Pricing would be too slow if an engine was performing a full rebuild and not streaming curves for pricing (required within &lt;1s of a price tick).</p>
<p>Thus a general process was devised as follows:</p>
<ol class="arabic simple">
<li><p>Have two or more instances of the engine.</p></li>
<li><p>Take the engine that has most recently performed a full rebuild. Perform one fast rebuild on this using latest (updated since the full rebuild was initiated) prices.</p></li>
<li><p>Always use the engine with the most recent full rebuild to stream prices/curves (via a fast rebuild).</p></li>
<li><p>Once any engine has finished a full rebuild and is in use as the fast engine, begin a new full rebuild on the engine that was previously streaming the fast rebuild.</p></li>
</ol>
<p>This also ensures at least one engine is always undergoing a full rebuild, to ensure accuracy.</p>
</section>
</section>
<section id="model-monitoring-kpis">
<h2>10. Model Monitoring – KPIs<a class="headerlink" href="#model-monitoring-kpis" title="Link to this heading">#</a></h2>
<section id="monitoring-tests-and-key-performance-indicators-kpi">
<h3>10.1 Monitoring Tests and Key Performance Indicators (KPI)<a class="headerlink" href="#monitoring-tests-and-key-performance-indicators-kpi" title="Link to this heading">#</a></h3>
<p>See 6.4.2 and 4.2.1.2 above.</p>
</section>
<section id="performance-exceptions">
<h3>10.2 Performance Exceptions<a class="headerlink" href="#performance-exceptions" title="Link to this heading">#</a></h3>
<p>See 4.2.1 &amp; 4.2.2.</p>
</section>
<section id="exception-mitigation-plan">
<h3>10.3 Exception Mitigation Plan<a class="headerlink" href="#exception-mitigation-plan" title="Link to this heading">#</a></h3>
<p>See 4.2.1.2</p>
</section>
</section>
<section id="summary-of-feedback-received-during-development">
<h2>11. Summary of Feedback Received During Development<a class="headerlink" href="#summary-of-feedback-received-during-development" title="Link to this heading">#</a></h2>
<p>The development of the NCF model was for accurate pricing – there was continual revision during 2007-10 when the majority of development took place. This was in the form of direct feedback from the trading desks during development.</p>
<p>There is not, as such, direct feedback on accuracy of curve construction/risk:</p>
<ul class="simple">
<li><p>Minimising the penalty function to find a solution to the optimisation is fundamental to the NCF model itself (testing/misprice results above in 4.2.1.2, 8.2.2 &amp; Error! Reference source not found.).</p></li>
<li><p>Risk generation (risk factors used) is the implementation of the framework to meet users’ needs. The users have all been able to configure these risk factors to their needs. Thus this flexibility of instruments available for the risk factors together with extremely low mispricing produces accurate risk.</p></li>
</ul>
</section>
<section id="references">
<h2>12. References<a class="headerlink" href="#references" title="Link to this heading">#</a></h2>
<section id="id26">
<h3>12.1 Literature Review<a class="headerlink" href="#id26" title="Link to this heading">#</a></h3>
<p>K. Adams &amp; D. van Deventer “Fitting yield curves and forward rate curves with maximum smoothness.” Journal of Fixed Income, June 1994, 4(1):52–62</p>
<p>M. Deacon &amp; A Derry “Estimating the Term Structure of Interest Rates” Bank of England 1994</p>
<p>K. Adams “Smooth Interpolation of Zero Curves”, Algo Research Quarterly, March/June 2001</p>
<p>V. Brousseau “The Functional Form of Yield Curves” European Central Bank Working Paper No. 148, May 2002</p>
<p>T. Krivobokova &amp; G. Kauermann “Estimating the Term Structure of Interest Rates using Penalized Splines” Goethe Universitat 2004</p>
<p>P.S. Hagan &amp; G. West “Interpolation Methods for Curve Construction” Applied Mathematical Finance, Vol. 13, No. 2, 89–129, June 2006</p>
<p>P.S. Hagan and G. West. “Methods for constructing a yield curve.” WILMOTT Magazine, May 70–81, 2008</p>
<p>M. H. A. Davis &amp; V. Mataix-Pastor “Arbitrage-free interpolation of the swap curve” International Journal of Theoretical and Applied Finance 12, 969 (2009)</p>
<p>P. Mamouassopoulos “Comparison of non-linear optimization algorithms for yield curve estimation” European Journal of Operational Research, Volume 192, Issue 2, 16 January 2009</p>
<p>T. Ito “Global financial crisis and US interest rate swap spreads” Applied Financial Economics Vol 20, 2010</p>
<p>M. L. Bech &amp; Y. Lengwiler “The financial crisis and the changing dynamics of the yield curve” 2011</p>
<p>M. N. Rugengamanzi “Term structure estimation based on a generalized optimization framework” University of Lingköping 2013</p>
</section>
<section id="nag">
<h3>12.3 NAG<a class="headerlink" href="#nag" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="http://www.nag.com/numeric/fl/manual/pdf/E04/e04lbc.pdf">http://www.nag.com/numeric/fl/manual/pdf/E04/e04lbc.pdf</a></p>
<p><a class="reference external" href="http://www.nag.com/numeric/fl/manual/pdf/F01/f01blf.pdf">http://www.nag.com/numeric/fl/manual/pdf/F01/f01blf.pdf</a></p>
<section id="id27">
<h4>12.4 Algorithmic Differentiation<a class="headerlink" href="#id27" title="Link to this heading">#</a></h4>
<p>L. Capriotti and S. Lee, Adjoint Credit Risk Management, SSRN, July 30, 2013.</p>
<p>L. Capriotti and M. B. Giles, Algorithmic Differentiation: Adjoint Greeks Made Easy, SSRN, April 2, 2011.</p>
<p>L. Capriotti, S. Lee and M. Peacock, Real Time Counterparty Credit Risk Management in Monte Carlo, Risk Magazine, April 27, 2011.</p>
<p>L. Capriotti, Fast Greeks by Algorithmic Differentiation, Journal of Computational Finance 14, 3, 2011.</p>
<p>M. B. Giles and P. Glasserman. Smoking adjoints: fast Monte Carlo Greeks, RISK, 19(1):88-92, January 2006.</p>
<p>C. Homescu, Adjoints and Automatic (Algorithmic) Differentiation in Computational Finance, SSRN, September 12, 2011.</p>
<p>U. Naumann and J. Lotz, Algorithmic Differentiation of Numerical Methods: Tangent-Linear and Adjoint Solvers for Systems of Linear Equations, Technical Report, 2012.</p>
<p>U. Naumann, J. Lotz, K. Leppkes, and M. Towara, Algorithmic Differentiation of Numerical Methods: Tangent-Linear and Adjoint Solvers for Systems of Nonlinear Equations, Technical Report, 2013.</p>
<p>J. du Toit, J. Lotz, and U. Naumann, Adjoint Algorithmic Differentiation of a GPU Accelerated Application, October 22, 2013.</p>
<p>U. Naumann, Adjoint Methods in Computational Finance - Software Tool Support for Algorithmic Differentiation, July 2013.</p>
<p>U. Naumann, Adjoint Algorithmic Differentiation for Computational Finance, AD Tool: dco//c++, November 2013.</p>
<p>U. Naumann, Adjoint Methods for Option Pricing (Misc.), November 2013.</p>
<p>U. Naumann, Adjoint Methods for Option Pricing (Case Studies), November 2013.</p>
</section>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../Fx/fx_volatility_surface.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">FX Analytic Volatility Surfaces</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../Cheyette/Cheyette_Model.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Cheyette Local Vol Model</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, XSIGMA Developers
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Curve Construction and Risk Framework (New Curve Framework)</a><ul>
<li><a class="reference internal" href="#table-of-contents">Table of Contents</a></li>
<li><a class="reference internal" href="#executive-summary">1. Executive Summary</a></li>
<li><a class="reference internal" href="#scope">2. Scope</a><ul>
<li><a class="reference internal" href="#model-purpose-and-intended-usage">2.1 Model Purpose and Intended Usage</a><ul>
<li><a class="reference internal" href="#model-purpose">2.1.1 Model Purpose</a></li>
<li><a class="reference internal" href="#curve-construction">2.1.2 Curve Construction</a></li>
<li><a class="reference internal" href="#risk-generation">2.1.3 Risk Generation</a></li>
<li><a class="reference internal" href="#curve-construction-requirements">2.1.4 Curve Construction Requirements</a><ul>
<li><a class="reference internal" href="#date-node-structure">2.1.4.1 Date/Node Structure</a></li>
<li><a class="reference internal" href="#arbitrage-free-single-set-of-market-data">2.1.4.2 Arbitrage-Free (Single Set of Market Data)</a></li>
<li><a class="reference internal" href="#global-consistency">2.1.4.3 Global Consistency</a></li>
<li><a class="reference internal" href="#correct-cross-currency-basis">2.1.4.4 Correct Cross-Currency Basis</a></li>
<li><a class="reference internal" href="#complex-interpolation">2.1.4.5 Complex Interpolation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#intended-use">2.1.5 Intended Use</a><ul>
<li><a class="reference internal" href="#valuation-and-curve-usage">2.1.5.1 Valuation and Curve Usage</a></li>
<li><a class="reference internal" href="#risk">2.1.5.2 Risk</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#conceptual-soundness">2.2 Conceptual Soundness</a><ul>
<li><a class="reference internal" href="#literature-review">2.2.1 Literature Review</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#product-payoff-portfolio">3. Product / Payoff / Portfolio</a><ul>
<li><a class="reference internal" href="#description">3.1 Description</a><ul>
<li><a class="reference internal" href="#curve-engine">3.1.1 Curve Engine</a></li>
</ul>
</li>
<li><a class="reference internal" href="#relationship-to-other-approved-models-payoffs">3.2 Relationship to Other Approved Models/Payoffs</a></li>
<li><a class="reference internal" href="#inputs">3.3 Inputs</a><ul>
<li><a class="reference internal" href="#ad-or-fd">3.3.1 AD or FD</a></li>
<li><a class="reference internal" href="#curve-queries">3.3.2 Curve Queries</a><ul>
<li><a class="reference internal" href="#discount-factor">3.3.2.1 Discount Factor</a></li>
<li><a class="reference internal" href="#forward-rate">3.3.2.2 Forward Rate</a></li>
<li><a class="reference internal" href="#index-value">3.3.2.3 Index Value</a></li>
</ul>
</li>
<li><a class="reference internal" href="#notation">3.3.3 Notation</a></li>
<li><a class="reference internal" href="#curve-types-internal-representation">3.3.4 Curve Types - Internal Representation</a><ul>
<li><a class="reference internal" href="#discount-factor-curves">3.3.4.1 Discount Factor Curves</a></li>
<li><a class="reference internal" href="#forward-rate-curves">3.3.4.2 Forward Rate Curves</a></li>
</ul>
</li>
<li><a class="reference internal" href="#curve-types-external-usage-taxonomy">3.3.5 Curve Types - External Usage (Taxonomy)</a><ul>
<li><a class="reference internal" href="#discount-curve">3.3.5.1 Discount Curve</a></li>
<li><a class="reference internal" href="#forecast-curve">3.3.5.2 Forecast Curve</a></li>
<li><a class="reference internal" href="#inflation-index-curves">3.3.5.3 Inflation (Index) Curves</a></li>
</ul>
</li>
<li><a class="reference internal" href="#table">3.3.6 Table</a></li>
<li><a class="reference internal" href="#price-rate">3.3.7 Price/Rate</a></li>
<li><a class="reference internal" href="#instruments">3.3.8 Instruments</a><ul>
<li><a class="reference internal" href="#convexity">3.3.8.1 Convexity</a></li>
<li><a class="reference internal" href="#daycount-fraction-tau">3.3.8.2 Daycount Fraction (<span class="math notranslate nohighlight">\(\tau\)</span>)</a></li>
<li><a class="reference internal" href="#deposit-forward-rate">3.3.8.3 Deposit/Forward Rate</a></li>
<li><a class="reference internal" href="#future">3.3.8.4 Future</a><ul>
<li><a class="reference internal" href="#m-3m-future">3.3.8.4.1 1m/3m Future</a></li>
<li><a class="reference internal" href="#averaging-future">3.3.8.4.2 Averaging Future</a></li>
<li><a class="reference internal" href="#compounding-future">3.3.8.4.3 Compounding Future</a></li>
<li><a class="reference internal" href="#convexity-and-the-front-future">3.3.8.4.4 Convexity and the Front Future</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#payoff">3.3.8.4.5. Payoff</a></li>
<li><a class="reference internal" href="#penalty-function-scaling">3.3.8.4.6. Penalty function scaling</a></li>
</ul>
</li>
<li><a class="reference internal" href="#swap">3.3.8.5. Swap</a></li>
<li><a class="reference internal" href="#forward-spread">3.3.8.6. Forward Spread</a></li>
<li><a class="reference internal" href="#basis-swap-may-be-referred-to-as-tenor-basis-swap">3.3.8.7. Basis Swap (may be referred to as Tenor Basis Swap)</a></li>
<li><a class="reference internal" href="#fx-forward">3.3.8.8. FX Forward</a><ul>
<li><a class="reference internal" href="#id1">3.3.8.8.1 Penalty function scaling</a></li>
<li><a class="reference internal" href="#cross-currency-basis-swap">3.3.8.9. Cross Currency Basis Swap</a></li>
<li><a class="reference internal" href="#i-o-mtm-cross-currency-basis-swap">3.3.8.10 I/O MTM Cross Currency Basis Swap</a></li>
<li><a class="reference internal" href="#cross-currency-swap">3.3.8.11 Cross Currency Swap</a></li>
<li><a class="reference internal" href="#mtm-gross-currency-swap">3.3.8.12   MTM Gross Currency Swap</a></li>
<li><a class="reference internal" href="#swap-spread-spread-between-two-swaps">3.3.8.13   (Swap) Spread (spread between two swaps)</a></li>
<li><a class="reference internal" href="#spread-constraint">3.3.8.14 Spread Constraint</a><ul>
<li><a class="reference internal" href="#id2">3.3.8.14.1 Payoff</a></li>
<li><a class="reference internal" href="#id3">3.3.8.14.2 Penalty function scaling</a></li>
</ul>
</li>
<li><a class="reference internal" href="#fly-butterfly-between-three-swaps">3.3.8.15 Fly (butterfly between three swaps)</a></li>
<li><a class="reference internal" href="#fly-constraint-butterfly-between-any-other-three-instruments">3.3.8.16 Fly Constraint (butterfly between any other three instruments)</a><ul>
<li><a class="reference internal" href="#id4">3.3.8.16.1. Payoff</a></li>
<li><a class="reference internal" href="#calculate-coefficients">3.3.8.16.2. Calculate Coefficients</a></li>
<li><a class="reference internal" href="#id5">3.3.8.16.3. Penalty function scaling</a></li>
</ul>
</li>
<li><a class="reference internal" href="#term-deposit">3.3.8.17. Term Deposit</a></li>
<li><a class="reference internal" href="#turn">3.3.8.18. Turn</a></li>
<li><a class="reference internal" href="#jump">3.3.8.19 Jump</a></li>
<li><a class="reference internal" href="#ibor-jump">3.3.8.20 Ibor Jump</a></li>
<li><a class="reference internal" href="#nominal-bond">3.3.8.21 (Nominal) Bond</a><ul>
<li><a class="reference internal" href="#penalty-function-calculation">3.3.8.21.1 Penalty function calculation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#inflation-instruments-lag-and-instrument-interpolation">3.3.8.22 Inflation Instruments Lag and Instrument Interpolation</a><ul>
<li><a class="reference internal" href="#inflation-lag">3.3.8.22.1. Inflation lag</a></li>
<li><a class="reference internal" href="#inflation-instrument-interpolation">3.3.8.22.2 Inflation instrument interpolation</a></li>
<li><a class="reference internal" href="#flat">3.3.8.22.2.1 Flat</a></li>
<li><a class="reference internal" href="#linear">3.3.8.22.2.2. Linear</a></li>
<li><a class="reference internal" href="#natural">3.3.8.22.2.3. Natural</a></li>
<li><a class="reference internal" href="#swedish-and-icelandic-inflation-bond-interpolation">3.3.8.22.2.4. Swedish and Icelandic inflation bond interpolation</a></li>
<li><a class="reference internal" href="#australian-inflation-bond-interpolation">3.3.8.22.2.5. Australian inflation bond interpolation</a></li>
<li><a class="reference internal" href="#mexican-inflation-bond-interpolation">3.3.8.22.2.6. Mexican inflation bond interpolation</a></li>
<li><a class="reference internal" href="#unused-interpolation-types">3.3.8.22.2.7. Unused interpolation types</a></li>
</ul>
</li>
<li><a class="reference internal" href="#inflation-zero-coupon-swap">3.3.8.23 Inflation Zero Coupon Swap</a><ul>
<li><a class="reference internal" href="#id6">3.3.8.23.1. Payoff</a></li>
</ul>
</li>
<li><a class="reference internal" href="#inflation-future">3.3.8.24. Inflation Future</a></li>
<li><a class="reference internal" href="#inflation-bond">3.3.8.25. Inflation Bond</a><ul>
<li><a class="reference internal" href="#id7">3.3.8.25.1. Penalty function calculation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#real-rate-swap">3.3.8.26 Real Rate Swap</a></li>
<li><a class="reference internal" href="#inflation-bond-spread-coupon-spread-ncf-name-inflation-asset-swap-spread">3.3.8.27 Inflation Bond Spread (Coupon Spread) [NCF name: Inflation Asset Swap Spread]</a></li>
<li><a class="reference internal" href="#seasonality">3.3.8.28 Seasonality</a></li>
<li><a class="reference internal" href="#interpolation">3.3.9 Interpolation</a><ul>
<li><a class="reference internal" href="#geometric-log-linear">3.3.9.1 Geometric/log linear</a><ul>
<li><a class="reference internal" href="#extrapolation">3.3.9.1.1 Extrapolation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#linear-zero-rate-interpolation-exponential">3.3.9.2 Linear Zero Rate Interpolation (‘Exponential’)</a><ul>
<li><a class="reference internal" href="#id8">3.3.9.2.1. Extrapolation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#log-cubic">3.3.9.3. Log-cubic</a><ul>
<li><a class="reference internal" href="#id9">3.3.9.3.1. Extrapolation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cpi-linear-inflation-curves-only">3.3.9.4. CPI linear (inflation curves only)</a></li>
<li><a class="reference internal" href="#local-discount-factor-curve-inflation-representation">3.3.9.4.1 Local, Discount Factor Curve (Inflation Representation)</a><ul>
<li><a class="reference internal" href="#id10">3.3.9.4.1. Extrapolation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#linear-rate">3.3.9.5. Linear Rate</a></li>
<li><a class="reference internal" href="#local-forward-rate-curve">3.3.9.5.1 Local, Forward Rate Curve</a><ul>
<li><a class="reference internal" href="#id11">3.3.9.5.1. Extrapolation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#quadratic-rate">3.3.9.6. Quadratic Rate</a><ul>
<li><a class="reference internal" href="#right-gradient">3.3.9.6.1. Right gradient</a></li>
<li><a class="reference internal" href="#left-gradient">3.3.9.6.2. Left gradient</a></li>
<li><a class="reference internal" href="#id12">3.3.9.6.3. Extrapolation</a></li>
<li><a class="reference internal" href="#id13">3.3.9.7. Extrapolation</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#id14">3.3.10 Seasonality</a></li>
<li><a class="reference internal" href="#interpolation-choice-and-granularity-of-market-data">3.3.11 Interpolation choice and granularity of market data</a><ul>
<li><a class="reference internal" href="#granular-market-data-granular-node-dates-local-interpolation">3.3.11.1. Granular market data (granular node dates) =&gt; local interpolation</a><ul>
<li><a class="reference internal" href="#linear-interpolation-of-1m-3m-fwds">3.3.11.1.1 Linear interpolation of 1m/3m fwds</a></li>
</ul>
</li>
<li><a class="reference internal" href="#sparse-market-data-sparse-node-dates-smooth-interpolation">3.3.11.2. Sparse market data (sparse node dates) -&gt; smooth interpolation</a></li>
<li><a class="reference internal" href="#split-interpolation">3.3.11.3. Split Interpolation</a></li>
<li><a class="reference internal" href="#single-interpolators">3.3.11.4. Single interpolators</a></li>
</ul>
</li>
<li><a class="reference internal" href="#implementation-specificities">3.3.12. Implementation specificities</a><ul>
<li><a class="reference internal" href="#discounting">3.3.12.1. Discounting</a><ul>
<li><a class="reference internal" href="#g7-currencies-curve-calibration">3.3.12.1.1 G7 Currencies Curve Calibration</a></li>
<li><a class="reference internal" href="#other-currencies-curve-calibration">3.3.12.1.2 Other Currencies Curve Calibration</a></li>
</ul>
</li>
<li><a class="reference internal" href="#ccp-aware-curves">3.3.12.2 CCP-Aware Curves</a></li>
</ul>
</li>
<li><a class="reference internal" href="#jpy-ccp-basis">JPY CCP basis</a></li>
<li><a class="reference internal" href="#outputs">3.4 Outputs</a><ul>
<li><a class="reference internal" href="#curve-representation">3.4.1 Curve representation</a><ul>
<li><a class="reference internal" href="#multiple-interpolators">3.4.1.1. Multiple interpolators</a></li>
</ul>
</li>
<li><a class="reference internal" href="#curve-market-data-object">3.4.2 Curve Market Data object</a></li>
<li><a class="reference internal" href="#risk-market-data-object">3.4.3 Risk Market Data object</a></li>
</ul>
</li>
<li><a class="reference internal" href="#payoff-analysis">3.5 Payoff Analysis</a></li>
<li><a class="reference internal" href="#portfolio-description-and-trends">3.6 Portfolio description and trends</a></li>
</ul>
</li>
<li><a class="reference internal" href="#model-methodology">4. Model / Methodology</a><ul>
<li><a class="reference internal" href="#id15">4.1 Description</a><ul>
<li><a class="reference internal" href="#model-design-development">4.1.1 Model design &amp; development</a><ul>
<li><a class="reference internal" href="#objective-function">4.1.1.1 Objective function</a></li>
<li><a class="reference internal" href="#optimisation-1">4.1.1.2 Optimisation (1)</a><ul>
<li><a class="reference internal" href="#nag-parameters">4.1.1.2.1 NAG parameters</a></li>
<li><a class="reference internal" href="#maxcal">4.1.1.2.1.1 MAXCAL</a></li>
</ul>
</li>
<li><a class="reference internal" href="#algorithmic-differentiation">4.1.1.3 Algorithmic Differentiation</a></li>
<li><a class="reference internal" href="#instrument-penalty">4.1.1.4 Instrument penalty</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#instrument-misprice-and-convergence">4.1.1.5. Instrument misprice and convergence</a><ul>
<li><a class="reference internal" href="#negative-discount-factors">4.1.1.6 Negative discount factors</a></li>
<li><a class="reference internal" href="#node-dates-degrees-of-freedom">4.1.1.7 Node dates (degrees of freedom)</a></li>
<li><a class="reference internal" href="#smoothing">4.1.1.8. Smoothing</a><ul>
<li><a class="reference internal" href="#smoothing-penalty-weight-w-curve">4.1.1.8.1. Smoothing penalty weight <span class="math notranslate nohighlight">\((W_{curve})\)</span></a></li>
</ul>
</li>
<li><a class="reference internal" href="#optimisation-2">4.1.1.9. Optimisation (2)</a></li>
<li><a class="reference internal" href="#inverse-jacobian-matrix">4.1.1.10. (Inverse) jacobian matrix</a><ul>
<li><a class="reference internal" href="#id16">4.1.1.10.1. NAG parameters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#types-of-curve-build">4.1.1.11. Types of curve build</a><ul>
<li><a class="reference internal" href="#complete-build-initial-construction">4.1.1.11.1. Complete build (initial construction)</a></li>
<li><a class="reference internal" href="#full-rebuild">4.1.1.11.2. Full rebuild</a></li>
<li><a class="reference internal" href="#fast-jacobian-rebuild">4.1.1.11.3. Fast (jacobian) rebuild</a></li>
</ul>
</li>
<li><a class="reference internal" href="#jacobian-rebuild-tolerance">4.1.1.12. Jacobian rebuild tolerance</a></li>
<li><a class="reference internal" href="#engine-parameters-for-rebuilds">4.1.1.13. Engine parameters for rebuilds</a></li>
<li><a class="reference internal" href="#solve-stages">4.1.1.14. Solve Stages</a><ul>
<li><a class="reference internal" href="#example">4.1.1.14.1. Example</a></li>
<li><a class="reference internal" href="#jacobian-rebuild-matrix-solve-stages">4.1.1.14.2. Jacobian rebuild matrix – solve stages</a></li>
</ul>
</li>
<li><a class="reference internal" href="#regulatory-compliance">4.1.2 Regulatory compliance</a></li>
</ul>
</li>
<li><a class="reference internal" href="#assumptions-limitations-and-outliers">4.2 Assumptions, Limitations and Outliers</a><ul>
<li><a class="reference internal" href="#validation">4.2.1 Validation</a><ul>
<li><a class="reference internal" href="#design">4.2.1.1 Design</a></li>
<li><a class="reference internal" href="#forward-looking-checks">4.2.1.2 Forward-looking checks</a><ul>
<li><a class="reference internal" href="#test-process">4.2.1.2.1 Test process</a></li>
<li><a class="reference internal" href="#summary-report">4.2.1.2.2 Summary report</a></li>
<li><a class="reference internal" href="#error-report">4.2.1.2.3 Error report</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#assumptions-and-limitations">4.2.2 Assumptions and limitations</a></li>
<li><a class="reference internal" href="#convergence-to-a-global-minimum">4.2.6 Convergence to a global minimum</a></li>
<li><a class="reference internal" href="#non-convergence-poorly-set-node-dates">4.2.7 Non-convergence – poorly set node dates</a></li>
<li><a class="reference internal" href="#inappropriate-curve-poorly-set-node-dates">4.2.8 Inappropriate curve – poorly set node dates</a></li>
<li><a class="reference internal" href="#smoothing-penalty-weight">4.2.9 Smoothing penalty weight</a><ul>
<li><a class="reference internal" href="#too-low">4.2.9.1. Too low</a></li>
<li><a class="reference internal" href="#too-high">4.2.9.2. Too high</a></li>
</ul>
</li>
<li><a class="reference internal" href="#smoothing-interpolation-choice">4.2.10 Smoothing &amp; interpolation choice</a></li>
</ul>
</li>
<li><a class="reference internal" href="#model-parameters-variables">4.3 Model Parameters / Variables</a></li>
<li><a class="reference internal" href="#model-outputs">4.4 Model Outputs</a></li>
<li><a class="reference internal" href="#model-uncertainty">4.5 Model Uncertainty</a></li>
<li><a class="reference internal" href="#risk-factor">4.6 Risk Factor</a></li>
<li><a class="reference internal" href="#feeder-models">4.7 Feeder Models</a></li>
<li><a class="reference internal" href="#justification-against-alternative-approaches">4.8 Justification against alternative approaches</a></li>
<li><a class="reference internal" href="#conditions-of-use">4.9 Conditions of Use</a><ul>
<li><a class="reference internal" href="#stressed-market-conditions">4.9.1 Stressed Market Conditions</a></li>
<li><a class="reference internal" href="#other">4.9.2 Other</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#implementation-numerical-schema-description">5. Implementation / Numerical Schema Description</a><ul>
<li><a class="reference internal" href="#id17">5.1 Description</a></li>
<li><a class="reference internal" href="#id18">5.2 Inputs</a></li>
<li><a class="reference internal" href="#quality-control">5.3 Quality control</a></li>
<li><a class="reference internal" href="#limitations">5.4 Limitations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#calibration">6. Calibration</a><ul>
<li><a class="reference internal" href="#id19">6.1 Description</a></li>
<li><a class="reference internal" href="#id20">6.2 Inputs</a><ul>
<li><a class="reference internal" href="#reference-data-market-data-and-other-data-inputs">6.2.1 Reference Data: Market Data and Other Data Inputs</a></li>
<li><a class="reference internal" href="#data-sources">6.2.2 Data Sources</a></li>
<li><a class="reference internal" href="#exchange-price">6.2.3 Exchange price</a></li>
<li><a class="reference internal" href="#broker-quote">6.2.4 Broker quote</a></li>
<li><a class="reference internal" href="#manual-input">6.2.5 Manual input</a></li>
<li><a class="reference internal" href="#data-availability-history">6.2.6 Data availability/history</a></li>
<li><a class="reference internal" href="#data-quality-and-data-checks">6.2.7 Data quality and data checks</a></li>
<li><a class="reference internal" href="#calibration-algorithm-inputs">6.2.8 Calibration Algorithm Inputs</a></li>
<li><a class="reference internal" href="#other-inputs">6.2.9 Other Inputs</a></li>
<li><a class="reference internal" href="#curves">6.2.10 Curves</a><ul>
<li><a class="reference internal" href="#jacobian-matrix">6.2.10.1. Jacobian matrix</a></li>
<li><a class="reference internal" href="#application">7.1.5.1. Application</a></li>
<li><a class="reference internal" href="#calculation-of-the-jacobian-transform-matrix">7.1.5.2. Calculation of the Jacobian transform matrix</a><ul>
<li><a class="reference internal" href="#numerical-method">7.1.5.2.1. Numerical method</a></li>
<li><a class="reference internal" href="#id21">7.1.5.2.2. Algorithmic Differentiation</a></li>
<li><a class="reference internal" href="#comparison-of-ad-vs-fd">7.1.5.2.3. Comparison of AD vs. FD</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#typical-risk-representations">7.1.6 Typical risk representations</a><ul>
<li><a class="reference internal" href="#single-outright-curve">7.1.6.1. Single outright curve</a></li>
<li><a class="reference internal" href="#market-instruments">7.1.6.2. Market instruments</a></li>
<li><a class="reference internal" href="#all-outright-curves">7.1.6.3. All outright curves</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#id22">7.2 Inputs</a><ul>
<li><a class="reference internal" href="#shock-size">7.2.1 Shock size</a></li>
<li><a class="reference internal" href="#id23">7.2.2 AD or FD</a></li>
</ul>
</li>
<li><a class="reference internal" href="#assumptions-limitations-and-risk-assessment">7.3 Assumptions, Limitations and Risk Assessment</a><ul>
<li><a class="reference internal" href="#jacobian-transform-accuracy">7.3.1 Jacobian transform accuracy</a><ul>
<li><a class="reference internal" href="#suboptimal-transform">7.3.1.1. Suboptimal transform</a></li>
<li><a class="reference internal" href="#optimal-transform">7.3.1.2. Optimal transform</a></li>
</ul>
</li>
<li><a class="reference internal" href="#approximation-of-finite-difference">7.3.2    Approximation of finite difference</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#test-and-outcome-analyses-performed-on-payoff-model-portfolio">8. Test and Outcome analyses performed on Payoff/Model/Portfolio</a><ul>
<li><a class="reference internal" href="#back-testing">8.1    Back testing</a></li>
<li><a class="reference internal" href="#stress-testing">8.2    Stress-testing</a><ul>
<li><a class="reference internal" href="#testing-development-background">8.2.1    Testing/development background</a><ul>
<li><a class="reference internal" href="#currencies">8.2.1.1. Currencies</a></li>
</ul>
</li>
<li><a class="reference internal" href="#testing-stressed-market-conditions">8.2.2    2008/9 testing – stressed market conditions</a><ul>
<li><a class="reference internal" href="#gbp-16-sep-2008">8.2.2.1. GBP 16-Sep-2008</a><ul>
<li><a class="reference internal" href="#curve-inputs-stress-test">8.2.2.1.    Curve inputs – stress test</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id24">8.2.2.2.    2016/7</a><ul>
<li><a class="reference internal" href="#jpy">8.2.2.2.1.    JPY</a></li>
<li><a class="reference internal" href="#eur">8.2.2.2.2.    EUR</a></li>
<li><a class="reference internal" href="#gbp">8.2.2.2.3.    GBP</a></li>
<li><a class="reference internal" href="#usd">8.2.2.2.4.    USD</a></li>
<li><a class="reference internal" href="#fd">8.2.2.2.5.    FD</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#shock-sizes">8.2.3    Shock sizes</a><ul>
<li><a class="reference internal" href="#mispricing-of-shocked-curves">8.2.3.1. Mispricing of shocked curves</a></li>
<li><a class="reference internal" href="#incremental-shocking">8.2.3.2. Incremental shocking</a><ul>
<li><a class="reference internal" href="#id25">8.2.3.2.1.    USD</a></li>
<li><a class="reference internal" href="#g7">8.2.3.2.2.    G7</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#jacobian-rebuild-accuracy">8.2.4    Jacobian rebuild accuracy</a><ul>
<li><a class="reference internal" href="#finite-difference-in-engine-build">8.2.4.1. Finite difference in engine build</a></li>
</ul>
</li>
<li><a class="reference internal" href="#extreme-scenario-analysis">8.2.5    Extreme scenario analysis</a><ul>
<li><a class="reference internal" href="#finite-difference">8.2.5.1. Finite difference</a></li>
</ul>
</li>
<li><a class="reference internal" href="#summary">8.2.6    Summary</a></li>
</ul>
</li>
<li><a class="reference internal" href="#statistical-testing">8.3    Statistical testing</a></li>
<li><a class="reference internal" href="#impact-of-assumptions-and-limitations">8.4    Impact of Assumptions and Limitations</a><ul>
<li><a class="reference internal" href="#smoothing-penalty-no-choice-of-nodes">8.4.1    Smoothing penalty - no choice of nodes</a><ul>
<li><a class="reference internal" href="#stepmx">8.5.1.3. STEPMX</a></li>
<li><a class="reference internal" href="#multiple-parameters">8.5.1.4. Multiple parameters</a></li>
<li><a class="reference internal" href="#iprint">8.5.1.5. IPRINT</a></li>
</ul>
</li>
<li><a class="reference internal" href="#fo1blf">8.5.2  FO1BLF</a><ul>
<li><a class="reference internal" href="#t">8.5.2.1. T</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#boundary-cases">8.6  Boundary Cases</a><ul>
<li><a class="reference internal" href="#invalid-price">8.6.1  Invalid price</a></li>
<li><a class="reference internal" href="#unit-tests">8.6.2  Unit tests</a></li>
</ul>
</li>
<li><a class="reference internal" href="#comparison-to-other-models">8.7  Comparison to Other Models</a></li>
<li><a class="reference internal" href="#other-outcome-analysis-testing">8.8  Other Outcome Analysis / Testing</a><ul>
<li><a class="reference internal" href="#development-testing">8.8.1  Development Testing</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#general-limitations">9. General Limitations</a><ul>
<li><a class="reference internal" href="#full-rebuild-time">9.1 Full rebuild time</a></li>
</ul>
</li>
<li><a class="reference internal" href="#model-monitoring-kpis">10. Model Monitoring – KPIs</a><ul>
<li><a class="reference internal" href="#monitoring-tests-and-key-performance-indicators-kpi">10.1 Monitoring Tests and Key Performance Indicators (KPI)</a></li>
<li><a class="reference internal" href="#performance-exceptions">10.2 Performance Exceptions</a></li>
<li><a class="reference internal" href="#exception-mitigation-plan">10.3 Exception Mitigation Plan</a></li>
</ul>
</li>
<li><a class="reference internal" href="#summary-of-feedback-received-during-development">11. Summary of Feedback Received During Development</a></li>
<li><a class="reference internal" href="#references">12. References</a><ul>
<li><a class="reference internal" href="#id26">12.1 Literature Review</a></li>
<li><a class="reference internal" href="#nag">12.3 NAG</a><ul>
<li><a class="reference internal" href="#id27">12.4 Algorithmic Differentiation</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=32e29ea5"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=60a0e41e"></script>
    <script src="../../_static/design-tabs.js?v=36754332"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>